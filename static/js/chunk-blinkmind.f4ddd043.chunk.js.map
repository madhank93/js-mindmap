{"version":3,"sources":["images/default.jpg","images/theme1.jpg","images/theme2.jpg","images/theme3.jpg","images/theme4.jpg","../node_modules/@blink-mind/renderer-react/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/renderer-react/node_modules/tiny-warning/dist/tiny-warning.esm.js","../node_modules/@blink-mind/renderer-react/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-simple-text-editor/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/plugin-simple-text-editor/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-simple-text-editor/lib/main.es.js","../node_modules/@blink-mind/renderer-react/lib/main.es.js","../node_modules/@blink-mind/plugin-rich-text-editor/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/plugin-rich-text-editor/node_modules/tiny-warning/dist/tiny-warning.esm.js","../node_modules/@blink-mind/plugin-rich-text-editor/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-rich-text-editor/node_modules/@blink-mind/renderer-react/lib/main.es.js","../node_modules/@blink-mind/plugin-rich-text-editor/lib/main.es.js","../node_modules/@blink-mind/plugin-json-serializer/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/plugin-json-serializer/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-json-serializer/lib/main.es.js","../node_modules/@blink-mind/plugin-theme-selector/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/plugin-theme-selector/node_modules/tiny-warning/dist/tiny-warning.esm.js","../node_modules/@blink-mind/plugin-theme-selector/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-theme-selector/lib/main.es.js","../node_modules/@blink-mind/plugin-topology-diagram/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/plugin-topology-diagram/node_modules/tiny-warning/dist/tiny-warning.esm.js","../node_modules/@blink-mind/plugin-topology-diagram/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugin-topology-diagram/node_modules/@blink-mind/renderer-react/lib/main.es.js","../node_modules/@blink-mind/plugin-topology-diagram/lib/main.es.js","../node_modules/@blink-mind/plugins/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/plugins/node_modules/tiny-warning/dist/tiny-warning.esm.js","../node_modules/@blink-mind/plugins/node_modules/@blink-mind/core/lib/main.es.js","../node_modules/@blink-mind/plugins/node_modules/@blink-mind/renderer-react/lib/main.es.js","../node_modules/@blink-mind/plugins/lib/main.es.js","component/toolbar/toolbar-item-open.js","../node_modules/@blink-mind/core/node_modules/is-plain-object/index.es.js","../node_modules/@blink-mind/core/lib/main.es.js","component/toolbar/toolbar-item-layout.js","component/toolbar/toolbar-item-theme.js","component/toolbar/toolbar-item-export.js","utils/index.js","component/toolbar/toolbar-item-search.js","component/toolbar/toolbar.js","component/mindmap.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","isObjectObject","o","val","Array","isArray","Object","prototype","toString","call","ctor","prot","constructor","hasOwnProperty","DiagramLayoutType","condition","message","TopicDirection","TopicVisualLevel","BlockType","FocusMode","TopicRelationship","OpType","_Record","Block","_super","this","apply","arguments","key","get","value","obj","isList","map","create","Error","concat","type","data","defaultConfigRecord","readOnly","allowUndo","layoutDir","LEFT_AND_RIGHT","theme","name","randomColor","background","highlightColor","marginH","marginV","contentStyle","lineHeight","linkStyle","lineRadius","lineType","lineWidth","rootTopic","fontSize","borderRadius","padding","subLinkStyle","lineColor","primaryTopic","borderWidth","borderStyle","normalTopic","border","_Record2","Config","_super2","createKey","replace","c","r","Math","random","_Record3","Topic","_super3","index","blocks","findIndex","b","block","_obj$parentKey","parentKey","_obj$subKeys","subKeys","_obj$collapse","collapse","createList","_ref","_ref$parentKey","_ref$content","content","_ref$subKeys","_ref$collapse","relations","style","getAllSubTopicKeys","model","topicKey","item","getTopic","res","size","_res","toArray","push","reduce","acc","getRelationship","srcKey","dstKey","srcTopic","dstTopic","pTopic","getParentTopic","log","focusTopic","_ref6","focusMode","focusKey","set","addChild","_ref8","topic","child","update","topics","addSibling","_ref9","rootTopicKey","pItem","idx","indexOf","sibling","updateIn","insert","toggleCollapse","_ref2","merge","collapseAll","_ref3","topicKeys","editorRootTopicKey","withMutations","m","forEach","setIn","expandAll","_ref4","expandTo","_ref5","keys","reverse","length","undefined","unshift","getKeyPath","filter","t","setFocusMode","_ref7","deleteTopic","_ref10","delete","deleteKeys","dKey","setBlockData","_ref11","blockType","_topic$getBlock","getBlock","dt","deleteBlock","_ref12","setStyle","_ref13","s","clearAllCustomStyle","_ref14","keySeq","setTheme","_ref15","setLayoutDir","_ref16","config","setEditorRootTopicKey","_ref17","setZoomFactor","_ref18","zoomFactor","defaultModelRecord","extData","formatVersion","CorePlugin","options","_options$plugins","plugins","registerPlugin","controller","plugin","p","fn","middleware","compose","TypeError","_step","_iterator","n","done","err","e","f","context","next","dispatch","i","bind","Controller","_options$plugins2","onChange","Map","corePlugin","fns","composedFn","_len","args","_key","propKey","arg","run","callback","currentModel","_extendStatics","d","setPrototypeOf","__proto__","__extends","__","_assign","assign","cooked","raw","templateObject_1","Content","div","defineProperty","props","SimpleTextEditor","_this","state","onMouseDown","stopPropagation","onMouseMove","onKeyDown","_handleClick","event","root","contains","target","onClickOutSide","rootRef","saveRef","ref","initState","_a","setState","componentDidMount","document","addEventListener","componentWillUnmount","removeEventListener","getCustomizeProps","getContent","deserialize","render","_b","getRefKeyFunc","placeholder","editorProps","contentProps","autoFocus","contentEditorRefKey","TopicContentEditor","nativeEvent","ctrlKey","code","save","whiteSpace","editingContentKey","opType","log$2","descEditorRefKey","TopicDescEditor","editingDescKey","getTopicTitle","maxLength","text","substr","renderTopicContentEditor","renderTopicDescEditor","isBlockEmpty","serializeBlockData","serialize","__rest","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","desc","getOwnPropertyDescriptor","Reflect","decorate","__values","Symbol","iterator","__read","ar","error","__spread","templateObject_2","templateObject_1$1","templateObject_2$1","templateObject_3","templateObject_4","templateObject_5","templateObject_6","templateObject_7","templateObject_8","templateObject_9","templateObject_10","templateObject_11","BaseWidget","operation","enumerable","configurable","DragScrollView","DragScrollContent","DragScrollWidget","contentResizeCallback","entries","observer","oldContentRect","widgetStyle","width","clientWidth","viewBox","height","clientHeight","bigView","contentRect","contentResizeObserver","contentRef","observe","viewBoxRef","enableMouseWheel","altKey","preventDefault","passive","setViewBoxScroll","bigViewRef","setWidgetStyle","left","top","scrollLeft","scrollTop","setViewBoxScrollDelta","deltaLeft","deltaTop","mouseKey","needKeyPressed","canDragFunc","button","_lastCoordX","clientX","_lastCoordY","clientY","ele","onMouseUp","handleContextMenu","transform","transformOrigin","children","defaultProps","SaveRef","getRef","node","fireListener","deleteRef","observers","e_1","has","listeners","listeners_1","listeners_1_1","listener","e_1_1","return","registerRefListener","Flex","flexDirection","alignItems","justifyContent","Margin","margin","ShowMenuIcon","a","IconBg","Btn","StyledCheckbox","CloseIcon","Title","TopicBlockIcon","span","ZIndex","zIndex","PanelTabRoot","EventPlugin","eventListeners","handleTopicClick","handleTopicDoubleClick","handleTopicContextMenu","handleActiveModalClose","activeModalProps","once","only","origin","fireEvent","IconName","iconClassName","Icon","iconName","className","contentRefKey","topicWidgetRefKey","topicRefKey","linksRefKey","linksSvgRefKey","collapseRefKey","dropAreaRefKey","dir","RefKey","EventKey","PropKey","cancelEvent","browserDownloadText","filename","url","link","createElement","href","download","click","browserDownloadFile","encodeURIComponent","browserOpenFile","accept","input","Promise","resolve","reject","evt","file","files","fr","FileReader","onload","txt","result","onerror","readAsText","paddingCss","right","_c","bottom","_d","centerY","rect","centerPointX","p1","p2","x","centerPointY","y","center","_getRelativeRect","el","rel","scale","getBoundingClientRect","relCenter","elCenter","getRelativeVector","HotKeyName","HotKeyPlugin","customizeHotKeys","handleKeyDown","op","topicHotKeys","label","combo","globalHotKeys","log$3","OperationPlugin","OpMap","dropDir","srcParentKey","srcParentSubKeys","srcIndex","dstSubKeys_1","dstParentKey_1","dstParentSubKeys_1","dstIndex","newDstParentSubKeys_1","undoStack","redoStack","enabled","whiteListOperation","Set","isOperationEnabled","enableOperation","disableOperation","whiteList","clear","getOpMap","getAllowUndo","getUndoRedoStack","setUndoStack","setRedoStack","canUndo","canRedo","undo","newModel","peek","shift","change","redo","opArray","opNotInWhiteList","opMap","undoStack_1","cur","opFunc","opFuncProps","deleteRefKey","allSubKeys","allSubKeys_1","allSubKeys_1_1","beforeOperation","afterOperation","beforeOpFunction","afterOpFunction","TopicContextMenu","icon","shortcut","rootCanUse","templateObject_1$2","templateObject_1$3","log$4","DropEffectSvg","svg","TopicDropEffect","layout","targetProps","svgRect","fill","stroke","strokeDasharray","strokeWidth","log$5","DropArea","DragAndDropPlugin","dragTargetKey","dragTargetDir","renderTopicDropArea","eventHandlers","onDragEnter","ev","onDragLeave","onDragOver","onDrop","renderDragAndDropEffect","getDragTargetProps","handleTopicDragStart","canDrop","handleTopicDragEnter","handleTopicDragLeave","relatedTarget","handleTopicDrop","templateObject_1$4","templateObject_2$2","templateObject_3$1","templateObject_1$5","templateObject_2$3","templateObject_1$6","templateObject_1$7","templateObject_2$4","templateObject_1$8","templateObject_2$5","templateObject_3$2","EditorRootBreadcrumbsRoot","TooltipContent","BreadcrumbTitle","EditorRootBreadcrumbs","breadcrumbRenderer","breadProps","needTooltip","title","tooltipProps","position","BOTTOM_RIGHT","breadcrumb","show","editingRootKey","items","getValue","onClick","breadcrumbProps","NodeLayer","DIV","MindDragScrollWidget","dragScrollWidget","onWheel","deltaY","renderHotkeys","hotKeys","v","k","global","nodeLayer","rootTopicRect","nodeLayerRect","componentDidUpdate","nodeKey","rootWidgetProps","Modals","handleClose","activeModal","onClose","isOpen","enforceFocus","usePortal","DIALOG_BODY","minHeight","RootLinksSvg","log$6","RootSubLinks","curves","curve","vDir","hDir","radius","log$7","LayerPart","topicDirection","RootWidget","renderPartTopics","isRoot","subTopics","cxName","topicStyle","topicContent","partTopics","L","R","LEFT_TO_RIGHT","RIGHT_TO_LEFT","TOP_TO_BOTTOM","B","Icon$1","TopicCollapseIcon","onClickCollapse","iconfont","templateObject_1$9","templateObject_2$6","log$8","EditingRoot","EditingWrapper","cancelEvent$1","TopicContent","editor","wrapper_1","rect_1","editorDiv","contentResizeObserver_1","templateObject_1$a","templateObject_2$7","templateObject_1$b","log$9","TopicContent$1","TopicContentWithDropArea","TopicContentWidget","onDragStart","handleTopicClickTimeout","setTimeout","onDoubleClick","clearTimeout","needRelocation","oldCollapseIconVector","dragEnter","renderContextMenu","onContextMenuClose","newRect","newVector","vector","draggable","collapseIcon","prevDropArea","nextDropArea","dropEventHandlers","log$a","TooltipContentWrapper","TopicDesc","isEditing","descEditor","diagramRoot","maxWidth","maxHeight","dRect","classname","POPOVER_DISMISS","tabIndex","interactionKind","HOVER","hoverOpenDelay","templateObject_1$c","templateObject_1$d","templateObject_1$e","templateObject_2$8","templateObject_3$3","templateObject_1$f","templateObject_2$9","templateObject_3$4","templateObject_1$g","FocusHighlightSvg","TopicHighlight","TopicLinksSvg","log$b","TopicSubLinks","p3","z","collapseRect","subContent","abs","log$c","Node","NodeChildren","NodeTopic","TopicWidget","renderSubTopics","subLinks","layoutLinks","links","propsMore","log$d","ViewerRoot","Item_","ZoomFactorSpan","tooltip","TOP","ICON","ViewPortViewer","zoomFactorChange","onClickResetZoom","onClickAddZoom","onClickMinusZoom","onClickCollapseAll","centerRootTopic","onClickExpandAll","floor","DescEditorWrapper","hasBackdrop","backdropProps","isCloseButtonShown","descData","Theme","templateObject_1$h","log$e","RenderingPlugin","diagramProps","DiagramRoot","getDiagramProps","renderDiagram","renderDrawer","renderDiagramCustomize","nProps","renderEditorRootBreadcrumbs","renderModals","renderModal","getActiveModalProps","renderDoc","renderRootWidget","renderTopicWidget","renderTopicContent","renderTopicCollapseIcon","renderTopicContentOthers","renderTopicBlocks","blockKey","renderTopicBlock","renderTopicBlockContent","renderTopicBlockDesc","renderSubLinks","renderRootSubLinks","renderFocusItemHighlight","renderRootWidgetOtherChildren","renderViewPortViewer","templateObject_1$i","templateObject_2$a","PanelRoot","StyledTabs","RightTopPanel","selectedTabId","handleTabIdChange","expand","setExpand","id","templateObject_1$j","templateObject_2$b","templateObject_3$5","templateObject_4$1","templateObject_5$1","templateObject_6$1","templateObject_7$1","SettingTitle","SettingItem","SettingBoxContainer","SettingLabel","SettingRow","ColorBar","color","WithBorder","SettingGroup","SettingItemColorPicker","handleColorChange","onChangeComplete","hex","SettingItemButton","handleClick","SettingItemNumericInput","restProps","flexProps","SettingItemSelect","itemRenderer","onItemSelect","PxSelect","ofType","pxProps","filterable","unit","borderWidthItems","borderWidthItems$1","borderRadiusItems","borderStyleItems","BorderStyleEditor","setContentStyle","borderColor","lineTypes","modifiers","query","LinkStyleEditor","showLinkStyle","showSubLinkStyle","setLinkStyle","setSubLinkStyle","TextStyleEditor","fontSizeNumInputProps","min","max","parseInt","onValueChange","lineHeightInputProps","copiedStyle","log$f","StyleEditor","linkStyleEditorProps","contentStyleEditorPros","JSON","stringify","ClearAllCustomStyle","PaddingStyleEditor","commonProps","setPadding","topProps","rightProps","bottomProps","leftProps","templateObject_1$k","TopicThemeEditorRoot","TopicThemeEditor","setTopicStyle","tabId","ThemeEditor","handler","alertThemeError","setAlertThemeError","handleRandomColorChange","checked","rootTopicEditorProps","rootTopicEditor","primaryTopicEditorProps","primaryTopicEditor","normalTopicEditorProps","normalTopicEditor","tabsProps","topicThemes","panel","alertProps","alert","then","parse","RightTopPanelPlugin","renderRightTopPanel","renderRightTopPanelTabs","renderTopicStyleEditor","tProps","renderThemeEditor","log$g","UtilsPlugin","tempValueMap","eventListenerMap","addTempValueChangeListener","removeTempValueChangeListener","l","getTempValue","setTempValue","deleteTempValue","log$h","StylePlugin","colorMap","colorIndex","getTopicStyle","getTopicContentStyle","themeStyle","visualLevel","getTopicVisualLevel","customStyle","getLinkStyle","presetStyle","parentSubLinkStyle","getSubLinkStyle","setTopicContentStyle","styleObj","newStyleObj","newStyleStr","getTopicThemeStyle","getRandomColor","colors","DefaultPlugin","renderTopicContextMenu","customizeTopicContextMenu","onClickItem","labelElement","getPartTopics","subTopicCount","slice","ceil","createSubTopics","tKey","topicProps","highlight","dropEffect","layoutTopic","topicWidget","subKey","getRelativeRect","element","getRelativeRectFromViewPort","getRelativeVectorFromViewPort","addZoomFactorChangeEventListener","removeZoomFactorChangeEventListener","getZoomFactor","moveTopicToCenter","dragScroll","focusTopicAndMoveToCenter","Diagram","resolveController","TheDefaultPlugin","defaultPlugin","construct","openNewModel","_Record4","Model","_super4","values","toJS","level","attrs","createEmpty","isModel","fromJSON","object","_object$topics","_object$config","_templateObject","_templateObject2","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","_templateObject8","_templateObject9","_templateObject10","_templateObject11","_templateObject12","_templateObject13","_templateObject14","_templateObject15","_templateObject16","_templateObject17","_templateObject18","_templateObject19","_templateObject20","_templateObject21","_templateObject22","_templateObject23","_templateObject24","_templateObject25","_templateObject26","_templateObject27","_templateObject28","_templateObject29","_templateObject30","_templateObject31","_templateObject32","_templateObject33","_templateObject34","_templateObject35","_templateObject36","_templateObject37","_templateObject38","_templateObject39","_templateObject40","_templateObject41","_templateObject42","_templateObject43","_templateObject44","_templateObject45","_templateObject46","_templateObject47","_templateObject48","_templateObject49","_templateObject50","_templateObject51","_templateObject52","_templateObject53","_templateObject54","_templateObject55","_templateObject56","_templateObject57","_excluded","_excluded2","_excluded3","_excluded4","_excluded5","_Component","_Component2","_this$props","_Component3","_this2","ToolbarItemPopoverTarget","I18nKey","_arg$top","_arg$right","_arg$bottom","_arg$left","getI18nText","ctx","toUpperCase","relRect","_props$layout","_props$layout2","SettingItemInput","_props$layout3","ToolbarItemRoot","disabled","ToolbarItem","MoveTopicDir","_props","I18nPlugin","i18nTextMap","getI18nTextMap","dstSubKeys","dstParentKey","dstParentSubKeys","newDstParentSubKeys","_ctx$allowUndo","_controller$run3","_controller$run4","_undoStack","_step3","_iterator3","_BaseWidget","_BaseWidget2","_super5","_this3","dragDrop","diagramState","targetKey","targetDir","setDiagramState","_props2","_PureComponent","_super6","_this4","_this$props2","_this5","_this$props3","Root","DiagramContainer","_useState","_useState2","_BaseWidget3","_super7","_this6","_this6$props","_BaseWidget4","_super8","_this7","_BaseWidget5","_super9","_this8","_this$props4","_Component4","_super10","_this$props5","wrapper","_BaseWidget6","_super11","_this9","_this9$props","_this$props6","_BaseWidget7","_super12","_this10","_this$props7","_BaseWidget8","_super13","_this11","_this$props8","_Component5","_super14","_this$props9","_BaseWidget9","_super15","_this12","_this12$props","getInitialDiagramState","rightTopPanel","RightTopPanelWidget","setRightTopPanelState","_props$showLinkStyle","_props$showSubLinkSty","_props$linkStyle","_props$subLinkStyle","_topicStyle$contentSt","_topicStyle$linkStyle","_topicStyle$subLinkSt","_useState3","_useState4","_controller$run6","isClone","ToolbarRoot","ToolbarItemLayout","layoutDirs","ToolbarPlugin","renderToolbar","renderToolbarItems","itemConfigs","sort","order","customizeToolbar","_step4","_iterator4","_PureComponent2","_super16","_this13","_this$props10","_this$getCustomizePro2","log$j","contentEditorRefKey$1","_SimpleTextEditor","_super17","_this14","_this$props11","_this$props12","log$k","descEditorRefKey$1","_SimpleTextEditor2","_super18","_this15","_this$props13","_this$props14","_this$props15","log$l","_step2","_iterator2","_props$moveDir","moveDir","boxRect","topicRect","delta","createNewModel","getThemeOfTopic","NodeContent","RichTextEditor","richEditorProps","editorValue","nodeContentProps","markdownSerializer","themeRandomColorSquare","theme1","theme2","boxShadow","theme3","theme4","TopicBlockTopology","iconProps","ToolsConfig","group","paddingLeft","paddingRight","paddingTop","paddingBottom","iconFamily","iconColor","textMaxLine","image","is3D","zRotate","fillStyle","iconSize","strokeStyle","font","fontFamily","fontWeight","rectInParent","rotate","textAlign","textBaseline","Canvas","Tools","ToolTitle","ToolbarButtons","TopologyDiagram","toolsConfig","canvasOptions","onMessage","diagramUtil","topology","setCanvasData","canvasRegister","on","openData","open","onDrag","dataTransfer","setData","renderTools","btn","onContextMenu","Root$1","TopologyDiagramUtils","canvasData","getTopology","scaleTo","deleteConfirm","deleteAlertProps","cancelButtonText","onConfirm","onCancel","DiagramWrapper","TopologyDrawer","utilProps","backdropClassName","canOutsideClickClose","topologyData","startEditingTopology","renderTopicBlockTopology","topoProps","AddReferenceTopicPanel","referenceKeys","defaultReferenceRecord","keyList","dataMap","ReferenceRecord","defaultExtDataReferenceRecord","reference","ExtDataReference","getReferenceKeys","getReferencedKeys","includes","setReferenceTopicKeys","getExtDataItem","referenceRecord","ButtonPlace","ReferenceTopicThumbnail","refKey","refType","removeHandler","setDeleteConfirm","Root$2","Group","GroupList","GroupTitle","GotoBtn","ReferenceTopicList","referenceGroup","thumbProps","referencedKeys","referencedGroup","currentTopic","TopicExtReference","refRecord","CLICK","TopicReferenceCheckbox","selectedTopicKeys","setChecked","checkboxProps","add","NavOmniBar","StyledNavOmniBar","TopicTitle","StyledPopover","Tip","TipContent","INPUT_PROPS","SearchPanel","setSearchWord","navigateToTopic","sections","getAllSections","inputProps","itemListPredicate","toLowerCase","section","sectionTitle","needTip","titleProps","titleEl","popoverProps","HOVER_TARGET_ONLY","resetOnSelect","ToolbarItemOpen","diagram","middleware_1","middleware_1_1","_i","_e","cx","ToolbarItemTheme","themes","defaultThemeImg","theme1Img","theme2Img","theme3Img","theme4Img","themeKey","src","alt","ToolbarItemExport","json","jsonStr","downloadFile","ToolbarItemSearch","Toolbar","onClickUndo","onClickRedo","React","PureComponent","debug","RichTextEditorPlugin","themeMap","getAllThemes","allTheme","ThemeSelectorPlugin","startSetReferenceTopics","allDeleteKeys","extData_1","reference_1","deleteKey","panelProps","EXT_KEY_TOPIC_REFERENCE","checkBoxProps","checkbox","renderTopicExtReference","clearSelectedReferenceKeys","getSelectedReferenceKeys","from","deserializeExtDataItem","extDataKey","extDataItem","extDataReference","_loop_1","TopicReferencePlugin","setSearchWorld","searchPanelProps","SearchPlugin","TopologyDiagramPlugin","serializeModel","nextRes","valueSeq","deserializeModel","serializeExtData","deserializeExtData","serializeExtDataItem","serializeConfig","deserializeConfig","serializeTopic","deserializeTopic","deserializeTopics","serializeBlock","deserializeBlock","deserializeBlockData","deserializeBlocks","Mindmap","diagramRef","initModel","toolbarProps","Component","App","Boolean","window","location","hostname","match","localStorage","join","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/chunk-blinkmind.f4ddd043.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/default.4f8c4983.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme1.2f59f00b.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme2.b18193fb.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme3.61c97910.jpg\";","module.exports = __webpack_public_path__ + \"static/media/theme4.1e21408c.jpg\";","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","var isProduction = process.env.NODE_ENV === 'production';\n\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import { BlockType, OpType, FocusMode } from '@blink-mind/core';\nimport { createElement, PureComponent } from 'react';\nimport plainSerializer from 'slate-plain-serializer';\nimport debug from 'debug';\nimport { Editor } from 'slate-react';\nimport styled from 'styled-components';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar log = debug('node:text-editor');\nvar Content = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"], [\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"])), function (props) {\n  return props.readOnly ? null : 'white';\n}, function (props) {\n  return props.readOnly ? 'pointer' : 'text';\n});\n\nvar SimpleTextEditor = function (_super) {\n  __extends(SimpleTextEditor, _super);\n\n  function SimpleTextEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      content: null\n    };\n\n    _this.onMouseDown = function (e) {\n      e.stopPropagation();\n    };\n\n    _this.onMouseMove = function (e) {// log('onMouseMove');\n      // e.stopPropagation();\n    };\n\n    _this.onKeyDown = function (e) {};\n\n    _this._handleClick = function (event) {\n      var wasOutside = !_this.root.contains(event.target);\n      wasOutside && _this.onClickOutSide(event);\n    };\n\n    _this.rootRef = function (saveRef) {\n      return function (ref) {\n        saveRef(ref);\n        _this.root = ref;\n      };\n    };\n\n    _this.initState();\n\n    return _this;\n  }\n\n  SimpleTextEditor.prototype.onChange = function (_a) {\n    var value = _a.value;\n    log('onChange', value);\n    this.setState({\n      content: value\n    });\n  };\n\n  SimpleTextEditor.prototype.componentDidMount = function () {\n    var readOnly = this.props.readOnly;\n    if (readOnly) return;\n    document.addEventListener('click', this._handleClick);\n  };\n\n  SimpleTextEditor.prototype.componentWillUnmount = function () {\n    var readOnly = this.props.readOnly;\n    if (readOnly) return;\n    document.removeEventListener('click', this._handleClick);\n  };\n\n  SimpleTextEditor.prototype.onClickOutSide = function (e) {};\n\n  SimpleTextEditor.prototype.getCustomizeProps = function () {\n    return null;\n  };\n\n  SimpleTextEditor.prototype.getContent = function () {\n    var block = this.getCustomizeProps().block;\n    var content = block.data;\n    if (content == null) return null;\n\n    if (typeof content === 'string') {\n      content = plainSerializer.deserialize(content);\n    }\n\n    return content;\n  };\n\n  SimpleTextEditor.prototype.initState = function () {\n    var content = this.getContent();\n    this.state = {\n      content: content\n    };\n  };\n\n  SimpleTextEditor.prototype.render = function () {\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n\n    var _b = this.getCustomizeProps(),\n        readOnly = _b.readOnly,\n        getRefKeyFunc = _b.getRefKeyFunc,\n        placeholder = _b.placeholder,\n        style = _b.style;\n\n    log(readOnly);\n    var key = getRefKeyFunc(topicKey);\n    var content = readOnly ? this.getContent() : this.state.content;\n\n    var _c = this,\n        onMouseDown = _c.onMouseDown,\n        onMouseMove = _c.onMouseMove,\n        onKeyDown = _c.onKeyDown;\n\n    var editorProps = {\n      value: content,\n      readOnly: readOnly,\n      onChange: this.onChange.bind(this),\n      placeholder: placeholder,\n      style: style\n    };\n    var contentProps = {\n      key: key,\n      readOnly: readOnly,\n      ref: this.rootRef(saveRef(key)),\n      onMouseDown: onMouseDown,\n      onMouseMove: onMouseMove,\n      onKeyDown: onKeyDown\n    };\n    return createElement(Content, _assign({}, contentProps), createElement(Editor, _assign({}, editorProps, {\n      autoFocus: true\n    })));\n  };\n\n  return SimpleTextEditor;\n}(PureComponent);\n\nvar templateObject_1;\nvar log$1 = debug('node:topic-content-editor');\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\" + key;\n}\n\nvar TopicContentEditor = function (_super) {\n  __extends(TopicContentEditor, _super);\n\n  function TopicContentEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.onKeyDown = function (e) {\n      if (e.nativeEvent.ctrlKey && e.nativeEvent.code === 'Enter') {\n        _this.save();\n      }\n    };\n\n    return _this;\n  }\n\n  TopicContentEditor.prototype.getCustomizeProps = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey,\n        readOnly = _a.readOnly;\n    var block = model.getTopic(topicKey).getBlock(BlockType.CONTENT).block;\n    var getRefKeyFunc = contentEditorRefKey;\n    var style = {\n      whiteSpace: 'pre'\n    };\n    return {\n      block: block,\n      readOnly: readOnly,\n      getRefKeyFunc: getRefKeyFunc,\n      placeholder: 'new',\n      style: style\n    };\n  };\n\n  TopicContentEditor.prototype.onClickOutSide = function (e) {\n    log$1('onClickOutSide');\n    this.save();\n  };\n\n  TopicContentEditor.prototype.save = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey;\n    var readOnly = model.editingContentKey !== topicKey;\n    if (readOnly) return;\n    var controller = this.props.controller;\n    controller.run('operation', _assign(_assign({}, this.props), {\n      opType: OpType.SET_TOPIC_BLOCK,\n      blockType: BlockType.CONTENT,\n      data: this.state.content,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  return TopicContentEditor;\n}(SimpleTextEditor);\n\nvar log$2 = debug('node:topic-desc-editor');\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\" + key;\n}\n\nvar TopicDescEditor = function (_super) {\n  __extends(TopicDescEditor, _super);\n\n  function TopicDescEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    log$2('constructor');\n    return _this;\n  }\n\n  TopicDescEditor.prototype.initState = function () {\n    _super.prototype.initState.call(this);\n\n    var _a = this.props,\n        controller = _a.controller,\n        topicKey = _a.topicKey;\n    var key = \"topic-desc-data-\" + topicKey;\n    var value = this.state.content;\n    controller.run('setTempValue', {\n      key: key,\n      value: value\n    });\n  };\n\n  TopicDescEditor.prototype.getCustomizeProps = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey;\n    var block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n    var readOnly = model.editingDescKey !== topicKey;\n    var getRefKeyFunc = descEditorRefKey;\n    return {\n      block: block,\n      readOnly: readOnly,\n      getRefKeyFunc: getRefKeyFunc,\n      placeholder: 'write topic notes here'\n    };\n  };\n\n  TopicDescEditor.prototype.onChange = function (_a) {\n    var value = _a.value;\n    log$2('onChange');\n    var _b = this.props,\n        controller = _b.controller,\n        topicKey = _b.topicKey,\n        model = _b.model;\n    var readOnly = model.editingDescKey !== topicKey;\n    if (readOnly) return;\n    var key = \"topic-desc-data-\" + topicKey;\n    controller.run('setTempValue', {\n      key: key,\n      value: value\n    });\n    this.setState({\n      content: value\n    });\n  };\n\n  return TopicDescEditor;\n}(SimpleTextEditor);\n\nfunction SimpleTextEditorPlugin() {\n  return {\n    getTopicTitle: function getTopicTitle(props) {\n      var model = props.model,\n          controller = props.controller,\n          topicKey = props.topicKey,\n          maxLength = props.maxLength;\n      var topic = model.getTopic(topicKey);\n      var block = topic.getBlock(BlockType.CONTENT).block;\n      var text = controller.run('serializeBlockData', _assign(_assign({}, props), {\n        block: block\n      }));\n\n      if (maxLength != null) {\n        text = text.length > maxLength ? text.substr(0, maxLength) + '...' : text;\n      }\n\n      return text;\n    },\n    renderTopicContentEditor: function renderTopicContentEditor(props) {\n      return createElement(TopicContentEditor, _assign({}, props));\n    },\n    renderTopicDescEditor: function renderTopicDescEditor(props) {\n      return createElement(TopicDescEditor, _assign({}, props));\n    },\n    isBlockEmpty: function isBlockEmpty(props, next) {\n      var block = props.block,\n          controller = props.controller;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return block.data == null || controller.run('serializeBlockData', props) === '';\n      }\n\n      return next();\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var block = props.block;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return typeof block.data === 'string' ? block.data : plainSerializer.serialize(block.data);\n      }\n\n      return next();\n    }\n  };\n}\n\nexport default SimpleTextEditorPlugin;","import { PureComponent, createElement, Component, Fragment, useState } from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled, { css, ThemeProvider } from 'styled-components';\nimport debug from 'debug';\nimport { Checkbox, Menu, MenuItem, Breadcrumbs, PopoverPosition, Breadcrumb, Tooltip, Hotkey, Hotkeys, HotkeysTarget, Dialog, Classes, ContextMenuTarget, PopoverInteractionKind, Popover, Position, Drawer, Tabs, Divider, Button, NumericInput, InputGroup, Tab, Alert } from '@blueprintjs/core';\nimport { FocusMode, OpType, DiagramLayoutType, ModelModifier, getRelationship, TopicRelationship, getAllSubTopicKeys, BlockType, TopicDirection, isThemeType, TopicVisualLevel, Controller } from '@blink-mind/core';\nimport '@blink-mind/icons';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport memoizeOne from 'memoize-one';\nimport SimpleTextEditorPlugin from '@blink-mind/plugin-simple-text-editor';\nimport { Stack, List } from 'immutable';\nimport cx from 'classnames';\nimport { Select } from '@blueprintjs/select';\nimport { SketchPicker } from 'react-color';\nimport { merge, clone, isEqual } from 'lodash';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n}\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar BaseWidget = function (_super) {\n  __extends(BaseWidget, _super);\n\n  function BaseWidget(props) {\n    return _super.call(this, props) || this;\n  }\n\n  BaseWidget.prototype.operation = function (opType, arg) {\n    this.props.controller.run('operation', _assign({\n      opType: opType\n    }, arg));\n  };\n\n  BaseWidget.prototype.run = function (name, arg) {\n    this.props.controller.run(name, arg);\n  };\n\n  Object.defineProperty(BaseWidget.prototype, \"topic\", {\n    get: function get() {\n      return this.props.model.getTopic(this.props.topicKey);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return BaseWidget;\n}(PureComponent);\n\nvar log = debug('node:drag-scroll-widget');\nvar DragScrollView = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"], [\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"])));\nvar DragScrollContent = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  position: relative;\\n  width: max-content;\\n\"], [\"\\n  position: relative;\\n  width: max-content;\\n\"])));\n\nvar DragScrollWidget = function (_super) {\n  __extends(DragScrollWidget, _super);\n\n  function DragScrollWidget(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.contentResizeCallback = function (entries, observer) {\n      if (_this.oldContentRect) {\n        var widgetStyle = {\n          width: _this.content.clientWidth + _this.viewBox.clientWidth * 2,\n          height: _this.content.clientHeight + _this.viewBox.clientHeight * 2\n        };\n        _this.bigView.style.width = widgetStyle.width + 'px';\n        _this.bigView.style.height = widgetStyle.height + 'px';\n      }\n\n      _this.oldContentRect = entries[0].contentRect;\n    };\n\n    _this.contentResizeObserver = new ResizeObserver(_this.contentResizeCallback);\n\n    _this.contentRef = function (ref) {\n      if (ref) {\n        _this.content = ref;\n\n        _this.contentResizeObserver.observe(_this.content);\n      }\n    };\n\n    _this.viewBoxRef = function (ref) {\n      if (ref) {\n        _this.viewBox = ref;\n\n        if (!_this.props.enableMouseWheel) {\n          log('addEventListener onwheel');\n\n          _this.viewBox.addEventListener('wheel', function (e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          }, {\n            passive: false\n          });\n        }\n\n        _this.setViewBoxScroll(_this.viewBox.clientWidth, _this.viewBox.clientHeight);\n      }\n    };\n\n    _this.bigViewRef = function (ref) {\n      if (ref) {\n        _this.bigView = ref;\n      }\n    };\n\n    _this.setWidgetStyle = function () {\n      if (_this.content && _this.viewBox && _this.bigView) {\n        _this.bigView.style.width = (_this.content.clientWidth + _this.viewBox.clientWidth) * 2 + 'px';\n        _this.bigView.style.height = (_this.content.clientHeight + _this.viewBox.clientHeight) * 2 + 'px';\n        _this.content.style.left = _this.viewBox.clientWidth + 'px';\n        _this.content.style.top = _this.viewBox.clientHeight + 'px';\n      }\n    };\n\n    _this.setViewBoxScroll = function (left, top) {\n      log(\"setViewBoxScroll \" + left + \" \" + top);\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft = left;\n        _this.viewBox.scrollTop = top;\n      }\n    };\n\n    _this.setViewBoxScrollDelta = function (deltaLeft, deltaTop) {\n      log(\"setViewBoxScrollDelta \" + deltaLeft + \" \" + deltaTop);\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft += deltaLeft;\n        _this.viewBox.scrollTop += deltaTop;\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      // log('Drag Scroll onMouseDown');\n      // log(e.nativeEvent.target);\n      // mouseKey \n      // needKeyPressed ctrl\n      // canDragFunc\n      var _a = _this.props,\n          mouseKey = _a.mouseKey,\n          needKeyPressed = _a.needKeyPressed,\n          canDragFunc = _a.canDragFunc;\n      if (canDragFunc && !canDragFunc()) return;\n\n      if (e.button === 0 && mouseKey === 'left' || e.button === 2 && mouseKey === 'right') {\n        if (needKeyPressed) {\n          if (!e.ctrlKey) return;\n        }\n\n        _this._lastCoordX = _this.viewBox.scrollLeft + e.nativeEvent.clientX;\n        _this._lastCoordY = _this.viewBox.scrollTop + e.nativeEvent.clientY;\n        var ele = _this.viewBox;\n        ele.addEventListener('mousemove', _this.onMouseMove);\n        ele.addEventListener('mouseup', _this.onMouseUp);\n      }\n    };\n\n    _this.onMouseUp = function (e) {\n      var ele = _this.viewBox;\n      ele.removeEventListener('mousemove', _this.onMouseMove);\n      ele.removeEventListener('mouseup', _this.onMouseUp);\n    };\n\n    _this.onMouseMove = function (e) {\n      _this.viewBox.scrollLeft = _this._lastCoordX - e.clientX;\n      _this.viewBox.scrollTop = _this._lastCoordY - e.clientY; // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n    };\n\n    _this.handleContextMenu = function (e) {\n      e.preventDefault();\n    };\n\n    _this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n    return _this;\n  }\n\n  DragScrollWidget.prototype.componentDidMount = function () {\n    this.setWidgetStyle();\n    document.addEventListener('contextmenu', this.handleContextMenu);\n  };\n\n  DragScrollWidget.prototype.componentWillUnmount = function () {\n    document.removeEventListener('contextmenu', this.handleContextMenu);\n  };\n\n  DragScrollWidget.prototype.setZoomFactor = function (zoomFactor) {\n    this.bigView.style.transform = \"scale(\" + zoomFactor + \")\";\n    this.bigView.style.transformOrigin = '50% 50%';\n  };\n\n  DragScrollWidget.prototype.render = function () {\n    var style = _assign({}, this.state.widgetStyle // zoom:this.props.zoomFactor,\n    // transform: `scale(${this.props.zoomFactor})`,\n    // transformOrigin: '50% 50%'\n    );\n\n    return createElement(DragScrollView, {\n      ref: this.viewBoxRef,\n      onMouseDown: this.onMouseDown\n    }, createElement(\"div\", {\n      style: style,\n      ref: this.bigViewRef\n    }, createElement(DragScrollContent, {\n      ref: this.contentRef,\n      style: this.state.contentStyle\n    }, this.props.children(this.setViewBoxScroll, this.setViewBoxScrollDelta))));\n  };\n\n  DragScrollWidget.defaultProps = {\n    mouseKey: 'left',\n    needKeyPressed: false\n  };\n  return DragScrollWidget;\n}(Component);\n\nvar templateObject_1, templateObject_2;\nvar log$1 = debug('node:save-ref'); //TODO ,topic\n\nvar SaveRef = function (_super) {\n  __extends(SaveRef, _super);\n\n  function SaveRef() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.getRef = function (name) {\n      log$1(_this);\n      return _this[name];\n    };\n\n    _this.saveRef = function (name) {\n      return function (node) {\n        if (node) {\n          _this[name] = node;\n\n          _this.fireListener(name, node);\n        }\n      };\n    };\n\n    _this.deleteRef = function (name) {\n      log$1('deleteRef:', name);\n      delete _this[name];\n    };\n\n    _this.observers = new Map();\n\n    _this.fireListener = function (name, ref) {\n      var e_1, _a;\n\n      if (_this.observers.has(name)) {\n        var listeners = _this.observers.get(name);\n\n        try {\n          for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\n            var listener = listeners_1_1.value;\n            listener(name, ref);\n          }\n        } catch (e_1_1) {\n          e_1 = {\n            error: e_1_1\n          };\n        } finally {\n          try {\n            if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n        }\n      }\n    };\n\n    _this.registerRefListener = function (name, listener) {\n      if (!_this.observers.has(name)) {\n        _this.observers.set(name, [listener]);\n      } else {\n        _this.observers.get(name).push(listener);\n      }\n    };\n\n    return _this;\n  }\n\n  SaveRef.prototype.render = function () {\n    return this.props.children(this.saveRef, this.getRef, this.deleteRef, this.registerRefListener.bind(this));\n  };\n\n  return SaveRef;\n}(Component);\n\nvar Flex = styled.div(templateObject_1$1 || (templateObject_1$1 = __makeTemplateObject([\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"], [\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"])), function (props) {\n  return props.flexDirection ? props.flexDirection : 'row';\n}, function (props) {\n  return props.alignItems;\n}, function (props) {\n  return props.justifyContent;\n});\nvar Margin = styled.div(templateObject_2$1 || (templateObject_2$1 = __makeTemplateObject([\"\\n  margin: \", \";\\n\"], [\"\\n  margin: \", \";\\n\"])), function (props) {\n  return props.margin;\n});\nvar ShowMenuIcon = styled.a(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  font-size: 20px !important;\\n\"], [\"\\n  font-size: 20px !important;\\n\"])));\nvar IconBg = styled.div(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"], [\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"])));\nvar Btn = styled.div(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"], [\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"])));\nvar StyledCheckbox = styled(Checkbox)(templateObject_6 || (templateObject_6 = __makeTemplateObject([\"\\n  margin-bottom: 0px !important;\\n\"], [\"\\n  margin-bottom: 0px !important;\\n\"])));\nvar CloseIcon = styled(Btn)(templateObject_7 || (templateObject_7 = __makeTemplateObject([\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"], [\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"])));\nvar Title = styled.div(templateObject_8 || (templateObject_8 = __makeTemplateObject([\"\\n  height: 16px;\\n\"], [\"\\n  height: 16px;\\n\"])));\nvar TopicBlockIcon = styled.span(templateObject_9 || (templateObject_9 = __makeTemplateObject([\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"], [\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"])));\nvar ZIndex = styled.div(templateObject_10 || (templateObject_10 = __makeTemplateObject([\"\\n  z-index: \", \";\\n\"], [\"\\n  z-index: \", \";\\n\"])), function (props) {\n  return props.zIndex;\n});\nvar PanelTabRoot = styled.div(templateObject_11 || (templateObject_11 = __makeTemplateObject([\"\\n  min-width: 360px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"], [\"\\n  min-width: 360px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"])));\nvar templateObject_1$1, templateObject_2$1, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8, templateObject_9, templateObject_10, templateObject_11;\nvar log$2 = debug('plugin:event');\n\nfunction EventPlugin() {\n  var eventListeners = {};\n  return {\n    handleTopicClick: function handleTopicClick(props) {\n      log$2('handleTopicClick');\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey;\n      log$2(model.zoomFactor); //TODO\n\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (model.focusKey === topicKey && model.focusMode === FocusMode.EDITING_CONTENT) return;\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      }));\n    },\n    handleTopicDoubleClick: function handleTopicDoubleClick(props) {\n      var controller = props.controller,\n          model = props.model;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      }));\n    },\n    handleTopicContextMenu: function handleTopicContextMenu(props) {\n      var controller = props.controller;\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n    },\n    handleActiveModalClose: function handleActiveModalClose(props) {\n      var controller = props.controller;\n      var activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n\n      if (activeModalProps.name === 'edit-desc') {\n        return function () {\n          controller.run('operation', _assign(_assign({}, props), {\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          }));\n        };\n      }\n    },\n    addEventListener: function addEventListener(props) {\n      var key = props.key,\n          listener = props.listener,\n          once = props.once,\n          controller = props.controller;\n      if (!eventListeners[key]) eventListeners[key] = [];\n\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key: key,\n          listener: listener\n        });\n      }\n    },\n    removeEventListener: function removeEventListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(function (fn) {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n    fireEvent: function fireEvent(props) {\n      var key = props.key;\n\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(function (fn) {\n          return fn();\n        });\n      }\n    }\n  };\n}\n\nvar IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile'\n};\n\nfunction iconClassName(name) {\n  return \"icon iconfont bm-\" + name;\n}\n\nfunction Icon(iconName) {\n  return createElement(\"span\", {\n    className: iconClassName(iconName)\n  });\n}\n\nfunction contentRefKey(key) {\n  return \"content-\" + key;\n}\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\" + key;\n}\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\" + key;\n}\n\nfunction topicWidgetRefKey(key) {\n  return \"topic-widget-\" + key;\n}\n\nfunction topicRefKey(key) {\n  return \"topic-\" + key;\n}\n\nfunction linksRefKey(key) {\n  return \"links-\" + key;\n}\n\nfunction linksSvgRefKey(key) {\n  return \"links-svg-\" + key;\n}\n\nfunction collapseRefKey(key) {\n  return \"collapse-\" + key;\n}\n\nfunction dropAreaRefKey(key, dir) {\n  return \"dropArea-\" + dir + \"-\" + key;\n}\n\nvar RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nvar EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\nvar PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE'\n};\n\nvar cancelEvent = function cancelEvent(e) {\n  e.stopPropagation();\n};\n\nfunction browserDownloadFile(url, filename) {\n  var link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nfunction browserDownloadText(text, filename) {\n  var url = \"data:text/plain,\" + encodeURIComponent(text);\n  browserDownloadFile(url, filename);\n}\n\nfunction browserOpenFile(accept) {\n  var input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n  return new Promise(function (resolve, reject) {\n    input.addEventListener('change', function (evt) {\n      //@ts-ignore\n      var file = evt.target.files[0];\n      var fr = new FileReader();\n\n      fr.onload = function (evt) {\n        var txt = evt.target.result; //@ts-ignore\n\n        resolve(txt);\n      };\n\n      fr.onerror = function (evt) {\n        reject(evt.target.error);\n      };\n\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n\nfunction paddingCss(arg) {\n  var _a = arg.top,\n      top = _a === void 0 ? 0 : _a,\n      _b = arg.right,\n      right = _b === void 0 ? 0 : _b,\n      _c = arg.bottom,\n      bottom = _c === void 0 ? 0 : _c,\n      _d = arg.left,\n      left = _d === void 0 ? 0 : _d;\n  return top + \"px \" + right + \"px \" + bottom + \"px \" + left + \"px\";\n}\n\nfunction getLinkKey(fromKey, toKey) {\n  return \"link-\" + fromKey + \"-\" + toKey;\n}\n\nfunction centerY(rect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nfunction centerX(rect) {\n  return (rect.left + rect.right) / 2;\n}\n\nfunction centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nfunction centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nfunction center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\n\nfunction _getRelativeRect(el, rel, scale) {\n  if (scale === void 0) {\n    scale = 1;\n  }\n\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  var width = rect.width / scale;\n  var height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getRelativeVector(el, rel) {\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  return [elCenter[0] - relCenter[0], elCenter[1] - relCenter[1]];\n}\n\nfunction GetValuePlugin() {\n  return {\n    getValue: function getValue(props, next) {\n      var propKey = props.propKey,\n          controller = props.controller;\n\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n      }\n\n      return next();\n    }\n  };\n}\n\nvar HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction op(opType, props) {\n  var topicKey = props.topicKey,\n      model = props.model,\n      controller = props.controller;\n\n  if (topicKey === undefined) {\n    props = _assign(_assign({}, props), {\n      topicKey: model.focusKey\n    });\n  }\n\n  controller.run('operation', _assign(_assign({}, props), {\n    opType: opType\n  }));\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys: function customizeHotKeys(props) {\n      var handleKeyDown = function handleKeyDown(opType) {\n        return function (e) {\n          // log('HotKeyPlugin', opType);\n          op(opType, props);\n        };\n      };\n\n      var topicHotKeys = new Map([[HotKeyName.ADD_CHILD, {\n        label: 'add child',\n        combo: 'tab',\n        onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n      }], [HotKeyName.ADD_SIBLING, {\n        label: 'add sibling',\n        combo: 'enter',\n        onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n      }], [HotKeyName.DELETE_TOPIC, {\n        label: 'delete topic',\n        combo: 'del',\n        onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n      }], [HotKeyName.EDIT_CONTENT, {\n        label: 'edit content',\n        combo: 'space',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n      }], [HotKeyName.EDIT_NOTES, {\n        label: 'edit notes',\n        combo: 'alt + d',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n      }], [HotKeyName.SET_EDITOR_ROOT, {\n        label: 'set editor root',\n        combo: 'alt + shift + f',\n        onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n      }]]);\n      var globalHotKeys = new Map();\n      return {\n        topicHotKeys: topicHotKeys,\n        globalHotKeys: globalHotKeys\n      };\n    }\n  };\n}\n\nfunction LayoutPlugin() {\n  var _zoomFactor = 1;\n  return {\n    getPartTopics: function getPartTopics(_a) {\n      var layout = _a.layout,\n          model = _a.model,\n          topicKey = _a.topicKey;\n      var topic = model.getTopic(topicKey);\n      var subTopicCount = topic.subKeys.size;\n      var topics = topic.subKeys.toArray();\n\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return {\n            R: topics\n          };\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return {\n            L: topics\n          };\n\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n    createSubTopics: function createSubTopics(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          topics = props.topics,\n          saveRef = props.saveRef;\n      var topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      var subTopics = [];\n      topics.forEach(function (tKey) {\n        var topicProps = _assign(_assign({}, props), {\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        });\n\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return {\n        subTopics: subTopics\n      };\n    },\n    layout: function layout(props) {\n      var getRef = props.getRef,\n          model = props.model;\n      var links = getRef(linksRefKey(model.editorRootTopicKey));\n      var highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY);\n      var dropEffect = getRef(RefKey.DROP_EFFECT_KEY);\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n      var editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic) {\n        var e_1, _a;\n\n        if (topic.key !== model.editorRootTopicKey) {\n          var topicWidget = getRef(topicWidgetRefKey(topic.key));\n          topicWidget && topicWidget.layoutLinks();\n        }\n\n        if (!topic.collapse) {\n          try {\n            for (var _b = __values(topic.subKeys), _c = _b.next(); !_c.done; _c = _b.next()) {\n              var subKey = _c.value;\n              layoutTopic(model.getTopic(subKey));\n            }\n          } catch (e_1_1) {\n            e_1 = {\n              error: e_1_1\n            };\n          } finally {\n            try {\n              if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            } finally {\n              if (e_1) throw e_1.error;\n            }\n          }\n        }\n      }\n    },\n    setLayoutDir: function setLayoutDir(props) {\n      var layoutDir = props.layoutDir,\n          model = props.model,\n          controller = props.controller;\n      controller.change(ModelModifier.setLayoutDir({\n        model: model,\n        layoutDir: layoutDir\n      }));\n    },\n    getRelativeRect: function getRelativeRect(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return _getRelativeRect(element, bigView, zoomFactor);\n    },\n    getRelativeRectFromViewPort: function getRelativeRectFromViewPort(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return _getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort: function getRelativeVectorFromViewPort(props) {\n      var element = props.element,\n          getRef = props.getRef;\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n    addZoomFactorChangeEventListener: function addZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('addTempValueChangeListener', _assign({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    removeZoomFactorChangeEventListener: function removeZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('removeTempValueChangeListener', _assign({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    setZoomFactor: function setZoomFactor(props) {\n      var controller = props.controller,\n          zoomFactor = props.zoomFactor;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n    getZoomFactor: function getZoomFactor(props) {\n      var controller = props.controller;\n      return controller.run('getTempValue', {\n        key: 'ZoomFactor'\n      }) || _zoomFactor;\n    },\n    moveTopicToCenter: function moveTopicToCenter(props) {\n      var getRef = props.getRef,\n          topicKey = props.topicKey,\n          model = props.model;\n\n      if (model.editorRootTopicKey !== topicKey && getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n        throw new Error(\"moveTopicToCenter error: topicKey \" + topicKey + \" is not the DESCENDANT of editor root topic\");\n      }\n\n      var topic = getRef(topicRefKey(topicKey));\n      var dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      var viewBox = dragScroll.viewBox;\n\n      if (!topic || !viewBox) {\n        throw new Error(\"moveTopicToCenter error: topic or viewBox is null\");\n      }\n\n      var vector = getRelativeVector(topic, viewBox); //TODO\n\n      dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);\n    },\n    focusTopicAndMoveToCenter: function focusTopicAndMoveToCenter(props) {\n      var controller = props.controller,\n          topicKey = props.topicKey;\n      controller.run('operation', _assign(_assign({}, props), {\n        opArray: [{\n          opType: OpType.FOCUS_TOPIC,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL\n        }, {\n          opType: OpType.EXPAND_TO,\n          topicKey: topicKey\n        }],\n        callback: function callback() {\n          controller.run('moveTopicToCenter', _assign(_assign({}, props), {\n            topicKey: topicKey\n          }));\n        }\n      }));\n    }\n  };\n}\n\nvar log$3 = debug('plugin:operation');\n\nfunction OperationPlugin() {\n  var startEditingContent = function startEditingContent(_a) {\n    var model = _a.model,\n        topicKey = _a.topicKey;\n    return ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n\n  var startEditingDesc = function startEditingDesc(_a) {\n    var model = _a.model,\n        topicKey = _a.topicKey;\n    var topic = model.getTopic(topicKey);\n    var desc = topic.getBlock(BlockType.DESC);\n\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model: model,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    var srcKey = props.srcKey,\n        dstKey = props.dstKey,\n        dropDir = props.dropDir;\n    var model = props.model;\n    var srcTopic = model.getTopic(srcKey);\n    var dstTopic = model.getTopic(dstKey);\n    var srcParentKey = srcTopic.parentKey;\n    var srcParentTopic = model.getTopic(srcParentKey);\n    var srcParentSubKeys = srcParentTopic.subKeys;\n    var srcIndex = srcParentSubKeys.indexOf(srcKey);\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      var dstSubKeys_1 = dstTopic.subKeys;\n      dstSubKeys_1 = dstSubKeys_1.push(srcKey);\n      model = model.withMutations(function (m) {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstKey).setIn(['topics', dstKey, 'subKeys'], dstSubKeys_1).setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      var dstParentKey_1 = dstTopic.parentKey;\n      var dstParentItem = model.getTopic(dstParentKey_1);\n      var dstParentSubKeys_1 = dstParentItem.subKeys;\n      var dstIndex = dstParentSubKeys_1.indexOf(dstKey); //src  dst \n\n      if (srcParentKey === dstParentKey_1) {\n        var newDstParentSubKeys_1 = List();\n        dstParentSubKeys_1.forEach(function (key) {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys_1 = newDstParentSubKeys_1.push(srcKey).push(key);\n              } else {\n                newDstParentSubKeys_1 = newDstParentSubKeys_1.push(key).push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys_1 = newDstParentSubKeys_1.push(key);\n            }\n          }\n        });\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', dstParentKey_1, 'subKeys'], newDstParentSubKeys_1);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys_1 = dstParentSubKeys_1.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys_1 = dstParentSubKeys_1.insert(dstIndex + 1, srcKey);\n        }\n\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstParentKey_1).setIn(['topics', dstParentKey_1, 'subKeys'], dstParentSubKeys_1).setIn(['topics', dstParentKey_1, 'collapse'], false);\n        });\n      }\n    }\n\n    return model;\n  }\n\n  var OpMap = new Map([[OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse], [OpType.COLLAPSE_ALL, ModelModifier.collapseAll], [OpType.EXPAND_ALL, ModelModifier.expandAll], [OpType.EXPAND_TO, ModelModifier.expandTo], [OpType.ADD_CHILD, ModelModifier.addChild], [OpType.ADD_SIBLING, ModelModifier.addSibling], [OpType.DELETE_TOPIC, ModelModifier.deleteTopic], [OpType.FOCUS_TOPIC, ModelModifier.focusTopic], [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode], [OpType.SET_STYLE, ModelModifier.setStyle], [OpType.SET_THEME, ModelModifier.setTheme], [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData], [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock], [OpType.START_EDITING_CONTENT, startEditingContent], [OpType.START_EDITING_DESC, startEditingDesc], [OpType.DRAG_AND_DROP, dragAndDrop], [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey]]);\n  var undoStack = Stack();\n  var redoStack = Stack();\n  var enabled = true;\n  var whiteListOperation = new Set();\n  return {\n    isOperationEnabled: function isOperationEnabled(props) {\n      return enabled;\n    },\n    enableOperation: function enableOperation() {\n      enabled = true;\n    },\n    disableOperation: function disableOperation(_a) {\n      var whiteList = _a.whiteList;\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\r\n     * for example: A plugin can write a function\r\n     * getOpMap(props,next) {\r\n     *   let opMap = next();\r\n     *   opMap.set(\"OpTypeName\",opFunc);\r\n     *   return opMap;\r\n     * }\r\n     * @param props\r\n     */\n    getOpMap: function getOpMap(props) {\n      return OpMap;\n    },\n    getAllowUndo: function getAllowUndo(props) {\n      var model = props.model,\n          opType = props.opType;\n\n      if (opType) {\n        switch (opType) {\n          case OpType.FOCUS_TOPIC:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n        }\n      }\n\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n\n      return model.config.allowUndo;\n    },\n    getUndoRedoStack: function getUndoRedoStack() {\n      return {\n        undoStack: undoStack,\n        redoStack: redoStack\n      };\n    },\n    setUndoStack: function setUndoStack(props) {\n      log$3('setUndoStack', props.undoStack);\n      undoStack = props.undoStack;\n    },\n    setRedoStack: function setRedoStack(props) {\n      log$3('setRedoStack', props.redoStack);\n      redoStack = props.redoStack;\n    },\n    canUndo: function canUndo(props) {\n      var controller = props.controller;\n      var undoStack = controller.run('getUndoRedoStack', props).undoStack;\n      var allowUndo = controller.run('getAllowUndo', props);\n      return undoStack.size > 0 && allowUndo;\n    },\n    canRedo: function canRedo(props) {\n      var controller = props.controller;\n      var redoStack = controller.run('getUndoRedoStack', props).redoStack;\n      var allowUndo = controller.run('getAllowUndo', props);\n      return redoStack.size > 0 && allowUndo;\n    },\n    undo: function undo(props) {\n      var controller = props.controller,\n          model = props.model;\n\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n\n      var _a = controller.run('getUndoRedoStack', props),\n          undoStack = _a.undoStack,\n          redoStack = _a.redoStack;\n\n      var newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _assign(_assign({}, props), {\n        undoStack: undoStack.shift()\n      }));\n      controller.run('setRedoStack', _assign(_assign({}, props), {\n        redoStack: redoStack.push(model)\n      }));\n      log$3(newModel);\n      controller.change(newModel);\n    },\n    redo: function redo(props) {\n      var controller = props.controller,\n          model = props.model;\n\n      if (!controller.run('getAllowUndo', props)) {\n        return;\n      }\n\n      var _a = controller.run('getUndoRedoStack', props),\n          undoStack = _a.undoStack,\n          redoStack = _a.redoStack;\n\n      var newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _assign(_assign({}, props), {\n        undoStack: undoStack.push(model)\n      }));\n      controller.run('setRedoStack', _assign(_assign({}, props), {\n        redoStack: redoStack.shift()\n      }));\n      controller.change(newModel);\n    },\n    //TODO \n    operation: function operation(props) {\n      var controller = props.controller,\n          opType = props.opType,\n          model = props.model,\n          opArray = props.opArray,\n          callback = props.callback;\n\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n\n      var isOperationEnabled = controller.run('isOperationEnabled', props);\n\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          var opNotInWhiteList = opArray.filter(function (op) {\n            return !whiteListOperation.has(op.opType);\n          });\n\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log$3('operation:', opType);\n      log$3('operation:', model);\n      log$3('operation:', props);\n      var opMap = controller.run('getOpMap', props);\n      controller.run('beforeOperation', props);\n\n      if (controller.run('getAllowUndo', props)) {\n        var undoStack_1 = controller.run('getUndoRedoStack', props).undoStack;\n        controller.run('setUndoStack', _assign(_assign({}, props), {\n          undoStack: undoStack_1.push(model)\n        }));\n      }\n\n      var newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce(function (acc, cur) {\n          var opType = cur.opType;\n          if (!opMap.has(opType)) throw new Error(\"opType:\" + opType + \" not exist!\");\n          var opFunc = opMap.get(opType);\n\n          var opFuncProps = _assign(_assign({\n            controller: controller\n          }, cur), {\n            model: acc\n          });\n\n          var res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc(_assign(_assign({}, opFuncProps), {\n            model: res\n          }));\n          res = controller.run('afterOpFunction', _assign(_assign({}, opFuncProps), {\n            model: res\n          }));\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(\"opType:\" + opType + \" not exist!\");\n        var opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', props);\n        newModel = opFunc(_assign(_assign({}, props), {\n          model: newModel\n        }));\n        newModel = controller.run('afterOpFunction', _assign(_assign({}, props), {\n          model: newModel\n        }));\n      }\n\n      log$3('newModel:', newModel);\n      controller.change(newModel, callback);\n      controller.run('afterOperation', props);\n    },\n    deleteRefKey: function deleteRefKey(props) {\n      var e_1, _a;\n\n      var model = props.model,\n          topicKey = props.topicKey,\n          deleteRef = props.deleteRef;\n      var allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n\n      try {\n        for (var allSubKeys_1 = __values(allSubKeys), allSubKeys_1_1 = allSubKeys_1.next(); !allSubKeys_1_1.done; allSubKeys_1_1 = allSubKeys_1.next()) {\n          var key = allSubKeys_1_1.value;\n          deleteRef(linksRefKey(key));\n          deleteRef(linksSvgRefKey(key));\n          deleteRef(contentRefKey(key));\n          deleteRef(contentEditorRefKey(key));\n          deleteRef(descEditorRefKey(key));\n          deleteRef(topicWidgetRefKey(key));\n          deleteRef(topicRefKey(key));\n          deleteRef(collapseRefKey(key));\n          deleteRef(dropAreaRefKey(key, 'next'));\n          deleteRef(dropAreaRefKey(key, 'prev'));\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (allSubKeys_1_1 && !allSubKeys_1_1.done && (_a = allSubKeys_1.return)) _a.call(allSubKeys_1);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    },\n    // Operation\n    beforeOperation: function beforeOperation(props) {},\n    afterOperation: function afterOperation(props) {},\n    // OpFunction\n    beforeOpFunction: function beforeOpFunction(props) {\n      var controller = props.controller,\n          opType = props.opType,\n          model = props.model,\n          topicKey = props.topicKey;\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        controller.run('deleteRefKey', props);\n      }\n\n      return model;\n    },\n    afterOpFunction: function afterOpFunction(props) {\n      return props.model;\n    }\n  };\n}\n\nvar TopicContextMenu = function (_super) {\n  __extends(TopicContextMenu, _super);\n\n  function TopicContextMenu() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TopicContextMenu.prototype.render = function () {\n    var controller = this.props.controller;\n    return createElement(Menu, null, controller.run('customizeTopicContextMenu', this.props));\n  };\n\n  return TopicContextMenu;\n}(BaseWidget);\n\nvar items = [{\n  icon: 'edit',\n  label: 'edit',\n  shortcut: 'Space',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_CONTENT\n}, {\n  icon: 'add-sibling',\n  label: 'add sibling',\n  shortcut: 'Enter',\n  opType: OpType.ADD_SIBLING\n}, {\n  icon: 'add-child',\n  label: 'add child',\n  shortcut: 'Tab',\n  rootCanUse: true,\n  opType: OpType.ADD_CHILD\n}, {\n  icon: 'notes',\n  label: 'edit notes',\n  shortcut: 'Alt + D',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_DESC\n}, {\n  icon: 'delete-node',\n  label: 'delete node',\n  shortcut: 'Del',\n  opType: OpType.DELETE_TOPIC\n}, {\n  icon: 'root',\n  label: 'set as editor root',\n  shortcut: 'Alt + Shift + F',\n  opType: OpType.SET_EDITOR_ROOT\n}];\n\nfunction ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu: function renderTopicContextMenu(props) {\n      return createElement(TopicContextMenu, _assign({}, props));\n    },\n    customizeTopicContextMenu: function customizeTopicContextMenu(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      var isRoot = topicKey === model.editorRootTopicKey;\n\n      function onClickItem(item) {\n        return function (e) {\n          item.opType && controller.run('operation', _assign(_assign({}, props), {\n            opType: item.opType\n          }));\n        };\n      }\n\n      return items.map(function (item) {\n        return isRoot && !item.rootCanUse ? null : createElement(MenuItem, {\n          key: item.label,\n          icon: Icon(item.icon),\n          text: item.label,\n          labelElement: createElement(\"kbd\", null, item.shortcut),\n          onClick: onClickItem(item)\n        });\n      });\n    }\n  };\n}\n\nvar log$4 = debug('node:topic-drop-effect');\nvar DropEffectSvg = styled.svg(templateObject_1$2 || (templateObject_1$2 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicDropEffect = function (_super) {\n  __extends(TopicDropEffect, _super);\n\n  function TopicDropEffect() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      content: null\n    };\n    return _this;\n  }\n\n  TopicDropEffect.prototype.layout = function () {\n    var props = this.props;\n    var _a = this.props,\n        getRef = _a.getRef,\n        model = _a.model,\n        zoomFactor = _a.zoomFactor,\n        controller = _a.controller;\n    var targetProps = controller.run('getDragTargetProps', props);\n    var key = targetProps.key,\n        dropDir = targetProps.dropDir;\n    log$4('layout', dropDir);\n\n    if (key === null) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n\n    var refKey;\n\n    if (dropDir === 'in') {\n      refKey = contentRefKey(key);\n    } else {\n      refKey = dropAreaRefKey(key, dropDir);\n    }\n\n    var content = getRef(refKey);\n    var svg = getRef('svg-drop-effect');\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n    var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n    var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n    var padding = 3;\n    var x = contentRect.left - svgRect.left - padding;\n    var y = contentRect.top - svgRect.top - padding;\n    var width = contentRect.width + 2 * padding;\n    var height = contentRect.height + 2 * padding;\n    this.setState({\n      content: createElement(\"g\", null, createElement(\"rect\", {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        fill: \"none\",\n        stroke: model.config.theme.highlightColor,\n        strokeDasharray: \"5,5\",\n        strokeWidth: 2\n      }))\n    });\n  };\n\n  TopicDropEffect.prototype.render = function () {\n    var saveRef = this.props.saveRef;\n    return createElement(DropEffectSvg, {\n      ref: saveRef('svg-drop-effect')\n    }, this.state.content);\n  };\n\n  return TopicDropEffect;\n}(BaseWidget);\n\nvar templateObject_1$2;\nvar log$5 = debug('plugin:drag-and-drop');\nvar DropArea = styled.div(templateObject_1$3 || (templateObject_1$3 = __makeTemplateObject([\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"], [\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"])), function (props) {\n  return props.height + \"px\";\n});\n\nfunction DragAndDropPlugin() {\n  var dragTargetKey = null;\n  var dragTargetDir = null;\n  return {\n    renderTopicDropArea: function renderTopicDropArea(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          saveRef = props.saveRef,\n          controller = props.controller,\n          model = props.model;\n\n      var onDragEnter = function onDragEnter(ev) {\n        log$5('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', _assign(_assign({}, props), {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragLeave = function onDragLeave(ev) {\n        log$5('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', _assign(_assign({}, props), {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragOver = function onDragOver(ev) {\n        ev.preventDefault();\n      };\n\n      var onDrop = function onDrop(ev) {\n        log$5('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', _assign(_assign({}, props), {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var eventHandlers = {\n        onDragEnter: onDragEnter,\n        onDragLeave: onDragLeave,\n        onDragOver: onDragOver,\n        onDrop: onDrop\n      };\n      return createElement(DropArea, _assign({\n        height: model.config.theme.marginV / 2,\n        ref: saveRef(dropAreaRefKey(topicKey, dropDir))\n      }, eventHandlers));\n    },\n    renderDragAndDropEffect: function renderDragAndDropEffect(props) {\n      log$5('renderDragAndDropEffect');\n      var saveRef = props.saveRef;\n      return createElement(TopicDropEffect, _assign({\n        ref: saveRef(RefKey.DROP_EFFECT_KEY)\n      }, props));\n    },\n    getDragTargetProps: function getDragTargetProps(props) {\n      return {\n        key: dragTargetKey,\n        dropDir: dragTargetDir\n      };\n    },\n    handleTopicDragStart: function handleTopicDragStart(props) {\n      var controller = props.controller,\n          ev = props.ev;\n      ev.stopPropagation();\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      }));\n    },\n    canDrop: function canDrop(props) {\n      var srcKey = props.srcKey,\n          dstKey = props.dstKey,\n          model = props.model,\n          dropDir = props.dropDir;\n      if (srcKey === model.editorRootTopicKey || srcKey === dstKey || getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR) return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n      var srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n    handleTopicDragEnter: function handleTopicDragEnter(props) {\n      var dropDir = props.dropDir,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          model = props.model;\n      log$5('handleTopicDragEnter:', topicKey, dropDir);\n      var canDrop = controller.run('canDrop', _assign(_assign({}, props), {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      }));\n\n      if (canDrop) {\n        dragTargetKey = topicKey;\n        dragTargetDir = dropDir;\n        controller.change(model);\n      }\n    },\n    handleTopicDragLeave: function handleTopicDragLeave(props) {\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          getRef = props.getRef,\n          ev = props.ev;\n      var relatedTarget = ev.nativeEvent.relatedTarget;\n      log$5('handleTopicDragLeave:', topicKey, dropDir);\n      var content = getRef(contentRefKey(topicKey));\n\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n\n      dragTargetKey = null;\n      dragTargetDir = null;\n      controller.change(model);\n    },\n    handleTopicDrop: function handleTopicDrop(props) {\n      log$5('handleTopicDrop');\n      var controller = props.controller,\n          topicKey = props.topicKey,\n          model = props.model;\n      props = _assign(_assign({}, props), {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      dragTargetKey = null;\n      dragTargetDir = null;\n\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.DRAG_AND_DROP\n        }));\n      }\n    }\n  };\n}\n\nvar templateObject_1$3;\nvar EditorRootBreadcrumbsRoot = styled(ZIndex)(templateObject_1$4 || (templateObject_1$4 = __makeTemplateObject([\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"], [\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"])));\nvar TooltipContent = styled.div(templateObject_2$2 || (templateObject_2$2 = __makeTemplateObject([\"\\n  max-width: 600px;\\n\"], [\"\\n  max-width: 600px;\\n\"])));\nvar BreadcrumbTitle = styled.span(templateObject_3$1 || (templateObject_3$1 = __makeTemplateObject([\"\"], [\"\"])));\n\nvar EditorRootBreadcrumbs = function (_super) {\n  __extends(EditorRootBreadcrumbs, _super);\n\n  function EditorRootBreadcrumbs(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.setEditorRootTopicKey = function (topicKey) {\n      return function () {\n        var _a = _this.props,\n            model = _a.model,\n            controller = _a.controller;\n\n        if (model.editorRootTopicKey !== topicKey) {\n          controller.change(ModelModifier.setEditorRootTopicKey({\n            model: model,\n            topicKey: topicKey\n          }));\n        }\n      };\n    };\n\n    _this.breadcrumbRenderer = function (props) {\n      var text = props.text,\n          breadProps = __rest(props, [\"text\"]);\n\n      var needTooltip = text.length > 8;\n      var title = needTooltip ? text.substr(0, 8) + '...' : text; //TODO\n\n      var content = createElement(TooltipContent, null, text);\n      var tooltipProps = {\n        content: content,\n        position: PopoverPosition.BOTTOM_RIGHT\n      };\n      var breadcrumb = createElement(Breadcrumb, _assign({}, breadProps), createElement(BreadcrumbTitle, null, title));\n      return needTooltip ? createElement(Tooltip, _assign({}, tooltipProps), breadcrumb) : breadcrumb; // return (\n      //   <Breadcrumb {...breadProps}>\n      //     <BreadcrumbTitle>{title}</BreadcrumbTitle>\n      //   </Breadcrumb>\n      // );\n    };\n\n    _this.state = {\n      show: false\n    };\n    return _this;\n  }\n\n  EditorRootBreadcrumbs.prototype.render = function () {\n    var props = this.props;\n    var model = props.model,\n        controller = props.controller,\n        zIndex = props.zIndex;\n    var editingRootKey = model.editorRootTopicKey;\n    if (editingRootKey === model.rootTopicKey) return null;\n    var items = [];\n    var topic = model.getTopic(editingRootKey);\n\n    while (topic != null) {\n      var title = controller.getValue(PropKey.TOPIC_TITLE, _assign(_assign({}, props), {\n        topicKey: topic.key\n      }));\n      items.unshift({\n        text: title,\n        onClick: this.setEditorRootTopicKey(topic.key)\n      });\n      topic = model.getTopic(topic.parentKey);\n    }\n\n    var breadcrumbProps = {\n      items: items,\n      breadcrumbRenderer: this.breadcrumbRenderer\n    };\n    return createElement(EditorRootBreadcrumbsRoot, {\n      zIndex: zIndex\n    }, createElement(Breadcrumbs, _assign({}, breadcrumbProps)));\n  };\n\n  return EditorRootBreadcrumbs;\n}(BaseWidget);\n\nvar templateObject_1$4, templateObject_2$2, templateObject_3$1;\nvar NodeLayer = styled.div(templateObject_1$5 || (templateObject_1$5 = __makeTemplateObject([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"], [\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"])));\nvar DIV = styled.div(templateObject_2$3 || (templateObject_2$3 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nvar MindDragScrollWidget = function (_super) {\n  __extends(MindDragScrollWidget, _super);\n\n  function MindDragScrollWidget(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.setZoomFactor = function (zoomFactor) {\n      _this.dragScrollWidget.setZoomFactor(zoomFactor);\n    };\n\n    _this.onWheel = function (e) {\n      if (e.altKey || e.ctrlKey) {\n        var controller = _this.props.controller;\n        var zoomFactor = controller.run('getZoomFactor', _this.props);\n        zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n        if (zoomFactor < 0.5) zoomFactor = 0.5;\n        if (zoomFactor > 4) zoomFactor = 4; // console.log('zoomFactor=>', zoomFactor);\n\n        controller.run('setZoomFactor', _assign(_assign({}, _this.props), {\n          zoomFactor: zoomFactor\n        }));\n      }\n    };\n\n    return _this;\n  }\n\n  MindDragScrollWidget.prototype.renderHotkeys = function () {\n    var props = this.props;\n    var controller = props.controller,\n        model = props.model;\n    var hotKeys = controller.run('customizeHotKeys', props);\n    if (hotKeys === null) return null;\n\n    if (!(hotKeys.topicHotKeys instanceof Map && hotKeys.globalHotKeys instanceof Map)) {\n      throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n    }\n\n    var children = [];\n\n    if (model.focusMode === FocusMode.NORMAL || model.focusMode === FocusMode.SHOW_POPUP) {\n      hotKeys.topicHotKeys.forEach(function (v, k) {\n        children.push(createElement(Hotkey, _assign({\n          key: k\n        }, v, {\n          global: true\n        })));\n      });\n    }\n\n    hotKeys.globalHotKeys.forEach(function (v, k) {\n      children.push(createElement(Hotkey, _assign({\n        key: k\n      }, v, {\n        global: true\n      })));\n    });\n    return createElement(Hotkeys, null, children);\n  };\n\n  MindDragScrollWidget.prototype.componentDidMount = function () {\n    var _a = this.props,\n        getRef = _a.getRef,\n        model = _a.model,\n        controller = _a.controller;\n    controller.run('addZoomFactorChangeEventListener', _assign(_assign({}, this.props), {\n      listener: this.setZoomFactor\n    }));\n    var rootTopic = getRef(topicRefKey(model.editorRootTopicKey)); //TODO\n\n    var nodeLayer = getRef('node-layer');\n    var rootTopicRect = rootTopic.getBoundingClientRect();\n    var nodeLayerRect = nodeLayer.getBoundingClientRect();\n    this.dragScrollWidget.setViewBoxScrollDelta(0, rootTopicRect.top - nodeLayerRect.top - this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 + rootTopicRect.height);\n    this.layout();\n  };\n\n  MindDragScrollWidget.prototype.componentWillUnmount = function () {\n    var controller = this.props.controller;\n    controller.run('removeZoomFactorChangeEventListener', _assign(_assign({}, this.props), {\n      listener: this.setZoomFactor\n    }));\n  };\n\n  Object.defineProperty(MindDragScrollWidget.prototype, \"dragScrollWidget\", {\n    get: function get() {\n      return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  MindDragScrollWidget.prototype.componentDidUpdate = function () {\n    var controller = this.props.controller;\n    controller.run('fireEvent', _assign(_assign({}, this.props), {\n      key: EventKey.CENTER_ROOT_TOPIC\n    }));\n    this.layout();\n  };\n\n  MindDragScrollWidget.prototype.layout = function () {\n    var controller = this.props.controller;\n    controller.run('layout', this.props);\n  };\n\n  MindDragScrollWidget.prototype.render = function () {\n    var _this = this;\n\n    var _a = this.props,\n        saveRef = _a.saveRef,\n        model = _a.model,\n        controller = _a.controller;\n    var nodeKey = model.editorRootTopicKey;\n    return createElement(DIV, {\n      onWheel: this.onWheel\n    }, createElement(DragScrollWidget, _assign({}, this.state, {\n      enableMouseWheel: false,\n      zoomFactor: model.zoomFactor,\n      ref: saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)\n    }), function (setViewBoxScroll, setViewBoxScrollDelta) {\n      var rootWidgetProps = _assign(_assign({}, _this.props), {\n        topicKey: nodeKey,\n        setViewBoxScroll: setViewBoxScroll,\n        setViewBoxScrollDelta: setViewBoxScrollDelta\n      });\n\n      return createElement(NodeLayer, {\n        ref: saveRef('node-layer')\n      }, controller.run('renderRootWidget', rootWidgetProps));\n    }));\n  };\n\n  MindDragScrollWidget = __decorate([HotkeysTarget], MindDragScrollWidget);\n  return MindDragScrollWidget;\n}(Component);\n\nvar templateObject_1$5, templateObject_2$3;\n\nvar Modals = function (_super) {\n  __extends(Modals, _super);\n\n  function Modals() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.handleClose = function () {\n      var controller = _this.props.controller;\n      var handleActiveModalClose = controller.run('handleActiveModalClose', _this.props);\n      handleActiveModalClose && handleActiveModalClose();\n    };\n\n    return _this;\n  }\n\n  Modals.prototype.render = function () {\n    var controller = this.props.controller;\n    var activeModal = controller.run('renderModal', this.props);\n    var activeModalProps = controller.run('getActiveModalProps', this.props);\n    return createElement(Dialog, {\n      onClose: this.handleClose,\n      isOpen: activeModal !== null,\n      autoFocus: true,\n      enforceFocus: true,\n      usePortal: true,\n      title: activeModalProps && activeModalProps.title,\n      style: activeModalProps && activeModalProps.style\n    }, createElement(\"div\", {\n      className: Classes.DIALOG_BODY,\n      style: {\n        minHeight: 0\n      }\n    }, activeModal));\n  };\n\n  return Modals;\n}(BaseWidget);\n\nvar RootLinksSvg = styled.svg(templateObject_1$6 || (templateObject_1$6 = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$6 = debug('node:root-sub-links');\n\nvar RootSubLinks = function (_super) {\n  __extends(RootSubLinks, _super);\n\n  function RootSubLinks() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      curves: []\n    };\n    return _this;\n  }\n\n  RootSubLinks.prototype.layout = function () {\n    var props = this.props;\n    var model = props.model,\n        getRef = props.getRef,\n        topicKey = props.topicKey,\n        zoomFactor = props.zoomFactor,\n        controller = props.controller;\n    var topic = model.getTopic(topicKey);\n    var content = getRef(contentRefKey(topicKey));\n    var svg = getRef(linksSvgRefKey(topicKey));\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n    var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n    var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n    var p1, p2;\n    p1 = {\n      x: centerX(contentRect) - svgRect.left,\n      y: centerY(contentRect) - svgRect.top\n    };\n    var curves = [];\n    topic.subKeys.forEach(function (key) {\n      var linkStyle = controller.run('getLinkStyle', _assign(_assign({}, props), {\n        topicKey: key\n      }));\n      var lineType = linkStyle.lineType;\n      var subTopicContent = getRef(contentRefKey(key));\n\n      var rect = _getRelativeRect(subTopicContent, bigView, zoomFactor);\n\n      if (rect.left > contentRect.right) {\n        p2 = {\n          x: rect.left,\n          y: centerY(rect)\n        };\n      } else {\n        p2 = {\n          x: rect.right,\n          y: centerY(rect)\n        };\n      }\n\n      p2 = {\n        x: p2.x - svgRect.left,\n        y: p2.y - svgRect.top\n      };\n      var curve;\n\n      if (lineType === 'curve') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" C \" + p1.x + \" \" + centerPointY(p1, p2) + \" \" + centerPointX(p1, p2) + \" \" + p2.y + \" \" + p2.x + \" \" + p2.y;\n      } else if (lineType === 'line') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" L \" + p2.x + \" \" + p2.y;\n      } else if (lineType === 'round') {\n        var vDir = p2.y > p1.y ? 1 : -1;\n        var hDir = p2.x > p1.x ? 1 : -1;\n        var radius = linkStyle.lineRadius;\n\n        if (radius == null) {\n          throw new Error('link line type is round, but lineRadius is not provided!');\n        }\n\n        if (p2.y === p1.y) {\n          curve = \"M \" + p1.x + \" \" + p1.y + \" H \" + p2.x;\n        } else {\n          // 0  1 \n          curve = \"M \" + p1.x + \" \" + p1.y + \"  V \" + (p2.y - vDir * radius) + \" A \" + radius + \" \" + radius + \" 0 0 \" + (vDir * hDir === 1 ? 0 : 1) + \" \" + (p1.x + radius * hDir) + \" \" + p2.y + \" H \" + p2.x;\n        }\n      }\n\n      curves.push(createElement(\"path\", {\n        key: \"link-\" + key,\n        d: curve,\n        strokeWidth: linkStyle.lineWidth,\n        stroke: linkStyle.lineColor,\n        fill: \"none\"\n      }));\n    });\n    this.setState({\n      curves: curves\n    });\n  };\n\n  RootSubLinks.prototype.render = function () {\n    log$6('render');\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n    return createElement(RootLinksSvg, {\n      ref: saveRef(linksSvgRefKey(topicKey))\n    }, createElement(\"g\", null, this.state.curves));\n  };\n\n  return RootSubLinks;\n}(BaseWidget);\n\nvar templateObject_1$6;\nvar log$7 = debug('RootNode');\nvar LayerPart = styled.div(templateObject_1$7 || (templateObject_1$7 = __makeTemplateObject([\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"], [\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"])), function (props) {\n  //@ts-ignore\n  return props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start';\n}, function (props) {\n  //@ts-ignore\n  return props.topicDirection === TopicDirection.LEFT ? '15px 60px 15px 0px' : '15px 0px 15px 60px';\n});\nvar Topic = styled.div(templateObject_2$4 || (templateObject_2$4 = __makeTemplateObject([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"], [\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"])));\n\nvar RootWidget = function (_super) {\n  __extends(RootWidget, _super);\n\n  function RootWidget() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  RootWidget.prototype.renderPartTopics = function (topics, dir) {\n    var _a = this.props,\n        controller = _a.controller,\n        saveRef = _a.saveRef;\n    var res = controller.run('createSubTopics', _assign(_assign({}, this.props), {\n      dir: dir,\n      isRoot: true,\n      topics: topics\n    }));\n    if (!res) return null;\n    var subTopics = res.subTopics;\n    var cxName = \"bm-layer-\" + (dir === TopicDirection.LEFT ? 'left' : 'right');\n    return (//@ts-ignore\n      createElement(LayerPart, {\n        topicDirection: dir,\n        ref: saveRef(cxName)\n      }, subTopics)\n    );\n  };\n\n  RootWidget.prototype.render = function () {\n    log$7('render');\n    var props = this.props;\n    var model = props.model,\n        topicKey = props.topicKey,\n        saveRef = props.saveRef,\n        controller = props.controller;\n    var topicStyle = controller.run('getTopicContentStyle', props);\n    var config = model.config;\n    var topicContent = controller.run('renderTopicContent', _assign(_assign({}, props), {\n      topicStyle: topicStyle,\n      dir: TopicDirection.MAIN\n    }));\n    var partTopics = controller.run('getPartTopics', {\n      layout: config.layoutDir,\n      model: model,\n      topicKey: topicKey\n    });\n    var rootTopic = createElement(Topic, {\n      ref: saveRef(topicRefKey(topicKey))\n    }, topicContent);\n    var children = controller.run('renderRootWidgetOtherChildren', props);\n\n    switch (config.layoutDir) {\n      case DiagramLayoutType.LEFT_AND_RIGHT:\n        return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n      case DiagramLayoutType.LEFT_TO_RIGHT:\n        return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n      case DiagramLayoutType.RIGHT_TO_LEFT:\n        return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, children);\n\n      case DiagramLayoutType.TOP_TO_BOTTOM:\n        return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.B, 'B'), children);\n    }\n\n    return null;\n  };\n\n  return RootWidget;\n}(Component);\n\nvar templateObject_1$7, templateObject_2$4;\nvar Icon$1 = styled.div(templateObject_3$2 || (templateObject_3$2 = __makeTemplateObject([\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"], [\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"])), function (_a) {\n  var dir = _a.dir;\n  if (dir === TopicDirection.RIGHT) return css(templateObject_1$8 || (templateObject_1$8 = __makeTemplateObject([\"\\n        right: -25px;\\n      \"], [\"\\n        right: -25px;\\n      \"])));\n  if (dir === TopicDirection.LEFT) return css(templateObject_2$5 || (templateObject_2$5 = __makeTemplateObject([\"\\n        left: -25px;\\n      \"], [\"\\n        left: -25px;\\n      \"])));\n}, function (props) {\n  return props.background;\n});\n\nfunction TopicCollapseIcon(props) {\n  var _a;\n\n  var model = props.model,\n      topicKey = props.topicKey,\n      topicStyle = props.topicStyle,\n      dir = props.dir,\n      saveRef = props.saveRef,\n      onClickCollapse = props.onClickCollapse;\n  var topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? createElement(Icon$1, {\n    ref: saveRef(collapseRefKey(topicKey)),\n    onClick: onClickCollapse,\n    background: topicStyle.background,\n    dir: dir,\n    className: cx((_a = {\n      icon: true,\n      iconfont: true\n    }, _a[\"bm-\" + (topic.collapse ? 'plus' : 'minus')] = true, _a))\n  }) : null;\n}\n\nvar templateObject_1$8, templateObject_2$5, templateObject_3$2;\nvar log$8 = debug('node:topic-content2');\nvar EditingRoot = styled.div(templateObject_1$9 || (templateObject_1$9 = __makeTemplateObject([\"\\n  position: relative;\\n\"], [\"\\n  position: relative;\\n\"])));\nvar EditingWrapper = styled.div(templateObject_2$6 || (templateObject_2$6 = __makeTemplateObject([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"], [\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"])));\n\nvar cancelEvent$1 = function cancelEvent$1(e) {\n  log$8('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nfunction TopicContent(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var readOnly = model.editingContentKey !== topicKey;\n  var editor = controller.run('renderTopicContentEditor', _assign(_assign({}, props), {\n    readOnly: readOnly\n  }));\n  var child;\n\n  if (readOnly) {\n    child = editor;\n  } else {\n    var wrapper_1;\n\n    var wrapperRef = function wrapperRef(ref) {\n      if (ref) {\n        wrapper_1 = ref;\n        contentResizeObserver_1.observe(wrapper_1);\n      }\n    };\n\n    var rect_1 = {\n      width: 50,\n      height: 40\n    };\n    var editorDiv = getRef(\"content-editor-\" + topicKey);\n    if (editorDiv) rect_1 = editorDiv.getBoundingClientRect();\n\n    var contentResizeCallback = function contentResizeCallback(entries, observer) {\n      var r = entries[0].contentRect;\n      wrapper_1.style.left = (rect_1.width - r.width) / 2 + 'px';\n      wrapper_1.style.top = (rect_1.height - r.height) / 2 + 'px';\n    };\n\n    var contentResizeObserver_1 = new ResizeObserver(contentResizeCallback);\n    log$8(rect_1);\n    child = createElement(Fragment, null, createElement(\"div\", {\n      style: {\n        width: rect_1.width,\n        height: rect_1.height\n      }\n    }), createElement(EditingWrapper, {\n      ref: wrapperRef\n    }, editor));\n  }\n\n  return createElement(EditingRoot, {\n    onDragEnter: cancelEvent$1,\n    onDragOver: cancelEvent$1\n  }, child);\n}\n\nvar templateObject_1$9, templateObject_2$6;\nvar log$9 = debug('node:topic-content-widget');\nvar TopicContent$1 = styled.div(templateObject_1$a || (templateObject_1$a = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"])));\nvar TopicContentWithDropArea = styled.div(templateObject_2$7 || (templateObject_2$7 = __makeTemplateObject([\"\\n  position: relative;\\n\"], [\"\\n  position: relative;\\n\"])));\n\nvar TopicContentWidget = function (_super) {\n  __extends(TopicContentWidget, _super);\n\n  function TopicContentWidget(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.onDragStart = function (ev) {\n      _this.run('handleTopicDragStart', _assign(_assign({}, _this.props), {\n        ev: ev\n      }));\n    };\n\n    _this.onDragOver = function (ev) {\n      // log('onDragOver');\n      ev.preventDefault();\n    };\n\n    _this.onDragEnter = function (ev) {\n      log$9('onDragEnter', _this.props.topicKey);\n\n      _this.run('handleTopicDragEnter', _assign(_assign({}, _this.props), {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this.onDragLeave = function (ev) {\n      _this.run('handleTopicDragLeave', _assign(_assign({}, _this.props), {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this.onDrop = function (ev) {\n      log$9('onDrop');\n\n      _this.run('handleTopicDrop', _assign(_assign({}, _this.props), {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this.onClick = function (ev) {\n      var props = _this.props;\n      var controller = props.controller; //TODO bug [Violation] 'setTimeout' handler took 69ms\n\n      _this.handleTopicClickTimeout = setTimeout(function () {\n        // log('handleTopicClick');\n        //this.props, props, onClick, topic-content-editoronClickOutside\n        //onClickOutside,model, props,model model\n        controller.run('handleTopicClick', _assign(_assign({}, _this.props), {\n          ev: ev\n        }));\n      }, 200);\n    };\n\n    _this.onDoubleClick = function (ev) {\n      clearTimeout(_this.handleTopicClickTimeout);\n      var controller = _this.props.controller;\n      controller.run('handleTopicDoubleClick', _assign(_assign({}, _this.props), {\n        ev: ev\n      }));\n    };\n\n    _this.needRelocation = false;\n\n    _this.onClickCollapse = function (e) {\n      e.stopPropagation();\n      var _a = _this.props,\n          topicKey = _a.topicKey,\n          getRef = _a.getRef;\n      _this.needRelocation = true;\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var rect = collapseIcon.getBoundingClientRect();\n      log$9('oldRect', rect);\n      _this.oldCollapseIconVector = [rect.left + rect.width / 2, rect.top + rect.height / 2];\n      log$9('oldCollapseIconVector', _this.oldCollapseIconVector); // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: collapseIcon\n      // });\n\n      _this.operation(OpType.TOGGLE_COLLAPSE, _this.props);\n    };\n\n    _this.state = {\n      dragEnter: false\n    };\n    return _this;\n  }\n\n  TopicContentWidget.prototype.renderContextMenu = function () {\n    var controller = this.props.controller;\n\n    if (!controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, _assign({}, this.props))) {\n      return;\n    }\n\n    this.operation(OpType.FOCUS_TOPIC, _assign(_assign({}, this.props), {\n      focusMode: FocusMode.SHOW_POPUP\n    }));\n    return controller.run('renderTopicContextMenu', this.props);\n  };\n\n  TopicContentWidget.prototype.onContextMenuClose = function () {// Optional method called once the context menu is closed.\n  };\n\n  TopicContentWidget.prototype.componentDidUpdate = function () {\n    if (this.needRelocation) {\n      var _a = this.props,\n          getRef = _a.getRef,\n          topicKey = _a.topicKey,\n          setViewBoxScrollDelta = _a.setViewBoxScrollDelta;\n      var newIcon = getRef(collapseRefKey(topicKey));\n      var newRect = newIcon.getBoundingClientRect(); // const newVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: getRef(collapseRefKey(topicKey))\n      // });\n\n      var newVector = [newRect.left + newRect.width / 2, newRect.top + newRect.height / 2];\n      log$9('newVector:', newVector);\n      log$9('oldVector:', this.oldCollapseIconVector); //TODO bug\n\n      var vector = [newVector[0] - this.oldCollapseIconVector[0], newVector[1] - this.oldCollapseIconVector[1]];\n      log$9('vector', vector);\n      setViewBoxScrollDelta(vector[0], vector[1]);\n      this.needRelocation = false;\n    }\n  };\n\n  TopicContentWidget.prototype.render = function () {\n    var props = this.props;\n    var saveRef = props.saveRef,\n        topicKey = props.topicKey,\n        model = props.model,\n        controller = props.controller,\n        topicStyle = props.topicStyle,\n        dir = props.dir;\n    log$9('render', topicKey, model.focusMode);\n    var draggable = controller.run('isOperationEnabled', props) && model.editingContentKey !== topicKey;\n    var collapseIcon = controller.run('renderTopicCollapseIcon', _assign(_assign({}, props), {\n      onClickCollapse: this.onClickCollapse.bind(this)\n    }));\n    var prevDropArea = controller.run('renderTopicDropArea', _assign(_assign({}, props), {\n      dropDir: 'prev'\n    }));\n    var nextDropArea = controller.run('renderTopicDropArea', _assign(_assign({}, props), {\n      dropDir: 'next'\n    }));\n    var dropEventHandlers = {\n      onDragEnter: this.onDragEnter,\n      onDragLeave: this.onDragLeave,\n      onDragOver: this.onDragOver,\n      onDrop: this.onDrop\n    }; // log(topicKey, 'style', topicStyle);\n\n    return createElement(TopicContentWithDropArea, null, prevDropArea, createElement(TopicContent$1, _assign({\n      style: topicStyle,\n      draggable: draggable,\n      ref: saveRef(contentRefKey(topicKey)),\n      onDragStart: this.onDragStart,\n      onClick: this.onClick,\n      onDoubleClick: this.onDoubleClick\n    }, dropEventHandlers), controller.run('renderTopicBlocks', props), controller.run('renderTopicContentOthers', props)), nextDropArea, dir !== TopicDirection.MAIN && collapseIcon);\n  };\n\n  TopicContentWidget = __decorate([ContextMenuTarget], TopicContentWidget);\n  return TopicContentWidget;\n}(BaseWidget);\n\nvar templateObject_1$a, templateObject_2$7;\nvar log$a = debug('node:topic-desc');\nvar TooltipContentWrapper = styled.div(templateObject_1$b || (templateObject_1$b = __makeTemplateObject([\"\\n  overflow: auto;\\n\"], [\"\\n  overflow: auto;\\n\"])));\n\nfunction TopicDesc(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var isEditing = model.editingDescKey === topicKey;\n  log$a('isEditing', isEditing);\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.START_EDITING_DESC\n    }));\n  };\n\n  var desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (!isEditing && controller.run('isBlockEmpty', _assign(_assign({}, props), {\n    block: desc.block\n  }))) return null;\n  var descEditor = controller.run('renderTopicDescEditor', props);\n  var diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  var style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n\n  if (diagramRoot) {\n    var dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = dRect.width * 0.6 + \"px\";\n    style.maxHeight = dRect.height * 0.8 + \"px\";\n  }\n\n  var tooltipContent = createElement(TooltipContentWrapper, {\n    onClick: cancelEvent,\n    classname: Classes.POPOVER_DISMISS,\n    style: style\n  }, descEditor);\n  var icon = createElement(TopicBlockIcon, {\n    onClick: onClick,\n    className: iconClassName(IconName.NOTES),\n    tabIndex: -1\n  });\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n  var descIcon = desc.block && createElement(Popover, _assign({}, tooltipProps));\n  return descIcon;\n}\n\nvar templateObject_1$b;\nvar FocusHighlightSvg = styled.svg(templateObject_1$c || (templateObject_1$c = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicHighlight = function (_super) {\n  __extends(TopicHighlight, _super);\n\n  function TopicHighlight() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      content: null\n    };\n    return _this;\n  }\n\n  TopicHighlight.prototype.layout = function () {\n    var _a = this.props,\n        getRef = _a.getRef,\n        model = _a.model,\n        zoomFactor = _a.zoomFactor;\n    var focusKey = model.focusKey;\n    var focusMode = model.focusMode;\n\n    if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n      this.setState({\n        content: null\n      });\n      return;\n    }\n\n    var content = getRef(contentRefKey(focusKey));\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n    var svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n\n    var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n    var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n    var padding = 3;\n    var x = contentRect.left - svgRect.left - padding;\n    var y = contentRect.top - svgRect.top - padding;\n    var width = contentRect.width + 2 * padding;\n    var height = contentRect.height + 2 * padding;\n    this.setState({\n      content: createElement(\"rect\", {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        fill: \"none\",\n        stroke: model.config.theme.highlightColor,\n        strokeWidth: 2\n      })\n    });\n  };\n\n  TopicHighlight.prototype.render = function () {\n    var saveRef = this.props.saveRef;\n    return createElement(FocusHighlightSvg, {\n      ref: saveRef(RefKey.SVG_HIGHLIGHT_KEY)\n    }, this.state.content);\n  };\n\n  return TopicHighlight;\n}(BaseWidget);\n\nvar templateObject_1$c;\nvar TopicLinksSvg = styled.svg(templateObject_1$d || (templateObject_1$d = __makeTemplateObject([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"], [\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$b = debug('node:topic-sub-links');\n\nvar TopicSubLinks = function (_super) {\n  __extends(TopicSubLinks, _super);\n\n  function TopicSubLinks() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      curves: []\n    };\n    return _this;\n  }\n\n  TopicSubLinks.prototype.layout = function () {\n    var props = this.props;\n    var model = props.model,\n        getRef = props.getRef,\n        topicKey = props.topicKey,\n        dir = props.dir,\n        controller = props.controller;\n    var z = controller.run('getZoomFactor', props);\n    var topic = model.getTopic(topicKey);\n    var content = getRef(contentRefKey(topicKey));\n    var svg = getRef(linksSvgRefKey(topicKey));\n    var collapseIcon = getRef(collapseRefKey(topicKey));\n    var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n    var svgRect = _getRelativeRect(svg, bigView, z);\n\n    var collapseRect = _getRelativeRect(collapseIcon, bigView, z);\n\n    var contentRect = _getRelativeRect(content, bigView, z);\n\n    log$b(topicKey);\n    log$b('svgRect', svgRect);\n    log$b('collapseRect', collapseRect);\n    log$b('contentRect', contentRect);\n    var p1, p2, p3;\n\n    if (dir === TopicDirection.RIGHT) {\n      p1 = {\n        x: 0,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.right - svgRect.left + 10,\n        y: p1.y\n      };\n    } else if (dir === TopicDirection.LEFT) {\n      p1 = {\n        x: svgRect.right - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      p2 = {\n        x: collapseRect.left - svgRect.left - 10,\n        y: p1.y\n      };\n    }\n\n    var curves = [];\n    topic.subKeys.forEach(function (key) {\n      var curve;\n      var linkStyle = controller.run('getLinkStyle', _assign(_assign({}, props), {\n        topicKey: key\n      })); // log(key);\n\n      var subContent = getRef(contentRefKey(key));\n      if (!subContent) return;\n\n      var rect = _getRelativeRect(subContent, bigView, z);\n\n      if (dir === TopicDirection.RIGHT) {\n        p3 = {\n          x: rect.left - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n\n      if (dir === TopicDirection.LEFT) {\n        p3 = {\n          x: rect.right - svgRect.left,\n          y: centerY(rect) - svgRect.top\n        };\n      }\n\n      var lineType = linkStyle.lineType;\n\n      if (lineType === 'curve') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" L \" + p2.x + \" \" + p2.y + \" C \" + p2.x + \" \" + centerPointY(p2, p3) + \" \" + centerPointX(p2, p3) + \" \" + p3.y + \" \" + p3.x + \" \" + p3.y;\n      } else if (lineType === 'round') {\n        var vDir = p3.y > p1.y ? 1 : -1;\n        var hDir = p3.x > p1.x ? 1 : -1;\n        var radius = linkStyle.lineRadius; // if (p3.y === p1.y) { //\n\n        if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n          curve = \"M \" + p1.x + \" \" + p1.y + \" L \" + p3.x + \" \" + p3.y;\n        } else {\n          // 0  1 \n          curve = \"M \" + p1.x + \" \" + p1.y + \" H \" + p2.x + \" V \" + (p3.y - vDir * radius) + \" A \" + radius + \" \" + radius + \" 0 0 \" + (vDir * hDir === 1 ? 0 : 1) + \" \" + (p2.x + radius * hDir) + \" \" + p3.y + \" H \" + p3.x;\n        }\n      } else if (lineType === 'line') {\n        curve = \"M \" + p1.x + \" \" + p1.y + \" H \" + p2.x + \" L \" + p3.x + \" \" + p3.y;\n      }\n\n      curves.push(createElement(\"path\", {\n        key: \"link-\" + key,\n        d: curve,\n        strokeWidth: linkStyle.lineWidth,\n        stroke: linkStyle.lineColor,\n        fill: \"none\"\n      }));\n    });\n    this.setState({\n      curves: curves\n    });\n  };\n\n  TopicSubLinks.prototype.render = function () {\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n    return createElement(TopicLinksSvg, {\n      ref: saveRef(linksSvgRefKey(topicKey))\n    }, createElement(\"g\", null, this.state.curves));\n  };\n\n  return TopicSubLinks;\n}(BaseWidget);\n\nvar templateObject_1$d;\nvar log$c = debug('node:topic-widget');\nvar Node = styled.div(templateObject_1$e || (templateObject_1$e = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n}); // TODO\n\nvar NodeChildren = styled.div(templateObject_2$8 || (templateObject_2$8 = __makeTemplateObject([\"\\n  position: relative;\\n  padding: \", \";\\n\"], [\"\\n  position: relative;\\n  padding: \", \";\\n\"])), function (props) {\n  return props.dir === TopicDirection.RIGHT ? \"0 0 0 \" + props.marginH + \"px\" : \"0 \" + props.marginH + \"px 0 0\";\n});\nvar NodeTopic = styled.div(templateObject_3$3 || (templateObject_3$3 = __makeTemplateObject([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"], [\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n});\n\nvar TopicWidget = function (_super) {\n  __extends(TopicWidget, _super);\n\n  function TopicWidget() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TopicWidget.prototype.renderSubTopics = function () {\n    var props = this.props;\n    var controller = props.controller,\n        model = props.model,\n        topicKey = props.topicKey,\n        dir = props.dir;\n    var topics = model.getTopic(topicKey).subKeys.toArray();\n    var res = controller.run('createSubTopics', _assign(_assign({}, props), {\n      topics: topics\n    }));\n    if (!res) return null;\n    var subTopics = res.subTopics;\n    var subLinks = controller.run('renderSubLinks', props);\n    return createElement(NodeChildren, {\n      dir: dir,\n      marginH: model.config.theme.marginH\n    }, subTopics, \" \", subLinks);\n  }; // componentDidUpdate(): void {\n  //   this.layoutLinks();\n  // }\n  //\n  // componentDidMount(): void {\n  //   this.layoutLinks();\n  // }\n\n\n  TopicWidget.prototype.layoutLinks = function () {\n    var _a = this.props,\n        getRef = _a.getRef,\n        topicKey = _a.topicKey,\n        model = _a.model;\n    var topic = model.getTopic(topicKey);\n    if (topic.subKeys.size === 0 || topic.collapse) return;\n    log$c('layoutLinks', topicKey);\n    var links = getRef(linksRefKey(topicKey));\n    links && links.layout();\n  };\n\n  TopicWidget.prototype.render = function () {\n    var props = this.props;\n    var controller = props.controller,\n        topicKey = props.topicKey,\n        dir = props.dir,\n        saveRef = props.saveRef;\n    log$c('render', topicKey);\n    var topicStyle = controller.run('getTopicContentStyle', props);\n\n    var propsMore = _assign(_assign({}, props), {\n      topicStyle: topicStyle\n    });\n\n    var topicContent = controller.run('renderTopicContent', propsMore);\n    return createElement(Node, {\n      topicDirection: dir\n    }, createElement(NodeTopic, {\n      topicDirection: dir,\n      ref: saveRef(topicRefKey(topicKey))\n    }, topicContent), this.renderSubTopics());\n  };\n\n  return TopicWidget;\n}(Component);\n\nvar templateObject_1$e, templateObject_2$8, templateObject_3$3;\nvar log$d = debug('node:view-port-viewer');\nvar ViewerRoot = styled(ZIndex)(templateObject_1$f || (templateObject_1$f = __makeTemplateObject([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"])));\nvar Item_ = styled(Btn)(templateObject_2$9 || (templateObject_2$9 = __makeTemplateObject([\"\\n  margin: 10px;\\n\"], [\"\\n  margin: 10px;\\n\"])));\nvar ZoomFactorSpan = styled.span(templateObject_3$4 || (templateObject_3$4 = __makeTemplateObject([\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"], [\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"])));\n\nvar Item = function Item(props) {\n  return createElement(Tooltip, {\n    content: props.tooltip,\n    position: Position.TOP,\n    className: Classes.ICON\n  }, createElement(Item_, {\n    onClick: props.onClick,\n    tabIndex: -1\n  }, props.children));\n};\n\nvar ViewPortViewer = function (_super) {\n  __extends(ViewPortViewer, _super);\n\n  function ViewPortViewer(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.zoomFactorChange = function (zoomFactor) {\n      log$d('zoomFactorChange', zoomFactor);\n\n      _this.setState({\n        zoomFactor: zoomFactor\n      });\n    };\n\n    _this.onClickResetZoom = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      controller.run('setZoomFactor', _assign(_assign({}, props), {\n        zoomFactor: 1\n      }));\n    };\n\n    _this.onClickAddZoom = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _assign(_assign({}, props), {\n        zoomFactor: zoomFactor + 0.1\n      }));\n    };\n\n    _this.onClickMinusZoom = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _assign(_assign({}, props), {\n        zoomFactor: zoomFactor - 0.1\n      }));\n    };\n\n    _this.onClickCollapseAll = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _assign(_assign({}, props), {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.COLLAPSE_ALL\n      }));\n    };\n\n    _this.onClickExpandAll = function (e) {\n      var props = _this.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _assign(_assign({}, props), {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.EXPAND_ALL\n      }));\n    };\n\n    _this.centerRootTopic = function () {\n      var _a = _this.props,\n          model = _a.model,\n          controller = _a.controller;\n      controller.run('moveTopicToCenter', _assign(_assign({}, _this.props), {\n        topicKey: model.editorRootTopicKey\n      }));\n    };\n\n    return _this;\n  }\n\n  ViewPortViewer.prototype.componentDidMount = function () {\n    var props = this.props;\n    var controller = props.controller;\n    controller.run('addZoomFactorChangeEventListener', _assign(_assign({}, props), {\n      listener: this.zoomFactorChange\n    }));\n  };\n\n  ViewPortViewer.prototype.componentWillUnmount = function () {\n    var props = this.props;\n    var controller = props.controller;\n    controller.run('removeZoomFactorChangeEventListener', _assign(_assign({}, props), {\n      listener: this.zoomFactorChange\n    }));\n  };\n\n  ViewPortViewer.prototype.render = function () {\n    log$d('render');\n    var props = this.props;\n    var controller = props.controller,\n        zIndex = props.zIndex;\n    var zoomFactor = controller.run('getZoomFactor', props);\n    return createElement(ViewerRoot, {\n      zIndex: zIndex\n    }, createElement(Item, {\n      onClick: this.onClickCollapseAll,\n      tooltip: \"collapse all\"\n    }, Icon(IconName.COLLAPSE_ALL)), createElement(Item, {\n      onClick: this.onClickExpandAll,\n      tooltip: \"expand all\"\n    }, Icon(IconName.EXPAND_ALL)), createElement(Item, {\n      onClick: this.centerRootTopic,\n      tooltip: \"center root topic\"\n    }, Icon(IconName.CENTER)), createElement(Item, {\n      onClick: this.onClickMinusZoom,\n      tooltip: \"zoom in\"\n    }, Icon(IconName.MINUS)), createElement(Item, {\n      onClick: this.onClickResetZoom,\n      tooltip: \"reset zoom\"\n    }, createElement(ZoomFactorSpan, null, \"zoom:\" + Math.floor(zoomFactor * 100) + \"%\")), createElement(Item, {\n      onClick: this.onClickAddZoom,\n      tooltip: \"zoom out\"\n    }, Icon(IconName.PLUS)));\n  };\n\n  return ViewPortViewer;\n}(BaseWidget);\n\nvar templateObject_1$f, templateObject_2$9, templateObject_3$4;\nvar DescEditorWrapper = styled.div(templateObject_1$g || (templateObject_1$g = __makeTemplateObject([\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"], [\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"])));\n\nfunction renderDrawer(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    var onDescEditorClose = function onDescEditorClose(e) {\n      e.stopPropagation();\n      var key = \"topic-desc-data-\" + topicKey;\n      var descData = controller.run('deleteTempValue', {\n        key: key\n      });\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      }));\n    };\n\n    var descEditor = controller.run('renderTopicDescEditor', props);\n    return createElement(Drawer, {\n      key: \"drawer\",\n      title: \"Edit Notes\",\n      icon: Icon('note'),\n      isOpen: true,\n      hasBackdrop: true,\n      backdropProps: {\n        onMouseDown: cancelEvent\n      },\n      isCloseButtonShown: false,\n      onClose: onDescEditorClose,\n      size: \"70%\"\n    }, createElement(DescEditorWrapper, null, descEditor));\n  }\n}\n\nvar templateObject_1$g; //TODO themeProvider\n\nfunction Theme(_a) {\n  var theme = _a.theme,\n      children = _a.children;\n  return (//@ts-ignore\n    createElement(ThemeProvider, {\n      theme: theme\n    }, createElement(Fragment, null, children))\n  );\n}\n\nvar log$e = debug('plugin:rendering');\n\nfunction RenderingPlugin() {\n  var DiagramRoot = styled.div(templateObject_1$h || (templateObject_1$h = __makeTemplateObject([\"\\n    width: 100%;\\n    height: 100%;\\n    background: \", \";\\n    position: relative;\\n  \"], [\"\\n    width: 100%;\\n    height: 100%;\\n    background: \", \";\\n    position: relative;\\n  \"])), function (props) {\n    return props.theme.background;\n  });\n  var diagramProps;\n  return {\n    getDiagramProps: function getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram: function renderDiagram(props) {\n      var model = props.model,\n          controller = props.controller;\n      return createElement(SaveRef, null, function (saveRef, getRef, deleteRef) {\n        diagramProps = _assign(_assign({}, props), {\n          saveRef: saveRef,\n          getRef: getRef,\n          deleteRef: deleteRef\n        });\n        log$e('renderDiagram', model);\n        return createElement(Theme, {\n          theme: model.config.theme\n        }, createElement(DiagramRoot, {\n          ref: saveRef(RefKey.DIAGRAM_ROOT_KEY)\n        }, createElement(MindDragScrollWidget, _assign({}, diagramProps)), controller.run('renderDiagramCustomize', diagramProps)));\n      });\n    },\n    renderDrawer: renderDrawer,\n    renderDiagramCustomize: function renderDiagramCustomize(props) {\n      var controller = props.controller,\n          model = props.model;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX);\n\n      var nProps = _assign(_assign({}, props), {\n        zIndex: zIndex,\n        topicKey: model.focusKey\n      });\n\n      var breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps); // const styleEditor = controller.run('renderStyleEditor', nProps);\n\n      var rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      var modals = controller.run('renderModals', _assign(_assign({}, nProps), {\n        zIndex: zIndex + 1\n      }));\n      var drawer = controller.run('renderDrawer', _assign(_assign({}, nProps), {\n        zIndex: zIndex + 1\n      }));\n      var viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n    renderEditorRootBreadcrumbs: function renderEditorRootBreadcrumbs(props) {\n      return createElement(EditorRootBreadcrumbs, _assign({\n        key: \"EditorRootBreadcrumbs\"\n      }, props));\n    },\n    renderModals: function renderModals(props) {\n      return createElement(Modals, _assign({\n        key: \"modals\"\n      }, props));\n    },\n    renderModal: function renderModal(props) {\n      return null;\n    },\n    getActiveModalProps: function getActiveModalProps(props) {\n      return null;\n    },\n    renderDoc: function renderDoc(_a) {\n      var children = _a.children;\n      return children;\n    },\n    renderRootWidget: function renderRootWidget(props) {\n      return createElement(RootWidget, _assign({}, props));\n    },\n    renderTopicWidget: function renderTopicWidget(props) {\n      return createElement(TopicWidget, _assign({}, props));\n    },\n    renderTopicContent: function renderTopicContent(props) {\n      return createElement(TopicContentWidget, _assign({}, props));\n    },\n    renderTopicCollapseIcon: function renderTopicCollapseIcon(props) {\n      return createElement(TopicCollapseIcon, _assign({}, props));\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props) {\n      return [];\n    },\n    renderTopicBlocks: function renderTopicBlocks(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var blocks = topic.blocks;\n      var res = [];\n      var i = 0;\n      blocks.forEach(function (block) {\n        var b = controller.run('renderTopicBlock', _assign(_assign({}, props), {\n          block: block,\n          blockKey: \"block-\" + i\n        }));\n\n        if (b) {\n          res.push(createElement(Fragment, {\n            key: \"block-\" + i\n          }, b));\n          i++;\n        }\n      });\n      return res;\n    },\n    renderTopicBlock: function renderTopicBlock(props) {\n      var controller = props.controller,\n          block = props.block;\n\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n      }\n\n      return null;\n    },\n    renderTopicBlockContent: function renderTopicBlockContent(props) {\n      return createElement(TopicContent, _assign({}, props));\n    },\n    renderTopicBlockDesc: function renderTopicBlockDesc(props) {\n      return createElement(TopicDesc, _assign({}, props));\n    },\n    renderSubLinks: function renderSubLinks(props) {\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return createElement(TopicSubLinks, _assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderRootSubLinks: function renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey; // ,layout \n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n\n      return createElement(RootSubLinks, _assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderFocusItemHighlight: function renderFocusItemHighlight(props) {\n      var saveRef = props.saveRef;\n      return createElement(TopicHighlight, _assign({\n        ref: saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)\n      }, props));\n    },\n    renderRootWidgetOtherChildren: function renderRootWidgetOtherChildren(props) {\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      props = _assign(_assign({}, props), {\n        zoomFactor: zoomFactor\n      });\n      return createElement(Fragment, null, controller.run('renderRootSubLinks', props), controller.run('renderFocusItemHighlight', props), controller.run('renderDragAndDropEffect', props));\n    },\n    renderViewPortViewer: function renderViewPortViewer(props) {\n      return createElement(ViewPortViewer, _assign({\n        key: \"view-port-viewer\"\n      }, props));\n    }\n  };\n}\n\nvar templateObject_1$h;\nvar PanelRoot = styled(ZIndex)(templateObject_1$i || (templateObject_1$i = __makeTemplateObject([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"])));\nvar StyledTabs = styled(Tabs)(templateObject_2$a || (templateObject_2$a = __makeTemplateObject([\"\\n  padding: 0px 10px;\\n\"], [\"\\n  padding: 0px 10px;\\n\"])));\n\nfunction RightTopPanel(props) {\n  var controller = props.controller,\n      zIndex = props.zIndex,\n      selectedTabId = props.selectedTabId,\n      handleTabIdChange = props.handleTabIdChange;\n\n  var _a = __read(useState(false), 2),\n      expand = _a[0],\n      setExpand = _a[1];\n\n  if (!expand) {\n    return createElement(PanelRoot, {\n      zIndex: zIndex\n    }, createElement(IconBg, {\n      onClick: function onClick() {\n        return setExpand(true);\n      }\n    }, createElement(ShowMenuIcon, {\n      className: iconClassName(IconName.SHOW_MENU)\n    })));\n  }\n\n  return createElement(PanelRoot, {\n    zIndex: zIndex\n  }, createElement(Title, null, createElement(CloseIcon, {\n    className: iconClassName(IconName.CLOSE),\n    onClick: function onClick() {\n      return setExpand(false);\n    }\n  })), createElement(StyledTabs, {\n    id: selectedTabId,\n    onChange: handleTabIdChange\n  }, controller.run('renderRightTopPanelTabs', props)));\n}\n\nvar templateObject_1$i, templateObject_2$a;\nvar SettingTitle = styled.div(templateObject_1$j || (templateObject_1$j = __makeTemplateObject([\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"], [\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"])));\nvar SettingItem = styled.span(templateObject_2$b || (templateObject_2$b = __makeTemplateObject([\"\\n  margin: 0px 10px 0px 0px;\\n\"], [\"\\n  margin: 0px 10px 0px 0px;\\n\"])));\nvar SettingBoxContainer = styled.div(templateObject_3$5 || (templateObject_3$5 = __makeTemplateObject([\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"], [\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"])));\nvar SettingLabel = styled(SettingItem)(templateObject_4$1 || (templateObject_4$1 = __makeTemplateObject([\"\"], [\"\"])));\nvar SettingRow = styled.div(templateObject_5$1 || (templateObject_5$1 = __makeTemplateObject([\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"], [\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"])));\nvar ColorBar = styled.div(templateObject_6$1 || (templateObject_6$1 = __makeTemplateObject([\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"], [\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"])), function (props) {\n  return props.color;\n});\nvar WithBorder = styled.div(templateObject_7$1 || (templateObject_7$1 = __makeTemplateObject([\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"], [\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"])));\nvar templateObject_1$j, templateObject_2$b, templateObject_3$5, templateObject_4$1, templateObject_5$1, templateObject_6$1, templateObject_7$1;\n\nfunction SettingGroup(props) {\n  return createElement(\"div\", null, props.children, createElement(Divider, {\n    style: {\n      margin: '10px 0'\n    }\n  }));\n}\n\nfunction SettingItemColorPicker(props) {\n  var color = props.color,\n      handleColorChange = props.handleColorChange;\n  return createElement(SettingItem, null, createElement(Popover, null, createElement(WithBorder, null, createElement(\"div\", {\n    className: iconClassName(IconName.COLOR_PICKER)\n  }), createElement(ColorBar, {\n    color: color\n  })), createElement(\"div\", null, createElement(SketchPicker, {\n    color: color,\n    onChangeComplete: function onChangeComplete(color) {\n      return handleColorChange(color.hex);\n    }\n  }))));\n}\n\nfunction SettingItemButton(props) {\n  var title = props.title,\n      handleClick = props.handleClick;\n  return createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClick\n  }, title));\n}\n\nfunction SettingItemNumericInput(props) {\n  var _a = props.layout,\n      layout = _a === void 0 ? 'h' : _a,\n      title = props.title,\n      restProps = __rest(props, [\"layout\", \"title\"]);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, _assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(NumericInput, _assign({}, restProps))));\n}\n\nfunction SettingItemSelect(props) {\n  var text = props.text,\n      items = props.items,\n      itemRenderer = props.itemRenderer,\n      onItemSelect = props.onItemSelect;\n  var PxSelect = Select.ofType();\n  var pxProps = {\n    items: items,\n    itemRenderer: itemRenderer,\n    onItemSelect: onItemSelect,\n    filterable: false\n  };\n  return createElement(SettingItem, null, createElement(PxSelect, _assign({}, pxProps), createElement(Button, {\n    text: text\n  })));\n}\n\nvar renderItem = function renderItem(unit) {\n  return function (width, _a) {\n    var handleClick = _a.handleClick;\n    return createElement(MenuItem, {\n      text: \"\" + width + unit,\n      key: width,\n      onClick: handleClick\n    });\n  };\n};\n\nvar PxSelect = Select.ofType();\n\nvar borderWidthItems = __spread(Array(7).keys());\n\nvar borderWidthItems$1 = __spread(Array(7).keys());\n\nvar borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nvar borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nfunction BorderStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleBorderWidthChange = function handleBorderWidthChange(value) {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({\n      borderWidth: value + \"px\"\n    });\n  };\n\n  var handleBorderStyleChange = function handleBorderStyleChange(value) {\n    setContentStyle({\n      borderStyle: value\n    });\n  };\n\n  var handleBorderRadiusChange = function handleBorderRadiusChange(value) {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({\n      borderRadius: value + \"px\"\n    });\n  };\n\n  var handleBorderColorChange = function handleBorderColorChange(color) {\n    setContentStyle({\n      borderColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Border\"), createElement(\"div\", null, createElement(SettingItemSelect, {\n    text: \"width: \" + (contentStyle.borderWidth ? contentStyle.borderWidth : '0px'),\n    items: borderWidthItems$1,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"style: \" + (contentStyle.borderStyle ? contentStyle.borderStyle : 'none'),\n    items: borderStyleItems,\n    itemRenderer: renderItem(''),\n    onItemSelect: handleBorderStyleChange\n  }), createElement(SettingItemSelect, {\n    text: \"radius: \" + contentStyle.borderRadius,\n    items: borderRadiusItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderRadiusChange\n  }), createElement(SettingItemColorPicker, {\n    color: contentStyle.borderColor,\n    handleColorChange: handleBorderColorChange\n  })));\n}\n\nfunction ClearAllCustomStyle(props) {\n  var controller = props.controller;\n\n  var handleClearAllCustomStyle = function handleClearAllCustomStyle(e) {\n    controller.run('clearAllCustomStyle', props);\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClearAllCustomStyle\n  }, \"Clear All Custom Styles\")));\n}\n\nvar lineTypes = ['curve', 'round', 'line'];\n\nvar renderLineTypeItem = function renderLineTypeItem(lineType, _a) {\n  var handleClick = _a.handleClick,\n      modifiers = _a.modifiers,\n      query = _a.query;\n  return createElement(MenuItem, {\n    text: \"\" + lineType,\n    key: lineType,\n    onClick: handleClick\n  });\n};\n\nfunction LinkStyleEditor(props) {\n  var _a = props.showLinkStyle,\n      showLinkStyle = _a === void 0 ? true : _a,\n      _b = props.showSubLinkStyle,\n      showSubLinkStyle = _b === void 0 ? true : _b,\n      _c = props.linkStyle,\n      linkStyle = _c === void 0 ? {} : _c,\n      _d = props.subLinkStyle,\n      subLinkStyle = _d === void 0 ? {} : _d,\n      setLinkStyle = props.setLinkStyle,\n      setSubLinkStyle = props.setSubLinkStyle;\n\n  var handleLinkWidthChange = function handleLinkWidthChange(value) {\n    setLinkStyle({\n      lineWidth: value + \"px\"\n    });\n  };\n\n  var handleLinkTypeChange = function handleLinkTypeChange(value) {\n    setLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleLinkColorChange = function handleLinkColorChange(color) {\n    setLinkStyle({\n      lineColor: color\n    });\n  };\n\n  var handleSubLinkWidthChange = function handleSubLinkWidthChange(value) {\n    setSubLinkStyle({\n      lineWidth: value + \"px\"\n    });\n  };\n\n  var handleSubLinkTypeChange = function handleSubLinkTypeChange(value) {\n    setSubLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleSubLinkColorChange = function handleSubLinkColorChange(color) {\n    setSubLinkStyle({\n      lineColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Link\"), showLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, \"LinkToParent: \"), createElement(SettingItemSelect, {\n    text: \"width: \" + (linkStyle ? linkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"lineType: \" + linkStyle.lineType,\n    items: lineTypes,\n    itemRenderer: renderLineTypeItem,\n    onItemSelect: handleLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: linkStyle.lineColor,\n    handleColorChange: handleLinkColorChange\n  })), showSubLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, \"SubLinks: \"), createElement(SettingItemSelect, {\n    text: \"width: \" + (subLinkStyle ? subLinkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleSubLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"lineType: \" + subLinkStyle.lineType,\n    items: lineTypes,\n    itemRenderer: renderLineTypeItem,\n    onItemSelect: handleSubLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: subLinkStyle.lineColor,\n    handleColorChange: handleSubLinkColorChange\n  })));\n}\n\nfunction TextStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleFontSizeChange = function handleFontSizeChange(value) {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({\n      fontSize: value\n    });\n  };\n\n  var handleLineHeightChange = function handleLineHeightChange(e) {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({\n      lineHeight: e.target.value\n    });\n  };\n\n  var handleColorChange = function handleColorChange(color) {\n    setContentStyle({\n      color: color\n    });\n  };\n\n  var fontSizeNumInputProps = {\n    title: 'FontSize:',\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  var lineHeightInputProps = {\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Text Editor\"), createElement(Flex, null, createElement(SettingItemNumericInput, _assign({}, fontSizeNumInputProps)), createElement(SettingItem, null, createElement(Flex, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, \"LineHeight: \"), createElement(InputGroup, _assign({}, lineHeightInputProps)))), createElement(SettingItemColorPicker, {\n    color: contentStyle.color,\n    handleColorChange: handleColorChange\n  })));\n}\n\nvar log$f = debug('node:style-editor');\nvar copiedStyle;\n\nfunction StyleEditor(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  var setContentStyle = function setContentStyle(style) {\n    controller.run('setTopicContentStyle', _assign(_assign({}, props), {\n      style: style\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(color) {\n    setContentStyle({\n      background: color\n    });\n  };\n\n  var handleClearStyle = function handleClearStyle() {\n    if (topic.style) {\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.SET_STYLE,\n        style: null\n      }));\n    }\n  };\n\n  var handleCopyStyle = function handleCopyStyle() {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log$f(copiedStyle);\n  };\n\n  var handlePasteStyle = function handlePasteStyle() {\n    if (copiedStyle) {\n      controller.run('operation', _assign(_assign({}, props), {\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      }));\n    }\n  };\n\n  if (!model.focusKey) return null;\n  var contentStyle = controller.run('getTopicContentStyle', props);\n  var linkStyle = controller.run('getLinkStyle', props);\n  var subLinkStyle = controller.run('getSubLinkStyle', props);\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    controller.run('setLinkStyle', _assign(_assign({}, props), {\n      linkStyle: linkStyle\n    }));\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    controller.run('setSubLinkStyle', _assign(_assign({}, props), {\n      subLinkStyle: subLinkStyle\n    }));\n  };\n\n  var linkStyleEditorProps = {\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  };\n  var contentStyleEditorPros = {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  };\n  return createElement(PanelTabRoot, null, createElement(BorderStyleEditor, _assign({}, contentStyleEditorPros)), createElement(TextStyleEditor, _assign({}, contentStyleEditorPros)), createElement(SettingGroup, null, createElement(SettingTitle, null, \"Background\"), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: handleBackgroundColorChange\n  })), createElement(LinkStyleEditor, _assign({}, linkStyleEditorProps)), createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: \"Clear Topic Style\",\n    handleClick: handleClearStyle\n  }), createElement(SettingItemButton, {\n    title: \"Copy Style\",\n    handleClick: handleCopyStyle\n  }), createElement(SettingItemButton, {\n    title: \"Paste Style\",\n    handleClick: handlePasteStyle\n  })), ClearAllCustomStyle(props));\n}\n/** Event handler that exposes the target element's value as a boolean. */\n\n\nfunction handleBooleanChange(handler) {\n  return function (event) {\n    return handler(event.target.checked);\n  };\n}\n\nvar expand = require('css-shorthand-expand');\n\nfunction PaddingStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n  var padding = expand('padding', contentStyle.padding || '0');\n  var commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  var top = parseInt(padding['padding-top']);\n  var right = parseInt(padding['padding-right']);\n  var bottom = parseInt(padding['padding-bottom']);\n  var left = parseInt(padding['padding-left']);\n  var p = {\n    top: top,\n    right: right,\n    bottom: bottom,\n    left: left\n  };\n\n  var setPadding = function setPadding(dir) {\n    return function (v) {\n      var _a;\n\n      setContentStyle({\n        padding: paddingCss(_assign(_assign({}, p), (_a = {}, _a[dir] = v, _a)))\n      });\n    };\n  };\n\n  var topProps = _assign(_assign({}, commonProps), {\n    title: 'top',\n    value: top,\n    onValueChange: setPadding('top')\n  });\n\n  var rightProps = _assign(_assign({}, commonProps), {\n    title: 'right',\n    value: right,\n    onValueChange: setPadding('right')\n  });\n\n  var bottomProps = _assign(_assign({}, commonProps), {\n    title: 'bottom',\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  });\n\n  var leftProps = _assign(_assign({}, commonProps), {\n    title: 'left',\n    value: left,\n    onValueChange: setPadding('left')\n  });\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, \"Padding\"), createElement(SettingRow, null, createElement(SettingItemNumericInput, _assign({}, topProps)), createElement(SettingItemNumericInput, _assign({}, rightProps)), createElement(SettingItemNumericInput, _assign({}, bottomProps)), createElement(SettingItemNumericInput, _assign({}, leftProps))));\n}\n\nvar TopicThemeEditorRoot = styled.div(templateObject_1$k || (templateObject_1$k = __makeTemplateObject([\"\\n  height: 250px;\\n  overflow: auto;\\n\"], [\"\\n  height: 250px;\\n  overflow: auto;\\n\"])));\n\nfunction TopicThemeEditor(props) {\n  var topicStyle = props.topicStyle,\n      setTopicStyle = props.setTopicStyle;\n  var _a = topicStyle.contentStyle,\n      contentStyle = _a === void 0 ? {} : _a,\n      _b = topicStyle.linkStyle,\n      linkStyle = _b === void 0 ? {} : _b,\n      _c = topicStyle.subLinkStyle,\n      subLinkStyle = _c === void 0 ? {} : _c;\n\n  var setContentStyle = function setContentStyle(contentStyle) {\n    setTopicStyle({\n      contentStyle: contentStyle\n    });\n  };\n\n  var nProps = {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  };\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    setTopicStyle({\n      linkStyle: linkStyle\n    });\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    setTopicStyle({\n      subLinkStyle: subLinkStyle\n    });\n  };\n\n  var linkStyleEditorProps = {\n    showLinkStyle: false,\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  };\n  return createElement(TopicThemeEditorRoot, null, createElement(BorderStyleEditor, _assign({}, nProps)), createElement(PaddingStyleEditor, _assign({}, nProps)), createElement(TextStyleEditor, _assign({}, nProps)), createElement(SettingGroup, null, createElement(SettingTitle, null, \"Background\"), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: function handleColorChange(color) {\n      setContentStyle({\n        background: color\n      });\n    }\n  })), createElement(LinkStyleEditor, _assign({}, linkStyleEditorProps)));\n}\n\nvar templateObject_1$k;\nvar tabId = 'normal';\n\nfunction ThemeEditor(props) {\n  var _a = __read(useState(false), 2),\n      showExportDialog = _a[0],\n      setShowExportDialog = _a[1];\n\n  var _b = __read(useState(false), 2),\n      alertThemeError = _b[0],\n      setAlertThemeError = _b[1];\n\n  var model = props.model,\n      controller = props.controller;\n  var theme = model.config.theme;\n  var rootTopic = theme.rootTopic,\n      primaryTopic = theme.primaryTopic,\n      normalTopic = theme.normalTopic;\n\n  var setTheme = function setTheme(theme) {\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_THEME,\n      theme: clone(theme)\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(background) {\n    setTheme(merge(theme, {\n      background: background\n    }));\n  };\n\n  var handleHighlightColorChange = function handleHighlightColorChange(highlightColor) {\n    setTheme(merge(theme, {\n      highlightColor: highlightColor\n    }));\n  };\n\n  var handleRandomColorChange = handleBooleanChange(function (randomColor) {\n    setTheme(merge(theme, {\n      randomColor: randomColor\n    }));\n  });\n\n  var setRootTopicStyle = function setRootTopicStyle(style) {\n    setTheme(merge(theme, {\n      rootTopic: style\n    }));\n  };\n\n  var setPrimaryTopicStyle = function setPrimaryTopicStyle(style) {\n    setTheme(merge(theme, {\n      primaryTopic: style\n    }));\n  };\n\n  var setNormalTopicStyle = function setNormalTopicStyle(style) {\n    setTheme(merge(theme, {\n      normalTopic: style\n    }));\n  };\n\n  var rootTopicEditorProps = {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  };\n  var rootTopicEditor = createElement(TopicThemeEditor, _assign({}, rootTopicEditorProps));\n  var primaryTopicEditorProps = {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  };\n  var primaryTopicEditor = createElement(TopicThemeEditor, _assign({}, primaryTopicEditorProps));\n  var normalTopicEditorProps = {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  };\n  var normalTopicEditor = createElement(TopicThemeEditor, _assign({}, normalTopicEditorProps));\n  var tabsProps = {\n    id: tabId,\n    handleTabIdChange: function handleTabIdChange(id) {\n      tabId = id;\n    }\n  };\n  var topicThemes = createElement(SettingBoxContainer, null, createElement(Tabs, _assign({}, tabsProps), createElement(Tab, {\n    id: \"normal\",\n    title: \"NormalTopic\",\n    panel: normalTopicEditor\n  }), createElement(Tab, {\n    id: \"primary\",\n    title: \"PrimaryTopic\",\n    panel: primaryTopicEditor\n  }), createElement(Tab, {\n    id: \"root\",\n    title: \"RootTopic\",\n    panel: rootTopicEditor\n  })));\n\n  var handleExportTheme = function handleExportTheme(e) {\n    // setShowExportDialog(true);\n    var text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n\n  var handleImportTheme = function handleImportTheme(e) {\n    browserOpenFile('.json,.txt').then(function (txt) {\n      var t = JSON.parse(txt);\n\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n\n      setTheme(t);\n    });\n  };\n\n  var alertProps = {\n    isOpen: alertThemeError,\n    onClose: function onClose(e) {\n      setAlertThemeError(false);\n    }\n  };\n  var alert = createElement(Alert, _assign({}, alertProps), createElement(\"p\", null, \"File format error\"));\n  return createElement(PanelTabRoot, null, createElement(SettingGroup, null, createElement(SettingTitle, null, \"Global\"), createElement(SettingRow, null, createElement(SettingLabel, null, \"Background:\"), createElement(SettingItemColorPicker, {\n    color: theme.background,\n    handleColorChange: handleBackgroundColorChange\n  }), createElement(SettingLabel, null, \"Highlight:\"), createElement(SettingItemColorPicker, {\n    color: theme.highlightColor,\n    handleColorChange: handleHighlightColorChange\n  }), createElement(SettingLabel, null, \"Random Color:\"), createElement(StyledCheckbox, {\n    checked: theme.randomColor,\n    onChange: handleRandomColorChange\n  }))), topicThemes, createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: \"Export Theme\",\n    handleClick: handleExportTheme\n  }), createElement(SettingItemButton, {\n    title: \"Import Theme\",\n    handleClick: handleImportTheme\n  })), alert);\n}\n\nfunction RightTopPanelPlugin() {\n  var selectedTabId = 'topic-style';\n\n  var handleTabIdChange = function handleTabIdChange(tabId) {\n    selectedTabId = tabId;\n  };\n\n  return {\n    renderRightTopPanel: function renderRightTopPanel(props) {\n      var nProps = _assign(_assign({}, props), {\n        key: 'right-top-panel',\n        selectedTabId: selectedTabId,\n        handleTabIdChange: handleTabIdChange\n      });\n\n      return createElement(RightTopPanel, _assign({}, nProps));\n    },\n    renderRightTopPanelTabs: function renderRightTopPanelTabs(props) {\n      var controller = props.controller;\n      var styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      var themeEditorTab = controller.run('renderThemeEditor', props);\n      return [styleEditorTab, themeEditorTab];\n    },\n    renderTopicStyleEditor: function renderTopicStyleEditor(props) {\n      var tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: 'TopicStyle',\n        panel: createElement(StyleEditor, _assign({}, props))\n      };\n      return createElement(Tab, _assign({}, tProps));\n    },\n    renderThemeEditor: function renderThemeEditor(props) {\n      var tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: 'Theme',\n        panel: createElement(ThemeEditor, _assign({}, props))\n      };\n      return createElement(Tab, _assign({}, tProps));\n    }\n  };\n}\n\nvar log$g = debug('plugin:utils');\n\nfunction UtilsPlugin() {\n  var tempValueMap = new Map();\n  var eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener: function addTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n\n      eventListenerMap.get(key).push(listener);\n    },\n    removeTempValueChangeListener: function removeTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap.get(key).filter(function (l) {\n          return l !== listener;\n        });\n      }\n    },\n    getTempValue: function getTempValue(props) {\n      var key = props.key;\n      log$g('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n    setTempValue: function setTempValue(props) {\n      var e_1, _a;\n\n      var key = props.key,\n          value = props.value;\n      log$g('setTempValue', key);\n      tempValueMap.set(key, value);\n\n      if (eventListenerMap.has(key)) {\n        var listeners = eventListenerMap.get(key);\n\n        try {\n          for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\n            var listener = listeners_1_1.value;\n            listener(value);\n          }\n        } catch (e_1_1) {\n          e_1 = {\n            error: e_1_1\n          };\n        } finally {\n          try {\n            if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\n          } finally {\n            if (e_1) throw e_1.error;\n          }\n        }\n      }\n    },\n    deleteTempValue: function deleteTempValue(props) {\n      var key = props.key;\n      log$g('deleteTempValue', key);\n      var value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n\nfunction ReactPlugin(options) {\n  return [RenderingPlugin(), UtilsPlugin(), ContextMenuPlugin(), RightTopPanelPlugin(), DragAndDropPlugin()];\n}\n\nvar log$h = debug('plugin:StylePlugin');\n\nfunction StylePlugin() {\n  var colorMap = new Map();\n  var colorIndex = 0;\n  return {\n    getTopicStyle: function getTopicStyle(props) {\n      var controller = props.controller;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n    getTopicContentStyle: function getTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$h('getTopicContentStyle:', topicKey, model);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;else if (visualLevel === TopicVisualLevel.PRIMARY) themeStyle = theme.primaryTopic;else themeStyle = theme.normalTopic;\n      themeStyle = _assign(_assign({}, theme.contentStyle), themeStyle.contentStyle);\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        themeStyle = _assign(_assign({}, themeStyle), {\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: _assign(_assign({}, themeStyle.subLinkStyle), {\n            lineColor: randomColor\n          })\n        });\n      }\n\n      var topic = model.getTopic(topicKey);\n\n      if (!topic.style) {\n        return themeStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _assign(_assign({}, themeStyle), customStyle.contentStyle);\n    },\n    getLinkStyle: function getLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$h('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var linkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.linkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.linkStyle;else presetStyle = theme.normalTopic.linkStyle;\n      linkStyle = _assign(_assign({}, linkStyle), presetStyle);\n      var topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        var parentSubLinkStyle = controller.run('getSubLinkStyle', _assign(_assign({}, props), {\n          topicKey: topic.parentKey\n        }));\n        linkStyle = _assign(_assign({}, linkStyle), parentSubLinkStyle);\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _assign(_assign({}, linkStyle), customStyle.linkStyle);\n    },\n    getSubLinkStyle: function getSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$h('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var subLinkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.subLinkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.subLinkStyle;else presetStyle = theme.normalTopic.subLinkStyle;\n      subLinkStyle = _assign(_assign({}, subLinkStyle), presetStyle);\n      var topic = model.getTopic(topicKey); // color\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        log$h(randomColor);\n        subLinkStyle = _assign(_assign({}, subLinkStyle), {\n          lineColor: randomColor\n        });\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n\n      var res = _assign(_assign({}, subLinkStyle), customStyle.subLinkStyle); // if (res.lineRadius == null) res.lineRadius = 5;\n\n\n      return res;\n    },\n    setTopicContentStyle: function setTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          style = props.style,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var topicStyle = topic.style;\n      var styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n\n      var newStyleObj = _assign(_assign({}, styleObj), {\n        contentStyle: _assign(_assign({}, styleObj.contentStyle), style)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setLinkStyle: function setLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          linkStyle = props.linkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _assign(_assign({}, styleObj), {\n        linkStyle: _assign(_assign({}, styleObj.linkStyle), linkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setSubLinkStyle: function setSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          subLinkStyle = props.subLinkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _assign(_assign({}, styleObj), {\n        subLinkStyle: _assign(_assign({}, styleObj.subLinkStyle), subLinkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    getTopicThemeStyle: function getTopicThemeStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model;\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n    getRandomColor: function getRandomColor(props) {\n      var topicKey = props.topicKey;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      var colors = ['#00CC99', '#FFEE88', '#A167A5', '#E5F993', '#F5C396', '#DB995A', '#83BCFF', '#ED7B84', '#739E82', '#D3BCC0', '#FFA0FD', '#EFD3D7', '#C6878F'];\n      var color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log$h('getRandomColor', topicKey, color);\n      return color;\n    },\n    clearAllCustomStyle: function clearAllCustomStyle(props) {\n      var model = props.model,\n          controller = props.controller;\n      var newModel = model.withMutations(function (model) {\n        model.topics.keySeq().forEach(function (key) {\n          model.setIn(['topics', key, 'style'], null);\n        });\n      });\n      controller.change(newModel);\n    }\n  };\n}\n\nfunction DefaultPlugin() {\n  return [ReactPlugin(), LayoutPlugin(), OperationPlugin(), StylePlugin(), EventPlugin(), HotKeyPlugin(), GetValuePlugin(), SimpleTextEditorPlugin()];\n}\n\nvar log$i = debug('node:Diagram');\n\nvar Diagram = function (_super) {\n  __extends(Diagram, _super);\n\n  function Diagram() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.resolveController = memoizeOne(function (plugins, TheDefaultPlugin) {\n      if (plugins === void 0) {\n        plugins = [];\n      }\n\n      var defaultPlugin = TheDefaultPlugin();\n      _this.controller = new Controller({\n        plugins: [plugins, defaultPlugin],\n        construct: false,\n        onChange: _this.props.onChange\n      }); // this.controller.run('onConstruct');\n    });\n    return _this;\n  }\n\n  Diagram.prototype.getDiagramProps = function () {\n    return this.controller.run('getDiagramProps');\n  };\n\n  Diagram.prototype.openNewModel = function (newModel) {\n    var _this = this;\n\n    var props = this.getDiagramProps();\n    var model = props.model,\n        controller = props.controller;\n    controller.run('deleteRefKey', _assign(_assign({}, props), {\n      topicKey: model.rootTopicKey\n    }));\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.EXPAND_TO,\n      topicKey: newModel.focusKey,\n      model: newModel,\n      callback: function callback() {\n        var props = _this.getDiagramProps();\n\n        var model = props.model;\n        controller.run('moveTopicToCenter', _assign(_assign({}, props), {\n          topicKey: model.focusKey\n        }));\n      }\n    }));\n  };\n\n  Diagram.prototype.render = function () {\n    var plugins = this.props.plugins;\n    this.resolveController(plugins, DefaultPlugin);\n    this.diagramProps = _assign(_assign({}, this.props), {\n      controller: this.controller\n    });\n    return this.controller.run('renderDiagram', this.diagramProps);\n  };\n\n  return Diagram;\n}(Component);\n\nexport { BaseWidget, Btn, CloseIcon, DefaultPlugin, Diagram, DragScrollWidget, EventKey, Flex, HotKeyName, HotKeyPlugin, Icon, IconBg, IconName, Margin, PanelTabRoot, PropKey, RefKey, SaveRef, ShowMenuIcon, StyledCheckbox, Title, TopicBlockIcon, ZIndex, browserDownloadFile, browserDownloadText, browserOpenFile, cancelEvent, center, centerPointX, centerPointY, centerX, centerY, collapseRefKey, contentEditorRefKey, contentRefKey, descEditorRefKey, dropAreaRefKey, getLinkKey, _getRelativeRect as getRelativeRect, getRelativeVector, iconClassName, linksRefKey, linksSvgRefKey, paddingCss, topicRefKey, topicWidgetRefKey };","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","var isProduction = process.env.NODE_ENV === 'production';\n\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import _get from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _assertThisInitialized from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _taggedTemplateLiteral from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _excluded = [\"title\"],\n    _excluded2 = [\"layout\", \"title\"],\n    _excluded3 = [\"layout\", \"title\"],\n    _excluded4 = [\"controller\", \"children\", \"onClick\"],\n    _excluded5 = [\"text\"];\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27, _templateObject28, _templateObject29, _templateObject30, _templateObject31, _templateObject32, _templateObject33, _templateObject34, _templateObject35, _templateObject36, _templateObject37, _templateObject38, _templateObject39, _templateObject40, _templateObject41, _templateObject42, _templateObject43, _templateObject44, _templateObject45, _templateObject46, _templateObject47, _templateObject48, _templateObject49, _templateObject50, _templateObject51, _templateObject52, _templateObject53, _templateObject54, _templateObject55, _templateObject56, _templateObject57;\n\nimport { Component, createElement, PureComponent, useState, Fragment } from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled, { css, ThemeProvider } from 'styled-components';\nimport debug from 'debug';\nimport { Checkbox, Divider, Popover, Button, NumericInput, InputGroup, MenuItem, Menu, Hotkey, Hotkeys, HotkeysTarget, PopoverPosition, Breadcrumb, Tooltip, Breadcrumbs, Dialog, Classes, ContextMenuTarget, PopoverInteractionKind, Position, Drawer, Tabs, Tab, Alert } from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport { SketchPicker } from 'react-color';\nimport { Model, FocusMode, OpType, DiagramLayoutType, getRelationship, TopicRelationship, getAllSubTopicKeys, ModelModifier, BlockType, TopicDirection, isThemeType, TopicVisualLevel, Controller } from '@blink-mind/core';\nimport '@blink-mind/icons';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport memoizeOne from 'memoize-one';\nimport { Stack, List } from 'immutable';\nimport cx from 'classnames';\nimport { cloneDeep, merge, isEqual } from 'lodash';\nimport plainSerializer from 'slate-plain-serializer';\nimport { Editor } from 'slate-react';\n\nvar BaseWidget = /*#__PURE__*/function (_Component) {\n  _inherits(BaseWidget, _Component);\n\n  var _super = _createSuper(BaseWidget);\n\n  function BaseWidget(props) {\n    _classCallCheck(this, BaseWidget);\n\n    return _super.call(this, props);\n  }\n\n  _createClass(BaseWidget, [{\n    key: \"operation\",\n    value: function operation(opType, arg) {\n      this.props.controller.run('operation', _objectSpread({\n        opType: opType\n      }, arg));\n    }\n  }, {\n    key: \"run\",\n    value: function run(name, arg) {\n      this.props.controller.run(name, arg);\n    }\n  }, {\n    key: \"topic\",\n    get: function get() {\n      return this.props.model.getTopic(this.props.topicKey);\n    }\n  }]);\n\n  return BaseWidget;\n}(Component);\n\nvar log = debug('node:drag-scroll-widget');\nvar DragScrollView = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"])));\nvar DragScrollContent = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  width: max-content;\\n\"])));\n\nvar DragScrollWidget = /*#__PURE__*/function (_Component2) {\n  _inherits(DragScrollWidget, _Component2);\n\n  var _super2 = _createSuper(DragScrollWidget);\n\n  function DragScrollWidget(props) {\n    var _this;\n\n    _classCallCheck(this, DragScrollWidget);\n\n    _this = _super2.call(this, props);\n\n    _this.contentResizeCallback = function (entries, observer) {\n      if (_this.oldContentRect) {\n        var widgetStyle = {\n          width: _this.content.clientWidth + _this.viewBox.clientWidth * 2,\n          height: _this.content.clientHeight + _this.viewBox.clientHeight * 2\n        };\n        _this.bigView.style.width = widgetStyle.width + 'px';\n        _this.bigView.style.height = widgetStyle.height + 'px';\n      }\n\n      _this.oldContentRect = entries[0].contentRect;\n    };\n\n    _this.contentResizeObserver = new ResizeObserver(_this.contentResizeCallback);\n\n    _this.contentRef = function (ref) {\n      if (ref) {\n        _this.content = ref;\n\n        _this.contentResizeObserver.observe(_this.content);\n      }\n    };\n\n    _this.viewBoxRef = function (ref) {\n      if (ref) {\n        _this.viewBox = ref;\n\n        if (!_this.props.enableMouseWheel) {\n          log('addEventListener onwheel');\n\n          _this.viewBox.addEventListener('wheel', function (e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          }, {\n            passive: false\n          });\n        }\n\n        _this.setViewBoxScroll(_this.viewBox.clientWidth, _this.viewBox.clientHeight);\n      }\n    };\n\n    _this.bigViewRef = function (ref) {\n      if (ref) {\n        _this.bigView = ref;\n      }\n    };\n\n    _this.setWidgetStyle = function () {\n      if (_this.content && _this.viewBox && _this.bigView) {\n        _this.bigView.style.width = (_this.content.clientWidth + _this.viewBox.clientWidth) * 2 + 'px';\n        _this.bigView.style.height = (_this.content.clientHeight + _this.viewBox.clientHeight) * 2 + 'px';\n        _this.content.style.left = _this.viewBox.clientWidth + 'px';\n        _this.content.style.top = _this.viewBox.clientHeight + 'px';\n      }\n    };\n\n    _this.setViewBoxScroll = function (left, top) {\n      log(\"setViewBoxScroll \".concat(left, \" \").concat(top));\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft = left;\n        _this.viewBox.scrollTop = top;\n      }\n    };\n\n    _this.setViewBoxScrollDelta = function (deltaLeft, deltaTop) {\n      log(\"setViewBoxScrollDelta \".concat(deltaLeft, \" \").concat(deltaTop));\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft += deltaLeft;\n        _this.viewBox.scrollTop += deltaTop;\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      // log('Drag Scroll onMouseDown');\n      // log(e.nativeEvent.target);\n      // mouseKey \n      // needKeyPressed ctrl\n      // canDragFunc\n      var _this$props = _this.props,\n          mouseKey = _this$props.mouseKey,\n          needKeyPressed = _this$props.needKeyPressed,\n          canDragFunc = _this$props.canDragFunc;\n      if (canDragFunc && !canDragFunc()) return;\n\n      if (e.button === 0 && mouseKey === 'left' || e.button === 2 && mouseKey === 'right') {\n        if (needKeyPressed) {\n          if (!e.ctrlKey) return;\n        }\n\n        _this._lastCoordX = _this.viewBox.scrollLeft + e.nativeEvent.clientX;\n        _this._lastCoordY = _this.viewBox.scrollTop + e.nativeEvent.clientY;\n        var ele = _this.viewBox;\n        ele.addEventListener('mousemove', _this.onMouseMove);\n        ele.addEventListener('mouseup', _this.onMouseUp);\n      }\n    };\n\n    _this.onMouseUp = function (e) {\n      var ele = _this.viewBox;\n      ele.removeEventListener('mousemove', _this.onMouseMove);\n      ele.removeEventListener('mouseup', _this.onMouseUp);\n    };\n\n    _this.onMouseMove = function (e) {\n      _this.viewBox.scrollLeft = _this._lastCoordX - e.clientX;\n      _this.viewBox.scrollTop = _this._lastCoordY - e.clientY; // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n    };\n\n    _this.handleContextMenu = function (e) {\n      e.preventDefault();\n    };\n\n    _this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n    return _this;\n  }\n\n  _createClass(DragScrollWidget, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setWidgetStyle();\n      document.addEventListener('contextmenu', this.handleContextMenu);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('contextmenu', this.handleContextMenu);\n    }\n  }, {\n    key: \"setZoomFactor\",\n    value: function setZoomFactor(zoomFactor) {\n      this.bigView.style.transform = \"scale(\".concat(zoomFactor, \")\");\n      this.bigView.style.transformOrigin = '50% 50%';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var style = _objectSpread({}, this.state.widgetStyle);\n\n      return createElement(DragScrollView, {\n        ref: this.viewBoxRef,\n        onMouseDown: this.onMouseDown\n      }, createElement(\"div\", {\n        style: style,\n        ref: this.bigViewRef\n      }, createElement(DragScrollContent, {\n        ref: this.contentRef,\n        style: this.state.contentStyle\n      }, this.props.children(this.setViewBoxScroll, this.setViewBoxScrollDelta))));\n    }\n  }]);\n\n  return DragScrollWidget;\n}(Component);\n\nDragScrollWidget.defaultProps = {\n  mouseKey: 'left',\n  needKeyPressed: false\n};\nvar log$1 = debug('node:save-ref'); //TODO ,topic\n\nvar SaveRef = /*#__PURE__*/function (_Component3) {\n  _inherits(SaveRef, _Component3);\n\n  var _super3 = _createSuper(SaveRef);\n\n  function SaveRef() {\n    var _this2;\n\n    _classCallCheck(this, SaveRef);\n\n    _this2 = _super3.apply(this, arguments);\n\n    _this2.getRef = function (name) {\n      log$1(_assertThisInitialized(_this2));\n      return _this2[name];\n    };\n\n    _this2.saveRef = function (name) {\n      return function (node) {\n        if (node) {\n          _this2[name] = node;\n\n          _this2.fireListener(name, node);\n        }\n      };\n    };\n\n    _this2.deleteRef = function (name) {\n      log$1('deleteRef:', name);\n      delete _this2[name];\n    };\n\n    _this2.observers = new Map();\n\n    _this2.fireListener = function (name, ref) {\n      if (_this2.observers.has(name)) {\n        var listeners = _this2.observers.get(name);\n\n        var _iterator = _createForOfIteratorHelper(listeners),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var listener = _step.value;\n            listener(name, ref);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    };\n\n    _this2.registerRefListener = function (name, listener) {\n      if (!_this2.observers.has(name)) {\n        _this2.observers.set(name, [listener]);\n      } else {\n        _this2.observers.get(name).push(listener);\n      }\n    };\n\n    return _this2;\n  }\n\n  _createClass(SaveRef, [{\n    key: \"render\",\n    value: function render() {\n      return this.props.children(this.saveRef, this.getRef, this.deleteRef, this.registerRefListener.bind(this));\n    }\n  }]);\n\n  return SaveRef;\n}(Component);\n\nvar Flex = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"])), function (props) {\n  return props.flexDirection ? props.flexDirection : 'row';\n}, function (props) {\n  return props.alignItems;\n}, function (props) {\n  return props.justifyContent;\n});\nvar Margin = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  margin: \", \";\\n\"])), function (props) {\n  return props.margin;\n});\nvar ShowMenuIcon = styled.a(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n  font-size: 20px !important;\\n\"])));\nvar IconBg = styled.div(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"])));\nvar Btn = styled.div(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"])));\nvar StyledCheckbox = styled(Checkbox)(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\\n  margin-bottom: 0px !important;\\n\"])));\nvar CloseIcon = styled(Btn)(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"])));\nvar Title = styled.div(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\\n  height: 16px;\\n\"])));\nvar TopicBlockIcon = styled.span(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"])));\nvar ZIndex = styled.div(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"\\n  z-index: \", \";\\n\"])), function (props) {\n  return props.zIndex;\n});\nvar PanelTabRoot = styled.div(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"\\n  min-width: 380px;\\n  max-width: 482px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"])));\nvar ToolbarItemPopoverTarget = styled.div(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar VListContainer = styled.div(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"\\n  max-height: \", \";\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n\"])), function (props) {\n  return props.maxHeight || '300px';\n});\nvar SettingTitle = styled.div(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"])));\nvar SettingItem = styled.span(_templateObject17 || (_templateObject17 = _taggedTemplateLiteral([\"\\n  margin: 0 10px 0 2px;\\n\"])));\nvar SettingBoxContainer = styled.div(_templateObject18 || (_templateObject18 = _taggedTemplateLiteral([\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"])));\nvar SettingLabel = styled(SettingItem)(_templateObject19 || (_templateObject19 = _taggedTemplateLiteral([\"\"])));\nvar SettingRow = styled.div(_templateObject20 || (_templateObject20 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"])));\nvar ColorBar = styled.div(_templateObject21 || (_templateObject21 = _taggedTemplateLiteral([\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"])), function (props) {\n  return props.color;\n});\nvar WithBorder = styled.div(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral([\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"])));\nvar IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile',\n  OPEN: 'open',\n  NEW_FILE: 'newfile',\n  SAVE: 'save',\n  LAYOUT_LEFT_AND_RIGHT: 'layout-left-and-right',\n  LAYOUT_LEFT: 'layout-left',\n  LAYOUT_RIGHT: 'layout-right',\n  UNDO: 'undo',\n  REDO: 'redo'\n};\n\nfunction iconClassName(name) {\n  return \"icon iconfont bm-\".concat(name);\n}\n\nfunction Icon(iconName) {\n  return createElement(\"span\", {\n    className: iconClassName(iconName)\n  });\n}\n\nfunction contentRefKey(key) {\n  return \"content-\".concat(key);\n}\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\".concat(key);\n}\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\".concat(key);\n}\n\nfunction topicWidgetRefKey(key) {\n  return \"topic-widget-\".concat(key);\n}\n\nfunction topicRefKey(key) {\n  return \"topic-\".concat(key);\n}\n\nfunction linksRefKey(key) {\n  return \"links-\".concat(key);\n}\n\nfunction linksSvgRefKey(key) {\n  return \"links-svg-\".concat(key);\n}\n\nfunction collapseRefKey(key) {\n  return \"collapse-\".concat(key);\n}\n\nfunction dropAreaRefKey(key, dir) {\n  return \"dropArea-\".concat(dir, \"-\").concat(key);\n}\n\nvar RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nvar EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\nvar PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE',\n  DRAG_DROP_STATE: 'DRAG_DROP_STATE',\n  RIGHT_TOP_PANEL_STATE: 'RIGHT_TOP_PANEL_STATE',\n  OPERATION_ENABLED: 'OPERATION_ENABLED'\n};\nvar I18nKey = {\n  CONFIRM: 'CONFIRM',\n  CANCEL: 'CANCEL',\n  DEFAULT: 'DEFAULT',\n  SEARCH: 'SEARCH',\n  LEFT_AND_RIGHT: 'LEFT_AND_RIGHT',\n  ONLY_LEFT: 'ONLY_LEFT',\n  ONLY_RIGHT: 'ONLY_RIGHT',\n  EDIT: 'EDIT',\n  ADD_SIBLING: 'ADD_SIBLING',\n  ADD_CHILD: 'ADD_CHILD',\n  EDIT_NOTES: 'EDIT_NOTES',\n  DELETE: 'DELETE',\n  SET_AS_EDITOR_ROOT: 'SET_AS_EDITOR_ROOT',\n  EDIT_TOPOLOGY_DIAGRAM: 'EDIT_TOPOLOGY_DIAGRAM',\n  SET_TOPIC_REFERENCES: 'SET_TOPIC_REFERENCES',\n  //========================================\n  TOPIC_STYLE: 'TOPIC_STYLE',\n  STYLE: 'STYLE',\n  TEXT_EDITOR: 'TEXT_EDITOR',\n  LINK: 'LINK',\n  LINK_TO_PARENT: 'LINK_TO_PARENT',\n  SUB_LINKS: 'SUB_LINKS',\n  COPY_STYLE: 'COPY_STYLE',\n  PASTE_STYLE: 'PASTE_STYLE',\n  CLEAR_TOPIC_STYLE: 'CLEAR_TOPIC_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  LINE_TYPE: 'LINE_TYPE',\n  //=======================================\n  THEME: 'THEME',\n  GLOBAL: 'GLOBAL',\n  HIGHLIGHT: 'HIGHLIGHT',\n  RANDOM_COLOR: 'RANDOM_COLOR',\n  NORMAL_TOPIC: 'NORMAL_TOPIC',\n  PRIMARY_TOPIC: 'PRIMARY_TOPIC',\n  ROOT_TOPIC: 'ROOT_TOPIC',\n  EXPORT_THEME: 'EXPORT_THEME',\n  IMPORT_THEME: 'IMPORT_THEME',\n  //=======================================\n  TAGS: 'TAGS',\n  TAGS_MANAGER: 'TAGS_MANAGER',\n  TAG_NAME: 'TAG_NAME',\n  ADD_TAG: 'ADD_TAG',\n  UPDATE_TAG: 'UPDATE_TAG',\n  ALREADY_ADDED: 'ALREADY_ADDED',\n  CAN_BE_ADDED: 'CAN_BE_ADDED',\n  TOPICS_THAT_USE_THIS_TAG: 'TOPICS_THAT_USE_THIS_TAG',\n  //=======================================\n  BACKGROUND: 'BACKGROUND',\n  COLOR: 'COLOR',\n  BORDER: 'BORDER',\n  WIDTH: 'WIDTH',\n  RADIUS: 'RADIUS',\n  FONT_SIZE: 'FONT_SIZE',\n  LINE_HEIGHT: 'LINE_HEIGHT',\n  PADDING: 'PADDING',\n  TOP: 'TOP',\n  BOTTOM: 'BOTTOM',\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  NONE: 'NONE',\n  SOLID: 'SOLID',\n  DOTTED: 'DOTTED',\n  DASHED: 'DASHED',\n  DOUBLE: 'DOUBLE',\n  ROUND: 'ROUND',\n  CURVE: 'CURVE',\n  LINE: 'LINE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC',\n  ZOOM: 'ZOOM',\n  ZOOM_IN: 'ZOOM_IN',\n  ZOOM_OUT: 'ZOOM_OUT',\n  RESET: 'RESET',\n  RESET_ZOOM: 'RESET_ZOOM',\n  NOTE_PLACEHOLDER: \"NOTE_PLACEHOLDER\",\n  TOPOLOGY_DIAGRAM_EDITOR: 'TOPOLOGY_DIAGRAM_EDITOR',\n  BASIC: 'BASIC',\n  FLOW_GRAPH: 'FLOW_GRAPH',\n  ACTIVITY_DIAGRAM: 'ACTIVITY_DIAGRAM',\n  SEQUENCE_DIAGRAM: 'SEQUENCE_DIAGRAM',\n  CLASS_DIAGRAM: 'CLASS_DIAGRAM',\n  REFERENCE_TOPICS: \"REFERENCE_TOPICS\",\n  REFERENCED_TOPICS: \"REFERENCED_TOPICS\",\n  SELECT_REF_TOPICS_TIP: 'SELECT_REF_TOPICS_TIP',\n  TAG_NAME_OVER_MAX_TIP: 'TAG_NAME_OVER_MAX_TIP',\n  DELETE_TAG_TIP: 'DELETE_TAG_TIP',\n  DELETE_TOPOLOGY_TIP: 'DELETE_TOPOLOGY_TIP'\n};\n\nvar cancelEvent = function cancelEvent(e) {\n  e.stopPropagation();\n};\n\nfunction browserDownloadFile(url, filename) {\n  var link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nfunction browserDownloadText(text, filename) {\n  var url = \"data:text/plain,\".concat(encodeURIComponent(text));\n  browserDownloadFile(url, filename);\n}\n\nfunction browserOpenFile(accept) {\n  var input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n  return new Promise(function (resolve, reject) {\n    input.addEventListener('change', function (evt) {\n      //@ts-ignore\n      var file = evt.target.files[0];\n      var fr = new FileReader();\n\n      fr.onload = function (evt) {\n        var txt = evt.target.result; //@ts-ignore\n\n        resolve(txt);\n      };\n\n      fr.onerror = function (evt) {\n        reject(evt.target.error);\n      };\n\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n\nfunction paddingCss(arg) {\n  var _arg$top = arg.top,\n      top = _arg$top === void 0 ? 0 : _arg$top,\n      _arg$right = arg.right,\n      right = _arg$right === void 0 ? 0 : _arg$right,\n      _arg$bottom = arg.bottom,\n      bottom = _arg$bottom === void 0 ? 0 : _arg$bottom,\n      _arg$left = arg.left,\n      left = _arg$left === void 0 ? 0 : _arg$left;\n  return \"\".concat(top, \"px \").concat(right, \"px \").concat(bottom, \"px \").concat(left, \"px\");\n} // import { I18nKey } from './keys';\n\n\nfunction getI18nText(ctx, key) {\n  if (Array.isArray(key)) {\n    return key.map(function (k) {\n      return ctx.controller.run('getI18nText', _objectSpread(_objectSpread({}, ctx), {}, {\n        key: k\n      }));\n    });\n  }\n\n  return ctx.controller.run('getI18nText', _objectSpread(_objectSpread({}, ctx), {}, {\n    key: key.toUpperCase()\n  }));\n} // export function getCssI18nText(ctx, cssName) {\n//   const cssNames = {\n//     none: I18nKey.NONE,\n//     solid: I18nKey.SOLID,\n//     dotted: I18nKey.DOTTED,\n//     dashed: I18nKey.DASHED,\n//     double: I18nKey.DOUBLE,\n//\n//     round: I18nKey.ROUND,\n//     curve: I18nKey.CURVE,\n//\n//   };\n//\n//   return getI18nText(ctx, cssNames[cssName]);\n// }\n\n\nfunction getLinkKey(fromKey, toKey) {\n  return \"link-\".concat(fromKey, \"-\").concat(toKey);\n}\n\nfunction centerY(rect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nfunction centerX(rect) {\n  return (rect.left + rect.right) / 2;\n}\n\nfunction centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nfunction centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nfunction center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\n\nfunction _getRelativeRect(el, rel) {\n  var scale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  var width = rect.width / scale;\n  var height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getRelativeVector(el, rel) {\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  return [elCenter[0] - relCenter[0], elCenter[1] - relCenter[1]];\n}\n\nfunction SettingGroup(props) {\n  return createElement(\"div\", null, props.children, createElement(Divider, {\n    style: {\n      margin: '10px 0'\n    }\n  }));\n}\n\nfunction SettingItemColorPicker(props) {\n  var title = props.title,\n      _props$layout = props.layout,\n      layout = _props$layout === void 0 ? 'h' : _props$layout,\n      color = props.color,\n      handleColorChange = props.handleColorChange;\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), title != null && createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(Popover, null, createElement(WithBorder, null, createElement(\"div\", {\n    className: iconClassName(IconName.COLOR_PICKER)\n  }), createElement(ColorBar, {\n    color: color\n  })), createElement(\"div\", null, createElement(SketchPicker, {\n    color: color,\n    onChangeComplete: function onChangeComplete(color) {\n      return handleColorChange(color.hex);\n    }\n  })))));\n}\n\nfunction SettingItemButton(props) {\n  var title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  return createElement(SettingItem, null, createElement(Button, Object.assign({}, restProps), title));\n}\n\nfunction SettingItemNumericInput(props) {\n  var _props$layout2 = props.layout,\n      layout = _props$layout2 === void 0 ? 'h' : _props$layout2,\n      title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded2);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(NumericInput, Object.assign({}, restProps))));\n}\n\nfunction SettingItemInput(props) {\n  var _props$layout3 = props.layout,\n      layout = _props$layout3 === void 0 ? 'h' : _props$layout3,\n      title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded3);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title, \" \"), createElement(InputGroup, Object.assign({}, restProps))));\n}\n\nfunction SettingItemSelect(props) {\n  var text = props.text,\n      items = props.items,\n      itemRenderer = props.itemRenderer,\n      onItemSelect = props.onItemSelect;\n  var PxSelect = Select.ofType();\n  var pxProps = {\n    items: items,\n    itemRenderer: itemRenderer,\n    onItemSelect: onItemSelect,\n    filterable: false\n  };\n  return createElement(SettingItem, null, createElement(PxSelect, Object.assign({}, pxProps), createElement(Button, {\n    text: text\n  })));\n}\n\nvar renderItem = function renderItem(unit) {\n  return function (v, _ref) {\n    var handleClick = _ref.handleClick;\n    return createElement(MenuItem, {\n      text: \"\".concat(v).concat(unit),\n      key: v,\n      onClick: handleClick\n    });\n  };\n};\n\nvar renderItemI18n = function renderItemI18n(ctx) {\n  return function (v, _ref2) {\n    var handleClick = _ref2.handleClick;\n    return createElement(MenuItem, {\n      text: getI18nText(ctx, v),\n      key: v,\n      onClick: handleClick\n    });\n  };\n};\n\nvar PxSelect = Select.ofType();\n\nvar borderWidthItems = _toConsumableArray(Array(7).keys());\n\nvar ToolbarItemRoot = styled.div(_templateObject23 || (_templateObject23 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  padding: 6px;\\n  width: 40px;\\n  height: 40px;\\n  cursor: pointer;\\n  color: \", \";\\n  font-size: 24px;\\n  display: inline-block;\\n  &:hover {\\n    color: \", \";\\n  }\\n\"])), function (props) {\n  return props.disabled ? 'grey' : 'black';\n}, function (props) {\n  return props.disabled ? 'grey' : 'rgb(44, 184, 146)';\n});\n\nfunction ToolbarItem(props) {\n  var controller = props.controller,\n      children = props.children,\n      onClick = props.onClick,\n      restProps = _objectWithoutProperties(props, _excluded4);\n\n  var disabled = props.disabled;\n  disabled = disabled || !controller.getValue(PropKey.OPERATION_ENABLED, props);\n\n  var handleClick = function handleClick(e) {\n    if (!disabled) onClick(e);\n  };\n\n  var nProps = _objectSpread({\n    controller: controller,\n    disabled: disabled,\n    onClick: handleClick\n  }, restProps);\n\n  return createElement(ToolbarItemRoot, Object.assign({}, nProps), children);\n}\n\nfunction CreateModelPlugin() {\n  return {\n    createNewModel: function createNewModel(props) {\n      return Model.createEmpty();\n    }\n  };\n}\n\nvar log$2 = debug('plugin:event');\n\nfunction EventPlugin() {\n  var eventListeners = {};\n  return {\n    handleTopicClick: function handleTopicClick(props) {\n      log$2('handleTopicClick');\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey;\n      log$2(model.zoomFactor); //TODO\n\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (model.focusKey === topicKey && model.focusMode === FocusMode.EDITING_CONTENT) return;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      }));\n    },\n    handleTopicDoubleClick: function handleTopicDoubleClick(props) {\n      var controller = props.controller,\n          model = props.model;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      }));\n    },\n    handleTopicContextMenu: function handleTopicContextMenu(props) {\n      var controller = props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n    },\n    handleActiveModalClose: function handleActiveModalClose(props) {\n      var controller = props.controller;\n      var activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n\n      if (activeModalProps.name === 'edit-desc') {\n        return function () {\n          controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          }));\n        };\n      }\n    },\n    addEventListener: function addEventListener(props) {\n      var key = props.key,\n          listener = props.listener,\n          once = props.once,\n          controller = props.controller;\n      if (!eventListeners[key]) eventListeners[key] = [];\n\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key: key,\n          listener: listener\n        });\n      }\n    },\n    removeEventListener: function removeEventListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(function (fn) {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n    fireEvent: function fireEvent(props) {\n      var key = props.key;\n\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(function (fn) {\n          return fn();\n        });\n      }\n    }\n  };\n}\n\nfunction GetValuePlugin() {\n  return {\n    getValue: function getValue(props, next) {\n      var propKey = props.propKey,\n          controller = props.controller,\n          diagramState = props.diagramState;\n\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.OPERATION_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n\n        case PropKey.DRAG_DROP_STATE:\n          return diagramState.dragDrop;\n\n        case PropKey.RIGHT_TOP_PANEL_STATE:\n          return diagramState.rightTopPanel;\n      }\n\n      return next();\n    }\n  };\n}\n\nvar HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\nvar MoveTopicDir = {\n  CENTER: 0,\n  LEFT_CENTER: 1\n};\n\nfunction op(opType, props) {\n  var _props = props,\n      topicKey = _props.topicKey,\n      model = _props.model,\n      controller = _props.controller;\n\n  if (topicKey === undefined) {\n    props = _objectSpread(_objectSpread({}, props), {}, {\n      topicKey: model.focusKey\n    });\n  }\n\n  controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n    opType: opType\n  }));\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys: function customizeHotKeys(props) {\n      var handleKeyDown = function handleKeyDown(opType) {\n        return function (e) {\n          // log('HotKeyPlugin', opType);\n          op(opType, props);\n        };\n      };\n\n      var topicHotKeys = new Map([[HotKeyName.ADD_CHILD, {\n        label: 'add child',\n        combo: 'tab',\n        onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n      }], [HotKeyName.ADD_SIBLING, {\n        label: 'add sibling',\n        combo: 'enter',\n        onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n      }], [HotKeyName.DELETE_TOPIC, {\n        label: 'delete topic',\n        combo: 'del',\n        onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n      }], [HotKeyName.EDIT_CONTENT, {\n        label: 'edit content',\n        combo: 'space',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n      }], [HotKeyName.EDIT_NOTES, {\n        label: 'edit notes',\n        combo: 'alt + d',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n      }], [HotKeyName.SET_EDITOR_ROOT, {\n        label: 'set editor root',\n        combo: 'alt + shift + f',\n        onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n      }]]);\n      var globalHotKeys = new Map();\n      return {\n        topicHotKeys: topicHotKeys,\n        globalHotKeys: globalHotKeys\n      };\n    }\n  };\n}\n\nfunction I18nPlugin() {\n  var i18nTextMap = new Map([[I18nKey.CONFIRM, 'Confirm'], [I18nKey.CANCEL, 'Cancel'], [I18nKey.DEFAULT, 'Default'], [I18nKey.SEARCH, 'Search'], [I18nKey.LEFT_AND_RIGHT, 'Left And Right'], [I18nKey.ONLY_LEFT, 'Only Left'], [I18nKey.ONLY_RIGHT, 'Only Right'], [I18nKey.EDIT, 'Edit'], [I18nKey.ADD_CHILD, 'Add Child'], [I18nKey.ADD_SIBLING, 'Add Sibling'], [I18nKey.EDIT_NOTES, 'Edit Notes'], [I18nKey.DELETE, 'Delete'], [I18nKey.SET_AS_EDITOR_ROOT, 'Set as Editor Root'], [I18nKey.EDIT_TOPOLOGY_DIAGRAM, 'Edit Topology Diagram'], [I18nKey.SET_TOPIC_REFERENCES, 'Set Topic References'], [I18nKey.TOPIC_STYLE, 'TopicStyle'], [I18nKey.STYLE, 'Style'], [I18nKey.TEXT_EDITOR, 'Text Editor'], [I18nKey.LINK, 'Link'], [I18nKey.LINK_TO_PARENT, 'LinkToParent'], [I18nKey.SUB_LINKS, 'SubLinks'], [I18nKey.COPY_STYLE, 'Copy Style'], [I18nKey.PASTE_STYLE, 'Paste Style'], [I18nKey.CLEAR_TOPIC_STYLE, 'Clear Topic Style'], [I18nKey.CLEAR_ALL_CUSTOM_STYLE, 'Clear All Custom Style'], [I18nKey.LINE_TYPE, 'LineType'], [I18nKey.THEME, 'Theme'], [I18nKey.GLOBAL, 'Global'], [I18nKey.HIGHLIGHT, 'Highlight'], [I18nKey.RANDOM_COLOR, 'Random Color'], [I18nKey.NORMAL_TOPIC, 'NormalTopic'], [I18nKey.PRIMARY_TOPIC, 'PrimaryTopic'], [I18nKey.ROOT_TOPIC, 'RootTopic'], [I18nKey.EXPORT_THEME, 'Export Theme'], [I18nKey.IMPORT_THEME, 'Import Theme'], [I18nKey.TAGS, 'Tags'], [I18nKey.TAGS_MANAGER, 'Tags Manager'], [I18nKey.TAG_NAME, 'Tag Name'], [I18nKey.ADD_TAG, 'Add Tag'], [I18nKey.UPDATE_TAG, 'Update Tag'], [I18nKey.ALREADY_ADDED, 'Already Added'], [I18nKey.CAN_BE_ADDED, 'Can be Added'], [I18nKey.TOPICS_THAT_USE_THIS_TAG, 'Topics that Use this Tag'], [I18nKey.BACKGROUND, 'Background'], [I18nKey.COLOR, 'Color'], [I18nKey.BORDER, 'Border'], [I18nKey.WIDTH, 'Width'], [I18nKey.RADIUS, 'Radius'], [I18nKey.FONT_SIZE, 'FontSize'], [I18nKey.LINE_HEIGHT, 'LineHeight'], [I18nKey.PADDING, 'Padding'], [I18nKey.TOP, 'Top'], [I18nKey.BOTTOM, 'Bottom'], [I18nKey.LEFT, 'Left'], [I18nKey.RIGHT, 'Right'], [I18nKey.NONE, 'None'], [I18nKey.SOLID, 'Solid'], [I18nKey.DOTTED, 'Dotted'], [I18nKey.DASHED, 'Dashed'], [I18nKey.DOUBLE, 'Double'], [I18nKey.ROUND, 'Round'], [I18nKey.CURVE, 'Curve'], [I18nKey.LINE, 'Line'], [I18nKey.COLLAPSE_ALL, 'Collapse All'], [I18nKey.EXPAND_ALL, 'Expand All'], [I18nKey.CENTER_ROOT_TOPIC, 'Center Root Topic'], [I18nKey.ZOOM, 'zoom'], [I18nKey.ZOOM_IN, 'Zoom In'], [I18nKey.ZOOM_OUT, 'Zoom Out'], [I18nKey.RESET, 'Reset'], [I18nKey.RESET_ZOOM, 'Reset Zoom'], [I18nKey.NOTE_PLACEHOLDER, 'Write topic notes here'], [I18nKey.TOPOLOGY_DIAGRAM_EDITOR, 'Topology Diagram Editor'], [I18nKey.BASIC, 'Basic'], [I18nKey.FLOW_GRAPH, 'Flow Graph'], [I18nKey.ACTIVITY_DIAGRAM, 'Activity Diagram'], [I18nKey.SEQUENCE_DIAGRAM, 'Sequence Diagram'], [I18nKey.CLASS_DIAGRAM, 'Class Diagram'], [I18nKey.REFERENCE_TOPICS, 'Reference Topics'], [I18nKey.REFERENCED_TOPICS, 'Referenced Topics'], [I18nKey.SELECT_REF_TOPICS_TIP, 'Please select the topics you want to reference. After selection, click the confirm button.'], [I18nKey.TAG_NAME_OVER_MAX_TIP, 'The length of tag name over the maximum length: 50!'], [I18nKey.DELETE_TAG_TIP, 'All the relationship about this tag will be lost if you delete this tag! Are you confirm?'], [I18nKey.DELETE_TOPOLOGY_TIP, 'Are you confirm to delete this topology diagram?']]);\n  return {\n    getI18nTextMap: function getI18nTextMap() {\n      return i18nTextMap;\n    },\n    getI18nText: function getI18nText(ctx) {\n      var controller = ctx.controller,\n          key = ctx.key;\n      var m = controller.run('getI18nTextMap', ctx);\n\n      if (!m.has(key)) {\n        throw new Error(\"i18n key \".concat(key, \" is not exist\"));\n      }\n\n      return m.get(key);\n    }\n  };\n}\n\nfunction LayoutPlugin() {\n  var _zoomFactor = 1;\n  return {\n    getPartTopics: function getPartTopics(_ref3) {\n      var layout = _ref3.layout,\n          model = _ref3.model,\n          topicKey = _ref3.topicKey;\n      var topic = model.getTopic(topicKey);\n      var subTopicCount = topic.subKeys.size;\n      var topics = topic.subKeys.toArray();\n\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return {\n            R: topics\n          };\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return {\n            L: topics\n          };\n\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n    createSubTopics: function createSubTopics(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          topics = props.topics,\n          saveRef = props.saveRef;\n      var topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      var subTopics = [];\n      topics.forEach(function (tKey) {\n        var topicProps = _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        });\n\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return {\n        subTopics: subTopics\n      };\n    },\n    layout: function layout(props) {\n      var getRef = props.getRef,\n          model = props.model;\n      var links = getRef(linksRefKey(model.editorRootTopicKey));\n      var highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY);\n      var dropEffect = getRef(RefKey.DROP_EFFECT_KEY);\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n      var editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic) {\n        if (topic.key !== model.editorRootTopicKey) {\n          var topicWidget = getRef(topicWidgetRefKey(topic.key));\n          topicWidget && topicWidget.layoutLinks();\n        }\n\n        if (!topic.collapse) {\n          var _iterator2 = _createForOfIteratorHelper(topic.subKeys),\n              _step2;\n\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var subKey = _step2.value;\n              layoutTopic(model.getTopic(subKey));\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n        }\n      }\n    },\n    getRelativeRect: function getRelativeRect(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return _getRelativeRect(element, bigView, zoomFactor);\n    },\n    getRelativeRectFromViewPort: function getRelativeRectFromViewPort(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return _getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort: function getRelativeVectorFromViewPort(props) {\n      var element = props.element,\n          getRef = props.getRef;\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n    addZoomFactorChangeEventListener: function addZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('addTempValueChangeListener', _objectSpread({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    removeZoomFactorChangeEventListener: function removeZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('removeTempValueChangeListener', _objectSpread({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    setZoomFactor: function setZoomFactor(props) {\n      var controller = props.controller,\n          zoomFactor = props.zoomFactor;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n    getZoomFactor: function getZoomFactor(props) {\n      var controller = props.controller;\n      return controller.run('getTempValue', {\n        key: 'ZoomFactor'\n      }) || _zoomFactor;\n    },\n    moveTopicToCenter: function moveTopicToCenter(props) {\n      var getRef = props.getRef,\n          topicKey = props.topicKey,\n          model = props.model,\n          _props$moveDir = props.moveDir,\n          moveDir = _props$moveDir === void 0 ? MoveTopicDir.LEFT_CENTER : _props$moveDir;\n\n      if (model.editorRootTopicKey !== topicKey && getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n        throw new Error(\"moveTopicToCenter error: topicKey \".concat(topicKey, \" is not the DESCENDANT of editor root topic\"));\n      }\n\n      var topic = getRef(topicRefKey(topicKey));\n      var dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      var viewBox = dragScroll.viewBox;\n\n      if (!topic || !viewBox) {\n        throw new Error(\"moveTopicToCenter error: topic or viewBox is null\");\n      }\n\n      var vector = getRelativeVector(topic, viewBox); //TODO\n\n      if (moveDir === MoveTopicDir.CENTER) dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);else if (moveDir === MoveTopicDir.LEFT_CENTER) {\n        var boxRect = viewBox.getBoundingClientRect();\n        var topicRect = topic.getBoundingClientRect();\n        var delta = (boxRect.width - topicRect.width) / 2;\n        dragScroll.setViewBoxScrollDelta(vector[0] + delta - 200, vector[1]);\n      }\n    },\n    focusTopicAndMoveToCenter: function focusTopicAndMoveToCenter(props) {\n      var controller = props.controller,\n          topicKey = props.topicKey;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opArray: [{\n          opType: OpType.FOCUS_TOPIC,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL\n        }, {\n          opType: OpType.EXPAND_TO,\n          topicKey: topicKey\n        }],\n        allowUndo: false,\n        callback: function callback(model) {\n          return function () {\n            controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, props), {}, {\n              model: model,\n              topicKey: topicKey\n            }));\n          };\n        }\n      }));\n    }\n  };\n}\n\nvar log$3 = debug('plugin:operation');\n\nfunction OperationPlugin() {\n  var startEditingContent = function startEditingContent(_ref4) {\n    var model = _ref4.model,\n        topicKey = _ref4.topicKey;\n    return ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n\n  var startEditingDesc = function startEditingDesc(_ref5) {\n    var model = _ref5.model,\n        topicKey = _ref5.topicKey;\n    var topic = model.getTopic(topicKey);\n    var desc = topic.getBlock(BlockType.DESC);\n\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model: model,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    var srcKey = props.srcKey,\n        dstKey = props.dstKey,\n        dropDir = props.dropDir;\n    var model = props.model;\n    var srcTopic = model.getTopic(srcKey);\n    var dstTopic = model.getTopic(dstKey);\n    var srcParentKey = srcTopic.parentKey;\n    var srcParentTopic = model.getTopic(srcParentKey);\n    var srcParentSubKeys = srcParentTopic.subKeys;\n    var srcIndex = srcParentSubKeys.indexOf(srcKey);\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      var dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(function (m) {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstKey).setIn(['topics', dstKey, 'subKeys'], dstSubKeys).setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      var dstParentKey = dstTopic.parentKey;\n      var dstParentItem = model.getTopic(dstParentKey);\n      var dstParentSubKeys = dstParentItem.subKeys;\n      var dstIndex = dstParentSubKeys.indexOf(dstKey); //src  dst \n\n      if (srcParentKey === dstParentKey) {\n        var newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(function (key) {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys.push(srcKey).push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys.push(key).push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstParentKey).setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys).setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n\n    return model;\n  }\n\n  var OpMap = new Map([[OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse], [OpType.COLLAPSE_ALL, ModelModifier.collapseAll], [OpType.EXPAND_ALL, ModelModifier.expandAll], [OpType.EXPAND_TO, ModelModifier.expandTo], [OpType.ADD_CHILD, ModelModifier.addChild], [OpType.ADD_SIBLING, ModelModifier.addSibling], [OpType.DELETE_TOPIC, ModelModifier.deleteTopic], [OpType.FOCUS_TOPIC, ModelModifier.focusTopic], [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode], [OpType.SET_STYLE, ModelModifier.setStyle], [OpType.CLEAR_ALL_CUSTOM_STYLE, ModelModifier.clearAllCustomStyle], [OpType.SET_THEME, ModelModifier.setTheme], [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData], [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock], [OpType.START_EDITING_CONTENT, startEditingContent], [OpType.START_EDITING_DESC, startEditingDesc], [OpType.DRAG_AND_DROP, dragAndDrop], [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey], [OpType.SET_LAYOUT_DIR, ModelModifier.setLayoutDir]]);\n  var undoStack = Stack();\n  var redoStack = Stack();\n  var enabled = true;\n  var whiteListOperation = new Set();\n  return {\n    isOperationEnabled: function isOperationEnabled(props) {\n      return enabled;\n    },\n    enableOperation: function enableOperation() {\n      enabled = true;\n    },\n    disableOperation: function disableOperation(_ref6) {\n      var whiteList = _ref6.whiteList;\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\r\n     * for example: A plugin can write a function\r\n     * getOpMap(ctx,next) {\r\n     *   let opMap = next();\r\n     *   opMap.set(\"OpTypeName\",opFunc);\r\n     *   return opMap;\r\n     * }\r\n     * @param ctx\r\n     */\n    getOpMap: function getOpMap(ctx) {\n      return OpMap;\n    },\n    //undo\n    getAllowUndo: function getAllowUndo(ctx) {\n      var model = ctx.model,\n          opType = ctx.opType,\n          _ctx$allowUndo = ctx.allowUndo,\n          allowUndo = _ctx$allowUndo === void 0 ? true : _ctx$allowUndo;\n      if (allowUndo === false) return false;\n\n      if (opType) {\n        switch (opType) {\n          // undo \n          case OpType.FOCUS_TOPIC:\n          case OpType.SET_FOCUS_MODE:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n        }\n      }\n\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n\n      return model.config.allowUndo;\n    },\n    getUndoRedoStack: function getUndoRedoStack() {\n      return {\n        undoStack: undoStack,\n        redoStack: redoStack\n      };\n    },\n    setUndoStack: function setUndoStack(ctx) {\n      log$3('setUndoStack', ctx.undoStack);\n      undoStack = ctx.undoStack;\n    },\n    setRedoStack: function setRedoStack(ctx) {\n      log$3('setRedoStack', ctx.redoStack);\n      redoStack = ctx.redoStack;\n    },\n    canUndo: function canUndo(ctx) {\n      var controller = ctx.controller;\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n      if (!isOperationEnabled) return false;\n\n      var _controller$run = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run.undoStack;\n\n      var allowUndo = controller.run('getAllowUndo', ctx);\n      return undoStack.size > 0 && allowUndo;\n    },\n    canRedo: function canRedo(ctx) {\n      var controller = ctx.controller;\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n      if (!isOperationEnabled) return false;\n\n      var _controller$run2 = controller.run('getUndoRedoStack', ctx),\n          redoStack = _controller$run2.redoStack;\n\n      var allowUndo = controller.run('getAllowUndo', ctx);\n      return redoStack.size > 0 && allowUndo;\n    },\n    undo: function undo(ctx) {\n      var controller = ctx.controller,\n          model = ctx.model;\n\n      if (!controller.run('getAllowUndo', ctx)) {\n        return;\n      }\n\n      var _controller$run3 = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run3.undoStack,\n          redoStack = _controller$run3.redoStack;\n\n      var newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        undoStack: undoStack.shift()\n      }));\n      controller.run('setRedoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        redoStack: redoStack.push(model)\n      }));\n      log$3(newModel);\n      controller.change(newModel);\n    },\n    redo: function redo(ctx) {\n      var controller = ctx.controller,\n          model = ctx.model;\n\n      if (!controller.run('getAllowUndo', ctx)) {\n        return;\n      }\n\n      var _controller$run4 = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run4.undoStack,\n          redoStack = _controller$run4.redoStack;\n\n      var newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        undoStack: undoStack.push(model)\n      }));\n      controller.run('setRedoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        redoStack: redoStack.shift()\n      }));\n      controller.change(newModel);\n    },\n    //TODO \n    operation: function operation(ctx) {\n      var controller = ctx.controller,\n          opType = ctx.opType,\n          model = ctx.model,\n          opArray = ctx.opArray,\n          callback = ctx.callback;\n\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          var opNotInWhiteList = opArray.filter(function (op) {\n            return !whiteListOperation.has(op.opType);\n          });\n\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log$3('operation:', opType || opArray.map(function (op) {\n        return op.opType;\n      }));\n      log$3('operation:', model);\n      log$3('operation:', ctx);\n      var opMap = controller.run('getOpMap', ctx);\n      controller.run('beforeOperation', ctx);\n\n      if (controller.run('getAllowUndo', ctx)) {\n        var _controller$run5 = controller.run('getUndoRedoStack', ctx),\n            _undoStack = _controller$run5.undoStack;\n\n        controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n          undoStack: _undoStack.push(model)\n        }));\n      }\n\n      var newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce(function (acc, cur) {\n          var opType = cur.opType;\n          if (!opMap.has(opType)) throw new Error(\"opType:\".concat(opType, \" not exist!\"));\n          var opFunc = opMap.get(opType);\n\n          var opFuncProps = _objectSpread(_objectSpread({\n            controller: controller\n          }, cur), {}, {\n            model: acc\n          });\n\n          var res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc(_objectSpread(_objectSpread({}, opFuncProps), {}, {\n            model: res\n          }));\n          res = controller.run('afterOpFunction', _objectSpread(_objectSpread({}, opFuncProps), {}, {\n            model: res\n          }));\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(\"opType:\".concat(opType, \" not exist!\"));\n        var opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', ctx);\n        newModel = opFunc(_objectSpread(_objectSpread({}, ctx), {}, {\n          model: newModel\n        }));\n        newModel = controller.run('afterOpFunction', _objectSpread(_objectSpread({}, ctx), {}, {\n          model: newModel\n        }));\n      }\n\n      log$3('newModel:', newModel);\n      controller.change(newModel, callback ? callback(newModel) : null);\n      controller.run('afterOperation', ctx);\n    },\n    deleteRefKey: function deleteRefKey(ctx) {\n      var model = ctx.model,\n          topicKey = ctx.topicKey,\n          deleteRef = ctx.deleteRef;\n      var allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n\n      var _iterator3 = _createForOfIteratorHelper(allSubKeys),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var key = _step3.value;\n          deleteRef(linksRefKey(key));\n          deleteRef(linksSvgRefKey(key));\n          deleteRef(contentRefKey(key));\n          deleteRef(contentEditorRefKey(key));\n          deleteRef(descEditorRefKey(key));\n          deleteRef(topicWidgetRefKey(key));\n          deleteRef(topicRefKey(key));\n          deleteRef(collapseRefKey(key));\n          deleteRef(dropAreaRefKey(key, 'next'));\n          deleteRef(dropAreaRefKey(key, 'prev'));\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    },\n    // Operation\n    beforeOperation: function beforeOperation(props) {},\n    afterOperation: function afterOperation(props) {},\n    // OpFunction\n    beforeOpFunction: function beforeOpFunction(ctx) {\n      var controller = ctx.controller,\n          opType = ctx.opType,\n          model = ctx.model,\n          topicKey = ctx.topicKey;\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        controller.run('deleteRefKey', ctx);\n      }\n\n      return model;\n    },\n    afterOpFunction: function afterOpFunction(ctx) {\n      return ctx.model;\n    },\n    openNewModel: function openNewModel(ctx) {\n      var model = ctx.model,\n          controller = ctx.controller,\n          newModel = ctx.newModel;\n      controller.run('deleteRefKey', _objectSpread(_objectSpread({}, ctx), {}, {\n        topicKey: model.rootTopicKey\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, ctx), {}, {\n        opType: OpType.EXPAND_TO,\n        topicKey: newModel.focusKey,\n        model: newModel,\n        callback: function callback(model) {\n          return function () {\n            controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, ctx), {}, {\n              model: model,\n              topicKey: model.focusKey\n            }));\n          };\n        }\n      }));\n    }\n  };\n}\n\nvar TopicContextMenu = /*#__PURE__*/function (_BaseWidget) {\n  _inherits(TopicContextMenu, _BaseWidget);\n\n  var _super4 = _createSuper(TopicContextMenu);\n\n  function TopicContextMenu() {\n    _classCallCheck(this, TopicContextMenu);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(TopicContextMenu, [{\n    key: \"render\",\n    value: function render() {\n      var controller = this.props.controller;\n      return createElement(Menu, null, controller.run('customizeTopicContextMenu', this.props));\n    }\n  }]);\n\n  return TopicContextMenu;\n}(BaseWidget);\n\nvar items = [{\n  icon: 'edit',\n  label: I18nKey.EDIT,\n  shortcut: 'Space',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_CONTENT\n}, {\n  icon: 'add-sibling',\n  label: I18nKey.ADD_SIBLING,\n  shortcut: 'Enter',\n  opType: OpType.ADD_SIBLING\n}, {\n  icon: 'add-child',\n  label: I18nKey.ADD_CHILD,\n  shortcut: 'Tab',\n  rootCanUse: true,\n  opType: OpType.ADD_CHILD\n}, {\n  icon: 'notes',\n  label: I18nKey.EDIT_NOTES,\n  shortcut: 'Alt + D',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_DESC\n}, {\n  icon: 'delete-node',\n  label: I18nKey.DELETE,\n  shortcut: 'Del',\n  opType: OpType.DELETE_TOPIC\n}, {\n  icon: 'root',\n  label: I18nKey.SET_AS_EDITOR_ROOT,\n  shortcut: 'Alt + Shift + F',\n  opType: OpType.SET_EDITOR_ROOT\n}];\n\nfunction ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu: function renderTopicContextMenu(props) {\n      return createElement(TopicContextMenu, Object.assign({}, props));\n    },\n    customizeTopicContextMenu: function customizeTopicContextMenu(ctx) {\n      var topicKey = ctx.topicKey,\n          model = ctx.model,\n          controller = ctx.controller;\n      var isRoot = topicKey === model.editorRootTopicKey;\n\n      function onClickItem(item) {\n        return function (e) {\n          item.opType && controller.run('operation', _objectSpread(_objectSpread({}, ctx), {}, {\n            opType: item.opType\n          }));\n        };\n      }\n\n      return items.map(function (item) {\n        return isRoot && !item.rootCanUse ? null : createElement(MenuItem, {\n          key: item.label,\n          icon: Icon(item.icon),\n          text: getI18nText(ctx, item.label),\n          labelElement: createElement(\"kbd\", null, item.shortcut),\n          onClick: onClickItem(item)\n        });\n      });\n    }\n  };\n}\n\nvar log$4 = debug('node:topic-drop-effect');\nvar DropEffectSvg = styled.svg(_templateObject24 || (_templateObject24 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicDropEffect = /*#__PURE__*/function (_BaseWidget2) {\n  _inherits(TopicDropEffect, _BaseWidget2);\n\n  var _super5 = _createSuper(TopicDropEffect);\n\n  function TopicDropEffect() {\n    var _this3;\n\n    _classCallCheck(this, TopicDropEffect);\n\n    _this3 = _super5.apply(this, arguments);\n    _this3.state = {\n      content: null\n    };\n    return _this3;\n  }\n\n  _createClass(TopicDropEffect, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var getRef = props.getRef,\n          model = props.model,\n          zoomFactor = props.zoomFactor,\n          diagramState = props.diagramState;\n      var dragDrop = diagramState.dragDrop;\n\n      if (dragDrop == null) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var targetKey = dragDrop.targetKey,\n          targetDir = dragDrop.targetDir;\n      log$4('layout', targetDir);\n\n      if (targetKey == null) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var refKey;\n\n      if (targetDir === 'in') {\n        refKey = contentRefKey(targetKey);\n      } else {\n        refKey = dropAreaRefKey(targetKey, targetDir);\n      }\n\n      var content = getRef(refKey);\n      var svg = getRef('svg-drop-effect');\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var padding = 3;\n      var x = contentRect.left - svgRect.left - padding;\n      var y = contentRect.top - svgRect.top - padding;\n      var width = contentRect.width + 2 * padding;\n      var height = contentRect.height + 2 * padding;\n      this.setState({\n        content: createElement(\"g\", null, createElement(\"rect\", {\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: \"none\",\n          stroke: model.config.theme.highlightColor,\n          strokeDasharray: \"5,5\",\n          strokeWidth: 2\n        }))\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var saveRef = this.props.saveRef;\n      return createElement(DropEffectSvg, {\n        ref: saveRef('svg-drop-effect')\n      }, this.state.content);\n    }\n  }]);\n\n  return TopicDropEffect;\n}(BaseWidget);\n\nvar log$5 = debug('plugin:drag-and-drop');\nvar DropArea = styled.div(_templateObject25 || (_templateObject25 = _taggedTemplateLiteral([\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"])), function (props) {\n  return \"\".concat(props.height, \"px\");\n});\n\nfunction DragAndDropPlugin() {\n  // let dragTargetKey: KeyType = null;\n  // let dragTargetDir: string = null;\n  return {\n    renderTopicDropArea: function renderTopicDropArea(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          saveRef = props.saveRef,\n          controller = props.controller,\n          model = props.model;\n\n      var onDragEnter = function onDragEnter(ev) {\n        log$5('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragLeave = function onDragLeave(ev) {\n        log$5('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragOver = function onDragOver(ev) {\n        ev.preventDefault();\n      };\n\n      var onDrop = function onDrop(ev) {\n        log$5('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var eventHandlers = {\n        onDragEnter: onDragEnter,\n        onDragLeave: onDragLeave,\n        onDragOver: onDragOver,\n        onDrop: onDrop\n      };\n      return createElement(DropArea, Object.assign({\n        height: model.config.theme.marginV / 2,\n        ref: saveRef(dropAreaRefKey(topicKey, dropDir))\n      }, eventHandlers));\n    },\n    renderDragAndDropEffect: function renderDragAndDropEffect(props) {\n      log$5('renderDragAndDropEffect');\n      var saveRef = props.saveRef;\n      return createElement(TopicDropEffect, Object.assign({\n        ref: saveRef(RefKey.DROP_EFFECT_KEY)\n      }, props));\n    },\n    handleTopicDragStart: function handleTopicDragStart(props) {\n      var controller = props.controller,\n          ev = props.ev;\n      ev.stopPropagation();\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      }));\n    },\n    canDrop: function canDrop(props) {\n      var srcKey = props.srcKey,\n          dstKey = props.dstKey,\n          model = props.model,\n          dropDir = props.dropDir;\n      if (srcKey === model.editorRootTopicKey || srcKey === dstKey || getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR) return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n      var srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n    handleTopicDragEnter: function handleTopicDragEnter(props) {\n      var dropDir = props.dropDir,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          model = props.model,\n          diagramState = props.diagramState,\n          setDiagramState = props.setDiagramState;\n      log$5('handleTopicDragEnter:', topicKey, dropDir);\n      var canDrop = controller.run('canDrop', _objectSpread(_objectSpread({}, props), {}, {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      }));\n\n      if (canDrop) {\n        setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n          dragDrop: {\n            targetKey: topicKey,\n            targetDir: dropDir\n          }\n        }));\n      }\n    },\n    handleTopicDragLeave: function handleTopicDragLeave(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          getRef = props.getRef,\n          ev = props.ev,\n          diagramState = props.diagramState,\n          setDiagramState = props.setDiagramState;\n      var relatedTarget = ev.nativeEvent.relatedTarget;\n      log$5('handleTopicDragLeave:', topicKey, dropDir);\n      var content = getRef(contentRefKey(topicKey));\n\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n\n      setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n        dragDrop: null\n      }));\n    },\n    handleTopicDrop: function handleTopicDrop(props) {\n      log$5('handleTopicDrop');\n      var _props2 = props,\n          controller = _props2.controller,\n          topicKey = _props2.topicKey,\n          model = _props2.model,\n          diagramState = _props2.diagramState,\n          setDiagramState = _props2.setDiagramState;\n      props = _objectSpread(_objectSpread({}, props), {}, {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n        dragDrop: null\n      }));\n\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.DRAG_AND_DROP\n        }));\n      }\n    }\n  };\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nvar NodeLayer = styled.div(_templateObject26 || (_templateObject26 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"])));\nvar DIV = styled.div(_templateObject27 || (_templateObject27 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nvar MindDragScrollWidget = /*#__PURE__*/function (_PureComponent) {\n  _inherits(MindDragScrollWidget, _PureComponent);\n\n  var _super6 = _createSuper(MindDragScrollWidget);\n\n  function MindDragScrollWidget(props) {\n    var _this4;\n\n    _classCallCheck(this, MindDragScrollWidget);\n\n    _this4 = _super6.call(this, props);\n\n    _this4.setZoomFactor = function (zoomFactor) {\n      _this4.dragScrollWidget.setZoomFactor(zoomFactor);\n    };\n\n    _this4.onWheel = function (e) {\n      if (e.altKey || e.ctrlKey) {\n        var controller = _this4.props.controller;\n        var zoomFactor = controller.run('getZoomFactor', _this4.props);\n        zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n        if (zoomFactor < 0.5) zoomFactor = 0.5;\n        if (zoomFactor > 4) zoomFactor = 4; // console.log('zoomFactor=>', zoomFactor);\n\n        controller.run('setZoomFactor', _objectSpread(_objectSpread({}, _this4.props), {}, {\n          zoomFactor: zoomFactor\n        }));\n      }\n    };\n\n    return _this4;\n  }\n\n  _createClass(MindDragScrollWidget, [{\n    key: \"renderHotkeys\",\n    value: function renderHotkeys() {\n      var props = this.props;\n      var controller = props.controller,\n          model = props.model;\n      var hotKeys = controller.run('customizeHotKeys', props);\n      if (hotKeys === null) return null;\n\n      if (!(hotKeys.topicHotKeys instanceof Map && hotKeys.globalHotKeys instanceof Map)) {\n        throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n      }\n\n      var children = [];\n\n      if (model.focusMode === FocusMode.NORMAL || model.focusMode === FocusMode.SHOW_POPUP) {\n        hotKeys.topicHotKeys.forEach(function (v, k) {\n          children.push(createElement(Hotkey, Object.assign({\n            key: k\n          }, v, {\n            global: true\n          })));\n        });\n      }\n\n      hotKeys.globalHotKeys.forEach(function (v, k) {\n        children.push(createElement(Hotkey, Object.assign({\n          key: k\n        }, v, {\n          global: true\n        })));\n      });\n      return createElement(Hotkeys, null, children);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props2 = this.props,\n          getRef = _this$props2.getRef,\n          model = _this$props2.model,\n          controller = _this$props2.controller;\n      controller.run('addZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, this.props), {}, {\n        listener: this.setZoomFactor\n      }));\n      var rootTopic = getRef(topicRefKey(model.editorRootTopicKey)); //TODO\n\n      var nodeLayer = getRef('node-layer');\n      var rootTopicRect = rootTopic.getBoundingClientRect();\n      var nodeLayerRect = nodeLayer.getBoundingClientRect();\n      this.dragScrollWidget.setViewBoxScrollDelta(0, rootTopicRect.top - nodeLayerRect.top - this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 + rootTopicRect.height);\n      this.layout();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var controller = this.props.controller;\n      controller.run('removeZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, this.props), {}, {\n        listener: this.setZoomFactor\n      }));\n    }\n  }, {\n    key: \"dragScrollWidget\",\n    get: function get() {\n      return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var controller = this.props.controller;\n      controller.run('fireEvent', _objectSpread(_objectSpread({}, this.props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC\n      }));\n      this.layout();\n    }\n  }, {\n    key: \"layout\",\n    value: function layout() {\n      var controller = this.props.controller;\n      controller.run('layout', this.props);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var _this$props3 = this.props,\n          saveRef = _this$props3.saveRef,\n          model = _this$props3.model,\n          controller = _this$props3.controller;\n      var nodeKey = model.editorRootTopicKey;\n      return createElement(DIV, {\n        onWheel: this.onWheel\n      }, createElement(DragScrollWidget, Object.assign({}, this.state, {\n        enableMouseWheel: false,\n        zoomFactor: model.zoomFactor,\n        ref: saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)\n      }), function (setViewBoxScroll, setViewBoxScrollDelta) {\n        var rootWidgetProps = _objectSpread(_objectSpread({}, _this5.props), {}, {\n          topicKey: nodeKey,\n          setViewBoxScroll: setViewBoxScroll,\n          setViewBoxScrollDelta: setViewBoxScrollDelta\n        });\n\n        return createElement(NodeLayer, {\n          ref: saveRef('node-layer')\n        }, controller.run('renderRootWidget', rootWidgetProps));\n      }));\n    }\n  }]);\n\n  return MindDragScrollWidget;\n}(PureComponent);\n\nMindDragScrollWidget = __decorate([HotkeysTarget], MindDragScrollWidget);\nvar Root = styled.div(_templateObject28 || (_templateObject28 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar DiagramContainer = styled.div(_templateObject29 || (_templateObject29 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  //height: 100%;\\n  overflow: auto;\\n  flex-grow: 1;\\n  background: \", \";\\n  position: relative;\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nfunction DiagramRoot(props) {\n  var controller = props.controller,\n      saveRef = props.saveRef;\n\n  var _useState = useState(controller.run('getInitialDiagramState', props)),\n      _useState2 = _slicedToArray(_useState, 2),\n      diagramState = _useState2[0],\n      setDiagramState = _useState2[1];\n\n  var nProps = _objectSpread(_objectSpread({}, props), {}, {\n    diagramState: diagramState,\n    setDiagramState: setDiagramState\n  });\n\n  return createElement(Root, null, controller.run('renderToolbar', props), createElement(DiagramContainer, {\n    ref: saveRef(RefKey.DIAGRAM_ROOT_KEY)\n  }, createElement(MindDragScrollWidget, Object.assign({}, nProps)), controller.run('renderDiagramCustomize', nProps)));\n}\n\nvar EditorRootBreadcrumbsRoot = styled(ZIndex)(_templateObject30 || (_templateObject30 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"])));\nvar TooltipContent = styled.div(_templateObject31 || (_templateObject31 = _taggedTemplateLiteral([\"\\n  max-width: 600px;\\n\"])));\nvar BreadcrumbTitle = styled.span(_templateObject32 || (_templateObject32 = _taggedTemplateLiteral([\"\"])));\n\nvar EditorRootBreadcrumbs = /*#__PURE__*/function (_BaseWidget3) {\n  _inherits(EditorRootBreadcrumbs, _BaseWidget3);\n\n  var _super7 = _createSuper(EditorRootBreadcrumbs);\n\n  function EditorRootBreadcrumbs(props) {\n    var _this6;\n\n    _classCallCheck(this, EditorRootBreadcrumbs);\n\n    _this6 = _super7.call(this, props);\n\n    _this6.setEditorRootTopicKey = function (topicKey) {\n      return function () {\n        var _this6$props = _this6.props,\n            model = _this6$props.model,\n            controller = _this6$props.controller;\n\n        if (model.editorRootTopicKey !== topicKey) {\n          controller.run('operation', _objectSpread(_objectSpread({}, _this6.props), {}, {\n            opType: OpType.SET_EDITOR_ROOT,\n            topicKey: topicKey\n          }));\n        }\n      };\n    };\n\n    _this6.breadcrumbRenderer = function (props) {\n      var text = props.text,\n          breadProps = _objectWithoutProperties(props, _excluded5);\n\n      var needTooltip = text.length > 8;\n      var title = needTooltip ? text.substr(0, 8) + '...' : text; //TODO\n\n      var content = createElement(TooltipContent, null, text);\n      var tooltipProps = {\n        content: content,\n        position: PopoverPosition.BOTTOM_RIGHT\n      };\n      var breadcrumb = createElement(Breadcrumb, Object.assign({}, breadProps), createElement(BreadcrumbTitle, null, title));\n      return needTooltip ? createElement(Tooltip, Object.assign({}, tooltipProps), breadcrumb) : breadcrumb;\n    };\n\n    return _this6;\n  }\n\n  _createClass(EditorRootBreadcrumbs, [{\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var model = props.model,\n          controller = props.controller,\n          zIndex = props.zIndex;\n      var editingRootKey = model.editorRootTopicKey;\n      if (editingRootKey === model.rootTopicKey) return null;\n      var items = [];\n      var topic = model.getTopic(editingRootKey);\n\n      while (topic != null) {\n        var title = controller.getValue(PropKey.TOPIC_TITLE, _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: topic.key\n        }));\n        items.unshift({\n          text: title,\n          onClick: this.setEditorRootTopicKey(topic.key)\n        });\n        topic = model.getTopic(topic.parentKey);\n      }\n\n      var breadcrumbProps = {\n        items: items,\n        breadcrumbRenderer: this.breadcrumbRenderer\n      };\n      return createElement(EditorRootBreadcrumbsRoot, {\n        zIndex: zIndex\n      }, createElement(Breadcrumbs, Object.assign({}, breadcrumbProps)));\n    }\n  }]);\n\n  return EditorRootBreadcrumbs;\n}(BaseWidget);\n\nvar Modals = /*#__PURE__*/function (_BaseWidget4) {\n  _inherits(Modals, _BaseWidget4);\n\n  var _super8 = _createSuper(Modals);\n\n  function Modals() {\n    var _this7;\n\n    _classCallCheck(this, Modals);\n\n    _this7 = _super8.apply(this, arguments);\n\n    _this7.handleClose = function () {\n      var controller = _this7.props.controller;\n      var handleActiveModalClose = controller.run('handleActiveModalClose', _this7.props);\n      handleActiveModalClose && handleActiveModalClose();\n    };\n\n    return _this7;\n  }\n\n  _createClass(Modals, [{\n    key: \"render\",\n    value: function render() {\n      var controller = this.props.controller;\n      var activeModal = controller.run('renderModal', this.props);\n      var activeModalProps = controller.run('getActiveModalProps', this.props);\n      return createElement(Dialog, {\n        onClose: this.handleClose,\n        isOpen: activeModal !== null,\n        autoFocus: true,\n        enforceFocus: true,\n        usePortal: true,\n        title: activeModalProps && activeModalProps.title,\n        style: activeModalProps && activeModalProps.style\n      }, createElement(\"div\", {\n        className: Classes.DIALOG_BODY,\n        style: {\n          minHeight: 0\n        }\n      }, activeModal));\n    }\n  }]);\n\n  return Modals;\n}(BaseWidget);\n\nvar RootLinksSvg = styled.svg(_templateObject33 || (_templateObject33 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$6 = debug('node:root-sub-links');\n\nvar RootSubLinks = /*#__PURE__*/function (_BaseWidget5) {\n  _inherits(RootSubLinks, _BaseWidget5);\n\n  var _super9 = _createSuper(RootSubLinks);\n\n  function RootSubLinks() {\n    var _this8;\n\n    _classCallCheck(this, RootSubLinks);\n\n    _this8 = _super9.apply(this, arguments);\n    _this8.state = {\n      curves: []\n    };\n    return _this8;\n  }\n\n  _createClass(RootSubLinks, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var model = props.model,\n          getRef = props.getRef,\n          topicKey = props.topicKey,\n          zoomFactor = props.zoomFactor,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var content = getRef(contentRefKey(topicKey));\n      var svg = getRef(linksSvgRefKey(topicKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var p1, p2;\n      p1 = {\n        x: centerX(contentRect) - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      var curves = [];\n      topic.subKeys.forEach(function (key) {\n        var linkStyle = controller.run('getLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: key\n        }));\n        var lineType = linkStyle.lineType;\n        var subTopicContent = getRef(contentRefKey(key));\n\n        var rect = _getRelativeRect(subTopicContent, bigView, zoomFactor);\n\n        if (rect.left > contentRect.right) {\n          p2 = {\n            x: rect.left,\n            y: centerY(rect)\n          };\n        } else {\n          p2 = {\n            x: rect.right,\n            y: centerY(rect)\n          };\n        }\n\n        p2 = {\n          x: p2.x - svgRect.left,\n          y: p2.y - svgRect.top\n        };\n        var curve;\n\n        if (lineType === 'curve') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" C \").concat(p1.x, \" \").concat(centerPointY(p1, p2), \" \").concat(centerPointX(p1, p2), \" \").concat(p2.y, \" \").concat(p2.x, \" \").concat(p2.y);\n        } else if (lineType === 'line') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p2.x, \" \").concat(p2.y);\n        } else if (lineType === 'round') {\n          var vDir = p2.y > p1.y ? 1 : -1;\n          var hDir = p2.x > p1.x ? 1 : -1;\n          var radius = linkStyle.lineRadius;\n\n          if (radius == null) {\n            throw new Error('link line type is round, but lineRadius is not provided!');\n          }\n\n          if (p2.y === p1.y) {\n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x);\n          } else {\n            // 0  1 \n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \"  V \").concat(p2.y - vDir * radius, \" A \").concat(radius, \" \").concat(radius, \" 0 0 \").concat(vDir * hDir === 1 ? 0 : 1, \" \").concat(p1.x + radius * hDir, \" \").concat(p2.y, \" H \").concat(p2.x);\n          }\n        }\n\n        curves.push(createElement(\"path\", {\n          key: \"link-\".concat(key),\n          d: curve,\n          strokeWidth: linkStyle.lineWidth,\n          stroke: linkStyle.lineColor,\n          fill: \"none\"\n        }));\n      });\n      this.setState({\n        curves: curves\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$6('render');\n      var _this$props4 = this.props,\n          topicKey = _this$props4.topicKey,\n          saveRef = _this$props4.saveRef;\n      return createElement(RootLinksSvg, {\n        ref: saveRef(linksSvgRefKey(topicKey))\n      }, createElement(\"g\", null, this.state.curves));\n    }\n  }]);\n\n  return RootSubLinks;\n}(BaseWidget);\n\nvar log$7 = debug('RootNode');\nvar LayerPart = styled.div(_templateObject34 || (_templateObject34 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"])), function (props) {\n  return (//@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'\n  );\n}, function (props) {\n  return (//@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? '15px 60px 15px 0px' : '15px 0px 15px 60px'\n  );\n});\nvar Topic = styled.div(_templateObject35 || (_templateObject35 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"])));\n\nvar RootWidget = /*#__PURE__*/function (_Component4) {\n  _inherits(RootWidget, _Component4);\n\n  var _super10 = _createSuper(RootWidget);\n\n  function RootWidget() {\n    _classCallCheck(this, RootWidget);\n\n    return _super10.apply(this, arguments);\n  }\n\n  _createClass(RootWidget, [{\n    key: \"renderPartTopics\",\n    value: function renderPartTopics(topics, dir) {\n      var _this$props5 = this.props,\n          controller = _this$props5.controller,\n          saveRef = _this$props5.saveRef;\n      var res = controller.run('createSubTopics', _objectSpread(_objectSpread({}, this.props), {}, {\n        dir: dir,\n        isRoot: true,\n        topics: topics\n      }));\n      if (!res) return null;\n      var subTopics = res.subTopics;\n      var cxName = \"bm-layer-\".concat(dir === TopicDirection.LEFT ? 'left' : 'right');\n      return (//@ts-ignore\n        createElement(LayerPart, {\n          topicDirection: dir,\n          ref: saveRef(cxName)\n        }, subTopics)\n      );\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$7('render');\n      var props = this.props;\n      var model = props.model,\n          topicKey = props.topicKey,\n          saveRef = props.saveRef,\n          controller = props.controller;\n      var topicStyle = controller.run('getTopicContentStyle', props);\n      var config = model.config;\n      var topicContent = controller.run('renderTopicContent', _objectSpread(_objectSpread({}, props), {}, {\n        topicStyle: topicStyle,\n        dir: TopicDirection.MAIN\n      }));\n      var partTopics = controller.run('getPartTopics', {\n        layout: config.layoutDir,\n        model: model,\n        topicKey: topicKey\n      });\n      var rootTopic = createElement(Topic, {\n        ref: saveRef(topicRefKey(topicKey))\n      }, topicContent);\n      var children = controller.run('renderRootWidgetOtherChildren', props);\n\n      switch (config.layoutDir) {\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, children);\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.B, 'B'), children);\n      }\n\n      return null;\n    }\n  }]);\n\n  return RootWidget;\n}(Component);\n\nvar Icon$1 = styled.div(_templateObject36 || (_templateObject36 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"])), function (_ref7) {\n  var dir = _ref7.dir;\n  if (dir === TopicDirection.RIGHT) return css(_templateObject37 || (_templateObject37 = _taggedTemplateLiteral([\"\\n        right: -25px;\\n      \"])));\n  if (dir === TopicDirection.LEFT) return css(_templateObject38 || (_templateObject38 = _taggedTemplateLiteral([\"\\n        left: -25px;\\n      \"])));\n}, function (props) {\n  return props.background;\n});\n\nfunction TopicCollapseIcon(props) {\n  var model = props.model,\n      topicKey = props.topicKey,\n      topicStyle = props.topicStyle,\n      dir = props.dir,\n      saveRef = props.saveRef,\n      onClickCollapse = props.onClickCollapse;\n  var topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? createElement(Icon$1, {\n    ref: saveRef(collapseRefKey(topicKey)),\n    onClick: onClickCollapse,\n    background: topicStyle.background,\n    dir: dir,\n    className: cx(_defineProperty({\n      icon: true,\n      iconfont: true\n    }, \"bm-\".concat(topic.collapse ? 'plus' : 'minus'), true))\n  }) : null;\n}\n\nvar log$8 = debug('node:topic-content2');\nvar EditingRoot = styled.div(_templateObject39 || (_templateObject39 = _taggedTemplateLiteral([\"\\n  position: relative;\\n\"])));\nvar EditingWrapper = styled.div(_templateObject40 || (_templateObject40 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"])));\n\nvar cancelEvent$1 = function cancelEvent$1(e) {\n  log$8('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nfunction TopicContent(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var readOnly = model.editingContentKey !== topicKey;\n  var editor = controller.run('renderTopicContentEditor', _objectSpread(_objectSpread({}, props), {}, {\n    readOnly: readOnly\n  }));\n  var child;\n\n  if (readOnly) {\n    child = editor;\n  } else {\n    var wrapper;\n\n    var wrapperRef = function wrapperRef(ref) {\n      if (ref) {\n        wrapper = ref;\n        contentResizeObserver.observe(wrapper);\n      }\n    };\n\n    var rect = {\n      width: 50,\n      height: 40\n    };\n    var editorDiv = getRef(\"content-editor-\".concat(topicKey));\n    if (editorDiv) rect = editorDiv.getBoundingClientRect();\n\n    var contentResizeCallback = function contentResizeCallback(entries, observer) {\n      var r = entries[0].contentRect;\n      wrapper.style.left = (rect.width - r.width) / 2 + 'px';\n      wrapper.style.top = (rect.height - r.height) / 2 + 'px';\n    };\n\n    var contentResizeObserver = new ResizeObserver(contentResizeCallback);\n    log$8(rect);\n    child = createElement(Fragment, null, createElement(\"div\", {\n      style: {\n        width: rect.width,\n        height: rect.height\n      }\n    }), createElement(EditingWrapper, {\n      ref: wrapperRef\n    }, editor));\n  }\n\n  return createElement(EditingRoot, {\n    onDragEnter: cancelEvent$1,\n    onDragOver: cancelEvent$1\n  }, child);\n}\n\nvar log$9 = debug('node:topic-content-widget');\nvar TopicContent$1 = styled.div(_templateObject41 || (_templateObject41 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"])));\nvar TopicContentWithDropArea = styled.div(_templateObject42 || (_templateObject42 = _taggedTemplateLiteral([\"\\n  position: relative;\\n\"])));\n\nvar TopicContentWidget = /*#__PURE__*/function (_BaseWidget6) {\n  _inherits(TopicContentWidget, _BaseWidget6);\n\n  var _super11 = _createSuper(TopicContentWidget);\n\n  function TopicContentWidget(props) {\n    var _this9;\n\n    _classCallCheck(this, TopicContentWidget);\n\n    _this9 = _super11.call(this, props);\n\n    _this9.onDragStart = function (ev) {\n      _this9.run('handleTopicDragStart', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev\n      }));\n    };\n\n    _this9.onDragOver = function (ev) {\n      // log('onDragOver');\n      ev.preventDefault();\n    };\n\n    _this9.onDragEnter = function (ev) {\n      log$9('onDragEnter', _this9.props.topicKey);\n\n      _this9.run('handleTopicDragEnter', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onDragLeave = function (ev) {\n      _this9.run('handleTopicDragLeave', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onDrop = function (ev) {\n      log$9('onDrop');\n\n      _this9.run('handleTopicDrop', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onClick = function (ev) {\n      var props = _this9.props;\n      var controller = props.controller; //TODO bug [Violation] 'setTimeout' handler took 69ms\n\n      _this9.handleTopicClickTimeout = setTimeout(function () {\n        // log('handleTopicClick');\n        //this.props, props, onClick, topic-content-editoronClickOutside\n        //onClickOutside,model, props,model model\n        controller.run('handleTopicClick', _objectSpread(_objectSpread({}, _this9.props), {}, {\n          ev: ev\n        }));\n      }, 200);\n    };\n\n    _this9.onDoubleClick = function (ev) {\n      clearTimeout(_this9.handleTopicClickTimeout);\n      var controller = _this9.props.controller;\n      controller.run('handleTopicDoubleClick', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev\n      }));\n    };\n\n    _this9.needRelocation = false;\n\n    _this9.onClickCollapse = function (e) {\n      e.stopPropagation();\n      var _this9$props = _this9.props,\n          topicKey = _this9$props.topicKey,\n          getRef = _this9$props.getRef;\n      _this9.needRelocation = true;\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var rect = collapseIcon.getBoundingClientRect();\n      log$9('oldRect', rect);\n      _this9.oldCollapseIconVector = [rect.left + rect.width / 2, rect.top + rect.height / 2];\n      log$9('oldCollapseIconVector', _this9.oldCollapseIconVector); // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: collapseIcon\n      // });\n\n      _this9.operation(OpType.TOGGLE_COLLAPSE, _this9.props);\n    };\n\n    _this9.state = {\n      dragEnter: false\n    };\n    return _this9;\n  }\n\n  _createClass(TopicContentWidget, [{\n    key: \"renderContextMenu\",\n    value: function renderContextMenu() {\n      var controller = this.props.controller;\n\n      if (!controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, _objectSpread({}, this.props))) {\n        return;\n      }\n\n      this.operation(OpType.FOCUS_TOPIC, _objectSpread(_objectSpread({}, this.props), {}, {\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n      return controller.run('renderTopicContextMenu', this.props);\n    }\n  }, {\n    key: \"onContextMenuClose\",\n    value: function onContextMenuClose() {// Optional method called once the context menu is closed.\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.needRelocation) {\n        var _this$props6 = this.props,\n            getRef = _this$props6.getRef,\n            topicKey = _this$props6.topicKey,\n            setViewBoxScrollDelta = _this$props6.setViewBoxScrollDelta;\n        var newIcon = getRef(collapseRefKey(topicKey));\n        var newRect = newIcon.getBoundingClientRect(); // const newVector = controller.run('getRelativeVectorFromViewPort', {\n        //   ...this.props,\n        //   element: getRef(collapseRefKey(topicKey))\n        // });\n\n        var newVector = [newRect.left + newRect.width / 2, newRect.top + newRect.height / 2];\n        log$9('newVector:', newVector);\n        log$9('oldVector:', this.oldCollapseIconVector); //TODO bug\n\n        var vector = [newVector[0] - this.oldCollapseIconVector[0], newVector[1] - this.oldCollapseIconVector[1]];\n        log$9('vector', vector);\n        setViewBoxScrollDelta(vector[0], vector[1]);\n        this.needRelocation = false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller,\n          topicStyle = props.topicStyle,\n          dir = props.dir;\n      log$9('render', topicKey, model.focusMode);\n      var draggable = controller.run('isOperationEnabled', props) && model.editingContentKey !== topicKey;\n      var collapseIcon = controller.run('renderTopicCollapseIcon', _objectSpread(_objectSpread({}, props), {}, {\n        onClickCollapse: this.onClickCollapse.bind(this)\n      }));\n      var prevDropArea = controller.run('renderTopicDropArea', _objectSpread(_objectSpread({}, props), {}, {\n        dropDir: 'prev'\n      }));\n      var nextDropArea = controller.run('renderTopicDropArea', _objectSpread(_objectSpread({}, props), {}, {\n        dropDir: 'next'\n      }));\n      var dropEventHandlers = {\n        onDragEnter: this.onDragEnter,\n        onDragLeave: this.onDragLeave,\n        onDragOver: this.onDragOver,\n        onDrop: this.onDrop\n      }; // log(topicKey, 'style', topicStyle);\n\n      return createElement(TopicContentWithDropArea, null, prevDropArea, createElement(TopicContent$1, Object.assign({\n        style: topicStyle,\n        draggable: draggable,\n        ref: saveRef(contentRefKey(topicKey)),\n        onDragStart: this.onDragStart,\n        onClick: this.onClick,\n        onDoubleClick: this.onDoubleClick\n      }, dropEventHandlers), controller.run('renderTopicBlocks', props), controller.run('renderTopicContentOthers', props)), nextDropArea, dir !== TopicDirection.MAIN && collapseIcon);\n    }\n  }]);\n\n  return TopicContentWidget;\n}(BaseWidget);\n\nTopicContentWidget = __decorate([ContextMenuTarget], TopicContentWidget);\nvar log$a = debug('node:topic-desc');\nvar TooltipContentWrapper = styled.div(_templateObject43 || (_templateObject43 = _taggedTemplateLiteral([\"\\n  overflow: auto;\\n\"])));\n\nfunction TopicDesc(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var isEditing = model.editingDescKey === topicKey;\n  log$a('isEditing', isEditing);\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.START_EDITING_DESC\n    }));\n  };\n\n  var desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (!isEditing && controller.run('isBlockEmpty', _objectSpread(_objectSpread({}, props), {}, {\n    block: desc.block\n  }))) return null;\n  var descEditor = controller.run('renderTopicDescEditor', props);\n  var diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  var style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n\n  if (diagramRoot) {\n    var dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = \"\".concat(dRect.width * 0.6, \"px\");\n    style.maxHeight = \"\".concat(dRect.height * 0.8, \"px\");\n  }\n\n  var tooltipContent = createElement(TooltipContentWrapper, {\n    onClick: cancelEvent,\n    classname: Classes.POPOVER_DISMISS,\n    style: style\n  }, descEditor);\n  var icon = createElement(TopicBlockIcon, {\n    onClick: onClick,\n    className: iconClassName(IconName.NOTES),\n    tabIndex: -1\n  });\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n  var descIcon = desc.block && createElement(Popover, Object.assign({}, tooltipProps));\n  return descIcon;\n}\n\nvar FocusHighlightSvg = styled.svg(_templateObject44 || (_templateObject44 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicHighlight = /*#__PURE__*/function (_BaseWidget7) {\n  _inherits(TopicHighlight, _BaseWidget7);\n\n  var _super12 = _createSuper(TopicHighlight);\n\n  function TopicHighlight() {\n    var _this10;\n\n    _classCallCheck(this, TopicHighlight);\n\n    _this10 = _super12.apply(this, arguments);\n    _this10.state = {\n      content: null\n    };\n    return _this10;\n  }\n\n  _createClass(TopicHighlight, [{\n    key: \"layout\",\n    value: function layout() {\n      var _this$props7 = this.props,\n          getRef = _this$props7.getRef,\n          model = _this$props7.model,\n          zoomFactor = _this$props7.zoomFactor;\n      var focusKey = model.focusKey;\n      var focusMode = model.focusMode;\n\n      if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var content = getRef(contentRefKey(focusKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      var svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var padding = 3;\n      var x = contentRect.left - svgRect.left - padding;\n      var y = contentRect.top - svgRect.top - padding;\n      var width = contentRect.width + 2 * padding;\n      var height = contentRect.height + 2 * padding;\n      this.setState({\n        content: createElement(\"rect\", {\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: \"none\",\n          stroke: model.config.theme.highlightColor,\n          strokeWidth: 2\n        })\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var saveRef = this.props.saveRef;\n      return createElement(FocusHighlightSvg, {\n        ref: saveRef(RefKey.SVG_HIGHLIGHT_KEY)\n      }, this.state.content);\n    }\n  }]);\n\n  return TopicHighlight;\n}(BaseWidget);\n\nvar TopicLinksSvg = styled.svg(_templateObject45 || (_templateObject45 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$b = debug('node:topic-sub-links');\n\nvar TopicSubLinks = /*#__PURE__*/function (_BaseWidget8) {\n  _inherits(TopicSubLinks, _BaseWidget8);\n\n  var _super13 = _createSuper(TopicSubLinks);\n\n  function TopicSubLinks() {\n    var _this11;\n\n    _classCallCheck(this, TopicSubLinks);\n\n    _this11 = _super13.apply(this, arguments);\n    _this11.state = {\n      curves: []\n    };\n    return _this11;\n  }\n\n  _createClass(TopicSubLinks, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var model = props.model,\n          getRef = props.getRef,\n          topicKey = props.topicKey,\n          dir = props.dir,\n          controller = props.controller;\n      var z = controller.run('getZoomFactor', props);\n      var topic = model.getTopic(topicKey);\n      var content = getRef(contentRefKey(topicKey));\n      var svg = getRef(linksSvgRefKey(topicKey));\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var svgRect = _getRelativeRect(svg, bigView, z);\n\n      var collapseRect = _getRelativeRect(collapseIcon, bigView, z);\n\n      var contentRect = _getRelativeRect(content, bigView, z);\n\n      log$b(topicKey);\n      log$b('svgRect', svgRect);\n      log$b('collapseRect', collapseRect);\n      log$b('contentRect', contentRect);\n      var p1, p2, p3;\n\n      if (dir === TopicDirection.RIGHT) {\n        p1 = {\n          x: 0,\n          y: centerY(contentRect) - svgRect.top\n        };\n        p2 = {\n          x: collapseRect.right - svgRect.left + 10,\n          y: p1.y\n        };\n      } else if (dir === TopicDirection.LEFT) {\n        p1 = {\n          x: svgRect.right - svgRect.left,\n          y: centerY(contentRect) - svgRect.top\n        };\n        p2 = {\n          x: collapseRect.left - svgRect.left - 10,\n          y: p1.y\n        };\n      }\n\n      var curves = [];\n      topic.subKeys.forEach(function (key) {\n        var curve;\n        var linkStyle = controller.run('getLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: key\n        })); // log(key);\n\n        var subContent = getRef(contentRefKey(key));\n        if (!subContent) return;\n\n        var rect = _getRelativeRect(subContent, bigView, z);\n\n        if (dir === TopicDirection.RIGHT) {\n          p3 = {\n            x: rect.left - svgRect.left,\n            y: centerY(rect) - svgRect.top\n          };\n        }\n\n        if (dir === TopicDirection.LEFT) {\n          p3 = {\n            x: rect.right - svgRect.left,\n            y: centerY(rect) - svgRect.top\n          };\n        }\n\n        var lineType = linkStyle.lineType;\n\n        if (lineType === 'curve') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p2.x, \" \").concat(p2.y, \" C \").concat(p2.x, \" \").concat(centerPointY(p2, p3), \" \").concat(centerPointX(p2, p3), \" \").concat(p3.y, \" \").concat(p3.x, \" \").concat(p3.y);\n        } else if (lineType === 'round') {\n          var vDir = p3.y > p1.y ? 1 : -1;\n          var hDir = p3.x > p1.x ? 1 : -1;\n          var radius = linkStyle.lineRadius; // if (p3.y === p1.y) { //\n\n          if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p3.x, \" \").concat(p3.y);\n          } else {\n            // 0  1 \n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x, \" V \").concat(p3.y - vDir * radius, \" A \").concat(radius, \" \").concat(radius, \" 0 0 \").concat(vDir * hDir === 1 ? 0 : 1, \" \").concat(p2.x + radius * hDir, \" \").concat(p3.y, \" H \").concat(p3.x);\n          }\n        } else if (lineType === 'line') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x, \" L \").concat(p3.x, \" \").concat(p3.y);\n        }\n\n        curves.push(createElement(\"path\", {\n          key: \"link-\".concat(key),\n          d: curve,\n          strokeWidth: linkStyle.lineWidth,\n          stroke: linkStyle.lineColor,\n          fill: \"none\"\n        }));\n      });\n      this.setState({\n        curves: curves\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props8 = this.props,\n          topicKey = _this$props8.topicKey,\n          saveRef = _this$props8.saveRef;\n      return createElement(TopicLinksSvg, {\n        ref: saveRef(linksSvgRefKey(topicKey))\n      }, createElement(\"g\", null, this.state.curves));\n    }\n  }]);\n\n  return TopicSubLinks;\n}(BaseWidget);\n\nvar log$c = debug('node:topic-widget');\nvar Node = styled.div(_templateObject46 || (_templateObject46 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n}); // TODO\n\nvar NodeChildren = styled.div(_templateObject47 || (_templateObject47 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  padding: \", \";\\n\"])), function (props) {\n  return props.dir === TopicDirection.RIGHT ? \"0 0 0 \".concat(props.marginH, \"px\") : \"0 \".concat(props.marginH, \"px 0 0\");\n});\nvar NodeTopic = styled.div(_templateObject48 || (_templateObject48 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n});\n\nvar TopicWidget = /*#__PURE__*/function (_Component5) {\n  _inherits(TopicWidget, _Component5);\n\n  var _super14 = _createSuper(TopicWidget);\n\n  function TopicWidget() {\n    _classCallCheck(this, TopicWidget);\n\n    return _super14.apply(this, arguments);\n  }\n\n  _createClass(TopicWidget, [{\n    key: \"renderSubTopics\",\n    value: function renderSubTopics() {\n      var props = this.props;\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey,\n          dir = props.dir;\n      var topics = model.getTopic(topicKey).subKeys.toArray();\n      var res = controller.run('createSubTopics', _objectSpread(_objectSpread({}, props), {}, {\n        topics: topics\n      }));\n      if (!res) return null;\n      var subTopics = res.subTopics;\n      var subLinks = controller.run('renderSubLinks', props);\n      return createElement(NodeChildren, {\n        dir: dir,\n        marginH: model.config.theme.marginH\n      }, subTopics, \" \", subLinks);\n    } // componentDidUpdate(): void {\n    //   this.layoutLinks();\n    // }\n    //\n    // componentDidMount(): void {\n    //   this.layoutLinks();\n    // }\n\n  }, {\n    key: \"layoutLinks\",\n    value: function layoutLinks() {\n      var _this$props9 = this.props,\n          getRef = _this$props9.getRef,\n          topicKey = _this$props9.topicKey,\n          model = _this$props9.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return;\n      log$c('layoutLinks', topicKey);\n      var links = getRef(linksRefKey(topicKey));\n      links && links.layout();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var controller = props.controller,\n          topicKey = props.topicKey,\n          dir = props.dir,\n          saveRef = props.saveRef;\n      log$c('render', topicKey);\n      var topicStyle = controller.run('getTopicContentStyle', props);\n\n      var propsMore = _objectSpread(_objectSpread({}, props), {}, {\n        topicStyle: topicStyle\n      });\n\n      var topicContent = controller.run('renderTopicContent', propsMore);\n      return createElement(Node, {\n        topicDirection: dir\n      }, createElement(NodeTopic, {\n        topicDirection: dir,\n        ref: saveRef(topicRefKey(topicKey))\n      }, topicContent), this.renderSubTopics());\n    }\n  }]);\n\n  return TopicWidget;\n}(Component);\n\nvar log$d = debug('node:view-port-viewer');\nvar ViewerRoot = styled(ZIndex)(_templateObject49 || (_templateObject49 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"])));\nvar Item_ = styled(Btn)(_templateObject50 || (_templateObject50 = _taggedTemplateLiteral([\"\\n  margin: 10px;\\n\"])));\nvar ZoomFactorSpan = styled.span(_templateObject51 || (_templateObject51 = _taggedTemplateLiteral([\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"])));\n\nvar Item = function Item(props) {\n  return createElement(Tooltip, {\n    content: props.tooltip,\n    position: Position.TOP,\n    className: Classes.ICON\n  }, createElement(Item_, {\n    onClick: props.onClick,\n    tabIndex: -1\n  }, props.children));\n};\n\nvar ViewPortViewer = /*#__PURE__*/function (_BaseWidget9) {\n  _inherits(ViewPortViewer, _BaseWidget9);\n\n  var _super15 = _createSuper(ViewPortViewer);\n\n  function ViewPortViewer(props) {\n    var _this12;\n\n    _classCallCheck(this, ViewPortViewer);\n\n    _this12 = _super15.call(this, props);\n\n    _this12.zoomFactorChange = function (zoomFactor) {\n      log$d('zoomFactorChange', zoomFactor);\n\n      _this12.setState({\n        zoomFactor: zoomFactor\n      });\n    };\n\n    _this12.onClickResetZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: 1\n      }));\n    };\n\n    _this12.onClickAddZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor + 0.1\n      }));\n    };\n\n    _this12.onClickMinusZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor - 0.1\n      }));\n    };\n\n    _this12.onClickCollapseAll = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this12.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.COLLAPSE_ALL\n      }));\n    };\n\n    _this12.onClickExpandAll = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this12.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.EXPAND_ALL\n      }));\n    };\n\n    _this12.centerRootTopic = function () {\n      var _this12$props = _this12.props,\n          model = _this12$props.model,\n          controller = _this12$props.controller;\n      controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, _this12.props), {}, {\n        topicKey: model.editorRootTopicKey\n      }));\n    };\n\n    return _this12;\n  }\n\n  _createClass(ViewPortViewer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var props = this.props;\n      var controller = props.controller;\n      controller.run('addZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        listener: this.zoomFactorChange\n      }));\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var props = this.props;\n      var controller = props.controller;\n      controller.run('removeZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        listener: this.zoomFactorChange\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$d('render');\n      var props = this.props;\n      var controller = props.controller,\n          zIndex = props.zIndex;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      return createElement(ViewerRoot, {\n        zIndex: zIndex\n      }, createElement(Item, {\n        onClick: this.onClickCollapseAll,\n        tooltip: getI18nText(props, I18nKey.COLLAPSE_ALL)\n      }, Icon(IconName.COLLAPSE_ALL)), createElement(Item, {\n        onClick: this.onClickExpandAll,\n        tooltip: getI18nText(props, I18nKey.EXPAND_ALL)\n      }, Icon(IconName.EXPAND_ALL)), createElement(Item, {\n        onClick: this.centerRootTopic,\n        tooltip: getI18nText(props, I18nKey.CENTER_ROOT_TOPIC)\n      }, Icon(IconName.CENTER)), createElement(Item, {\n        onClick: this.onClickMinusZoom,\n        tooltip: getI18nText(props, I18nKey.ZOOM_IN)\n      }, Icon(IconName.MINUS)), createElement(Item, {\n        onClick: this.onClickResetZoom,\n        tooltip: getI18nText(props, I18nKey.RESET)\n      }, createElement(ZoomFactorSpan, null, \"\".concat(getI18nText(props, I18nKey.ZOOM), \":\").concat(Math.floor(zoomFactor * 100), \"%\"))), createElement(Item, {\n        onClick: this.onClickAddZoom,\n        tooltip: getI18nText(props, I18nKey.ZOOM_OUT)\n      }, Icon(IconName.PLUS)));\n    }\n  }]);\n\n  return ViewPortViewer;\n}(BaseWidget);\n\nvar DescEditorWrapper = styled.div(_templateObject52 || (_templateObject52 = _taggedTemplateLiteral([\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"])));\n\nfunction renderDrawer(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    var onDescEditorClose = function onDescEditorClose(e) {\n      e.stopPropagation();\n      var key = \"topic-desc-data-\".concat(topicKey);\n      var descData = controller.run('deleteTempValue', {\n        key: key\n      });\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      }));\n    };\n\n    var descEditor = controller.run('renderTopicDescEditor', props);\n    return createElement(Drawer, {\n      key: \"drawer\",\n      title: getI18nText(props, I18nKey.EDIT_NOTES),\n      icon: Icon('note'),\n      isOpen: true,\n      hasBackdrop: true,\n      backdropProps: {\n        onMouseDown: cancelEvent\n      },\n      isCloseButtonShown: false,\n      onClose: onDescEditorClose,\n      size: \"70%\"\n    }, createElement(DescEditorWrapper, null, descEditor));\n  }\n} //TODO themeProvider\n\n\nfunction Theme(_ref8) {\n  var theme = _ref8.theme,\n      children = _ref8.children;\n  return (//@ts-ignore\n    createElement(ThemeProvider, {\n      theme: theme\n    }, createElement(Fragment, null, children))\n  );\n}\n\nvar log$e = debug('plugin:rendering');\n\nfunction RenderingPlugin() {\n  var diagramProps;\n  return {\n    getDiagramProps: function getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram: function renderDiagram(props) {\n      var model = props.model;\n      return createElement(SaveRef, null, function (saveRef, getRef, deleteRef) {\n        diagramProps = _objectSpread(_objectSpread({}, props), {}, {\n          saveRef: saveRef,\n          getRef: getRef,\n          deleteRef: deleteRef\n        });\n        log$e('renderDiagram', model);\n        return createElement(Theme, {\n          theme: model.config.theme\n        }, createElement(DiagramRoot, diagramProps));\n      });\n    },\n    renderDrawer: renderDrawer,\n    getInitialDiagramState: function getInitialDiagramState(props) {\n      return {\n        rightTopPanel: {\n          isOpen: false,\n          selectedTabId: 'topic-style'\n        }\n      };\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props) {\n      var controller = props.controller,\n          model = props.model;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX);\n\n      var nProps = _objectSpread(_objectSpread({}, props), {}, {\n        zIndex: zIndex,\n        topicKey: model.focusKey\n      });\n\n      var breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps); // const styleEditor = controller.run('renderStyleEditor', nProps);\n\n      var rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      var modals = controller.run('renderModals', _objectSpread(_objectSpread({}, nProps), {}, {\n        zIndex: zIndex + 1\n      }));\n      var drawer = controller.run('renderDrawer', _objectSpread(_objectSpread({}, nProps), {}, {\n        zIndex: zIndex + 1\n      }));\n      var viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n    renderEditorRootBreadcrumbs: function renderEditorRootBreadcrumbs(props) {\n      return createElement(EditorRootBreadcrumbs, Object.assign({\n        key: \"EditorRootBreadcrumbs\"\n      }, props));\n    },\n    renderModals: function renderModals(props) {\n      return createElement(Modals, Object.assign({\n        key: \"modals\"\n      }, props));\n    },\n    renderModal: function renderModal(props) {\n      return null;\n    },\n    getActiveModalProps: function getActiveModalProps(props) {\n      return null;\n    },\n    renderDoc: function renderDoc(_ref9) {\n      var children = _ref9.children;\n      return children;\n    },\n    renderRootWidget: function renderRootWidget(props) {\n      return createElement(RootWidget, Object.assign({}, props));\n    },\n    renderTopicWidget: function renderTopicWidget(props) {\n      return createElement(TopicWidget, Object.assign({}, props));\n    },\n    renderTopicContent: function renderTopicContent(props) {\n      return createElement(TopicContentWidget, Object.assign({}, props));\n    },\n    renderTopicCollapseIcon: function renderTopicCollapseIcon(props) {\n      return createElement(TopicCollapseIcon, Object.assign({}, props));\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props) {\n      return [];\n    },\n    renderTopicBlocks: function renderTopicBlocks(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var blocks = topic.blocks;\n      var res = [];\n      var i = 0;\n      blocks.forEach(function (block) {\n        var b = controller.run('renderTopicBlock', _objectSpread(_objectSpread({}, props), {}, {\n          block: block,\n          blockKey: \"block-\".concat(i)\n        }));\n\n        if (b) {\n          res.push(createElement(Fragment, {\n            key: \"block-\".concat(i)\n          }, b));\n          i++;\n        }\n      });\n      return res;\n    },\n    renderTopicBlock: function renderTopicBlock(props) {\n      var controller = props.controller,\n          block = props.block;\n\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n      }\n\n      return null;\n    },\n    renderTopicBlockContent: function renderTopicBlockContent(props) {\n      return createElement(TopicContent, Object.assign({}, props));\n    },\n    renderTopicBlockDesc: function renderTopicBlockDesc(props) {\n      return createElement(TopicDesc, Object.assign({}, props));\n    },\n    renderSubLinks: function renderSubLinks(props) {\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return createElement(TopicSubLinks, Object.assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderRootSubLinks: function renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey; // ,layout \n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n\n      return createElement(RootSubLinks, Object.assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderFocusItemHighlight: function renderFocusItemHighlight(props) {\n      var saveRef = props.saveRef;\n      return createElement(TopicHighlight, Object.assign({\n        ref: saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)\n      }, props));\n    },\n    renderRootWidgetOtherChildren: function renderRootWidgetOtherChildren(props) {\n      var _props3 = props,\n          controller = _props3.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      props = _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor\n      });\n      return createElement(Fragment, null, controller.run('renderRootSubLinks', props), controller.run('renderFocusItemHighlight', props), controller.run('renderDragAndDropEffect', props));\n    },\n    renderViewPortViewer: function renderViewPortViewer(props) {\n      return createElement(ViewPortViewer, Object.assign({\n        key: \"view-port-viewer\"\n      }, props));\n    }\n  };\n}\n\nvar PanelRoot = styled(ZIndex)(_templateObject53 || (_templateObject53 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"])));\nvar StyledTabs = styled(Tabs)(_templateObject54 || (_templateObject54 = _taggedTemplateLiteral([\"\\n  padding: 0px 10px;\\n\"])));\n\nfunction RightTopPanelWidget(props) {\n  var controller = props.controller,\n      zIndex = props.zIndex,\n      diagramState = props.diagramState,\n      setDiagramState = props.setDiagramState;\n  var rightTopPanel = diagramState.rightTopPanel;\n  var isOpen = rightTopPanel.isOpen,\n      selectedTabId = rightTopPanel.selectedTabId;\n\n  var setRightTopPanelState = function setRightTopPanelState(obj) {\n    setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n      rightTopPanel: _objectSpread(_objectSpread({}, rightTopPanel), obj)\n    }));\n  };\n\n  if (!isOpen) {\n    return createElement(PanelRoot, {\n      zIndex: zIndex\n    }, createElement(IconBg, {\n      onClick: function onClick() {\n        setRightTopPanelState({\n          isOpen: true\n        });\n      }\n    }, createElement(ShowMenuIcon, {\n      className: iconClassName(IconName.SHOW_MENU)\n    })));\n  }\n\n  var handleTabIdChange = function handleTabIdChange(tabId) {\n    setRightTopPanelState({\n      selectedTabId: tabId\n    });\n  };\n\n  return createElement(PanelRoot, {\n    zIndex: zIndex\n  }, createElement(Title, null, createElement(CloseIcon, {\n    className: iconClassName(IconName.CLOSE),\n    onClick: function onClick() {\n      setRightTopPanelState({\n        isOpen: false\n      });\n    }\n  })), createElement(StyledTabs, {\n    id: \"tabs\",\n    selectedTabId: selectedTabId,\n    onChange: handleTabIdChange\n  }, controller.run('renderRightTopPanelTabs', props)));\n}\n\nvar borderWidthItems$1 = _toConsumableArray(Array(7).keys());\n\nvar borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nvar borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nfunction BorderStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleBorderWidthChange = function handleBorderWidthChange(value) {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({\n      borderWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleBorderStyleChange = function handleBorderStyleChange(value) {\n    setContentStyle({\n      borderStyle: value\n    });\n  };\n\n  var handleBorderRadiusChange = function handleBorderRadiusChange(value) {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({\n      borderRadius: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleBorderColorChange = function handleBorderColorChange(color) {\n    setContentStyle({\n      borderColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BORDER)), createElement(SettingRow, null, createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(contentStyle.borderWidth ? contentStyle.borderWidth : getI18nText(props, I18nKey.DEFAULT)),\n    items: borderWidthItems$1,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.STYLE), \": \").concat(contentStyle.borderStyle ? getI18nText(props, contentStyle.borderStyle) : getI18nText(props, I18nKey.NONE)),\n    items: borderStyleItems,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleBorderStyleChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.RADIUS), \": \").concat(contentStyle.borderRadius),\n    items: borderRadiusItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderRadiusChange\n  }), createElement(SettingItemColorPicker, {\n    color: contentStyle.borderColor,\n    handleColorChange: handleBorderColorChange\n  })));\n}\n\nfunction ClearAllCustomStyle(props) {\n  var controller = props.controller;\n\n  var handleClearAllCustomStyle = function handleClearAllCustomStyle(e) {\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.CLEAR_ALL_CUSTOM_STYLE\n    }));\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClearAllCustomStyle\n  }, getI18nText(props, I18nKey.CLEAR_ALL_CUSTOM_STYLE))));\n}\n\nvar lineTypes = ['curve', 'round', 'line'];\n\nfunction LinkStyleEditor(props) {\n  var _props$showLinkStyle = props.showLinkStyle,\n      showLinkStyle = _props$showLinkStyle === void 0 ? true : _props$showLinkStyle,\n      _props$showSubLinkSty = props.showSubLinkStyle,\n      showSubLinkStyle = _props$showSubLinkSty === void 0 ? true : _props$showSubLinkSty,\n      _props$linkStyle = props.linkStyle,\n      linkStyle = _props$linkStyle === void 0 ? {} : _props$linkStyle,\n      _props$subLinkStyle = props.subLinkStyle,\n      subLinkStyle = _props$subLinkStyle === void 0 ? {} : _props$subLinkStyle,\n      setLinkStyle = props.setLinkStyle,\n      setSubLinkStyle = props.setSubLinkStyle;\n\n  var handleLinkWidthChange = function handleLinkWidthChange(value) {\n    setLinkStyle({\n      lineWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleLinkTypeChange = function handleLinkTypeChange(value) {\n    setLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleLinkColorChange = function handleLinkColorChange(color) {\n    setLinkStyle({\n      lineColor: color\n    });\n  };\n\n  var handleSubLinkWidthChange = function handleSubLinkWidthChange(value) {\n    setSubLinkStyle({\n      lineWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleSubLinkTypeChange = function handleSubLinkTypeChange(value) {\n    setSubLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleSubLinkColorChange = function handleSubLinkColorChange(color) {\n    setSubLinkStyle({\n      lineColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.LINK)), showLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, getI18nText(props, I18nKey.LINK_TO_PARENT) + ':', ' '), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(linkStyle ? linkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.LINE_TYPE), \": \").concat(getI18nText(props, linkStyle.lineType)),\n    items: lineTypes,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: linkStyle.lineColor,\n    handleColorChange: handleLinkColorChange\n  })), showSubLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, getI18nText(props, I18nKey.SUB_LINKS) + ': '), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(subLinkStyle ? subLinkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleSubLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.LINE_TYPE), \": \").concat(getI18nText(props, subLinkStyle.lineType)),\n    items: lineTypes,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleSubLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: subLinkStyle.lineColor,\n    handleColorChange: handleSubLinkColorChange\n  })));\n}\n\nfunction TextStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleFontSizeChange = function handleFontSizeChange(value) {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({\n      fontSize: value\n    });\n  };\n\n  var handleLineHeightChange = function handleLineHeightChange(e) {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({\n      lineHeight: e.target.value\n    });\n  };\n\n  var handleColorChange = function handleColorChange(color) {\n    setContentStyle({\n      color: color\n    });\n  };\n\n  var fontSizeNumInputProps = {\n    title: \"\".concat(getI18nText(props, I18nKey.FONT_SIZE), \":\"),\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  var lineHeightInputProps = {\n    title: \"\".concat(getI18nText(props, I18nKey.LINE_HEIGHT), \":\"),\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.TEXT_EDITOR)), createElement(Flex, null, createElement(SettingItemNumericInput, Object.assign({}, fontSizeNumInputProps)), createElement(SettingItemInput, Object.assign({}, lineHeightInputProps)), createElement(SettingItemColorPicker, {\n    color: contentStyle.color,\n    handleColorChange: handleColorChange\n  })));\n}\n\nvar log$f = debug('node:style-editor');\nvar copiedStyle;\n\nfunction StyleEditor(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  var setContentStyle = function setContentStyle(style) {\n    controller.run('setTopicContentStyle', _objectSpread(_objectSpread({}, props), {}, {\n      style: style\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(color) {\n    setContentStyle({\n      background: color\n    });\n  };\n\n  var handleClearStyle = function handleClearStyle() {\n    if (topic.style) {\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_STYLE,\n        style: null\n      }));\n    }\n  };\n\n  var handleCopyStyle = function handleCopyStyle() {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log$f(copiedStyle);\n  };\n\n  var handlePasteStyle = function handlePasteStyle() {\n    if (copiedStyle) {\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      }));\n    }\n  };\n\n  if (!model.focusKey) return null;\n  var contentStyle = controller.run('getTopicContentStyle', props);\n  var linkStyle = controller.run('getLinkStyle', props);\n  var subLinkStyle = controller.run('getSubLinkStyle', props);\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    controller.run('setLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n      linkStyle: linkStyle\n    }));\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    controller.run('setSubLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n      subLinkStyle: subLinkStyle\n    }));\n  };\n\n  var linkStyleEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  });\n\n  var contentStyleEditorPros = _objectSpread(_objectSpread({}, props), {}, {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  });\n\n  return createElement(PanelTabRoot, null, createElement(BorderStyleEditor, Object.assign({}, contentStyleEditorPros)), createElement(TextStyleEditor, Object.assign({}, contentStyleEditorPros)), createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BACKGROUND)), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: handleBackgroundColorChange\n  })), createElement(LinkStyleEditor, Object.assign({}, linkStyleEditorProps)), createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.CLEAR_TOPIC_STYLE),\n    onClick: handleClearStyle\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.COPY_STYLE),\n    onClick: handleCopyStyle\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.PASTE_STYLE),\n    onClick: handlePasteStyle\n  })), ClearAllCustomStyle(props));\n}\n/** Event handler that exposes the target element's value as a boolean. */\n\n\nfunction handleBooleanChange(handler) {\n  return function (event) {\n    return handler(event.target.checked);\n  };\n}\n\nvar expand = require('css-shorthand-expand');\n\nfunction PaddingStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n  var padding = expand('padding', contentStyle.padding || '0');\n  var commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  var top = parseInt(padding['padding-top']);\n  var right = parseInt(padding['padding-right']);\n  var bottom = parseInt(padding['padding-bottom']);\n  var left = parseInt(padding['padding-left']);\n  var p = {\n    top: top,\n    right: right,\n    bottom: bottom,\n    left: left\n  };\n\n  var setPadding = function setPadding(dir) {\n    return function (v) {\n      setContentStyle({\n        padding: paddingCss(_objectSpread(_objectSpread({}, p), {}, _defineProperty({}, dir, v)))\n      });\n    };\n  };\n\n  var topProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.TOP),\n    value: top,\n    onValueChange: setPadding('top')\n  });\n\n  var rightProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.RIGHT),\n    value: right,\n    onValueChange: setPadding('right')\n  });\n\n  var bottomProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.BOTTOM),\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  });\n\n  var leftProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.LEFT),\n    value: left,\n    onValueChange: setPadding('left')\n  });\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.PADDING)), createElement(SettingRow, null, createElement(SettingItemNumericInput, Object.assign({}, topProps)), createElement(SettingItemNumericInput, Object.assign({}, rightProps)), createElement(SettingItemNumericInput, Object.assign({}, bottomProps)), createElement(SettingItemNumericInput, Object.assign({}, leftProps))));\n}\n\nvar TopicThemeEditorRoot = styled.div(_templateObject55 || (_templateObject55 = _taggedTemplateLiteral([\"\\n  height: 250px;\\n  overflow: auto;\\n\"])));\n\nfunction TopicThemeEditor(props) {\n  var topicStyle = props.topicStyle,\n      setTopicStyle = props.setTopicStyle;\n  var _topicStyle$contentSt = topicStyle.contentStyle,\n      contentStyle = _topicStyle$contentSt === void 0 ? {} : _topicStyle$contentSt,\n      _topicStyle$linkStyle = topicStyle.linkStyle,\n      linkStyle = _topicStyle$linkStyle === void 0 ? {} : _topicStyle$linkStyle,\n      _topicStyle$subLinkSt = topicStyle.subLinkStyle,\n      subLinkStyle = _topicStyle$subLinkSt === void 0 ? {} : _topicStyle$subLinkSt;\n\n  var setContentStyle = function setContentStyle(contentStyle) {\n    setTopicStyle({\n      contentStyle: contentStyle\n    });\n  };\n\n  var nProps = _objectSpread(_objectSpread({}, props), {}, {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  });\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    setTopicStyle({\n      linkStyle: linkStyle\n    });\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    setTopicStyle({\n      subLinkStyle: subLinkStyle\n    });\n  };\n\n  var linkStyleEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    showLinkStyle: false,\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  });\n\n  return createElement(TopicThemeEditorRoot, null, createElement(BorderStyleEditor, Object.assign({}, nProps)), createElement(PaddingStyleEditor, Object.assign({}, nProps)), createElement(TextStyleEditor, Object.assign({}, nProps)), createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BACKGROUND)), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: function handleColorChange(color) {\n      setContentStyle({\n        background: color\n      });\n    }\n  })), createElement(LinkStyleEditor, Object.assign({}, linkStyleEditorProps)));\n}\n\nvar log$g = debug('node:theme-editor');\nvar tabId = 'normal';\n\nfunction ThemeEditor(props) {\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      alertThemeError = _useState4[0],\n      setAlertThemeError = _useState4[1];\n\n  var model = props.model,\n      controller = props.controller; // cloneDeep\n\n  var theme = cloneDeep(model.config.theme);\n\n  var _controller$run6 = controller.run('getThemeOfTopic', _objectSpread(_objectSpread({}, props), {}, {\n    isClone: true\n  })),\n      rootTopic = _controller$run6.rootTopic,\n      primaryTopic = _controller$run6.primaryTopic,\n      normalTopic = _controller$run6.normalTopic;\n\n  var setTheme = function setTheme(theme) {\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.SET_THEME,\n      theme: theme\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(background) {\n    setTheme(merge(theme, {\n      background: background\n    }));\n  };\n\n  var handleHighlightColorChange = function handleHighlightColorChange(highlightColor) {\n    setTheme(merge(theme, {\n      highlightColor: highlightColor\n    }));\n  };\n\n  var handleRandomColorChange = handleBooleanChange(function (randomColor) {\n    setTheme(merge(theme, {\n      randomColor: randomColor\n    }));\n  });\n\n  var setRootTopicStyle = function setRootTopicStyle(style) {\n    setTheme(merge(theme, {\n      rootTopic: style\n    }));\n  };\n\n  var setPrimaryTopicStyle = function setPrimaryTopicStyle(style) {\n    setTheme(merge(theme, {\n      primaryTopic: style\n    }));\n  };\n\n  var setNormalTopicStyle = function setNormalTopicStyle(style) {\n    setTheme(merge(theme, {\n      normalTopic: style\n    }));\n  };\n\n  var rootTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  });\n\n  var rootTopicEditor = createElement(TopicThemeEditor, Object.assign({}, rootTopicEditorProps));\n\n  var primaryTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  });\n\n  var primaryTopicEditor = createElement(TopicThemeEditor, Object.assign({}, primaryTopicEditorProps));\n\n  var normalTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  });\n\n  var normalTopicEditor = createElement(TopicThemeEditor, Object.assign({}, normalTopicEditorProps));\n  var tabsProps = {\n    id: tabId,\n    handleTabIdChange: function handleTabIdChange(id) {\n      tabId = id;\n    }\n  };\n  var topicThemes = createElement(SettingBoxContainer, null, createElement(Tabs, Object.assign({}, tabsProps), createElement(Tab, {\n    id: \"normal\",\n    title: getI18nText(props, I18nKey.NORMAL_TOPIC),\n    panel: normalTopicEditor\n  }), createElement(Tab, {\n    id: \"primary\",\n    title: getI18nText(props, I18nKey.PRIMARY_TOPIC),\n    panel: primaryTopicEditor\n  }), createElement(Tab, {\n    id: \"root\",\n    title: getI18nText(props, I18nKey.ROOT_TOPIC),\n    panel: rootTopicEditor\n  })));\n\n  var handleExportTheme = function handleExportTheme(e) {\n    // setShowExportDialog(true);\n    var text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n\n  var handleImportTheme = function handleImportTheme(e) {\n    browserOpenFile('.json,.txt').then(function (txt) {\n      var t = JSON.parse(txt);\n\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n\n      setTheme(t);\n    });\n  };\n\n  var alertProps = {\n    isOpen: alertThemeError,\n    onClose: function onClose(e) {\n      setAlertThemeError(false);\n    }\n  };\n  var alert = createElement(Alert, Object.assign({}, alertProps), createElement(\"p\", null, \"File format error\"));\n  return createElement(PanelTabRoot, null, createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.GLOBAL)), createElement(SettingRow, null, createElement(SettingLabel, null, getI18nText(props, I18nKey.BACKGROUND) + ':'), createElement(SettingItemColorPicker, {\n    color: theme.background,\n    handleColorChange: handleBackgroundColorChange\n  }), createElement(SettingLabel, null, getI18nText(props, I18nKey.HIGHLIGHT) + ':'), createElement(SettingItemColorPicker, {\n    color: theme.highlightColor,\n    handleColorChange: handleHighlightColorChange\n  }), createElement(SettingLabel, null, getI18nText(props, I18nKey.RANDOM_COLOR) + ':'), createElement(StyledCheckbox, {\n    checked: theme.randomColor,\n    onChange: handleRandomColorChange\n  }))), topicThemes, createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.EXPORT_THEME),\n    onClick: handleExportTheme\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.IMPORT_THEME),\n    onClick: handleImportTheme\n  })), alert);\n}\n\nfunction RightTopPanelPlugin() {\n  return {\n    renderRightTopPanel: function renderRightTopPanel(props) {\n      var nProps = _objectSpread(_objectSpread({}, props), {}, {\n        key: 'right-top-panel'\n      });\n\n      return createElement(RightTopPanelWidget, Object.assign({}, nProps));\n    },\n    renderRightTopPanelTabs: function renderRightTopPanelTabs(props) {\n      var controller = props.controller;\n      var styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      var themeEditorTab = controller.run('renderThemeEditor', props);\n      return [styleEditorTab, themeEditorTab];\n    },\n    renderTopicStyleEditor: function renderTopicStyleEditor(ctx) {\n      var tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: getI18nText(ctx, I18nKey.TOPIC_STYLE),\n        panel: createElement(StyleEditor, Object.assign({}, ctx))\n      };\n      return createElement(Tab, Object.assign({}, tProps));\n    },\n    renderThemeEditor: function renderThemeEditor(props) {\n      var tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: getI18nText(props, I18nKey.THEME),\n        panel: createElement(ThemeEditor, Object.assign({}, props))\n      };\n      return createElement(Tab, Object.assign({}, tProps));\n    }\n  };\n}\n\nvar ToolbarRoot = styled.div(_templateObject56 || (_templateObject56 = _taggedTemplateLiteral([\"\\n  box-shadow: rgb(170, 170, 170) 0 0 2px;\\n  background: white;\\n  .iconfont {\\n    font-size: 28px !important;\\n  }\\n\"])));\n\nfunction Toolbar(props) {\n  var controller = props.controller;\n  return createElement(ToolbarRoot, null, controller.run('renderToolbarItems', props));\n}\n\nfunction ToolbarItemLayout(props) {\n  var layoutDirs = [[DiagramLayoutType.LEFT_AND_RIGHT, getI18nText(props, I18nKey.LEFT_AND_RIGHT), 'layout-left-and-right'], [DiagramLayoutType.LEFT_TO_RIGHT, getI18nText(props, I18nKey.ONLY_RIGHT), 'layout-right'], [DiagramLayoutType.RIGHT_TO_LEFT, getI18nText(props, I18nKey.ONLY_LEFT), 'layout-left']];\n\n  var onClickSetLayout = function onClickSetLayout(layoutDir) {\n    return function (e) {\n      var controller = props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_LAYOUT_DIR,\n        layoutDir: layoutDir\n      }));\n    };\n  };\n\n  return createElement(ToolbarItem, Object.assign({\n    className: iconClassName(IconName.LAYOUT_LEFT_AND_RIGHT)\n  }, props), createElement(Popover, {\n    enforceFocus: false\n  }, createElement(ToolbarItemPopoverTarget, null), createElement(Menu, null, layoutDirs.map(function (dir) {\n    return createElement(MenuItem, {\n      key: dir[1],\n      icon: Icon(dir[2]),\n      text: dir[1],\n      onClick: onClickSetLayout(dir[0])\n    });\n  }))));\n}\n\nfunction ToolbarPlugin() {\n  return {\n    renderToolbar: function renderToolbar(props) {\n      return createElement(Toolbar, Object.assign({}, props));\n    },\n    renderToolbarItems: function renderToolbarItems(props) {\n      var controller = props.controller;\n      var itemConfigs = controller.run('customizeToolbar', props); //TODO  order\n\n      itemConfigs.sort(function (a, b) {\n        return a.order - b.order;\n      });\n      return itemConfigs.map(function (item) {\n        return createElement(item.element, _objectSpread(_objectSpread({}, props), {}, {\n          key: item.order.toString()\n        }));\n      });\n    },\n    customizeToolbar: function customizeToolbar(props) {\n      return [{\n        order: 100,\n        element: ToolbarItemLayout\n      }];\n    }\n  };\n}\n\nvar log$h = debug('plugin:utils');\n\nfunction UtilsPlugin() {\n  var tempValueMap = new Map();\n  var eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener: function addTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n\n      eventListenerMap.get(key).push(listener);\n    },\n    removeTempValueChangeListener: function removeTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap.get(key).filter(function (l) {\n          return l !== listener;\n        });\n      }\n    },\n    getTempValue: function getTempValue(props) {\n      var key = props.key;\n      log$h('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n    setTempValue: function setTempValue(props) {\n      var key = props.key,\n          value = props.value;\n      log$h('setTempValue', key);\n      tempValueMap.set(key, value);\n\n      if (eventListenerMap.has(key)) {\n        var listeners = eventListenerMap.get(key);\n\n        var _iterator4 = _createForOfIteratorHelper(listeners),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var listener = _step4.value;\n            listener(value);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n    },\n    deleteTempValue: function deleteTempValue(props) {\n      var key = props.key;\n      log$h('deleteTempValue', key);\n      var value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n\nfunction ReactPlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return [RenderingPlugin(), UtilsPlugin(), ContextMenuPlugin(), RightTopPanelPlugin(), ToolbarPlugin(), DragAndDropPlugin()];\n}\n\nvar log$i = debug('node:text-editor');\nvar Content = styled.div(_templateObject57 || (_templateObject57 = _taggedTemplateLiteral([\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"])), function (props) {\n  return props.readOnly ? null : 'white';\n}, function (props) {\n  return props.readOnly ? 'pointer' : 'text';\n});\n\nvar SimpleTextEditor = /*#__PURE__*/function (_PureComponent2) {\n  _inherits(SimpleTextEditor, _PureComponent2);\n\n  var _super16 = _createSuper(SimpleTextEditor);\n\n  function SimpleTextEditor(props) {\n    var _this13;\n\n    _classCallCheck(this, SimpleTextEditor);\n\n    _this13 = _super16.call(this, props);\n    _this13.state = {\n      content: null\n    };\n\n    _this13.onMouseDown = function (e) {\n      e.stopPropagation();\n    };\n\n    _this13.onMouseMove = function (e) {// log('onMouseMove');\n      // e.stopPropagation();\n    };\n\n    _this13.onKeyDown = function (e) {};\n\n    _this13._handleClick = function (event) {\n      var wasOutside = !_this13.root.contains(event.target);\n      wasOutside && _this13.onClickOutSide(event);\n    };\n\n    _this13.rootRef = function (saveRef) {\n      return function (ref) {\n        saveRef(ref);\n        _this13.root = ref;\n      };\n    };\n\n    _this13.initState();\n\n    return _this13;\n  }\n\n  _createClass(SimpleTextEditor, [{\n    key: \"onChange\",\n    value: function onChange(_ref10) {\n      var value = _ref10.value;\n      log$i('onChange', value);\n      this.setState({\n        content: value\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var readOnly = this.props.readOnly;\n      if (readOnly) return;\n      document.addEventListener('click', this._handleClick);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var readOnly = this.props.readOnly;\n      if (readOnly) return;\n      document.removeEventListener('click', this._handleClick);\n    }\n  }, {\n    key: \"onClickOutSide\",\n    value: function onClickOutSide(e) {}\n  }, {\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      return null;\n    }\n  }, {\n    key: \"getContent\",\n    value: function getContent() {\n      var _this$getCustomizePro = this.getCustomizeProps(),\n          block = _this$getCustomizePro.block;\n\n      var content = block.data;\n      if (content == null) return null;\n\n      if (typeof content === 'string') {\n        content = plainSerializer.deserialize(content);\n      }\n\n      return content;\n    }\n  }, {\n    key: \"initState\",\n    value: function initState() {\n      var content = this.getContent();\n      this.state = {\n        content: content\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props10 = this.props,\n          topicKey = _this$props10.topicKey,\n          saveRef = _this$props10.saveRef;\n\n      var _this$getCustomizePro2 = this.getCustomizeProps(),\n          readOnly = _this$getCustomizePro2.readOnly,\n          getRefKeyFunc = _this$getCustomizePro2.getRefKeyFunc,\n          placeholder = _this$getCustomizePro2.placeholder,\n          style = _this$getCustomizePro2.style;\n\n      log$i(readOnly);\n      var key = getRefKeyFunc(topicKey);\n      var content = readOnly ? this.getContent() : this.state.content;\n      var onMouseDown = this.onMouseDown,\n          onMouseMove = this.onMouseMove,\n          onKeyDown = this.onKeyDown;\n      var editorProps = {\n        value: content,\n        readOnly: readOnly,\n        onChange: this.onChange.bind(this),\n        placeholder: placeholder,\n        style: style\n      };\n      var contentProps = {\n        key: key,\n        readOnly: readOnly,\n        ref: this.rootRef(saveRef(key)),\n        onMouseDown: onMouseDown,\n        onMouseMove: onMouseMove,\n        onKeyDown: onKeyDown\n      };\n      return createElement(Content, Object.assign({}, contentProps), createElement(Editor, Object.assign({}, editorProps, {\n        autoFocus: true\n      })));\n    }\n  }]);\n\n  return SimpleTextEditor;\n}(PureComponent);\n\nvar log$j = debug('node:topic-content-editor');\n\nfunction contentEditorRefKey$1(key) {\n  return \"content-editor-\".concat(key);\n}\n\nvar TopicContentEditor = /*#__PURE__*/function (_SimpleTextEditor) {\n  _inherits(TopicContentEditor, _SimpleTextEditor);\n\n  var _super17 = _createSuper(TopicContentEditor);\n\n  function TopicContentEditor(props) {\n    var _this14;\n\n    _classCallCheck(this, TopicContentEditor);\n\n    _this14 = _super17.call(this, props);\n\n    _this14.onKeyDown = function (e) {\n      if (e.nativeEvent.ctrlKey && e.nativeEvent.code === 'Enter') {\n        _this14.save();\n      }\n    };\n\n    return _this14;\n  }\n\n  _createClass(TopicContentEditor, [{\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      var _this$props11 = this.props,\n          model = _this$props11.model,\n          topicKey = _this$props11.topicKey,\n          readOnly = _this$props11.readOnly;\n      var block = model.getTopic(topicKey).getBlock(BlockType.CONTENT).block;\n      var getRefKeyFunc = contentEditorRefKey$1;\n      var style = {\n        whiteSpace: 'pre'\n      };\n      return {\n        block: block,\n        readOnly: readOnly,\n        getRefKeyFunc: getRefKeyFunc,\n        placeholder: 'new',\n        style: style\n      };\n    }\n  }, {\n    key: \"onClickOutSide\",\n    value: function onClickOutSide(e) {\n      log$j('onClickOutSide');\n      this.save();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var _this$props12 = this.props,\n          model = _this$props12.model,\n          topicKey = _this$props12.topicKey;\n      var readOnly = model.editingContentKey !== topicKey;\n      if (readOnly) return;\n      var controller = this.props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, this.props), {}, {\n        opType: OpType.SET_TOPIC_BLOCK,\n        blockType: BlockType.CONTENT,\n        data: this.state.content,\n        focusMode: FocusMode.NORMAL\n      }));\n    }\n  }]);\n\n  return TopicContentEditor;\n}(SimpleTextEditor);\n\nvar log$k = debug('node:topic-desc-editor');\n\nfunction descEditorRefKey$1(key) {\n  return \"desc-editor-\".concat(key);\n}\n\nvar TopicDescEditor = /*#__PURE__*/function (_SimpleTextEditor2) {\n  _inherits(TopicDescEditor, _SimpleTextEditor2);\n\n  var _super18 = _createSuper(TopicDescEditor);\n\n  function TopicDescEditor(props) {\n    var _this15;\n\n    _classCallCheck(this, TopicDescEditor);\n\n    _this15 = _super18.call(this, props);\n    log$k('constructor');\n    return _this15;\n  }\n\n  _createClass(TopicDescEditor, [{\n    key: \"initState\",\n    value: function initState() {\n      _get(_getPrototypeOf(TopicDescEditor.prototype), \"initState\", this).call(this);\n\n      var _this$props13 = this.props,\n          controller = _this$props13.controller,\n          topicKey = _this$props13.topicKey;\n      var key = \"topic-desc-data-\".concat(topicKey);\n      var value = this.state.content;\n      controller.run('setTempValue', {\n        key: key,\n        value: value\n      });\n    }\n  }, {\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      var _this$props14 = this.props,\n          model = _this$props14.model,\n          topicKey = _this$props14.topicKey;\n      var block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n      var readOnly = model.editingDescKey !== topicKey;\n      var getRefKeyFunc = descEditorRefKey$1;\n      return {\n        block: block,\n        readOnly: readOnly,\n        getRefKeyFunc: getRefKeyFunc,\n        placeholder: 'write topic notes here'\n      };\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(_ref11) {\n      var value = _ref11.value;\n      log$k('onChange');\n      var _this$props15 = this.props,\n          controller = _this$props15.controller,\n          topicKey = _this$props15.topicKey,\n          model = _this$props15.model;\n      var readOnly = model.editingDescKey !== topicKey;\n      if (readOnly) return;\n      var key = \"topic-desc-data-\".concat(topicKey);\n      controller.run('setTempValue', {\n        key: key,\n        value: value\n      });\n      this.setState({\n        content: value\n      });\n    }\n  }]);\n\n  return TopicDescEditor;\n}(SimpleTextEditor);\n\nfunction SimpleTextEditorPlugin() {\n  return {\n    getTopicTitle: function getTopicTitle(props) {\n      var model = props.model,\n          controller = props.controller,\n          topicKey = props.topicKey,\n          maxLength = props.maxLength;\n      var topic = model.getTopic(topicKey);\n      var block = topic.getBlock(BlockType.CONTENT).block;\n      var text = controller.run('serializeBlockData', _objectSpread(_objectSpread({}, props), {}, {\n        block: block\n      }));\n\n      if (maxLength != null) {\n        text = text.length > maxLength ? text.substr(0, maxLength) + '...' : text;\n      }\n\n      return text;\n    },\n    renderTopicContentEditor: function renderTopicContentEditor(props) {\n      return createElement(TopicContentEditor, Object.assign({}, props));\n    },\n    renderTopicDescEditor: function renderTopicDescEditor(props) {\n      return createElement(TopicDescEditor, Object.assign({}, props));\n    },\n    isBlockEmpty: function isBlockEmpty(props, next) {\n      var block = props.block,\n          controller = props.controller;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return block.data == null || controller.run('serializeBlockData', props) === '';\n      }\n\n      return next();\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var block = props.block;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return typeof block.data === 'string' ? block.data : plainSerializer.serialize(block.data);\n      }\n\n      return next();\n    }\n  };\n}\n\nvar log$l = debug('plugin:StylePlugin');\n\nfunction StylePlugin() {\n  var colorMap = new Map();\n  var colorIndex = 0;\n  return {\n    getTopicStyle: function getTopicStyle(props) {\n      var controller = props.controller;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n    getTopicContentStyle: function getTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getTopicContentStyle:', topicKey, model);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;else if (visualLevel === TopicVisualLevel.PRIMARY) themeStyle = theme.primaryTopic;else themeStyle = theme.normalTopic;\n      themeStyle = _objectSpread(_objectSpread({}, theme.contentStyle), themeStyle.contentStyle);\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        themeStyle = _objectSpread(_objectSpread({}, themeStyle), {}, {\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: _objectSpread(_objectSpread({}, themeStyle.subLinkStyle), {}, {\n            lineColor: randomColor\n          })\n        });\n      }\n\n      var topic = model.getTopic(topicKey);\n\n      if (!topic.style) {\n        return themeStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _objectSpread(_objectSpread({}, themeStyle), customStyle.contentStyle);\n    },\n    getLinkStyle: function getLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var linkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.linkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.linkStyle;else presetStyle = theme.normalTopic.linkStyle;\n      linkStyle = _objectSpread(_objectSpread({}, linkStyle), presetStyle);\n      var topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        var parentSubLinkStyle = controller.run('getSubLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: topic.parentKey\n        }));\n        linkStyle = _objectSpread(_objectSpread({}, linkStyle), parentSubLinkStyle);\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _objectSpread(_objectSpread({}, linkStyle), customStyle.linkStyle);\n    },\n    getSubLinkStyle: function getSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var subLinkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.subLinkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.subLinkStyle;else presetStyle = theme.normalTopic.subLinkStyle;\n      subLinkStyle = _objectSpread(_objectSpread({}, subLinkStyle), presetStyle);\n      var topic = model.getTopic(topicKey); // color\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        log$l(randomColor);\n        subLinkStyle = _objectSpread(_objectSpread({}, subLinkStyle), {}, {\n          lineColor: randomColor\n        });\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n\n      var res = _objectSpread(_objectSpread({}, subLinkStyle), customStyle.subLinkStyle); // if (res.lineRadius == null) res.lineRadius = 5;\n\n\n      return res;\n    },\n    setTopicContentStyle: function setTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          style = props.style,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var topicStyle = topic.style;\n      var styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        contentStyle: _objectSpread(_objectSpread({}, styleObj.contentStyle), style)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setLinkStyle: function setLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          linkStyle = props.linkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        linkStyle: _objectSpread(_objectSpread({}, styleObj.linkStyle), linkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setSubLinkStyle: function setSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          subLinkStyle = props.subLinkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        subLinkStyle: _objectSpread(_objectSpread({}, styleObj.subLinkStyle), subLinkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    getTopicThemeStyle: function getTopicThemeStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model;\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n    getRandomColor: function getRandomColor(props) {\n      var topicKey = props.topicKey;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      var colors = ['#00CC99', '#FFEE88', '#A167A5', '#E5F993', '#F5C396', '#DB995A', '#83BCFF', '#ED7B84', '#739E82', '#D3BCC0', '#FFA0FD', '#EFD3D7', '#C6878F'];\n      var color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log$l('getRandomColor', topicKey, color);\n      return color;\n    }\n  };\n}\n\nfunction ThemePlugin() {\n  return {\n    getThemeOfTopic: function getThemeOfTopic(ctx) {\n      var model = ctx.model;\n      var theme = model.config.theme;\n      var contentStyle = theme.contentStyle,\n          rootTopic = theme.rootTopic,\n          primaryTopic = theme.primaryTopic,\n          normalTopic = theme.normalTopic;\n      return {\n        rootTopic: _objectSpread(_objectSpread({}, rootTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), rootTopic.contentStyle)\n        }),\n        primaryTopic: _objectSpread(_objectSpread({}, primaryTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), primaryTopic.contentStyle)\n        }),\n        normalTopic: _objectSpread(_objectSpread({}, normalTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), normalTopic.contentStyle)\n        })\n      };\n    }\n  };\n}\n\nfunction DefaultPlugin() {\n  return [ReactPlugin(), LayoutPlugin(), OperationPlugin(), StylePlugin(), EventPlugin(), HotKeyPlugin(), GetValuePlugin(), SimpleTextEditorPlugin(), CreateModelPlugin(), ThemePlugin(), I18nPlugin()];\n}\n\nvar log$m = debug('node:Diagram');\n\nvar Diagram = /*#__PURE__*/function (_Component6) {\n  _inherits(Diagram, _Component6);\n\n  var _super19 = _createSuper(Diagram);\n\n  function Diagram() {\n    var _this16;\n\n    _classCallCheck(this, Diagram);\n\n    _this16 = _super19.apply(this, arguments);\n    _this16.resolveController = memoizeOne(function () {\n      var plugins = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var TheDefaultPlugin = arguments.length > 1 ? arguments[1] : undefined;\n      var defaultPlugin = TheDefaultPlugin();\n      _this16.controller = new Controller({\n        plugins: [plugins, defaultPlugin],\n        onChange: _this16.props.onChange\n      });\n    });\n    return _this16;\n  }\n\n  _createClass(Diagram, [{\n    key: \"getDiagramProps\",\n    value: function getDiagramProps() {\n      return this.controller.run('getDiagramProps');\n    }\n  }, {\n    key: \"openNewModel\",\n    value: function openNewModel(newModel) {\n      var props = this.getDiagramProps();\n      var controller = props.controller;\n      controller.run('openNewModel', _objectSpread(_objectSpread({}, props), {}, {\n        newModel: newModel\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props16 = this.props,\n          plugins = _this$props16.plugins,\n          controller = _this$props16.controller;\n      if (controller) this.controller = controller;else this.resolveController(plugins, DefaultPlugin);\n      var model = this.props.model;\n\n      if (!model) {\n        model = this.controller.run('createNewModel');\n      }\n\n      this.diagramProps = _objectSpread(_objectSpread({}, this.props), {}, {\n        model: model,\n        controller: this.controller\n      });\n      return this.controller.run('renderDiagram', this.diagramProps);\n    }\n  }]);\n\n  return Diagram;\n}(Component);\n\nexport { BaseWidget, Btn, CloseIcon, ColorBar, DefaultPlugin, Diagram, DragScrollWidget, EventKey, Flex, HotKeyName, I18nKey, Icon, IconBg, IconName, Margin, MoveTopicDir, PanelTabRoot, PropKey, PxSelect, RefKey, SaveRef, SettingBoxContainer, SettingGroup, SettingItem, SettingItemButton, SettingItemColorPicker, SettingItemInput, SettingItemNumericInput, SettingItemSelect, SettingLabel, SettingRow, SettingTitle, ShowMenuIcon, StyledCheckbox, Title, ToolbarItem, ToolbarItemPopoverTarget, ToolbarItemRoot, TopicBlockIcon, VListContainer, WithBorder, ZIndex, borderWidthItems, browserDownloadFile, browserDownloadText, browserOpenFile, cancelEvent, center, centerPointX, centerPointY, centerX, centerY, collapseRefKey, contentEditorRefKey, contentRefKey, descEditorRefKey, dropAreaRefKey, getI18nText, getLinkKey, _getRelativeRect as getRelativeRect, getRelativeVector, iconClassName, linksRefKey, linksSvgRefKey, paddingCss, renderItem, renderItemI18n, topicRefKey, topicWidgetRefKey };","import { BlockType } from '@blink-mind/core';\nimport { createElement } from 'react';\nimport { BaseWidget, descEditorRefKey } from '@blink-mind/renderer-react';\nimport RichMarkDownEditor from 'awehook-rich-markdown-editor';\nimport debug from 'debug';\nimport styled from 'styled-components';\nimport MarkdownSerializer from 'slate-md-serializer';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar log = debug('node:topic-content-editor');\nvar NodeContent = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  \", \";\\n\"], [\"\\n  \", \";\\n\"])), function (props) {\n  return !props.readOnly && \"\\n    // padding: 75px\\n    // min-width: 150px\\n    // min-height: 150px\\n  \";\n});\n\nvar RichTextEditor = function (_super) {\n  __extends(RichTextEditor, _super);\n\n  function RichTextEditor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.onMouseDown = function (e) {\n      e.stopPropagation();\n    };\n\n    _this.onMouseMove = function (e) {\n      e.stopPropagation();\n    };\n\n    _this.rootRef = function (saveRef) {\n      return function (ref) {\n        saveRef(ref);\n        _this.root = ref;\n      };\n    };\n\n    _this._handleClick = function (event) {\n      var wasOutside = !_this.root.contains(event.target);\n      wasOutside && _this.onClickOutSide(event);\n    };\n\n    _this.initState();\n\n    return _this;\n  }\n\n  RichTextEditor.prototype.initState = function () {\n    this.state = {\n      content: this.getContent()\n    };\n  };\n\n  RichTextEditor.prototype.getContent = function () {\n    var block = this.getCustomizeProps().block;\n    return block.data;\n  };\n\n  RichTextEditor.prototype.onChange = function (value) {\n    this.setState({\n      content: value\n    });\n  };\n\n  RichTextEditor.prototype.getCustomizeProps = function () {\n    return null;\n  };\n\n  RichTextEditor.prototype.componentDidMount = function () {\n    document.addEventListener('click', this._handleClick);\n  };\n\n  RichTextEditor.prototype.componentWillUnmount = function () {\n    document.removeEventListener('click', this._handleClick);\n  };\n\n  RichTextEditor.prototype.onClickOutSide = function (e) {};\n\n  RichTextEditor.prototype.render = function () {\n    var _a = this.props,\n        topicKey = _a.topicKey,\n        saveRef = _a.saveRef;\n\n    var _b = this.getCustomizeProps(),\n        readOnly = _b.readOnly,\n        getRefKeyFunc = _b.getRefKeyFunc,\n        placeholder = _b.placeholder;\n\n    log('readOnly:', readOnly);\n    var content = readOnly ? this.getContent() : this.state.content;\n    if (content == null) return null;\n    var key = getRefKeyFunc(topicKey);\n\n    var _c = this,\n        onMouseDown = _c.onMouseDown,\n        onMouseMove = _c.onMouseMove;\n\n    var richEditorProps = {\n      editorValue: content,\n      readOnly: readOnly,\n      onChange: this.onChange.bind(this),\n      placeholder: placeholder\n    };\n    var nodeContentProps = {\n      key: key,\n      ref: this.rootRef(saveRef(key)),\n      readOnly: readOnly,\n      onMouseDown: onMouseDown,\n      onMouseMove: onMouseMove\n    };\n    return createElement(NodeContent, _assign({}, nodeContentProps), createElement(RichMarkDownEditor, _assign({}, richEditorProps)));\n  };\n\n  return RichTextEditor;\n}(BaseWidget);\n\nvar templateObject_1;\n\nvar TopicDescEditor = function (_super) {\n  __extends(TopicDescEditor, _super);\n\n  function TopicDescEditor() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TopicDescEditor.prototype.initState = function () {\n    _super.prototype.initState.call(this);\n\n    var _a = this.props,\n        controller = _a.controller,\n        topicKey = _a.topicKey;\n    var key = \"topic-desc-data-\" + topicKey;\n    var value = this.state.content;\n    controller.run('setTempValue', {\n      key: key,\n      value: value\n    });\n  };\n\n  TopicDescEditor.prototype.getCustomizeProps = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey;\n    var block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n    var readOnly = model.editingDescKey !== topicKey; //TODO\n\n    var getRefKeyFunc = descEditorRefKey;\n    return {\n      block: block,\n      readOnly: readOnly,\n      getRefKeyFunc: getRefKeyFunc,\n      placeholder: 'write topic notes here'\n    };\n  };\n\n  TopicDescEditor.prototype.onChange = function (value) {\n    var _a = this.props,\n        controller = _a.controller,\n        topicKey = _a.topicKey;\n    var key = \"topic-desc-data-\" + topicKey;\n    controller.run('setTempValue', {\n      key: key,\n      value: value\n    });\n    this.setState({\n      content: value\n    });\n  };\n\n  return TopicDescEditor;\n}(RichTextEditor);\n\nvar markdownSerializer = new MarkdownSerializer();\n\nfunction RichTextEditorPlugin() {\n  return {\n    renderTopicDescEditor: function renderTopicDescEditor(props) {\n      return createElement(TopicDescEditor, _assign({}, props));\n    },\n    isBlockEmpty: function isBlockEmpty(props, next) {\n      var block = props.block,\n          controller = props.controller;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return block.data == null || controller.run('serializeBlockData', props) === '';\n      }\n\n      return next();\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var block = props.block;\n\n      if (block.type === BlockType.DESC) {\n        return typeof block.data === 'string' ? block.data : markdownSerializer.serialize(block.data);\n      }\n\n      return next();\n    }\n  };\n}\n\nexport default RichTextEditorPlugin;","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import { Model, FocusMode, Config, Topic, Block } from '@blink-mind/core';\nimport debug from 'debug';\nimport { Map, isImmutable, List } from 'immutable';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nvar log = debug('plugin:json-serializer');\n\nfunction JsonSerializerPlugin() {\n  return {\n    serializeModel: function serializeModel(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var model = props.model,\n          controller = props.controller;\n      var obj = {\n        rootTopicKey: model.rootTopicKey,\n        editorRootTopicKey: model.editorRootTopicKey,\n        focusKey: model.focusKey,\n        extData: controller.run('serializeExtData', _assign(_assign({}, props), {\n          extData: model.extData\n        })),\n        topics: model.topics.valueSeq().toArray().map(function (topic) {\n          return controller.run('serializeTopic', _assign(_assign({}, props), {\n            topic: topic\n          }));\n        }),\n        config: controller.run('serializeConfig', _assign(_assign({}, props), {\n          config: model.config\n        })),\n        formatVersion: model.formatVersion\n      };\n      return obj;\n    },\n    deserializeModel: function deserializeModel(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var obj = props.obj,\n          controller = props.controller;\n\n      if (obj.formatVersion == null) {\n        obj.formatVersion = '0.0';\n      }\n\n      var rootTopicKey = obj.rootTopicKey,\n          editorRootTopicKey = obj.editorRootTopicKey,\n          focusKey = obj.focusKey,\n          topics = obj.topics,\n          config = obj.config,\n          extData = obj.extData,\n          formatVersion = obj.formatVersion;\n      var res = new Model();\n      res = res.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey == null ? rootTopicKey : editorRootTopicKey,\n        focusKey: focusKey,\n        extData: controller.run('deserializeExtData', _assign(_assign({}, props), {\n          extData: extData,\n          formatVersion: formatVersion\n        })),\n        config: controller.run('deserializeConfig', _assign(_assign({}, props), {\n          config: config,\n          formatVersion: formatVersion\n        })),\n        topics: controller.run('deserializeTopics', _assign(_assign({}, props), {\n          topics: topics,\n          formatVersion: formatVersion\n        })),\n        formatVersion: obj.formatVersion\n      });\n\n      if (res.focusKey == null) {\n        res = res.set('focusKey', res.rootTopicKey);\n      }\n\n      if (res.focusMode == null) {\n        res = res.set('focusMode', FocusMode.NORMAL);\n      }\n\n      log('deserializeModel', res);\n      return res;\n    },\n    serializeExtData: function serializeExtData(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var extData = props.extData,\n          controller = props.controller;\n      var res = {};\n      extData.forEach(function (v, k) {\n        res[k] = controller.run('serializeExtDataItem', {\n          props: props,\n          extDataKey: k,\n          extDataItem: v\n        });\n      });\n      return res;\n    },\n    deserializeExtData: function deserializeExtData(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var extData = props.extData,\n          controller = props.controller;\n      var res = Map();\n\n      for (var extDataKey in extData) {\n        res = res.set(extDataKey, controller.run('deserializeExtDataItem', _assign(_assign({}, props), {\n          extDataKey: extDataKey,\n          extDataItem: extData[extDataKey]\n        })));\n      }\n\n      return res;\n    },\n    serializeExtDataItem: function serializeExtDataItem(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var extDataItem = props.extDataItem;\n\n      if (isImmutable(extDataItem)) {\n        return extDataItem.toJS();\n      }\n\n      return extDataItem;\n    },\n    deserializeExtDataItem: function deserializeExtDataItem(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var extDataItem = props.extDataItem;\n      return extDataItem;\n    },\n    serializeConfig: function serializeConfig(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var config = props.config;\n      return config.toJS();\n    },\n    deserializeConfig: function deserializeConfig(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var config = props.config;\n      return new Config(config);\n    },\n    serializeTopic: function serializeTopic(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var topic = props.topic,\n          controller = props.controller;\n      return {\n        key: topic.key,\n        parentKey: topic.parentKey,\n        subKeys: topic.subKeys.toArray(),\n        collapse: topic.collapse,\n        style: topic.style,\n        blocks: topic.blocks.map(function (block) {\n          return controller.run('serializeBlock', _assign(_assign({}, props), {\n            block: block\n          }));\n        })\n      };\n    },\n    deserializeTopic: function deserializeTopic(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var topic = props.topic,\n          controller = props.controller;\n      var key = topic.key,\n          parentKey = topic.parentKey,\n          subKeys = topic.subKeys,\n          blocks = topic.blocks,\n          style = topic.style,\n          collapse = topic.collapse;\n      var res = new Topic();\n      res = res.merge({\n        key: key,\n        parentKey: parentKey,\n        subKeys: List(subKeys),\n        style: style,\n        collapse: collapse,\n        blocks: controller.run('deserializeBlocks', _assign(_assign({}, props), {\n          blocks: blocks\n        }))\n      });\n      return res;\n    },\n    deserializeTopics: function deserializeTopics(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var topics = props.topics,\n          controller = props.controller;\n      var res = Map();\n      res = res.withMutations(function (r) {\n        topics.forEach(function (topic) {\n          return r.set(topic.key, controller.run('deserializeTopic', _assign(_assign({}, props), {\n            topic: topic\n          })));\n        });\n      });\n      return res;\n    },\n    serializeBlock: function serializeBlock(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var block = props.block,\n          controller = props.controller;\n      var res = {\n        type: block.type,\n        data: controller.run('serializeBlockData', _assign({}, props))\n      };\n      return res;\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var block = props.block;\n      return block.data;\n    },\n    deserializeBlock: function deserializeBlock(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var block = props.block,\n          controller = props.controller;\n      var type = block.type;\n      return new Block({\n        type: type,\n        data: controller.run('deserializeBlockData', _assign(_assign({}, props), {\n          block: block\n        }))\n      });\n    },\n    deserializeBlockData: function deserializeBlockData(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var block = props.block;\n      return block.data;\n    },\n    deserializeBlocks: function deserializeBlocks(props, next) {\n      var nextRes = next();\n      if (nextRes != null) return nextRes;\n      var blocks = props.blocks,\n          controller = props.controller;\n      var res = List();\n      res = res.withMutations(function (res) {\n        blocks.forEach(function (block) {\n          return res.push(controller.run('deserializeBlock', _assign(_assign({}, props), {\n            block: block\n          })));\n        });\n      });\n      return res;\n    }\n  };\n}\n\nexport { JsonSerializerPlugin };","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","var isProduction = process.env.NODE_ENV === 'production';\n\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import { ModelModifier, defaultTheme } from '@blink-mind/core';\nvar themeRandomColorSquare = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5',\n    fontSize: '16px'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '36px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      fontSize: '24px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px'\n    }\n  },\n  normalTopic: {\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px'\n    }\n  }\n};\nvar theme1 = {\n  name: 'theme1',\n  randomColor: false,\n  background: 'rgb(250,245,205)',\n  highlightColor: '#50C9CE',\n  marginH: 50,\n  marginV: 30,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5\n  },\n  rootTopic: {\n    contentStyle: {\n      background: 'rgb(221, 170, 68)',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: 'rgb(221, 170, 68)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#e8eaec',\n      borderWidth: '2px',\n      borderStyle: 'solid',\n      borderColor: 'rgb(221, 170, 68)',\n      borderRadius: '5px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: 'rgb(221, 170, 68)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      background: '#fff',\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      color: 'rgb(187, 136, 34)',\n      fontSize: '13px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: 'rgb(187, 136, 34)'\n    }\n  }\n};\nvar theme2 = {\n  name: 'theme2',\n  randomColor: false,\n  background: '#f8f8f8',\n  highlightColor: '#50C9CE',\n  marginH: 45,\n  marginV: 10,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5\n  },\n  rootTopic: {\n    contentStyle: {\n      background: '#50C18A',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#ffffff',\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderColor: 'rgb(221, 170, 68)',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '14px',\n      padding: '6px 10px 5px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      background: '#fff',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '13px',\n      padding: '3px 9px 4px',\n      boxShadow: '1px 1px 1px #ccc'\n    },\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: '#43a9ff'\n    }\n  }\n};\nvar theme3 = {\n  name: 'theme3',\n  randomColor: false,\n  background: '#A9DEF9',\n  highlightColor: '#50C9CE',\n  marginH: 50,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5\n  },\n  rootTopic: {\n    contentStyle: {\n      background: '#FF99C8',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#FCF6BD',\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderColor: '#E4C1F9',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '14px',\n      padding: '6px 10px 5px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      background: '#E4FDE1',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '13px',\n      padding: '3px 9px 4px',\n      boxShadow: '1px 1px 1px #ccc'\n    },\n    subLinkStyle: {\n      lineType: 'round',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: '#43a9ff'\n    }\n  }\n};\nvar theme4 = {\n  name: 'theme3',\n  randomColor: false,\n  background: '#CCFBFE',\n  highlightColor: '#50C9CE',\n  marginH: 50,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5\n  },\n  rootTopic: {\n    contentStyle: {\n      background: '#CD8987',\n      color: '#fff',\n      fontSize: '34px',\n      borderRadius: '5px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      background: '#CDACA1',\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderColor: '#E4C1F9',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '14px',\n      padding: '6px 10px 5px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'line',\n      lineWidth: '2px',\n      lineColor: '#43a9ff'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      background: '#CDCACC',\n      borderRadius: '5px',\n      color: 'rgb(103,103,103)',\n      fontSize: '13px',\n      padding: '3px 9px 4px',\n      boxShadow: '1px 1px 1px #ccc'\n    },\n    subLinkStyle: {\n      lineType: 'line',\n      lineRadius: 5,\n      lineWidth: '1px',\n      lineColor: '#43a9ff'\n    }\n  }\n};\n\nfunction ThemeSelectorPlugin() {\n  var themeMap = new Map([['default', defaultTheme], ['random-color-square', themeRandomColorSquare], ['theme1', theme1], ['theme2', theme2], ['theme3', theme3], ['theme4', theme4]]);\n  return {\n    getAllThemes: function getAllThemes(props) {\n      return themeMap;\n    },\n    setTheme: function setTheme(props) {\n      var model = props.model,\n          controller = props.controller,\n          themeKey = props.themeKey;\n      var allTheme = controller.run('getAllThemes', props);\n\n      if (!allTheme.has(themeKey)) {\n        throw new Error('setTheme: the theme key is not correct!');\n      }\n\n      var theme = allTheme.get(themeKey);\n      var newModel = ModelModifier.setTheme({\n        model: model,\n        theme: theme\n      });\n      controller.change(newModel);\n    }\n  };\n}\n\nexport { ThemeSelectorPlugin, theme1, theme2, theme3, theme4, themeRandomColorSquare };","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","var isProduction = process.env.NODE_ENV === 'production';\n\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import _get from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _assertThisInitialized from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _taggedTemplateLiteral from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _excluded = [\"title\"],\n    _excluded2 = [\"layout\", \"title\"],\n    _excluded3 = [\"layout\", \"title\"],\n    _excluded4 = [\"controller\", \"children\", \"onClick\"],\n    _excluded5 = [\"text\"];\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27, _templateObject28, _templateObject29, _templateObject30, _templateObject31, _templateObject32, _templateObject33, _templateObject34, _templateObject35, _templateObject36, _templateObject37, _templateObject38, _templateObject39, _templateObject40, _templateObject41, _templateObject42, _templateObject43, _templateObject44, _templateObject45, _templateObject46, _templateObject47, _templateObject48, _templateObject49, _templateObject50, _templateObject51, _templateObject52, _templateObject53, _templateObject54, _templateObject55, _templateObject56, _templateObject57;\n\nimport { Component, createElement, PureComponent, useState, Fragment } from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled, { css, ThemeProvider } from 'styled-components';\nimport debug from 'debug';\nimport { Checkbox, Divider, Popover, Button, NumericInput, InputGroup, MenuItem, Menu, Hotkey, Hotkeys, HotkeysTarget, PopoverPosition, Breadcrumb, Tooltip, Breadcrumbs, Dialog, Classes, ContextMenuTarget, PopoverInteractionKind, Position, Drawer, Tabs, Tab, Alert } from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport { SketchPicker } from 'react-color';\nimport { Model, FocusMode, OpType, DiagramLayoutType, getRelationship, TopicRelationship, getAllSubTopicKeys, ModelModifier, BlockType, TopicDirection, isThemeType, TopicVisualLevel, Controller } from '@blink-mind/core';\nimport '@blink-mind/icons';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport memoizeOne from 'memoize-one';\nimport { Stack, List } from 'immutable';\nimport cx from 'classnames';\nimport { cloneDeep, merge, isEqual } from 'lodash';\nimport plainSerializer from 'slate-plain-serializer';\nimport { Editor } from 'slate-react';\n\nvar BaseWidget = /*#__PURE__*/function (_Component) {\n  _inherits(BaseWidget, _Component);\n\n  var _super = _createSuper(BaseWidget);\n\n  function BaseWidget(props) {\n    _classCallCheck(this, BaseWidget);\n\n    return _super.call(this, props);\n  }\n\n  _createClass(BaseWidget, [{\n    key: \"operation\",\n    value: function operation(opType, arg) {\n      this.props.controller.run('operation', _objectSpread({\n        opType: opType\n      }, arg));\n    }\n  }, {\n    key: \"run\",\n    value: function run(name, arg) {\n      this.props.controller.run(name, arg);\n    }\n  }, {\n    key: \"topic\",\n    get: function get() {\n      return this.props.model.getTopic(this.props.topicKey);\n    }\n  }]);\n\n  return BaseWidget;\n}(Component);\n\nvar log = debug('node:drag-scroll-widget');\nvar DragScrollView = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"])));\nvar DragScrollContent = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  width: max-content;\\n\"])));\n\nvar DragScrollWidget = /*#__PURE__*/function (_Component2) {\n  _inherits(DragScrollWidget, _Component2);\n\n  var _super2 = _createSuper(DragScrollWidget);\n\n  function DragScrollWidget(props) {\n    var _this;\n\n    _classCallCheck(this, DragScrollWidget);\n\n    _this = _super2.call(this, props);\n\n    _this.contentResizeCallback = function (entries, observer) {\n      if (_this.oldContentRect) {\n        var widgetStyle = {\n          width: _this.content.clientWidth + _this.viewBox.clientWidth * 2,\n          height: _this.content.clientHeight + _this.viewBox.clientHeight * 2\n        };\n        _this.bigView.style.width = widgetStyle.width + 'px';\n        _this.bigView.style.height = widgetStyle.height + 'px';\n      }\n\n      _this.oldContentRect = entries[0].contentRect;\n    };\n\n    _this.contentResizeObserver = new ResizeObserver(_this.contentResizeCallback);\n\n    _this.contentRef = function (ref) {\n      if (ref) {\n        _this.content = ref;\n\n        _this.contentResizeObserver.observe(_this.content);\n      }\n    };\n\n    _this.viewBoxRef = function (ref) {\n      if (ref) {\n        _this.viewBox = ref;\n\n        if (!_this.props.enableMouseWheel) {\n          log('addEventListener onwheel');\n\n          _this.viewBox.addEventListener('wheel', function (e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          }, {\n            passive: false\n          });\n        }\n\n        _this.setViewBoxScroll(_this.viewBox.clientWidth, _this.viewBox.clientHeight);\n      }\n    };\n\n    _this.bigViewRef = function (ref) {\n      if (ref) {\n        _this.bigView = ref;\n      }\n    };\n\n    _this.setWidgetStyle = function () {\n      if (_this.content && _this.viewBox && _this.bigView) {\n        _this.bigView.style.width = (_this.content.clientWidth + _this.viewBox.clientWidth) * 2 + 'px';\n        _this.bigView.style.height = (_this.content.clientHeight + _this.viewBox.clientHeight) * 2 + 'px';\n        _this.content.style.left = _this.viewBox.clientWidth + 'px';\n        _this.content.style.top = _this.viewBox.clientHeight + 'px';\n      }\n    };\n\n    _this.setViewBoxScroll = function (left, top) {\n      log(\"setViewBoxScroll \".concat(left, \" \").concat(top));\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft = left;\n        _this.viewBox.scrollTop = top;\n      }\n    };\n\n    _this.setViewBoxScrollDelta = function (deltaLeft, deltaTop) {\n      log(\"setViewBoxScrollDelta \".concat(deltaLeft, \" \").concat(deltaTop));\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft += deltaLeft;\n        _this.viewBox.scrollTop += deltaTop;\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      // log('Drag Scroll onMouseDown');\n      // log(e.nativeEvent.target);\n      // mouseKey \n      // needKeyPressed ctrl\n      // canDragFunc\n      var _this$props = _this.props,\n          mouseKey = _this$props.mouseKey,\n          needKeyPressed = _this$props.needKeyPressed,\n          canDragFunc = _this$props.canDragFunc;\n      if (canDragFunc && !canDragFunc()) return;\n\n      if (e.button === 0 && mouseKey === 'left' || e.button === 2 && mouseKey === 'right') {\n        if (needKeyPressed) {\n          if (!e.ctrlKey) return;\n        }\n\n        _this._lastCoordX = _this.viewBox.scrollLeft + e.nativeEvent.clientX;\n        _this._lastCoordY = _this.viewBox.scrollTop + e.nativeEvent.clientY;\n        var ele = _this.viewBox;\n        ele.addEventListener('mousemove', _this.onMouseMove);\n        ele.addEventListener('mouseup', _this.onMouseUp);\n      }\n    };\n\n    _this.onMouseUp = function (e) {\n      var ele = _this.viewBox;\n      ele.removeEventListener('mousemove', _this.onMouseMove);\n      ele.removeEventListener('mouseup', _this.onMouseUp);\n    };\n\n    _this.onMouseMove = function (e) {\n      _this.viewBox.scrollLeft = _this._lastCoordX - e.clientX;\n      _this.viewBox.scrollTop = _this._lastCoordY - e.clientY; // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n    };\n\n    _this.handleContextMenu = function (e) {\n      e.preventDefault();\n    };\n\n    _this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n    return _this;\n  }\n\n  _createClass(DragScrollWidget, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setWidgetStyle();\n      document.addEventListener('contextmenu', this.handleContextMenu);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('contextmenu', this.handleContextMenu);\n    }\n  }, {\n    key: \"setZoomFactor\",\n    value: function setZoomFactor(zoomFactor) {\n      this.bigView.style.transform = \"scale(\".concat(zoomFactor, \")\");\n      this.bigView.style.transformOrigin = '50% 50%';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var style = _objectSpread({}, this.state.widgetStyle);\n\n      return createElement(DragScrollView, {\n        ref: this.viewBoxRef,\n        onMouseDown: this.onMouseDown\n      }, createElement(\"div\", {\n        style: style,\n        ref: this.bigViewRef\n      }, createElement(DragScrollContent, {\n        ref: this.contentRef,\n        style: this.state.contentStyle\n      }, this.props.children(this.setViewBoxScroll, this.setViewBoxScrollDelta))));\n    }\n  }]);\n\n  return DragScrollWidget;\n}(Component);\n\nDragScrollWidget.defaultProps = {\n  mouseKey: 'left',\n  needKeyPressed: false\n};\nvar log$1 = debug('node:save-ref'); //TODO ,topic\n\nvar SaveRef = /*#__PURE__*/function (_Component3) {\n  _inherits(SaveRef, _Component3);\n\n  var _super3 = _createSuper(SaveRef);\n\n  function SaveRef() {\n    var _this2;\n\n    _classCallCheck(this, SaveRef);\n\n    _this2 = _super3.apply(this, arguments);\n\n    _this2.getRef = function (name) {\n      log$1(_assertThisInitialized(_this2));\n      return _this2[name];\n    };\n\n    _this2.saveRef = function (name) {\n      return function (node) {\n        if (node) {\n          _this2[name] = node;\n\n          _this2.fireListener(name, node);\n        }\n      };\n    };\n\n    _this2.deleteRef = function (name) {\n      log$1('deleteRef:', name);\n      delete _this2[name];\n    };\n\n    _this2.observers = new Map();\n\n    _this2.fireListener = function (name, ref) {\n      if (_this2.observers.has(name)) {\n        var listeners = _this2.observers.get(name);\n\n        var _iterator = _createForOfIteratorHelper(listeners),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var listener = _step.value;\n            listener(name, ref);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    };\n\n    _this2.registerRefListener = function (name, listener) {\n      if (!_this2.observers.has(name)) {\n        _this2.observers.set(name, [listener]);\n      } else {\n        _this2.observers.get(name).push(listener);\n      }\n    };\n\n    return _this2;\n  }\n\n  _createClass(SaveRef, [{\n    key: \"render\",\n    value: function render() {\n      return this.props.children(this.saveRef, this.getRef, this.deleteRef, this.registerRefListener.bind(this));\n    }\n  }]);\n\n  return SaveRef;\n}(Component);\n\nvar Flex = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"])), function (props) {\n  return props.flexDirection ? props.flexDirection : 'row';\n}, function (props) {\n  return props.alignItems;\n}, function (props) {\n  return props.justifyContent;\n});\nvar Margin = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  margin: \", \";\\n\"])), function (props) {\n  return props.margin;\n});\nvar ShowMenuIcon = styled.a(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n  font-size: 20px !important;\\n\"])));\nvar IconBg = styled.div(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"])));\nvar Btn = styled.div(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"])));\nvar StyledCheckbox = styled(Checkbox)(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\\n  margin-bottom: 0px !important;\\n\"])));\nvar CloseIcon = styled(Btn)(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"])));\nvar Title = styled.div(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\\n  height: 16px;\\n\"])));\nvar TopicBlockIcon = styled.span(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"])));\nvar ZIndex = styled.div(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"\\n  z-index: \", \";\\n\"])), function (props) {\n  return props.zIndex;\n});\nvar PanelTabRoot = styled.div(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"\\n  min-width: 380px;\\n  max-width: 482px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"])));\nvar ToolbarItemPopoverTarget = styled.div(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar VListContainer = styled.div(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"\\n  max-height: \", \";\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n\"])), function (props) {\n  return props.maxHeight || '300px';\n});\nvar SettingTitle = styled.div(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"])));\nvar SettingItem = styled.span(_templateObject17 || (_templateObject17 = _taggedTemplateLiteral([\"\\n  margin: 0 10px 0 2px;\\n\"])));\nvar SettingBoxContainer = styled.div(_templateObject18 || (_templateObject18 = _taggedTemplateLiteral([\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"])));\nvar SettingLabel = styled(SettingItem)(_templateObject19 || (_templateObject19 = _taggedTemplateLiteral([\"\"])));\nvar SettingRow = styled.div(_templateObject20 || (_templateObject20 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"])));\nvar ColorBar = styled.div(_templateObject21 || (_templateObject21 = _taggedTemplateLiteral([\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"])), function (props) {\n  return props.color;\n});\nvar WithBorder = styled.div(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral([\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"])));\nvar IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile',\n  OPEN: 'open',\n  NEW_FILE: 'newfile',\n  SAVE: 'save',\n  LAYOUT_LEFT_AND_RIGHT: 'layout-left-and-right',\n  LAYOUT_LEFT: 'layout-left',\n  LAYOUT_RIGHT: 'layout-right',\n  UNDO: 'undo',\n  REDO: 'redo'\n};\n\nfunction iconClassName(name) {\n  return \"icon iconfont bm-\".concat(name);\n}\n\nfunction Icon(iconName) {\n  return createElement(\"span\", {\n    className: iconClassName(iconName)\n  });\n}\n\nfunction contentRefKey(key) {\n  return \"content-\".concat(key);\n}\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\".concat(key);\n}\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\".concat(key);\n}\n\nfunction topicWidgetRefKey(key) {\n  return \"topic-widget-\".concat(key);\n}\n\nfunction topicRefKey(key) {\n  return \"topic-\".concat(key);\n}\n\nfunction linksRefKey(key) {\n  return \"links-\".concat(key);\n}\n\nfunction linksSvgRefKey(key) {\n  return \"links-svg-\".concat(key);\n}\n\nfunction collapseRefKey(key) {\n  return \"collapse-\".concat(key);\n}\n\nfunction dropAreaRefKey(key, dir) {\n  return \"dropArea-\".concat(dir, \"-\").concat(key);\n}\n\nvar RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nvar EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\nvar PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE',\n  DRAG_DROP_STATE: 'DRAG_DROP_STATE',\n  RIGHT_TOP_PANEL_STATE: 'RIGHT_TOP_PANEL_STATE',\n  OPERATION_ENABLED: 'OPERATION_ENABLED'\n};\nvar I18nKey = {\n  CONFIRM: 'CONFIRM',\n  CANCEL: 'CANCEL',\n  DEFAULT: 'DEFAULT',\n  SEARCH: 'SEARCH',\n  LEFT_AND_RIGHT: 'LEFT_AND_RIGHT',\n  ONLY_LEFT: 'ONLY_LEFT',\n  ONLY_RIGHT: 'ONLY_RIGHT',\n  EDIT: 'EDIT',\n  ADD_SIBLING: 'ADD_SIBLING',\n  ADD_CHILD: 'ADD_CHILD',\n  EDIT_NOTES: 'EDIT_NOTES',\n  DELETE: 'DELETE',\n  SET_AS_EDITOR_ROOT: 'SET_AS_EDITOR_ROOT',\n  EDIT_TOPOLOGY_DIAGRAM: 'EDIT_TOPOLOGY_DIAGRAM',\n  SET_TOPIC_REFERENCES: 'SET_TOPIC_REFERENCES',\n  //========================================\n  TOPIC_STYLE: 'TOPIC_STYLE',\n  STYLE: 'STYLE',\n  TEXT_EDITOR: 'TEXT_EDITOR',\n  LINK: 'LINK',\n  LINK_TO_PARENT: 'LINK_TO_PARENT',\n  SUB_LINKS: 'SUB_LINKS',\n  COPY_STYLE: 'COPY_STYLE',\n  PASTE_STYLE: 'PASTE_STYLE',\n  CLEAR_TOPIC_STYLE: 'CLEAR_TOPIC_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  LINE_TYPE: 'LINE_TYPE',\n  //=======================================\n  THEME: 'THEME',\n  GLOBAL: 'GLOBAL',\n  HIGHLIGHT: 'HIGHLIGHT',\n  RANDOM_COLOR: 'RANDOM_COLOR',\n  NORMAL_TOPIC: 'NORMAL_TOPIC',\n  PRIMARY_TOPIC: 'PRIMARY_TOPIC',\n  ROOT_TOPIC: 'ROOT_TOPIC',\n  EXPORT_THEME: 'EXPORT_THEME',\n  IMPORT_THEME: 'IMPORT_THEME',\n  //=======================================\n  TAGS: 'TAGS',\n  TAGS_MANAGER: 'TAGS_MANAGER',\n  TAG_NAME: 'TAG_NAME',\n  ADD_TAG: 'ADD_TAG',\n  UPDATE_TAG: 'UPDATE_TAG',\n  ALREADY_ADDED: 'ALREADY_ADDED',\n  CAN_BE_ADDED: 'CAN_BE_ADDED',\n  TOPICS_THAT_USE_THIS_TAG: 'TOPICS_THAT_USE_THIS_TAG',\n  //=======================================\n  BACKGROUND: 'BACKGROUND',\n  COLOR: 'COLOR',\n  BORDER: 'BORDER',\n  WIDTH: 'WIDTH',\n  RADIUS: 'RADIUS',\n  FONT_SIZE: 'FONT_SIZE',\n  LINE_HEIGHT: 'LINE_HEIGHT',\n  PADDING: 'PADDING',\n  TOP: 'TOP',\n  BOTTOM: 'BOTTOM',\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  NONE: 'NONE',\n  SOLID: 'SOLID',\n  DOTTED: 'DOTTED',\n  DASHED: 'DASHED',\n  DOUBLE: 'DOUBLE',\n  ROUND: 'ROUND',\n  CURVE: 'CURVE',\n  LINE: 'LINE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC',\n  ZOOM: 'ZOOM',\n  ZOOM_IN: 'ZOOM_IN',\n  ZOOM_OUT: 'ZOOM_OUT',\n  RESET: 'RESET',\n  RESET_ZOOM: 'RESET_ZOOM',\n  NOTE_PLACEHOLDER: \"NOTE_PLACEHOLDER\",\n  TOPOLOGY_DIAGRAM_EDITOR: 'TOPOLOGY_DIAGRAM_EDITOR',\n  BASIC: 'BASIC',\n  FLOW_GRAPH: 'FLOW_GRAPH',\n  ACTIVITY_DIAGRAM: 'ACTIVITY_DIAGRAM',\n  SEQUENCE_DIAGRAM: 'SEQUENCE_DIAGRAM',\n  CLASS_DIAGRAM: 'CLASS_DIAGRAM',\n  REFERENCE_TOPICS: \"REFERENCE_TOPICS\",\n  REFERENCED_TOPICS: \"REFERENCED_TOPICS\",\n  SELECT_REF_TOPICS_TIP: 'SELECT_REF_TOPICS_TIP',\n  TAG_NAME_OVER_MAX_TIP: 'TAG_NAME_OVER_MAX_TIP',\n  DELETE_TAG_TIP: 'DELETE_TAG_TIP',\n  DELETE_TOPOLOGY_TIP: 'DELETE_TOPOLOGY_TIP'\n};\n\nvar cancelEvent = function cancelEvent(e) {\n  e.stopPropagation();\n};\n\nfunction browserDownloadFile(url, filename) {\n  var link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nfunction browserDownloadText(text, filename) {\n  var url = \"data:text/plain,\".concat(encodeURIComponent(text));\n  browserDownloadFile(url, filename);\n}\n\nfunction browserOpenFile(accept) {\n  var input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n  return new Promise(function (resolve, reject) {\n    input.addEventListener('change', function (evt) {\n      //@ts-ignore\n      var file = evt.target.files[0];\n      var fr = new FileReader();\n\n      fr.onload = function (evt) {\n        var txt = evt.target.result; //@ts-ignore\n\n        resolve(txt);\n      };\n\n      fr.onerror = function (evt) {\n        reject(evt.target.error);\n      };\n\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n\nfunction paddingCss(arg) {\n  var _arg$top = arg.top,\n      top = _arg$top === void 0 ? 0 : _arg$top,\n      _arg$right = arg.right,\n      right = _arg$right === void 0 ? 0 : _arg$right,\n      _arg$bottom = arg.bottom,\n      bottom = _arg$bottom === void 0 ? 0 : _arg$bottom,\n      _arg$left = arg.left,\n      left = _arg$left === void 0 ? 0 : _arg$left;\n  return \"\".concat(top, \"px \").concat(right, \"px \").concat(bottom, \"px \").concat(left, \"px\");\n} // import { I18nKey } from './keys';\n\n\nfunction getI18nText(ctx, key) {\n  if (Array.isArray(key)) {\n    return key.map(function (k) {\n      return ctx.controller.run('getI18nText', _objectSpread(_objectSpread({}, ctx), {}, {\n        key: k\n      }));\n    });\n  }\n\n  return ctx.controller.run('getI18nText', _objectSpread(_objectSpread({}, ctx), {}, {\n    key: key.toUpperCase()\n  }));\n} // export function getCssI18nText(ctx, cssName) {\n//   const cssNames = {\n//     none: I18nKey.NONE,\n//     solid: I18nKey.SOLID,\n//     dotted: I18nKey.DOTTED,\n//     dashed: I18nKey.DASHED,\n//     double: I18nKey.DOUBLE,\n//\n//     round: I18nKey.ROUND,\n//     curve: I18nKey.CURVE,\n//\n//   };\n//\n//   return getI18nText(ctx, cssNames[cssName]);\n// }\n\n\nfunction getLinkKey(fromKey, toKey) {\n  return \"link-\".concat(fromKey, \"-\").concat(toKey);\n}\n\nfunction centerY(rect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nfunction centerX(rect) {\n  return (rect.left + rect.right) / 2;\n}\n\nfunction centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nfunction centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nfunction center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\n\nfunction _getRelativeRect(el, rel) {\n  var scale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  var width = rect.width / scale;\n  var height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getRelativeVector(el, rel) {\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  return [elCenter[0] - relCenter[0], elCenter[1] - relCenter[1]];\n}\n\nfunction SettingGroup(props) {\n  return createElement(\"div\", null, props.children, createElement(Divider, {\n    style: {\n      margin: '10px 0'\n    }\n  }));\n}\n\nfunction SettingItemColorPicker(props) {\n  var title = props.title,\n      _props$layout = props.layout,\n      layout = _props$layout === void 0 ? 'h' : _props$layout,\n      color = props.color,\n      handleColorChange = props.handleColorChange;\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), title != null && createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(Popover, null, createElement(WithBorder, null, createElement(\"div\", {\n    className: iconClassName(IconName.COLOR_PICKER)\n  }), createElement(ColorBar, {\n    color: color\n  })), createElement(\"div\", null, createElement(SketchPicker, {\n    color: color,\n    onChangeComplete: function onChangeComplete(color) {\n      return handleColorChange(color.hex);\n    }\n  })))));\n}\n\nfunction SettingItemButton(props) {\n  var title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  return createElement(SettingItem, null, createElement(Button, Object.assign({}, restProps), title));\n}\n\nfunction SettingItemNumericInput(props) {\n  var _props$layout2 = props.layout,\n      layout = _props$layout2 === void 0 ? 'h' : _props$layout2,\n      title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded2);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(NumericInput, Object.assign({}, restProps))));\n}\n\nfunction SettingItemInput(props) {\n  var _props$layout3 = props.layout,\n      layout = _props$layout3 === void 0 ? 'h' : _props$layout3,\n      title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded3);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title, \" \"), createElement(InputGroup, Object.assign({}, restProps))));\n}\n\nfunction SettingItemSelect(props) {\n  var text = props.text,\n      items = props.items,\n      itemRenderer = props.itemRenderer,\n      onItemSelect = props.onItemSelect;\n  var PxSelect = Select.ofType();\n  var pxProps = {\n    items: items,\n    itemRenderer: itemRenderer,\n    onItemSelect: onItemSelect,\n    filterable: false\n  };\n  return createElement(SettingItem, null, createElement(PxSelect, Object.assign({}, pxProps), createElement(Button, {\n    text: text\n  })));\n}\n\nvar renderItem = function renderItem(unit) {\n  return function (v, _ref) {\n    var handleClick = _ref.handleClick;\n    return createElement(MenuItem, {\n      text: \"\".concat(v).concat(unit),\n      key: v,\n      onClick: handleClick\n    });\n  };\n};\n\nvar renderItemI18n = function renderItemI18n(ctx) {\n  return function (v, _ref2) {\n    var handleClick = _ref2.handleClick;\n    return createElement(MenuItem, {\n      text: getI18nText(ctx, v),\n      key: v,\n      onClick: handleClick\n    });\n  };\n};\n\nvar PxSelect = Select.ofType();\n\nvar borderWidthItems = _toConsumableArray(Array(7).keys());\n\nvar ToolbarItemRoot = styled.div(_templateObject23 || (_templateObject23 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  padding: 6px;\\n  width: 40px;\\n  height: 40px;\\n  cursor: pointer;\\n  color: \", \";\\n  font-size: 24px;\\n  display: inline-block;\\n  &:hover {\\n    color: \", \";\\n  }\\n\"])), function (props) {\n  return props.disabled ? 'grey' : 'black';\n}, function (props) {\n  return props.disabled ? 'grey' : 'rgb(44, 184, 146)';\n});\n\nfunction ToolbarItem(props) {\n  var controller = props.controller,\n      children = props.children,\n      onClick = props.onClick,\n      restProps = _objectWithoutProperties(props, _excluded4);\n\n  var disabled = props.disabled;\n  disabled = disabled || !controller.getValue(PropKey.OPERATION_ENABLED, props);\n\n  var handleClick = function handleClick(e) {\n    if (!disabled) onClick(e);\n  };\n\n  var nProps = _objectSpread({\n    controller: controller,\n    disabled: disabled,\n    onClick: handleClick\n  }, restProps);\n\n  return createElement(ToolbarItemRoot, Object.assign({}, nProps), children);\n}\n\nfunction CreateModelPlugin() {\n  return {\n    createNewModel: function createNewModel(props) {\n      return Model.createEmpty();\n    }\n  };\n}\n\nvar log$2 = debug('plugin:event');\n\nfunction EventPlugin() {\n  var eventListeners = {};\n  return {\n    handleTopicClick: function handleTopicClick(props) {\n      log$2('handleTopicClick');\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey;\n      log$2(model.zoomFactor); //TODO\n\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (model.focusKey === topicKey && model.focusMode === FocusMode.EDITING_CONTENT) return;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      }));\n    },\n    handleTopicDoubleClick: function handleTopicDoubleClick(props) {\n      var controller = props.controller,\n          model = props.model;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      }));\n    },\n    handleTopicContextMenu: function handleTopicContextMenu(props) {\n      var controller = props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n    },\n    handleActiveModalClose: function handleActiveModalClose(props) {\n      var controller = props.controller;\n      var activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n\n      if (activeModalProps.name === 'edit-desc') {\n        return function () {\n          controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          }));\n        };\n      }\n    },\n    addEventListener: function addEventListener(props) {\n      var key = props.key,\n          listener = props.listener,\n          once = props.once,\n          controller = props.controller;\n      if (!eventListeners[key]) eventListeners[key] = [];\n\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key: key,\n          listener: listener\n        });\n      }\n    },\n    removeEventListener: function removeEventListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(function (fn) {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n    fireEvent: function fireEvent(props) {\n      var key = props.key;\n\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(function (fn) {\n          return fn();\n        });\n      }\n    }\n  };\n}\n\nfunction GetValuePlugin() {\n  return {\n    getValue: function getValue(props, next) {\n      var propKey = props.propKey,\n          controller = props.controller,\n          diagramState = props.diagramState;\n\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.OPERATION_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n\n        case PropKey.DRAG_DROP_STATE:\n          return diagramState.dragDrop;\n\n        case PropKey.RIGHT_TOP_PANEL_STATE:\n          return diagramState.rightTopPanel;\n      }\n\n      return next();\n    }\n  };\n}\n\nvar HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\nvar MoveTopicDir = {\n  CENTER: 0,\n  LEFT_CENTER: 1\n};\n\nfunction op(opType, props) {\n  var _props = props,\n      topicKey = _props.topicKey,\n      model = _props.model,\n      controller = _props.controller;\n\n  if (topicKey === undefined) {\n    props = _objectSpread(_objectSpread({}, props), {}, {\n      topicKey: model.focusKey\n    });\n  }\n\n  controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n    opType: opType\n  }));\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys: function customizeHotKeys(props) {\n      var handleKeyDown = function handleKeyDown(opType) {\n        return function (e) {\n          // log('HotKeyPlugin', opType);\n          op(opType, props);\n        };\n      };\n\n      var topicHotKeys = new Map([[HotKeyName.ADD_CHILD, {\n        label: 'add child',\n        combo: 'tab',\n        onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n      }], [HotKeyName.ADD_SIBLING, {\n        label: 'add sibling',\n        combo: 'enter',\n        onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n      }], [HotKeyName.DELETE_TOPIC, {\n        label: 'delete topic',\n        combo: 'del',\n        onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n      }], [HotKeyName.EDIT_CONTENT, {\n        label: 'edit content',\n        combo: 'space',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n      }], [HotKeyName.EDIT_NOTES, {\n        label: 'edit notes',\n        combo: 'alt + d',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n      }], [HotKeyName.SET_EDITOR_ROOT, {\n        label: 'set editor root',\n        combo: 'alt + shift + f',\n        onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n      }]]);\n      var globalHotKeys = new Map();\n      return {\n        topicHotKeys: topicHotKeys,\n        globalHotKeys: globalHotKeys\n      };\n    }\n  };\n}\n\nfunction I18nPlugin() {\n  var i18nTextMap = new Map([[I18nKey.CONFIRM, 'Confirm'], [I18nKey.CANCEL, 'Cancel'], [I18nKey.DEFAULT, 'Default'], [I18nKey.SEARCH, 'Search'], [I18nKey.LEFT_AND_RIGHT, 'Left And Right'], [I18nKey.ONLY_LEFT, 'Only Left'], [I18nKey.ONLY_RIGHT, 'Only Right'], [I18nKey.EDIT, 'Edit'], [I18nKey.ADD_CHILD, 'Add Child'], [I18nKey.ADD_SIBLING, 'Add Sibling'], [I18nKey.EDIT_NOTES, 'Edit Notes'], [I18nKey.DELETE, 'Delete'], [I18nKey.SET_AS_EDITOR_ROOT, 'Set as Editor Root'], [I18nKey.EDIT_TOPOLOGY_DIAGRAM, 'Edit Topology Diagram'], [I18nKey.SET_TOPIC_REFERENCES, 'Set Topic References'], [I18nKey.TOPIC_STYLE, 'TopicStyle'], [I18nKey.STYLE, 'Style'], [I18nKey.TEXT_EDITOR, 'Text Editor'], [I18nKey.LINK, 'Link'], [I18nKey.LINK_TO_PARENT, 'LinkToParent'], [I18nKey.SUB_LINKS, 'SubLinks'], [I18nKey.COPY_STYLE, 'Copy Style'], [I18nKey.PASTE_STYLE, 'Paste Style'], [I18nKey.CLEAR_TOPIC_STYLE, 'Clear Topic Style'], [I18nKey.CLEAR_ALL_CUSTOM_STYLE, 'Clear All Custom Style'], [I18nKey.LINE_TYPE, 'LineType'], [I18nKey.THEME, 'Theme'], [I18nKey.GLOBAL, 'Global'], [I18nKey.HIGHLIGHT, 'Highlight'], [I18nKey.RANDOM_COLOR, 'Random Color'], [I18nKey.NORMAL_TOPIC, 'NormalTopic'], [I18nKey.PRIMARY_TOPIC, 'PrimaryTopic'], [I18nKey.ROOT_TOPIC, 'RootTopic'], [I18nKey.EXPORT_THEME, 'Export Theme'], [I18nKey.IMPORT_THEME, 'Import Theme'], [I18nKey.TAGS, 'Tags'], [I18nKey.TAGS_MANAGER, 'Tags Manager'], [I18nKey.TAG_NAME, 'Tag Name'], [I18nKey.ADD_TAG, 'Add Tag'], [I18nKey.UPDATE_TAG, 'Update Tag'], [I18nKey.ALREADY_ADDED, 'Already Added'], [I18nKey.CAN_BE_ADDED, 'Can be Added'], [I18nKey.TOPICS_THAT_USE_THIS_TAG, 'Topics that Use this Tag'], [I18nKey.BACKGROUND, 'Background'], [I18nKey.COLOR, 'Color'], [I18nKey.BORDER, 'Border'], [I18nKey.WIDTH, 'Width'], [I18nKey.RADIUS, 'Radius'], [I18nKey.FONT_SIZE, 'FontSize'], [I18nKey.LINE_HEIGHT, 'LineHeight'], [I18nKey.PADDING, 'Padding'], [I18nKey.TOP, 'Top'], [I18nKey.BOTTOM, 'Bottom'], [I18nKey.LEFT, 'Left'], [I18nKey.RIGHT, 'Right'], [I18nKey.NONE, 'None'], [I18nKey.SOLID, 'Solid'], [I18nKey.DOTTED, 'Dotted'], [I18nKey.DASHED, 'Dashed'], [I18nKey.DOUBLE, 'Double'], [I18nKey.ROUND, 'Round'], [I18nKey.CURVE, 'Curve'], [I18nKey.LINE, 'Line'], [I18nKey.COLLAPSE_ALL, 'Collapse All'], [I18nKey.EXPAND_ALL, 'Expand All'], [I18nKey.CENTER_ROOT_TOPIC, 'Center Root Topic'], [I18nKey.ZOOM, 'zoom'], [I18nKey.ZOOM_IN, 'Zoom In'], [I18nKey.ZOOM_OUT, 'Zoom Out'], [I18nKey.RESET, 'Reset'], [I18nKey.RESET_ZOOM, 'Reset Zoom'], [I18nKey.NOTE_PLACEHOLDER, 'Write topic notes here'], [I18nKey.TOPOLOGY_DIAGRAM_EDITOR, 'Topology Diagram Editor'], [I18nKey.BASIC, 'Basic'], [I18nKey.FLOW_GRAPH, 'Flow Graph'], [I18nKey.ACTIVITY_DIAGRAM, 'Activity Diagram'], [I18nKey.SEQUENCE_DIAGRAM, 'Sequence Diagram'], [I18nKey.CLASS_DIAGRAM, 'Class Diagram'], [I18nKey.REFERENCE_TOPICS, 'Reference Topics'], [I18nKey.REFERENCED_TOPICS, 'Referenced Topics'], [I18nKey.SELECT_REF_TOPICS_TIP, 'Please select the topics you want to reference. After selection, click the confirm button.'], [I18nKey.TAG_NAME_OVER_MAX_TIP, 'The length of tag name over the maximum length: 50!'], [I18nKey.DELETE_TAG_TIP, 'All the relationship about this tag will be lost if you delete this tag! Are you confirm?'], [I18nKey.DELETE_TOPOLOGY_TIP, 'Are you confirm to delete this topology diagram?']]);\n  return {\n    getI18nTextMap: function getI18nTextMap() {\n      return i18nTextMap;\n    },\n    getI18nText: function getI18nText(ctx) {\n      var controller = ctx.controller,\n          key = ctx.key;\n      var m = controller.run('getI18nTextMap', ctx);\n\n      if (!m.has(key)) {\n        throw new Error(\"i18n key \".concat(key, \" is not exist\"));\n      }\n\n      return m.get(key);\n    }\n  };\n}\n\nfunction LayoutPlugin() {\n  var _zoomFactor = 1;\n  return {\n    getPartTopics: function getPartTopics(_ref3) {\n      var layout = _ref3.layout,\n          model = _ref3.model,\n          topicKey = _ref3.topicKey;\n      var topic = model.getTopic(topicKey);\n      var subTopicCount = topic.subKeys.size;\n      var topics = topic.subKeys.toArray();\n\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return {\n            R: topics\n          };\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return {\n            L: topics\n          };\n\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n    createSubTopics: function createSubTopics(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          topics = props.topics,\n          saveRef = props.saveRef;\n      var topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      var subTopics = [];\n      topics.forEach(function (tKey) {\n        var topicProps = _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        });\n\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return {\n        subTopics: subTopics\n      };\n    },\n    layout: function layout(props) {\n      var getRef = props.getRef,\n          model = props.model;\n      var links = getRef(linksRefKey(model.editorRootTopicKey));\n      var highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY);\n      var dropEffect = getRef(RefKey.DROP_EFFECT_KEY);\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n      var editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic) {\n        if (topic.key !== model.editorRootTopicKey) {\n          var topicWidget = getRef(topicWidgetRefKey(topic.key));\n          topicWidget && topicWidget.layoutLinks();\n        }\n\n        if (!topic.collapse) {\n          var _iterator2 = _createForOfIteratorHelper(topic.subKeys),\n              _step2;\n\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var subKey = _step2.value;\n              layoutTopic(model.getTopic(subKey));\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n        }\n      }\n    },\n    getRelativeRect: function getRelativeRect(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return _getRelativeRect(element, bigView, zoomFactor);\n    },\n    getRelativeRectFromViewPort: function getRelativeRectFromViewPort(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return _getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort: function getRelativeVectorFromViewPort(props) {\n      var element = props.element,\n          getRef = props.getRef;\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n    addZoomFactorChangeEventListener: function addZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('addTempValueChangeListener', _objectSpread({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    removeZoomFactorChangeEventListener: function removeZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('removeTempValueChangeListener', _objectSpread({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    setZoomFactor: function setZoomFactor(props) {\n      var controller = props.controller,\n          zoomFactor = props.zoomFactor;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n    getZoomFactor: function getZoomFactor(props) {\n      var controller = props.controller;\n      return controller.run('getTempValue', {\n        key: 'ZoomFactor'\n      }) || _zoomFactor;\n    },\n    moveTopicToCenter: function moveTopicToCenter(props) {\n      var getRef = props.getRef,\n          topicKey = props.topicKey,\n          model = props.model,\n          _props$moveDir = props.moveDir,\n          moveDir = _props$moveDir === void 0 ? MoveTopicDir.LEFT_CENTER : _props$moveDir;\n\n      if (model.editorRootTopicKey !== topicKey && getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n        throw new Error(\"moveTopicToCenter error: topicKey \".concat(topicKey, \" is not the DESCENDANT of editor root topic\"));\n      }\n\n      var topic = getRef(topicRefKey(topicKey));\n      var dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      var viewBox = dragScroll.viewBox;\n\n      if (!topic || !viewBox) {\n        throw new Error(\"moveTopicToCenter error: topic or viewBox is null\");\n      }\n\n      var vector = getRelativeVector(topic, viewBox); //TODO\n\n      if (moveDir === MoveTopicDir.CENTER) dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);else if (moveDir === MoveTopicDir.LEFT_CENTER) {\n        var boxRect = viewBox.getBoundingClientRect();\n        var topicRect = topic.getBoundingClientRect();\n        var delta = (boxRect.width - topicRect.width) / 2;\n        dragScroll.setViewBoxScrollDelta(vector[0] + delta - 200, vector[1]);\n      }\n    },\n    focusTopicAndMoveToCenter: function focusTopicAndMoveToCenter(props) {\n      var controller = props.controller,\n          topicKey = props.topicKey;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opArray: [{\n          opType: OpType.FOCUS_TOPIC,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL\n        }, {\n          opType: OpType.EXPAND_TO,\n          topicKey: topicKey\n        }],\n        allowUndo: false,\n        callback: function callback(model) {\n          return function () {\n            controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, props), {}, {\n              model: model,\n              topicKey: topicKey\n            }));\n          };\n        }\n      }));\n    }\n  };\n}\n\nvar log$3 = debug('plugin:operation');\n\nfunction OperationPlugin() {\n  var startEditingContent = function startEditingContent(_ref4) {\n    var model = _ref4.model,\n        topicKey = _ref4.topicKey;\n    return ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n\n  var startEditingDesc = function startEditingDesc(_ref5) {\n    var model = _ref5.model,\n        topicKey = _ref5.topicKey;\n    var topic = model.getTopic(topicKey);\n    var desc = topic.getBlock(BlockType.DESC);\n\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model: model,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    var srcKey = props.srcKey,\n        dstKey = props.dstKey,\n        dropDir = props.dropDir;\n    var model = props.model;\n    var srcTopic = model.getTopic(srcKey);\n    var dstTopic = model.getTopic(dstKey);\n    var srcParentKey = srcTopic.parentKey;\n    var srcParentTopic = model.getTopic(srcParentKey);\n    var srcParentSubKeys = srcParentTopic.subKeys;\n    var srcIndex = srcParentSubKeys.indexOf(srcKey);\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      var dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(function (m) {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstKey).setIn(['topics', dstKey, 'subKeys'], dstSubKeys).setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      var dstParentKey = dstTopic.parentKey;\n      var dstParentItem = model.getTopic(dstParentKey);\n      var dstParentSubKeys = dstParentItem.subKeys;\n      var dstIndex = dstParentSubKeys.indexOf(dstKey); //src  dst \n\n      if (srcParentKey === dstParentKey) {\n        var newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(function (key) {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys.push(srcKey).push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys.push(key).push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstParentKey).setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys).setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n\n    return model;\n  }\n\n  var OpMap = new Map([[OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse], [OpType.COLLAPSE_ALL, ModelModifier.collapseAll], [OpType.EXPAND_ALL, ModelModifier.expandAll], [OpType.EXPAND_TO, ModelModifier.expandTo], [OpType.ADD_CHILD, ModelModifier.addChild], [OpType.ADD_SIBLING, ModelModifier.addSibling], [OpType.DELETE_TOPIC, ModelModifier.deleteTopic], [OpType.FOCUS_TOPIC, ModelModifier.focusTopic], [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode], [OpType.SET_STYLE, ModelModifier.setStyle], [OpType.CLEAR_ALL_CUSTOM_STYLE, ModelModifier.clearAllCustomStyle], [OpType.SET_THEME, ModelModifier.setTheme], [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData], [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock], [OpType.START_EDITING_CONTENT, startEditingContent], [OpType.START_EDITING_DESC, startEditingDesc], [OpType.DRAG_AND_DROP, dragAndDrop], [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey], [OpType.SET_LAYOUT_DIR, ModelModifier.setLayoutDir]]);\n  var undoStack = Stack();\n  var redoStack = Stack();\n  var enabled = true;\n  var whiteListOperation = new Set();\n  return {\n    isOperationEnabled: function isOperationEnabled(props) {\n      return enabled;\n    },\n    enableOperation: function enableOperation() {\n      enabled = true;\n    },\n    disableOperation: function disableOperation(_ref6) {\n      var whiteList = _ref6.whiteList;\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\r\n     * for example: A plugin can write a function\r\n     * getOpMap(ctx,next) {\r\n     *   let opMap = next();\r\n     *   opMap.set(\"OpTypeName\",opFunc);\r\n     *   return opMap;\r\n     * }\r\n     * @param ctx\r\n     */\n    getOpMap: function getOpMap(ctx) {\n      return OpMap;\n    },\n    //undo\n    getAllowUndo: function getAllowUndo(ctx) {\n      var model = ctx.model,\n          opType = ctx.opType,\n          _ctx$allowUndo = ctx.allowUndo,\n          allowUndo = _ctx$allowUndo === void 0 ? true : _ctx$allowUndo;\n      if (allowUndo === false) return false;\n\n      if (opType) {\n        switch (opType) {\n          // undo \n          case OpType.FOCUS_TOPIC:\n          case OpType.SET_FOCUS_MODE:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n        }\n      }\n\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n\n      return model.config.allowUndo;\n    },\n    getUndoRedoStack: function getUndoRedoStack() {\n      return {\n        undoStack: undoStack,\n        redoStack: redoStack\n      };\n    },\n    setUndoStack: function setUndoStack(ctx) {\n      log$3('setUndoStack', ctx.undoStack);\n      undoStack = ctx.undoStack;\n    },\n    setRedoStack: function setRedoStack(ctx) {\n      log$3('setRedoStack', ctx.redoStack);\n      redoStack = ctx.redoStack;\n    },\n    canUndo: function canUndo(ctx) {\n      var controller = ctx.controller;\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n      if (!isOperationEnabled) return false;\n\n      var _controller$run = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run.undoStack;\n\n      var allowUndo = controller.run('getAllowUndo', ctx);\n      return undoStack.size > 0 && allowUndo;\n    },\n    canRedo: function canRedo(ctx) {\n      var controller = ctx.controller;\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n      if (!isOperationEnabled) return false;\n\n      var _controller$run2 = controller.run('getUndoRedoStack', ctx),\n          redoStack = _controller$run2.redoStack;\n\n      var allowUndo = controller.run('getAllowUndo', ctx);\n      return redoStack.size > 0 && allowUndo;\n    },\n    undo: function undo(ctx) {\n      var controller = ctx.controller,\n          model = ctx.model;\n\n      if (!controller.run('getAllowUndo', ctx)) {\n        return;\n      }\n\n      var _controller$run3 = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run3.undoStack,\n          redoStack = _controller$run3.redoStack;\n\n      var newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        undoStack: undoStack.shift()\n      }));\n      controller.run('setRedoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        redoStack: redoStack.push(model)\n      }));\n      log$3(newModel);\n      controller.change(newModel);\n    },\n    redo: function redo(ctx) {\n      var controller = ctx.controller,\n          model = ctx.model;\n\n      if (!controller.run('getAllowUndo', ctx)) {\n        return;\n      }\n\n      var _controller$run4 = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run4.undoStack,\n          redoStack = _controller$run4.redoStack;\n\n      var newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        undoStack: undoStack.push(model)\n      }));\n      controller.run('setRedoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        redoStack: redoStack.shift()\n      }));\n      controller.change(newModel);\n    },\n    //TODO \n    operation: function operation(ctx) {\n      var controller = ctx.controller,\n          opType = ctx.opType,\n          model = ctx.model,\n          opArray = ctx.opArray,\n          callback = ctx.callback;\n\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          var opNotInWhiteList = opArray.filter(function (op) {\n            return !whiteListOperation.has(op.opType);\n          });\n\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log$3('operation:', opType || opArray.map(function (op) {\n        return op.opType;\n      }));\n      log$3('operation:', model);\n      log$3('operation:', ctx);\n      var opMap = controller.run('getOpMap', ctx);\n      controller.run('beforeOperation', ctx);\n\n      if (controller.run('getAllowUndo', ctx)) {\n        var _controller$run5 = controller.run('getUndoRedoStack', ctx),\n            _undoStack = _controller$run5.undoStack;\n\n        controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n          undoStack: _undoStack.push(model)\n        }));\n      }\n\n      var newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce(function (acc, cur) {\n          var opType = cur.opType;\n          if (!opMap.has(opType)) throw new Error(\"opType:\".concat(opType, \" not exist!\"));\n          var opFunc = opMap.get(opType);\n\n          var opFuncProps = _objectSpread(_objectSpread({\n            controller: controller\n          }, cur), {}, {\n            model: acc\n          });\n\n          var res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc(_objectSpread(_objectSpread({}, opFuncProps), {}, {\n            model: res\n          }));\n          res = controller.run('afterOpFunction', _objectSpread(_objectSpread({}, opFuncProps), {}, {\n            model: res\n          }));\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(\"opType:\".concat(opType, \" not exist!\"));\n        var opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', ctx);\n        newModel = opFunc(_objectSpread(_objectSpread({}, ctx), {}, {\n          model: newModel\n        }));\n        newModel = controller.run('afterOpFunction', _objectSpread(_objectSpread({}, ctx), {}, {\n          model: newModel\n        }));\n      }\n\n      log$3('newModel:', newModel);\n      controller.change(newModel, callback ? callback(newModel) : null);\n      controller.run('afterOperation', ctx);\n    },\n    deleteRefKey: function deleteRefKey(ctx) {\n      var model = ctx.model,\n          topicKey = ctx.topicKey,\n          deleteRef = ctx.deleteRef;\n      var allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n\n      var _iterator3 = _createForOfIteratorHelper(allSubKeys),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var key = _step3.value;\n          deleteRef(linksRefKey(key));\n          deleteRef(linksSvgRefKey(key));\n          deleteRef(contentRefKey(key));\n          deleteRef(contentEditorRefKey(key));\n          deleteRef(descEditorRefKey(key));\n          deleteRef(topicWidgetRefKey(key));\n          deleteRef(topicRefKey(key));\n          deleteRef(collapseRefKey(key));\n          deleteRef(dropAreaRefKey(key, 'next'));\n          deleteRef(dropAreaRefKey(key, 'prev'));\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    },\n    // Operation\n    beforeOperation: function beforeOperation(props) {},\n    afterOperation: function afterOperation(props) {},\n    // OpFunction\n    beforeOpFunction: function beforeOpFunction(ctx) {\n      var controller = ctx.controller,\n          opType = ctx.opType,\n          model = ctx.model,\n          topicKey = ctx.topicKey;\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        controller.run('deleteRefKey', ctx);\n      }\n\n      return model;\n    },\n    afterOpFunction: function afterOpFunction(ctx) {\n      return ctx.model;\n    },\n    openNewModel: function openNewModel(ctx) {\n      var model = ctx.model,\n          controller = ctx.controller,\n          newModel = ctx.newModel;\n      controller.run('deleteRefKey', _objectSpread(_objectSpread({}, ctx), {}, {\n        topicKey: model.rootTopicKey\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, ctx), {}, {\n        opType: OpType.EXPAND_TO,\n        topicKey: newModel.focusKey,\n        model: newModel,\n        callback: function callback(model) {\n          return function () {\n            controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, ctx), {}, {\n              model: model,\n              topicKey: model.focusKey\n            }));\n          };\n        }\n      }));\n    }\n  };\n}\n\nvar TopicContextMenu = /*#__PURE__*/function (_BaseWidget) {\n  _inherits(TopicContextMenu, _BaseWidget);\n\n  var _super4 = _createSuper(TopicContextMenu);\n\n  function TopicContextMenu() {\n    _classCallCheck(this, TopicContextMenu);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(TopicContextMenu, [{\n    key: \"render\",\n    value: function render() {\n      var controller = this.props.controller;\n      return createElement(Menu, null, controller.run('customizeTopicContextMenu', this.props));\n    }\n  }]);\n\n  return TopicContextMenu;\n}(BaseWidget);\n\nvar items = [{\n  icon: 'edit',\n  label: I18nKey.EDIT,\n  shortcut: 'Space',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_CONTENT\n}, {\n  icon: 'add-sibling',\n  label: I18nKey.ADD_SIBLING,\n  shortcut: 'Enter',\n  opType: OpType.ADD_SIBLING\n}, {\n  icon: 'add-child',\n  label: I18nKey.ADD_CHILD,\n  shortcut: 'Tab',\n  rootCanUse: true,\n  opType: OpType.ADD_CHILD\n}, {\n  icon: 'notes',\n  label: I18nKey.EDIT_NOTES,\n  shortcut: 'Alt + D',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_DESC\n}, {\n  icon: 'delete-node',\n  label: I18nKey.DELETE,\n  shortcut: 'Del',\n  opType: OpType.DELETE_TOPIC\n}, {\n  icon: 'root',\n  label: I18nKey.SET_AS_EDITOR_ROOT,\n  shortcut: 'Alt + Shift + F',\n  opType: OpType.SET_EDITOR_ROOT\n}];\n\nfunction ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu: function renderTopicContextMenu(props) {\n      return createElement(TopicContextMenu, Object.assign({}, props));\n    },\n    customizeTopicContextMenu: function customizeTopicContextMenu(ctx) {\n      var topicKey = ctx.topicKey,\n          model = ctx.model,\n          controller = ctx.controller;\n      var isRoot = topicKey === model.editorRootTopicKey;\n\n      function onClickItem(item) {\n        return function (e) {\n          item.opType && controller.run('operation', _objectSpread(_objectSpread({}, ctx), {}, {\n            opType: item.opType\n          }));\n        };\n      }\n\n      return items.map(function (item) {\n        return isRoot && !item.rootCanUse ? null : createElement(MenuItem, {\n          key: item.label,\n          icon: Icon(item.icon),\n          text: getI18nText(ctx, item.label),\n          labelElement: createElement(\"kbd\", null, item.shortcut),\n          onClick: onClickItem(item)\n        });\n      });\n    }\n  };\n}\n\nvar log$4 = debug('node:topic-drop-effect');\nvar DropEffectSvg = styled.svg(_templateObject24 || (_templateObject24 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicDropEffect = /*#__PURE__*/function (_BaseWidget2) {\n  _inherits(TopicDropEffect, _BaseWidget2);\n\n  var _super5 = _createSuper(TopicDropEffect);\n\n  function TopicDropEffect() {\n    var _this3;\n\n    _classCallCheck(this, TopicDropEffect);\n\n    _this3 = _super5.apply(this, arguments);\n    _this3.state = {\n      content: null\n    };\n    return _this3;\n  }\n\n  _createClass(TopicDropEffect, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var getRef = props.getRef,\n          model = props.model,\n          zoomFactor = props.zoomFactor,\n          diagramState = props.diagramState;\n      var dragDrop = diagramState.dragDrop;\n\n      if (dragDrop == null) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var targetKey = dragDrop.targetKey,\n          targetDir = dragDrop.targetDir;\n      log$4('layout', targetDir);\n\n      if (targetKey == null) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var refKey;\n\n      if (targetDir === 'in') {\n        refKey = contentRefKey(targetKey);\n      } else {\n        refKey = dropAreaRefKey(targetKey, targetDir);\n      }\n\n      var content = getRef(refKey);\n      var svg = getRef('svg-drop-effect');\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var padding = 3;\n      var x = contentRect.left - svgRect.left - padding;\n      var y = contentRect.top - svgRect.top - padding;\n      var width = contentRect.width + 2 * padding;\n      var height = contentRect.height + 2 * padding;\n      this.setState({\n        content: createElement(\"g\", null, createElement(\"rect\", {\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: \"none\",\n          stroke: model.config.theme.highlightColor,\n          strokeDasharray: \"5,5\",\n          strokeWidth: 2\n        }))\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var saveRef = this.props.saveRef;\n      return createElement(DropEffectSvg, {\n        ref: saveRef('svg-drop-effect')\n      }, this.state.content);\n    }\n  }]);\n\n  return TopicDropEffect;\n}(BaseWidget);\n\nvar log$5 = debug('plugin:drag-and-drop');\nvar DropArea = styled.div(_templateObject25 || (_templateObject25 = _taggedTemplateLiteral([\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"])), function (props) {\n  return \"\".concat(props.height, \"px\");\n});\n\nfunction DragAndDropPlugin() {\n  // let dragTargetKey: KeyType = null;\n  // let dragTargetDir: string = null;\n  return {\n    renderTopicDropArea: function renderTopicDropArea(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          saveRef = props.saveRef,\n          controller = props.controller,\n          model = props.model;\n\n      var onDragEnter = function onDragEnter(ev) {\n        log$5('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragLeave = function onDragLeave(ev) {\n        log$5('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragOver = function onDragOver(ev) {\n        ev.preventDefault();\n      };\n\n      var onDrop = function onDrop(ev) {\n        log$5('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var eventHandlers = {\n        onDragEnter: onDragEnter,\n        onDragLeave: onDragLeave,\n        onDragOver: onDragOver,\n        onDrop: onDrop\n      };\n      return createElement(DropArea, Object.assign({\n        height: model.config.theme.marginV / 2,\n        ref: saveRef(dropAreaRefKey(topicKey, dropDir))\n      }, eventHandlers));\n    },\n    renderDragAndDropEffect: function renderDragAndDropEffect(props) {\n      log$5('renderDragAndDropEffect');\n      var saveRef = props.saveRef;\n      return createElement(TopicDropEffect, Object.assign({\n        ref: saveRef(RefKey.DROP_EFFECT_KEY)\n      }, props));\n    },\n    handleTopicDragStart: function handleTopicDragStart(props) {\n      var controller = props.controller,\n          ev = props.ev;\n      ev.stopPropagation();\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      }));\n    },\n    canDrop: function canDrop(props) {\n      var srcKey = props.srcKey,\n          dstKey = props.dstKey,\n          model = props.model,\n          dropDir = props.dropDir;\n      if (srcKey === model.editorRootTopicKey || srcKey === dstKey || getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR) return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n      var srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n    handleTopicDragEnter: function handleTopicDragEnter(props) {\n      var dropDir = props.dropDir,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          model = props.model,\n          diagramState = props.diagramState,\n          setDiagramState = props.setDiagramState;\n      log$5('handleTopicDragEnter:', topicKey, dropDir);\n      var canDrop = controller.run('canDrop', _objectSpread(_objectSpread({}, props), {}, {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      }));\n\n      if (canDrop) {\n        setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n          dragDrop: {\n            targetKey: topicKey,\n            targetDir: dropDir\n          }\n        }));\n      }\n    },\n    handleTopicDragLeave: function handleTopicDragLeave(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          getRef = props.getRef,\n          ev = props.ev,\n          diagramState = props.diagramState,\n          setDiagramState = props.setDiagramState;\n      var relatedTarget = ev.nativeEvent.relatedTarget;\n      log$5('handleTopicDragLeave:', topicKey, dropDir);\n      var content = getRef(contentRefKey(topicKey));\n\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n\n      setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n        dragDrop: null\n      }));\n    },\n    handleTopicDrop: function handleTopicDrop(props) {\n      log$5('handleTopicDrop');\n      var _props2 = props,\n          controller = _props2.controller,\n          topicKey = _props2.topicKey,\n          model = _props2.model,\n          diagramState = _props2.diagramState,\n          setDiagramState = _props2.setDiagramState;\n      props = _objectSpread(_objectSpread({}, props), {}, {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n        dragDrop: null\n      }));\n\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.DRAG_AND_DROP\n        }));\n      }\n    }\n  };\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nvar NodeLayer = styled.div(_templateObject26 || (_templateObject26 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"])));\nvar DIV = styled.div(_templateObject27 || (_templateObject27 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nvar MindDragScrollWidget = /*#__PURE__*/function (_PureComponent) {\n  _inherits(MindDragScrollWidget, _PureComponent);\n\n  var _super6 = _createSuper(MindDragScrollWidget);\n\n  function MindDragScrollWidget(props) {\n    var _this4;\n\n    _classCallCheck(this, MindDragScrollWidget);\n\n    _this4 = _super6.call(this, props);\n\n    _this4.setZoomFactor = function (zoomFactor) {\n      _this4.dragScrollWidget.setZoomFactor(zoomFactor);\n    };\n\n    _this4.onWheel = function (e) {\n      if (e.altKey || e.ctrlKey) {\n        var controller = _this4.props.controller;\n        var zoomFactor = controller.run('getZoomFactor', _this4.props);\n        zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n        if (zoomFactor < 0.5) zoomFactor = 0.5;\n        if (zoomFactor > 4) zoomFactor = 4; // console.log('zoomFactor=>', zoomFactor);\n\n        controller.run('setZoomFactor', _objectSpread(_objectSpread({}, _this4.props), {}, {\n          zoomFactor: zoomFactor\n        }));\n      }\n    };\n\n    return _this4;\n  }\n\n  _createClass(MindDragScrollWidget, [{\n    key: \"renderHotkeys\",\n    value: function renderHotkeys() {\n      var props = this.props;\n      var controller = props.controller,\n          model = props.model;\n      var hotKeys = controller.run('customizeHotKeys', props);\n      if (hotKeys === null) return null;\n\n      if (!(hotKeys.topicHotKeys instanceof Map && hotKeys.globalHotKeys instanceof Map)) {\n        throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n      }\n\n      var children = [];\n\n      if (model.focusMode === FocusMode.NORMAL || model.focusMode === FocusMode.SHOW_POPUP) {\n        hotKeys.topicHotKeys.forEach(function (v, k) {\n          children.push(createElement(Hotkey, Object.assign({\n            key: k\n          }, v, {\n            global: true\n          })));\n        });\n      }\n\n      hotKeys.globalHotKeys.forEach(function (v, k) {\n        children.push(createElement(Hotkey, Object.assign({\n          key: k\n        }, v, {\n          global: true\n        })));\n      });\n      return createElement(Hotkeys, null, children);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props2 = this.props,\n          getRef = _this$props2.getRef,\n          model = _this$props2.model,\n          controller = _this$props2.controller;\n      controller.run('addZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, this.props), {}, {\n        listener: this.setZoomFactor\n      }));\n      var rootTopic = getRef(topicRefKey(model.editorRootTopicKey)); //TODO\n\n      var nodeLayer = getRef('node-layer');\n      var rootTopicRect = rootTopic.getBoundingClientRect();\n      var nodeLayerRect = nodeLayer.getBoundingClientRect();\n      this.dragScrollWidget.setViewBoxScrollDelta(0, rootTopicRect.top - nodeLayerRect.top - this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 + rootTopicRect.height);\n      this.layout();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var controller = this.props.controller;\n      controller.run('removeZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, this.props), {}, {\n        listener: this.setZoomFactor\n      }));\n    }\n  }, {\n    key: \"dragScrollWidget\",\n    get: function get() {\n      return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var controller = this.props.controller;\n      controller.run('fireEvent', _objectSpread(_objectSpread({}, this.props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC\n      }));\n      this.layout();\n    }\n  }, {\n    key: \"layout\",\n    value: function layout() {\n      var controller = this.props.controller;\n      controller.run('layout', this.props);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var _this$props3 = this.props,\n          saveRef = _this$props3.saveRef,\n          model = _this$props3.model,\n          controller = _this$props3.controller;\n      var nodeKey = model.editorRootTopicKey;\n      return createElement(DIV, {\n        onWheel: this.onWheel\n      }, createElement(DragScrollWidget, Object.assign({}, this.state, {\n        enableMouseWheel: false,\n        zoomFactor: model.zoomFactor,\n        ref: saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)\n      }), function (setViewBoxScroll, setViewBoxScrollDelta) {\n        var rootWidgetProps = _objectSpread(_objectSpread({}, _this5.props), {}, {\n          topicKey: nodeKey,\n          setViewBoxScroll: setViewBoxScroll,\n          setViewBoxScrollDelta: setViewBoxScrollDelta\n        });\n\n        return createElement(NodeLayer, {\n          ref: saveRef('node-layer')\n        }, controller.run('renderRootWidget', rootWidgetProps));\n      }));\n    }\n  }]);\n\n  return MindDragScrollWidget;\n}(PureComponent);\n\nMindDragScrollWidget = __decorate([HotkeysTarget], MindDragScrollWidget);\nvar Root = styled.div(_templateObject28 || (_templateObject28 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar DiagramContainer = styled.div(_templateObject29 || (_templateObject29 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  //height: 100%;\\n  overflow: auto;\\n  flex-grow: 1;\\n  background: \", \";\\n  position: relative;\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nfunction DiagramRoot(props) {\n  var controller = props.controller,\n      saveRef = props.saveRef;\n\n  var _useState = useState(controller.run('getInitialDiagramState', props)),\n      _useState2 = _slicedToArray(_useState, 2),\n      diagramState = _useState2[0],\n      setDiagramState = _useState2[1];\n\n  var nProps = _objectSpread(_objectSpread({}, props), {}, {\n    diagramState: diagramState,\n    setDiagramState: setDiagramState\n  });\n\n  return createElement(Root, null, controller.run('renderToolbar', props), createElement(DiagramContainer, {\n    ref: saveRef(RefKey.DIAGRAM_ROOT_KEY)\n  }, createElement(MindDragScrollWidget, Object.assign({}, nProps)), controller.run('renderDiagramCustomize', nProps)));\n}\n\nvar EditorRootBreadcrumbsRoot = styled(ZIndex)(_templateObject30 || (_templateObject30 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"])));\nvar TooltipContent = styled.div(_templateObject31 || (_templateObject31 = _taggedTemplateLiteral([\"\\n  max-width: 600px;\\n\"])));\nvar BreadcrumbTitle = styled.span(_templateObject32 || (_templateObject32 = _taggedTemplateLiteral([\"\"])));\n\nvar EditorRootBreadcrumbs = /*#__PURE__*/function (_BaseWidget3) {\n  _inherits(EditorRootBreadcrumbs, _BaseWidget3);\n\n  var _super7 = _createSuper(EditorRootBreadcrumbs);\n\n  function EditorRootBreadcrumbs(props) {\n    var _this6;\n\n    _classCallCheck(this, EditorRootBreadcrumbs);\n\n    _this6 = _super7.call(this, props);\n\n    _this6.setEditorRootTopicKey = function (topicKey) {\n      return function () {\n        var _this6$props = _this6.props,\n            model = _this6$props.model,\n            controller = _this6$props.controller;\n\n        if (model.editorRootTopicKey !== topicKey) {\n          controller.run('operation', _objectSpread(_objectSpread({}, _this6.props), {}, {\n            opType: OpType.SET_EDITOR_ROOT,\n            topicKey: topicKey\n          }));\n        }\n      };\n    };\n\n    _this6.breadcrumbRenderer = function (props) {\n      var text = props.text,\n          breadProps = _objectWithoutProperties(props, _excluded5);\n\n      var needTooltip = text.length > 8;\n      var title = needTooltip ? text.substr(0, 8) + '...' : text; //TODO\n\n      var content = createElement(TooltipContent, null, text);\n      var tooltipProps = {\n        content: content,\n        position: PopoverPosition.BOTTOM_RIGHT\n      };\n      var breadcrumb = createElement(Breadcrumb, Object.assign({}, breadProps), createElement(BreadcrumbTitle, null, title));\n      return needTooltip ? createElement(Tooltip, Object.assign({}, tooltipProps), breadcrumb) : breadcrumb;\n    };\n\n    return _this6;\n  }\n\n  _createClass(EditorRootBreadcrumbs, [{\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var model = props.model,\n          controller = props.controller,\n          zIndex = props.zIndex;\n      var editingRootKey = model.editorRootTopicKey;\n      if (editingRootKey === model.rootTopicKey) return null;\n      var items = [];\n      var topic = model.getTopic(editingRootKey);\n\n      while (topic != null) {\n        var title = controller.getValue(PropKey.TOPIC_TITLE, _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: topic.key\n        }));\n        items.unshift({\n          text: title,\n          onClick: this.setEditorRootTopicKey(topic.key)\n        });\n        topic = model.getTopic(topic.parentKey);\n      }\n\n      var breadcrumbProps = {\n        items: items,\n        breadcrumbRenderer: this.breadcrumbRenderer\n      };\n      return createElement(EditorRootBreadcrumbsRoot, {\n        zIndex: zIndex\n      }, createElement(Breadcrumbs, Object.assign({}, breadcrumbProps)));\n    }\n  }]);\n\n  return EditorRootBreadcrumbs;\n}(BaseWidget);\n\nvar Modals = /*#__PURE__*/function (_BaseWidget4) {\n  _inherits(Modals, _BaseWidget4);\n\n  var _super8 = _createSuper(Modals);\n\n  function Modals() {\n    var _this7;\n\n    _classCallCheck(this, Modals);\n\n    _this7 = _super8.apply(this, arguments);\n\n    _this7.handleClose = function () {\n      var controller = _this7.props.controller;\n      var handleActiveModalClose = controller.run('handleActiveModalClose', _this7.props);\n      handleActiveModalClose && handleActiveModalClose();\n    };\n\n    return _this7;\n  }\n\n  _createClass(Modals, [{\n    key: \"render\",\n    value: function render() {\n      var controller = this.props.controller;\n      var activeModal = controller.run('renderModal', this.props);\n      var activeModalProps = controller.run('getActiveModalProps', this.props);\n      return createElement(Dialog, {\n        onClose: this.handleClose,\n        isOpen: activeModal !== null,\n        autoFocus: true,\n        enforceFocus: true,\n        usePortal: true,\n        title: activeModalProps && activeModalProps.title,\n        style: activeModalProps && activeModalProps.style\n      }, createElement(\"div\", {\n        className: Classes.DIALOG_BODY,\n        style: {\n          minHeight: 0\n        }\n      }, activeModal));\n    }\n  }]);\n\n  return Modals;\n}(BaseWidget);\n\nvar RootLinksSvg = styled.svg(_templateObject33 || (_templateObject33 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$6 = debug('node:root-sub-links');\n\nvar RootSubLinks = /*#__PURE__*/function (_BaseWidget5) {\n  _inherits(RootSubLinks, _BaseWidget5);\n\n  var _super9 = _createSuper(RootSubLinks);\n\n  function RootSubLinks() {\n    var _this8;\n\n    _classCallCheck(this, RootSubLinks);\n\n    _this8 = _super9.apply(this, arguments);\n    _this8.state = {\n      curves: []\n    };\n    return _this8;\n  }\n\n  _createClass(RootSubLinks, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var model = props.model,\n          getRef = props.getRef,\n          topicKey = props.topicKey,\n          zoomFactor = props.zoomFactor,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var content = getRef(contentRefKey(topicKey));\n      var svg = getRef(linksSvgRefKey(topicKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var p1, p2;\n      p1 = {\n        x: centerX(contentRect) - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      var curves = [];\n      topic.subKeys.forEach(function (key) {\n        var linkStyle = controller.run('getLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: key\n        }));\n        var lineType = linkStyle.lineType;\n        var subTopicContent = getRef(contentRefKey(key));\n\n        var rect = _getRelativeRect(subTopicContent, bigView, zoomFactor);\n\n        if (rect.left > contentRect.right) {\n          p2 = {\n            x: rect.left,\n            y: centerY(rect)\n          };\n        } else {\n          p2 = {\n            x: rect.right,\n            y: centerY(rect)\n          };\n        }\n\n        p2 = {\n          x: p2.x - svgRect.left,\n          y: p2.y - svgRect.top\n        };\n        var curve;\n\n        if (lineType === 'curve') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" C \").concat(p1.x, \" \").concat(centerPointY(p1, p2), \" \").concat(centerPointX(p1, p2), \" \").concat(p2.y, \" \").concat(p2.x, \" \").concat(p2.y);\n        } else if (lineType === 'line') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p2.x, \" \").concat(p2.y);\n        } else if (lineType === 'round') {\n          var vDir = p2.y > p1.y ? 1 : -1;\n          var hDir = p2.x > p1.x ? 1 : -1;\n          var radius = linkStyle.lineRadius;\n\n          if (radius == null) {\n            throw new Error('link line type is round, but lineRadius is not provided!');\n          }\n\n          if (p2.y === p1.y) {\n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x);\n          } else {\n            // 0  1 \n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \"  V \").concat(p2.y - vDir * radius, \" A \").concat(radius, \" \").concat(radius, \" 0 0 \").concat(vDir * hDir === 1 ? 0 : 1, \" \").concat(p1.x + radius * hDir, \" \").concat(p2.y, \" H \").concat(p2.x);\n          }\n        }\n\n        curves.push(createElement(\"path\", {\n          key: \"link-\".concat(key),\n          d: curve,\n          strokeWidth: linkStyle.lineWidth,\n          stroke: linkStyle.lineColor,\n          fill: \"none\"\n        }));\n      });\n      this.setState({\n        curves: curves\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$6('render');\n      var _this$props4 = this.props,\n          topicKey = _this$props4.topicKey,\n          saveRef = _this$props4.saveRef;\n      return createElement(RootLinksSvg, {\n        ref: saveRef(linksSvgRefKey(topicKey))\n      }, createElement(\"g\", null, this.state.curves));\n    }\n  }]);\n\n  return RootSubLinks;\n}(BaseWidget);\n\nvar log$7 = debug('RootNode');\nvar LayerPart = styled.div(_templateObject34 || (_templateObject34 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"])), function (props) {\n  return (//@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'\n  );\n}, function (props) {\n  return (//@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? '15px 60px 15px 0px' : '15px 0px 15px 60px'\n  );\n});\nvar Topic = styled.div(_templateObject35 || (_templateObject35 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"])));\n\nvar RootWidget = /*#__PURE__*/function (_Component4) {\n  _inherits(RootWidget, _Component4);\n\n  var _super10 = _createSuper(RootWidget);\n\n  function RootWidget() {\n    _classCallCheck(this, RootWidget);\n\n    return _super10.apply(this, arguments);\n  }\n\n  _createClass(RootWidget, [{\n    key: \"renderPartTopics\",\n    value: function renderPartTopics(topics, dir) {\n      var _this$props5 = this.props,\n          controller = _this$props5.controller,\n          saveRef = _this$props5.saveRef;\n      var res = controller.run('createSubTopics', _objectSpread(_objectSpread({}, this.props), {}, {\n        dir: dir,\n        isRoot: true,\n        topics: topics\n      }));\n      if (!res) return null;\n      var subTopics = res.subTopics;\n      var cxName = \"bm-layer-\".concat(dir === TopicDirection.LEFT ? 'left' : 'right');\n      return (//@ts-ignore\n        createElement(LayerPart, {\n          topicDirection: dir,\n          ref: saveRef(cxName)\n        }, subTopics)\n      );\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$7('render');\n      var props = this.props;\n      var model = props.model,\n          topicKey = props.topicKey,\n          saveRef = props.saveRef,\n          controller = props.controller;\n      var topicStyle = controller.run('getTopicContentStyle', props);\n      var config = model.config;\n      var topicContent = controller.run('renderTopicContent', _objectSpread(_objectSpread({}, props), {}, {\n        topicStyle: topicStyle,\n        dir: TopicDirection.MAIN\n      }));\n      var partTopics = controller.run('getPartTopics', {\n        layout: config.layoutDir,\n        model: model,\n        topicKey: topicKey\n      });\n      var rootTopic = createElement(Topic, {\n        ref: saveRef(topicRefKey(topicKey))\n      }, topicContent);\n      var children = controller.run('renderRootWidgetOtherChildren', props);\n\n      switch (config.layoutDir) {\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, children);\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.B, 'B'), children);\n      }\n\n      return null;\n    }\n  }]);\n\n  return RootWidget;\n}(Component);\n\nvar Icon$1 = styled.div(_templateObject36 || (_templateObject36 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"])), function (_ref7) {\n  var dir = _ref7.dir;\n  if (dir === TopicDirection.RIGHT) return css(_templateObject37 || (_templateObject37 = _taggedTemplateLiteral([\"\\n        right: -25px;\\n      \"])));\n  if (dir === TopicDirection.LEFT) return css(_templateObject38 || (_templateObject38 = _taggedTemplateLiteral([\"\\n        left: -25px;\\n      \"])));\n}, function (props) {\n  return props.background;\n});\n\nfunction TopicCollapseIcon(props) {\n  var model = props.model,\n      topicKey = props.topicKey,\n      topicStyle = props.topicStyle,\n      dir = props.dir,\n      saveRef = props.saveRef,\n      onClickCollapse = props.onClickCollapse;\n  var topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? createElement(Icon$1, {\n    ref: saveRef(collapseRefKey(topicKey)),\n    onClick: onClickCollapse,\n    background: topicStyle.background,\n    dir: dir,\n    className: cx(_defineProperty({\n      icon: true,\n      iconfont: true\n    }, \"bm-\".concat(topic.collapse ? 'plus' : 'minus'), true))\n  }) : null;\n}\n\nvar log$8 = debug('node:topic-content2');\nvar EditingRoot = styled.div(_templateObject39 || (_templateObject39 = _taggedTemplateLiteral([\"\\n  position: relative;\\n\"])));\nvar EditingWrapper = styled.div(_templateObject40 || (_templateObject40 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"])));\n\nvar cancelEvent$1 = function cancelEvent$1(e) {\n  log$8('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nfunction TopicContent(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var readOnly = model.editingContentKey !== topicKey;\n  var editor = controller.run('renderTopicContentEditor', _objectSpread(_objectSpread({}, props), {}, {\n    readOnly: readOnly\n  }));\n  var child;\n\n  if (readOnly) {\n    child = editor;\n  } else {\n    var wrapper;\n\n    var wrapperRef = function wrapperRef(ref) {\n      if (ref) {\n        wrapper = ref;\n        contentResizeObserver.observe(wrapper);\n      }\n    };\n\n    var rect = {\n      width: 50,\n      height: 40\n    };\n    var editorDiv = getRef(\"content-editor-\".concat(topicKey));\n    if (editorDiv) rect = editorDiv.getBoundingClientRect();\n\n    var contentResizeCallback = function contentResizeCallback(entries, observer) {\n      var r = entries[0].contentRect;\n      wrapper.style.left = (rect.width - r.width) / 2 + 'px';\n      wrapper.style.top = (rect.height - r.height) / 2 + 'px';\n    };\n\n    var contentResizeObserver = new ResizeObserver(contentResizeCallback);\n    log$8(rect);\n    child = createElement(Fragment, null, createElement(\"div\", {\n      style: {\n        width: rect.width,\n        height: rect.height\n      }\n    }), createElement(EditingWrapper, {\n      ref: wrapperRef\n    }, editor));\n  }\n\n  return createElement(EditingRoot, {\n    onDragEnter: cancelEvent$1,\n    onDragOver: cancelEvent$1\n  }, child);\n}\n\nvar log$9 = debug('node:topic-content-widget');\nvar TopicContent$1 = styled.div(_templateObject41 || (_templateObject41 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"])));\nvar TopicContentWithDropArea = styled.div(_templateObject42 || (_templateObject42 = _taggedTemplateLiteral([\"\\n  position: relative;\\n\"])));\n\nvar TopicContentWidget = /*#__PURE__*/function (_BaseWidget6) {\n  _inherits(TopicContentWidget, _BaseWidget6);\n\n  var _super11 = _createSuper(TopicContentWidget);\n\n  function TopicContentWidget(props) {\n    var _this9;\n\n    _classCallCheck(this, TopicContentWidget);\n\n    _this9 = _super11.call(this, props);\n\n    _this9.onDragStart = function (ev) {\n      _this9.run('handleTopicDragStart', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev\n      }));\n    };\n\n    _this9.onDragOver = function (ev) {\n      // log('onDragOver');\n      ev.preventDefault();\n    };\n\n    _this9.onDragEnter = function (ev) {\n      log$9('onDragEnter', _this9.props.topicKey);\n\n      _this9.run('handleTopicDragEnter', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onDragLeave = function (ev) {\n      _this9.run('handleTopicDragLeave', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onDrop = function (ev) {\n      log$9('onDrop');\n\n      _this9.run('handleTopicDrop', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onClick = function (ev) {\n      var props = _this9.props;\n      var controller = props.controller; //TODO bug [Violation] 'setTimeout' handler took 69ms\n\n      _this9.handleTopicClickTimeout = setTimeout(function () {\n        // log('handleTopicClick');\n        //this.props, props, onClick, topic-content-editoronClickOutside\n        //onClickOutside,model, props,model model\n        controller.run('handleTopicClick', _objectSpread(_objectSpread({}, _this9.props), {}, {\n          ev: ev\n        }));\n      }, 200);\n    };\n\n    _this9.onDoubleClick = function (ev) {\n      clearTimeout(_this9.handleTopicClickTimeout);\n      var controller = _this9.props.controller;\n      controller.run('handleTopicDoubleClick', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev\n      }));\n    };\n\n    _this9.needRelocation = false;\n\n    _this9.onClickCollapse = function (e) {\n      e.stopPropagation();\n      var _this9$props = _this9.props,\n          topicKey = _this9$props.topicKey,\n          getRef = _this9$props.getRef;\n      _this9.needRelocation = true;\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var rect = collapseIcon.getBoundingClientRect();\n      log$9('oldRect', rect);\n      _this9.oldCollapseIconVector = [rect.left + rect.width / 2, rect.top + rect.height / 2];\n      log$9('oldCollapseIconVector', _this9.oldCollapseIconVector); // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: collapseIcon\n      // });\n\n      _this9.operation(OpType.TOGGLE_COLLAPSE, _this9.props);\n    };\n\n    _this9.state = {\n      dragEnter: false\n    };\n    return _this9;\n  }\n\n  _createClass(TopicContentWidget, [{\n    key: \"renderContextMenu\",\n    value: function renderContextMenu() {\n      var controller = this.props.controller;\n\n      if (!controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, _objectSpread({}, this.props))) {\n        return;\n      }\n\n      this.operation(OpType.FOCUS_TOPIC, _objectSpread(_objectSpread({}, this.props), {}, {\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n      return controller.run('renderTopicContextMenu', this.props);\n    }\n  }, {\n    key: \"onContextMenuClose\",\n    value: function onContextMenuClose() {// Optional method called once the context menu is closed.\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.needRelocation) {\n        var _this$props6 = this.props,\n            getRef = _this$props6.getRef,\n            topicKey = _this$props6.topicKey,\n            setViewBoxScrollDelta = _this$props6.setViewBoxScrollDelta;\n        var newIcon = getRef(collapseRefKey(topicKey));\n        var newRect = newIcon.getBoundingClientRect(); // const newVector = controller.run('getRelativeVectorFromViewPort', {\n        //   ...this.props,\n        //   element: getRef(collapseRefKey(topicKey))\n        // });\n\n        var newVector = [newRect.left + newRect.width / 2, newRect.top + newRect.height / 2];\n        log$9('newVector:', newVector);\n        log$9('oldVector:', this.oldCollapseIconVector); //TODO bug\n\n        var vector = [newVector[0] - this.oldCollapseIconVector[0], newVector[1] - this.oldCollapseIconVector[1]];\n        log$9('vector', vector);\n        setViewBoxScrollDelta(vector[0], vector[1]);\n        this.needRelocation = false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller,\n          topicStyle = props.topicStyle,\n          dir = props.dir;\n      log$9('render', topicKey, model.focusMode);\n      var draggable = controller.run('isOperationEnabled', props) && model.editingContentKey !== topicKey;\n      var collapseIcon = controller.run('renderTopicCollapseIcon', _objectSpread(_objectSpread({}, props), {}, {\n        onClickCollapse: this.onClickCollapse.bind(this)\n      }));\n      var prevDropArea = controller.run('renderTopicDropArea', _objectSpread(_objectSpread({}, props), {}, {\n        dropDir: 'prev'\n      }));\n      var nextDropArea = controller.run('renderTopicDropArea', _objectSpread(_objectSpread({}, props), {}, {\n        dropDir: 'next'\n      }));\n      var dropEventHandlers = {\n        onDragEnter: this.onDragEnter,\n        onDragLeave: this.onDragLeave,\n        onDragOver: this.onDragOver,\n        onDrop: this.onDrop\n      }; // log(topicKey, 'style', topicStyle);\n\n      return createElement(TopicContentWithDropArea, null, prevDropArea, createElement(TopicContent$1, Object.assign({\n        style: topicStyle,\n        draggable: draggable,\n        ref: saveRef(contentRefKey(topicKey)),\n        onDragStart: this.onDragStart,\n        onClick: this.onClick,\n        onDoubleClick: this.onDoubleClick\n      }, dropEventHandlers), controller.run('renderTopicBlocks', props), controller.run('renderTopicContentOthers', props)), nextDropArea, dir !== TopicDirection.MAIN && collapseIcon);\n    }\n  }]);\n\n  return TopicContentWidget;\n}(BaseWidget);\n\nTopicContentWidget = __decorate([ContextMenuTarget], TopicContentWidget);\nvar log$a = debug('node:topic-desc');\nvar TooltipContentWrapper = styled.div(_templateObject43 || (_templateObject43 = _taggedTemplateLiteral([\"\\n  overflow: auto;\\n\"])));\n\nfunction TopicDesc(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var isEditing = model.editingDescKey === topicKey;\n  log$a('isEditing', isEditing);\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.START_EDITING_DESC\n    }));\n  };\n\n  var desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (!isEditing && controller.run('isBlockEmpty', _objectSpread(_objectSpread({}, props), {}, {\n    block: desc.block\n  }))) return null;\n  var descEditor = controller.run('renderTopicDescEditor', props);\n  var diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  var style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n\n  if (diagramRoot) {\n    var dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = \"\".concat(dRect.width * 0.6, \"px\");\n    style.maxHeight = \"\".concat(dRect.height * 0.8, \"px\");\n  }\n\n  var tooltipContent = createElement(TooltipContentWrapper, {\n    onClick: cancelEvent,\n    classname: Classes.POPOVER_DISMISS,\n    style: style\n  }, descEditor);\n  var icon = createElement(TopicBlockIcon, {\n    onClick: onClick,\n    className: iconClassName(IconName.NOTES),\n    tabIndex: -1\n  });\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n  var descIcon = desc.block && createElement(Popover, Object.assign({}, tooltipProps));\n  return descIcon;\n}\n\nvar FocusHighlightSvg = styled.svg(_templateObject44 || (_templateObject44 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicHighlight = /*#__PURE__*/function (_BaseWidget7) {\n  _inherits(TopicHighlight, _BaseWidget7);\n\n  var _super12 = _createSuper(TopicHighlight);\n\n  function TopicHighlight() {\n    var _this10;\n\n    _classCallCheck(this, TopicHighlight);\n\n    _this10 = _super12.apply(this, arguments);\n    _this10.state = {\n      content: null\n    };\n    return _this10;\n  }\n\n  _createClass(TopicHighlight, [{\n    key: \"layout\",\n    value: function layout() {\n      var _this$props7 = this.props,\n          getRef = _this$props7.getRef,\n          model = _this$props7.model,\n          zoomFactor = _this$props7.zoomFactor;\n      var focusKey = model.focusKey;\n      var focusMode = model.focusMode;\n\n      if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var content = getRef(contentRefKey(focusKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      var svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var padding = 3;\n      var x = contentRect.left - svgRect.left - padding;\n      var y = contentRect.top - svgRect.top - padding;\n      var width = contentRect.width + 2 * padding;\n      var height = contentRect.height + 2 * padding;\n      this.setState({\n        content: createElement(\"rect\", {\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: \"none\",\n          stroke: model.config.theme.highlightColor,\n          strokeWidth: 2\n        })\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var saveRef = this.props.saveRef;\n      return createElement(FocusHighlightSvg, {\n        ref: saveRef(RefKey.SVG_HIGHLIGHT_KEY)\n      }, this.state.content);\n    }\n  }]);\n\n  return TopicHighlight;\n}(BaseWidget);\n\nvar TopicLinksSvg = styled.svg(_templateObject45 || (_templateObject45 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$b = debug('node:topic-sub-links');\n\nvar TopicSubLinks = /*#__PURE__*/function (_BaseWidget8) {\n  _inherits(TopicSubLinks, _BaseWidget8);\n\n  var _super13 = _createSuper(TopicSubLinks);\n\n  function TopicSubLinks() {\n    var _this11;\n\n    _classCallCheck(this, TopicSubLinks);\n\n    _this11 = _super13.apply(this, arguments);\n    _this11.state = {\n      curves: []\n    };\n    return _this11;\n  }\n\n  _createClass(TopicSubLinks, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var model = props.model,\n          getRef = props.getRef,\n          topicKey = props.topicKey,\n          dir = props.dir,\n          controller = props.controller;\n      var z = controller.run('getZoomFactor', props);\n      var topic = model.getTopic(topicKey);\n      var content = getRef(contentRefKey(topicKey));\n      var svg = getRef(linksSvgRefKey(topicKey));\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var svgRect = _getRelativeRect(svg, bigView, z);\n\n      var collapseRect = _getRelativeRect(collapseIcon, bigView, z);\n\n      var contentRect = _getRelativeRect(content, bigView, z);\n\n      log$b(topicKey);\n      log$b('svgRect', svgRect);\n      log$b('collapseRect', collapseRect);\n      log$b('contentRect', contentRect);\n      var p1, p2, p3;\n\n      if (dir === TopicDirection.RIGHT) {\n        p1 = {\n          x: 0,\n          y: centerY(contentRect) - svgRect.top\n        };\n        p2 = {\n          x: collapseRect.right - svgRect.left + 10,\n          y: p1.y\n        };\n      } else if (dir === TopicDirection.LEFT) {\n        p1 = {\n          x: svgRect.right - svgRect.left,\n          y: centerY(contentRect) - svgRect.top\n        };\n        p2 = {\n          x: collapseRect.left - svgRect.left - 10,\n          y: p1.y\n        };\n      }\n\n      var curves = [];\n      topic.subKeys.forEach(function (key) {\n        var curve;\n        var linkStyle = controller.run('getLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: key\n        })); // log(key);\n\n        var subContent = getRef(contentRefKey(key));\n        if (!subContent) return;\n\n        var rect = _getRelativeRect(subContent, bigView, z);\n\n        if (dir === TopicDirection.RIGHT) {\n          p3 = {\n            x: rect.left - svgRect.left,\n            y: centerY(rect) - svgRect.top\n          };\n        }\n\n        if (dir === TopicDirection.LEFT) {\n          p3 = {\n            x: rect.right - svgRect.left,\n            y: centerY(rect) - svgRect.top\n          };\n        }\n\n        var lineType = linkStyle.lineType;\n\n        if (lineType === 'curve') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p2.x, \" \").concat(p2.y, \" C \").concat(p2.x, \" \").concat(centerPointY(p2, p3), \" \").concat(centerPointX(p2, p3), \" \").concat(p3.y, \" \").concat(p3.x, \" \").concat(p3.y);\n        } else if (lineType === 'round') {\n          var vDir = p3.y > p1.y ? 1 : -1;\n          var hDir = p3.x > p1.x ? 1 : -1;\n          var radius = linkStyle.lineRadius; // if (p3.y === p1.y) { //\n\n          if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p3.x, \" \").concat(p3.y);\n          } else {\n            // 0  1 \n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x, \" V \").concat(p3.y - vDir * radius, \" A \").concat(radius, \" \").concat(radius, \" 0 0 \").concat(vDir * hDir === 1 ? 0 : 1, \" \").concat(p2.x + radius * hDir, \" \").concat(p3.y, \" H \").concat(p3.x);\n          }\n        } else if (lineType === 'line') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x, \" L \").concat(p3.x, \" \").concat(p3.y);\n        }\n\n        curves.push(createElement(\"path\", {\n          key: \"link-\".concat(key),\n          d: curve,\n          strokeWidth: linkStyle.lineWidth,\n          stroke: linkStyle.lineColor,\n          fill: \"none\"\n        }));\n      });\n      this.setState({\n        curves: curves\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props8 = this.props,\n          topicKey = _this$props8.topicKey,\n          saveRef = _this$props8.saveRef;\n      return createElement(TopicLinksSvg, {\n        ref: saveRef(linksSvgRefKey(topicKey))\n      }, createElement(\"g\", null, this.state.curves));\n    }\n  }]);\n\n  return TopicSubLinks;\n}(BaseWidget);\n\nvar log$c = debug('node:topic-widget');\nvar Node = styled.div(_templateObject46 || (_templateObject46 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n}); // TODO\n\nvar NodeChildren = styled.div(_templateObject47 || (_templateObject47 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  padding: \", \";\\n\"])), function (props) {\n  return props.dir === TopicDirection.RIGHT ? \"0 0 0 \".concat(props.marginH, \"px\") : \"0 \".concat(props.marginH, \"px 0 0\");\n});\nvar NodeTopic = styled.div(_templateObject48 || (_templateObject48 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n});\n\nvar TopicWidget = /*#__PURE__*/function (_Component5) {\n  _inherits(TopicWidget, _Component5);\n\n  var _super14 = _createSuper(TopicWidget);\n\n  function TopicWidget() {\n    _classCallCheck(this, TopicWidget);\n\n    return _super14.apply(this, arguments);\n  }\n\n  _createClass(TopicWidget, [{\n    key: \"renderSubTopics\",\n    value: function renderSubTopics() {\n      var props = this.props;\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey,\n          dir = props.dir;\n      var topics = model.getTopic(topicKey).subKeys.toArray();\n      var res = controller.run('createSubTopics', _objectSpread(_objectSpread({}, props), {}, {\n        topics: topics\n      }));\n      if (!res) return null;\n      var subTopics = res.subTopics;\n      var subLinks = controller.run('renderSubLinks', props);\n      return createElement(NodeChildren, {\n        dir: dir,\n        marginH: model.config.theme.marginH\n      }, subTopics, \" \", subLinks);\n    } // componentDidUpdate(): void {\n    //   this.layoutLinks();\n    // }\n    //\n    // componentDidMount(): void {\n    //   this.layoutLinks();\n    // }\n\n  }, {\n    key: \"layoutLinks\",\n    value: function layoutLinks() {\n      var _this$props9 = this.props,\n          getRef = _this$props9.getRef,\n          topicKey = _this$props9.topicKey,\n          model = _this$props9.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return;\n      log$c('layoutLinks', topicKey);\n      var links = getRef(linksRefKey(topicKey));\n      links && links.layout();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var controller = props.controller,\n          topicKey = props.topicKey,\n          dir = props.dir,\n          saveRef = props.saveRef;\n      log$c('render', topicKey);\n      var topicStyle = controller.run('getTopicContentStyle', props);\n\n      var propsMore = _objectSpread(_objectSpread({}, props), {}, {\n        topicStyle: topicStyle\n      });\n\n      var topicContent = controller.run('renderTopicContent', propsMore);\n      return createElement(Node, {\n        topicDirection: dir\n      }, createElement(NodeTopic, {\n        topicDirection: dir,\n        ref: saveRef(topicRefKey(topicKey))\n      }, topicContent), this.renderSubTopics());\n    }\n  }]);\n\n  return TopicWidget;\n}(Component);\n\nvar log$d = debug('node:view-port-viewer');\nvar ViewerRoot = styled(ZIndex)(_templateObject49 || (_templateObject49 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"])));\nvar Item_ = styled(Btn)(_templateObject50 || (_templateObject50 = _taggedTemplateLiteral([\"\\n  margin: 10px;\\n\"])));\nvar ZoomFactorSpan = styled.span(_templateObject51 || (_templateObject51 = _taggedTemplateLiteral([\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"])));\n\nvar Item = function Item(props) {\n  return createElement(Tooltip, {\n    content: props.tooltip,\n    position: Position.TOP,\n    className: Classes.ICON\n  }, createElement(Item_, {\n    onClick: props.onClick,\n    tabIndex: -1\n  }, props.children));\n};\n\nvar ViewPortViewer = /*#__PURE__*/function (_BaseWidget9) {\n  _inherits(ViewPortViewer, _BaseWidget9);\n\n  var _super15 = _createSuper(ViewPortViewer);\n\n  function ViewPortViewer(props) {\n    var _this12;\n\n    _classCallCheck(this, ViewPortViewer);\n\n    _this12 = _super15.call(this, props);\n\n    _this12.zoomFactorChange = function (zoomFactor) {\n      log$d('zoomFactorChange', zoomFactor);\n\n      _this12.setState({\n        zoomFactor: zoomFactor\n      });\n    };\n\n    _this12.onClickResetZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: 1\n      }));\n    };\n\n    _this12.onClickAddZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor + 0.1\n      }));\n    };\n\n    _this12.onClickMinusZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor - 0.1\n      }));\n    };\n\n    _this12.onClickCollapseAll = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this12.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.COLLAPSE_ALL\n      }));\n    };\n\n    _this12.onClickExpandAll = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this12.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.EXPAND_ALL\n      }));\n    };\n\n    _this12.centerRootTopic = function () {\n      var _this12$props = _this12.props,\n          model = _this12$props.model,\n          controller = _this12$props.controller;\n      controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, _this12.props), {}, {\n        topicKey: model.editorRootTopicKey\n      }));\n    };\n\n    return _this12;\n  }\n\n  _createClass(ViewPortViewer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var props = this.props;\n      var controller = props.controller;\n      controller.run('addZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        listener: this.zoomFactorChange\n      }));\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var props = this.props;\n      var controller = props.controller;\n      controller.run('removeZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        listener: this.zoomFactorChange\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$d('render');\n      var props = this.props;\n      var controller = props.controller,\n          zIndex = props.zIndex;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      return createElement(ViewerRoot, {\n        zIndex: zIndex\n      }, createElement(Item, {\n        onClick: this.onClickCollapseAll,\n        tooltip: getI18nText(props, I18nKey.COLLAPSE_ALL)\n      }, Icon(IconName.COLLAPSE_ALL)), createElement(Item, {\n        onClick: this.onClickExpandAll,\n        tooltip: getI18nText(props, I18nKey.EXPAND_ALL)\n      }, Icon(IconName.EXPAND_ALL)), createElement(Item, {\n        onClick: this.centerRootTopic,\n        tooltip: getI18nText(props, I18nKey.CENTER_ROOT_TOPIC)\n      }, Icon(IconName.CENTER)), createElement(Item, {\n        onClick: this.onClickMinusZoom,\n        tooltip: getI18nText(props, I18nKey.ZOOM_IN)\n      }, Icon(IconName.MINUS)), createElement(Item, {\n        onClick: this.onClickResetZoom,\n        tooltip: getI18nText(props, I18nKey.RESET)\n      }, createElement(ZoomFactorSpan, null, \"\".concat(getI18nText(props, I18nKey.ZOOM), \":\").concat(Math.floor(zoomFactor * 100), \"%\"))), createElement(Item, {\n        onClick: this.onClickAddZoom,\n        tooltip: getI18nText(props, I18nKey.ZOOM_OUT)\n      }, Icon(IconName.PLUS)));\n    }\n  }]);\n\n  return ViewPortViewer;\n}(BaseWidget);\n\nvar DescEditorWrapper = styled.div(_templateObject52 || (_templateObject52 = _taggedTemplateLiteral([\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"])));\n\nfunction renderDrawer(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    var onDescEditorClose = function onDescEditorClose(e) {\n      e.stopPropagation();\n      var key = \"topic-desc-data-\".concat(topicKey);\n      var descData = controller.run('deleteTempValue', {\n        key: key\n      });\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      }));\n    };\n\n    var descEditor = controller.run('renderTopicDescEditor', props);\n    return createElement(Drawer, {\n      key: \"drawer\",\n      title: getI18nText(props, I18nKey.EDIT_NOTES),\n      icon: Icon('note'),\n      isOpen: true,\n      hasBackdrop: true,\n      backdropProps: {\n        onMouseDown: cancelEvent\n      },\n      isCloseButtonShown: false,\n      onClose: onDescEditorClose,\n      size: \"70%\"\n    }, createElement(DescEditorWrapper, null, descEditor));\n  }\n} //TODO themeProvider\n\n\nfunction Theme(_ref8) {\n  var theme = _ref8.theme,\n      children = _ref8.children;\n  return (//@ts-ignore\n    createElement(ThemeProvider, {\n      theme: theme\n    }, createElement(Fragment, null, children))\n  );\n}\n\nvar log$e = debug('plugin:rendering');\n\nfunction RenderingPlugin() {\n  var diagramProps;\n  return {\n    getDiagramProps: function getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram: function renderDiagram(props) {\n      var model = props.model;\n      return createElement(SaveRef, null, function (saveRef, getRef, deleteRef) {\n        diagramProps = _objectSpread(_objectSpread({}, props), {}, {\n          saveRef: saveRef,\n          getRef: getRef,\n          deleteRef: deleteRef\n        });\n        log$e('renderDiagram', model);\n        return createElement(Theme, {\n          theme: model.config.theme\n        }, createElement(DiagramRoot, diagramProps));\n      });\n    },\n    renderDrawer: renderDrawer,\n    getInitialDiagramState: function getInitialDiagramState(props) {\n      return {\n        rightTopPanel: {\n          isOpen: false,\n          selectedTabId: 'topic-style'\n        }\n      };\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props) {\n      var controller = props.controller,\n          model = props.model;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX);\n\n      var nProps = _objectSpread(_objectSpread({}, props), {}, {\n        zIndex: zIndex,\n        topicKey: model.focusKey\n      });\n\n      var breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps); // const styleEditor = controller.run('renderStyleEditor', nProps);\n\n      var rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      var modals = controller.run('renderModals', _objectSpread(_objectSpread({}, nProps), {}, {\n        zIndex: zIndex + 1\n      }));\n      var drawer = controller.run('renderDrawer', _objectSpread(_objectSpread({}, nProps), {}, {\n        zIndex: zIndex + 1\n      }));\n      var viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n    renderEditorRootBreadcrumbs: function renderEditorRootBreadcrumbs(props) {\n      return createElement(EditorRootBreadcrumbs, Object.assign({\n        key: \"EditorRootBreadcrumbs\"\n      }, props));\n    },\n    renderModals: function renderModals(props) {\n      return createElement(Modals, Object.assign({\n        key: \"modals\"\n      }, props));\n    },\n    renderModal: function renderModal(props) {\n      return null;\n    },\n    getActiveModalProps: function getActiveModalProps(props) {\n      return null;\n    },\n    renderDoc: function renderDoc(_ref9) {\n      var children = _ref9.children;\n      return children;\n    },\n    renderRootWidget: function renderRootWidget(props) {\n      return createElement(RootWidget, Object.assign({}, props));\n    },\n    renderTopicWidget: function renderTopicWidget(props) {\n      return createElement(TopicWidget, Object.assign({}, props));\n    },\n    renderTopicContent: function renderTopicContent(props) {\n      return createElement(TopicContentWidget, Object.assign({}, props));\n    },\n    renderTopicCollapseIcon: function renderTopicCollapseIcon(props) {\n      return createElement(TopicCollapseIcon, Object.assign({}, props));\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props) {\n      return [];\n    },\n    renderTopicBlocks: function renderTopicBlocks(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var blocks = topic.blocks;\n      var res = [];\n      var i = 0;\n      blocks.forEach(function (block) {\n        var b = controller.run('renderTopicBlock', _objectSpread(_objectSpread({}, props), {}, {\n          block: block,\n          blockKey: \"block-\".concat(i)\n        }));\n\n        if (b) {\n          res.push(createElement(Fragment, {\n            key: \"block-\".concat(i)\n          }, b));\n          i++;\n        }\n      });\n      return res;\n    },\n    renderTopicBlock: function renderTopicBlock(props) {\n      var controller = props.controller,\n          block = props.block;\n\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n      }\n\n      return null;\n    },\n    renderTopicBlockContent: function renderTopicBlockContent(props) {\n      return createElement(TopicContent, Object.assign({}, props));\n    },\n    renderTopicBlockDesc: function renderTopicBlockDesc(props) {\n      return createElement(TopicDesc, Object.assign({}, props));\n    },\n    renderSubLinks: function renderSubLinks(props) {\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return createElement(TopicSubLinks, Object.assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderRootSubLinks: function renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey; // ,layout \n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n\n      return createElement(RootSubLinks, Object.assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderFocusItemHighlight: function renderFocusItemHighlight(props) {\n      var saveRef = props.saveRef;\n      return createElement(TopicHighlight, Object.assign({\n        ref: saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)\n      }, props));\n    },\n    renderRootWidgetOtherChildren: function renderRootWidgetOtherChildren(props) {\n      var _props3 = props,\n          controller = _props3.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      props = _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor\n      });\n      return createElement(Fragment, null, controller.run('renderRootSubLinks', props), controller.run('renderFocusItemHighlight', props), controller.run('renderDragAndDropEffect', props));\n    },\n    renderViewPortViewer: function renderViewPortViewer(props) {\n      return createElement(ViewPortViewer, Object.assign({\n        key: \"view-port-viewer\"\n      }, props));\n    }\n  };\n}\n\nvar PanelRoot = styled(ZIndex)(_templateObject53 || (_templateObject53 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"])));\nvar StyledTabs = styled(Tabs)(_templateObject54 || (_templateObject54 = _taggedTemplateLiteral([\"\\n  padding: 0px 10px;\\n\"])));\n\nfunction RightTopPanelWidget(props) {\n  var controller = props.controller,\n      zIndex = props.zIndex,\n      diagramState = props.diagramState,\n      setDiagramState = props.setDiagramState;\n  var rightTopPanel = diagramState.rightTopPanel;\n  var isOpen = rightTopPanel.isOpen,\n      selectedTabId = rightTopPanel.selectedTabId;\n\n  var setRightTopPanelState = function setRightTopPanelState(obj) {\n    setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n      rightTopPanel: _objectSpread(_objectSpread({}, rightTopPanel), obj)\n    }));\n  };\n\n  if (!isOpen) {\n    return createElement(PanelRoot, {\n      zIndex: zIndex\n    }, createElement(IconBg, {\n      onClick: function onClick() {\n        setRightTopPanelState({\n          isOpen: true\n        });\n      }\n    }, createElement(ShowMenuIcon, {\n      className: iconClassName(IconName.SHOW_MENU)\n    })));\n  }\n\n  var handleTabIdChange = function handleTabIdChange(tabId) {\n    setRightTopPanelState({\n      selectedTabId: tabId\n    });\n  };\n\n  return createElement(PanelRoot, {\n    zIndex: zIndex\n  }, createElement(Title, null, createElement(CloseIcon, {\n    className: iconClassName(IconName.CLOSE),\n    onClick: function onClick() {\n      setRightTopPanelState({\n        isOpen: false\n      });\n    }\n  })), createElement(StyledTabs, {\n    id: \"tabs\",\n    selectedTabId: selectedTabId,\n    onChange: handleTabIdChange\n  }, controller.run('renderRightTopPanelTabs', props)));\n}\n\nvar borderWidthItems$1 = _toConsumableArray(Array(7).keys());\n\nvar borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nvar borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nfunction BorderStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleBorderWidthChange = function handleBorderWidthChange(value) {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({\n      borderWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleBorderStyleChange = function handleBorderStyleChange(value) {\n    setContentStyle({\n      borderStyle: value\n    });\n  };\n\n  var handleBorderRadiusChange = function handleBorderRadiusChange(value) {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({\n      borderRadius: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleBorderColorChange = function handleBorderColorChange(color) {\n    setContentStyle({\n      borderColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BORDER)), createElement(SettingRow, null, createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(contentStyle.borderWidth ? contentStyle.borderWidth : getI18nText(props, I18nKey.DEFAULT)),\n    items: borderWidthItems$1,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.STYLE), \": \").concat(contentStyle.borderStyle ? getI18nText(props, contentStyle.borderStyle) : getI18nText(props, I18nKey.NONE)),\n    items: borderStyleItems,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleBorderStyleChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.RADIUS), \": \").concat(contentStyle.borderRadius),\n    items: borderRadiusItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderRadiusChange\n  }), createElement(SettingItemColorPicker, {\n    color: contentStyle.borderColor,\n    handleColorChange: handleBorderColorChange\n  })));\n}\n\nfunction ClearAllCustomStyle(props) {\n  var controller = props.controller;\n\n  var handleClearAllCustomStyle = function handleClearAllCustomStyle(e) {\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.CLEAR_ALL_CUSTOM_STYLE\n    }));\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClearAllCustomStyle\n  }, getI18nText(props, I18nKey.CLEAR_ALL_CUSTOM_STYLE))));\n}\n\nvar lineTypes = ['curve', 'round', 'line'];\n\nfunction LinkStyleEditor(props) {\n  var _props$showLinkStyle = props.showLinkStyle,\n      showLinkStyle = _props$showLinkStyle === void 0 ? true : _props$showLinkStyle,\n      _props$showSubLinkSty = props.showSubLinkStyle,\n      showSubLinkStyle = _props$showSubLinkSty === void 0 ? true : _props$showSubLinkSty,\n      _props$linkStyle = props.linkStyle,\n      linkStyle = _props$linkStyle === void 0 ? {} : _props$linkStyle,\n      _props$subLinkStyle = props.subLinkStyle,\n      subLinkStyle = _props$subLinkStyle === void 0 ? {} : _props$subLinkStyle,\n      setLinkStyle = props.setLinkStyle,\n      setSubLinkStyle = props.setSubLinkStyle;\n\n  var handleLinkWidthChange = function handleLinkWidthChange(value) {\n    setLinkStyle({\n      lineWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleLinkTypeChange = function handleLinkTypeChange(value) {\n    setLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleLinkColorChange = function handleLinkColorChange(color) {\n    setLinkStyle({\n      lineColor: color\n    });\n  };\n\n  var handleSubLinkWidthChange = function handleSubLinkWidthChange(value) {\n    setSubLinkStyle({\n      lineWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleSubLinkTypeChange = function handleSubLinkTypeChange(value) {\n    setSubLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleSubLinkColorChange = function handleSubLinkColorChange(color) {\n    setSubLinkStyle({\n      lineColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.LINK)), showLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, getI18nText(props, I18nKey.LINK_TO_PARENT) + ':', ' '), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(linkStyle ? linkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.LINE_TYPE), \": \").concat(getI18nText(props, linkStyle.lineType)),\n    items: lineTypes,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: linkStyle.lineColor,\n    handleColorChange: handleLinkColorChange\n  })), showSubLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, getI18nText(props, I18nKey.SUB_LINKS) + ': '), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(subLinkStyle ? subLinkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleSubLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.LINE_TYPE), \": \").concat(getI18nText(props, subLinkStyle.lineType)),\n    items: lineTypes,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleSubLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: subLinkStyle.lineColor,\n    handleColorChange: handleSubLinkColorChange\n  })));\n}\n\nfunction TextStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleFontSizeChange = function handleFontSizeChange(value) {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({\n      fontSize: value\n    });\n  };\n\n  var handleLineHeightChange = function handleLineHeightChange(e) {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({\n      lineHeight: e.target.value\n    });\n  };\n\n  var handleColorChange = function handleColorChange(color) {\n    setContentStyle({\n      color: color\n    });\n  };\n\n  var fontSizeNumInputProps = {\n    title: \"\".concat(getI18nText(props, I18nKey.FONT_SIZE), \":\"),\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  var lineHeightInputProps = {\n    title: \"\".concat(getI18nText(props, I18nKey.LINE_HEIGHT), \":\"),\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.TEXT_EDITOR)), createElement(Flex, null, createElement(SettingItemNumericInput, Object.assign({}, fontSizeNumInputProps)), createElement(SettingItemInput, Object.assign({}, lineHeightInputProps)), createElement(SettingItemColorPicker, {\n    color: contentStyle.color,\n    handleColorChange: handleColorChange\n  })));\n}\n\nvar log$f = debug('node:style-editor');\nvar copiedStyle;\n\nfunction StyleEditor(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  var setContentStyle = function setContentStyle(style) {\n    controller.run('setTopicContentStyle', _objectSpread(_objectSpread({}, props), {}, {\n      style: style\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(color) {\n    setContentStyle({\n      background: color\n    });\n  };\n\n  var handleClearStyle = function handleClearStyle() {\n    if (topic.style) {\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_STYLE,\n        style: null\n      }));\n    }\n  };\n\n  var handleCopyStyle = function handleCopyStyle() {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log$f(copiedStyle);\n  };\n\n  var handlePasteStyle = function handlePasteStyle() {\n    if (copiedStyle) {\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      }));\n    }\n  };\n\n  if (!model.focusKey) return null;\n  var contentStyle = controller.run('getTopicContentStyle', props);\n  var linkStyle = controller.run('getLinkStyle', props);\n  var subLinkStyle = controller.run('getSubLinkStyle', props);\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    controller.run('setLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n      linkStyle: linkStyle\n    }));\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    controller.run('setSubLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n      subLinkStyle: subLinkStyle\n    }));\n  };\n\n  var linkStyleEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  });\n\n  var contentStyleEditorPros = _objectSpread(_objectSpread({}, props), {}, {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  });\n\n  return createElement(PanelTabRoot, null, createElement(BorderStyleEditor, Object.assign({}, contentStyleEditorPros)), createElement(TextStyleEditor, Object.assign({}, contentStyleEditorPros)), createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BACKGROUND)), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: handleBackgroundColorChange\n  })), createElement(LinkStyleEditor, Object.assign({}, linkStyleEditorProps)), createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.CLEAR_TOPIC_STYLE),\n    onClick: handleClearStyle\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.COPY_STYLE),\n    onClick: handleCopyStyle\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.PASTE_STYLE),\n    onClick: handlePasteStyle\n  })), ClearAllCustomStyle(props));\n}\n/** Event handler that exposes the target element's value as a boolean. */\n\n\nfunction handleBooleanChange(handler) {\n  return function (event) {\n    return handler(event.target.checked);\n  };\n}\n\nvar expand = require('css-shorthand-expand');\n\nfunction PaddingStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n  var padding = expand('padding', contentStyle.padding || '0');\n  var commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  var top = parseInt(padding['padding-top']);\n  var right = parseInt(padding['padding-right']);\n  var bottom = parseInt(padding['padding-bottom']);\n  var left = parseInt(padding['padding-left']);\n  var p = {\n    top: top,\n    right: right,\n    bottom: bottom,\n    left: left\n  };\n\n  var setPadding = function setPadding(dir) {\n    return function (v) {\n      setContentStyle({\n        padding: paddingCss(_objectSpread(_objectSpread({}, p), {}, _defineProperty({}, dir, v)))\n      });\n    };\n  };\n\n  var topProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.TOP),\n    value: top,\n    onValueChange: setPadding('top')\n  });\n\n  var rightProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.RIGHT),\n    value: right,\n    onValueChange: setPadding('right')\n  });\n\n  var bottomProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.BOTTOM),\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  });\n\n  var leftProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.LEFT),\n    value: left,\n    onValueChange: setPadding('left')\n  });\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.PADDING)), createElement(SettingRow, null, createElement(SettingItemNumericInput, Object.assign({}, topProps)), createElement(SettingItemNumericInput, Object.assign({}, rightProps)), createElement(SettingItemNumericInput, Object.assign({}, bottomProps)), createElement(SettingItemNumericInput, Object.assign({}, leftProps))));\n}\n\nvar TopicThemeEditorRoot = styled.div(_templateObject55 || (_templateObject55 = _taggedTemplateLiteral([\"\\n  height: 250px;\\n  overflow: auto;\\n\"])));\n\nfunction TopicThemeEditor(props) {\n  var topicStyle = props.topicStyle,\n      setTopicStyle = props.setTopicStyle;\n  var _topicStyle$contentSt = topicStyle.contentStyle,\n      contentStyle = _topicStyle$contentSt === void 0 ? {} : _topicStyle$contentSt,\n      _topicStyle$linkStyle = topicStyle.linkStyle,\n      linkStyle = _topicStyle$linkStyle === void 0 ? {} : _topicStyle$linkStyle,\n      _topicStyle$subLinkSt = topicStyle.subLinkStyle,\n      subLinkStyle = _topicStyle$subLinkSt === void 0 ? {} : _topicStyle$subLinkSt;\n\n  var setContentStyle = function setContentStyle(contentStyle) {\n    setTopicStyle({\n      contentStyle: contentStyle\n    });\n  };\n\n  var nProps = _objectSpread(_objectSpread({}, props), {}, {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  });\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    setTopicStyle({\n      linkStyle: linkStyle\n    });\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    setTopicStyle({\n      subLinkStyle: subLinkStyle\n    });\n  };\n\n  var linkStyleEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    showLinkStyle: false,\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  });\n\n  return createElement(TopicThemeEditorRoot, null, createElement(BorderStyleEditor, Object.assign({}, nProps)), createElement(PaddingStyleEditor, Object.assign({}, nProps)), createElement(TextStyleEditor, Object.assign({}, nProps)), createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BACKGROUND)), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: function handleColorChange(color) {\n      setContentStyle({\n        background: color\n      });\n    }\n  })), createElement(LinkStyleEditor, Object.assign({}, linkStyleEditorProps)));\n}\n\nvar log$g = debug('node:theme-editor');\nvar tabId = 'normal';\n\nfunction ThemeEditor(props) {\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      alertThemeError = _useState4[0],\n      setAlertThemeError = _useState4[1];\n\n  var model = props.model,\n      controller = props.controller; // cloneDeep\n\n  var theme = cloneDeep(model.config.theme);\n\n  var _controller$run6 = controller.run('getThemeOfTopic', _objectSpread(_objectSpread({}, props), {}, {\n    isClone: true\n  })),\n      rootTopic = _controller$run6.rootTopic,\n      primaryTopic = _controller$run6.primaryTopic,\n      normalTopic = _controller$run6.normalTopic;\n\n  var setTheme = function setTheme(theme) {\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.SET_THEME,\n      theme: theme\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(background) {\n    setTheme(merge(theme, {\n      background: background\n    }));\n  };\n\n  var handleHighlightColorChange = function handleHighlightColorChange(highlightColor) {\n    setTheme(merge(theme, {\n      highlightColor: highlightColor\n    }));\n  };\n\n  var handleRandomColorChange = handleBooleanChange(function (randomColor) {\n    setTheme(merge(theme, {\n      randomColor: randomColor\n    }));\n  });\n\n  var setRootTopicStyle = function setRootTopicStyle(style) {\n    setTheme(merge(theme, {\n      rootTopic: style\n    }));\n  };\n\n  var setPrimaryTopicStyle = function setPrimaryTopicStyle(style) {\n    setTheme(merge(theme, {\n      primaryTopic: style\n    }));\n  };\n\n  var setNormalTopicStyle = function setNormalTopicStyle(style) {\n    setTheme(merge(theme, {\n      normalTopic: style\n    }));\n  };\n\n  var rootTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  });\n\n  var rootTopicEditor = createElement(TopicThemeEditor, Object.assign({}, rootTopicEditorProps));\n\n  var primaryTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  });\n\n  var primaryTopicEditor = createElement(TopicThemeEditor, Object.assign({}, primaryTopicEditorProps));\n\n  var normalTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  });\n\n  var normalTopicEditor = createElement(TopicThemeEditor, Object.assign({}, normalTopicEditorProps));\n  var tabsProps = {\n    id: tabId,\n    handleTabIdChange: function handleTabIdChange(id) {\n      tabId = id;\n    }\n  };\n  var topicThemes = createElement(SettingBoxContainer, null, createElement(Tabs, Object.assign({}, tabsProps), createElement(Tab, {\n    id: \"normal\",\n    title: getI18nText(props, I18nKey.NORMAL_TOPIC),\n    panel: normalTopicEditor\n  }), createElement(Tab, {\n    id: \"primary\",\n    title: getI18nText(props, I18nKey.PRIMARY_TOPIC),\n    panel: primaryTopicEditor\n  }), createElement(Tab, {\n    id: \"root\",\n    title: getI18nText(props, I18nKey.ROOT_TOPIC),\n    panel: rootTopicEditor\n  })));\n\n  var handleExportTheme = function handleExportTheme(e) {\n    // setShowExportDialog(true);\n    var text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n\n  var handleImportTheme = function handleImportTheme(e) {\n    browserOpenFile('.json,.txt').then(function (txt) {\n      var t = JSON.parse(txt);\n\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n\n      setTheme(t);\n    });\n  };\n\n  var alertProps = {\n    isOpen: alertThemeError,\n    onClose: function onClose(e) {\n      setAlertThemeError(false);\n    }\n  };\n  var alert = createElement(Alert, Object.assign({}, alertProps), createElement(\"p\", null, \"File format error\"));\n  return createElement(PanelTabRoot, null, createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.GLOBAL)), createElement(SettingRow, null, createElement(SettingLabel, null, getI18nText(props, I18nKey.BACKGROUND) + ':'), createElement(SettingItemColorPicker, {\n    color: theme.background,\n    handleColorChange: handleBackgroundColorChange\n  }), createElement(SettingLabel, null, getI18nText(props, I18nKey.HIGHLIGHT) + ':'), createElement(SettingItemColorPicker, {\n    color: theme.highlightColor,\n    handleColorChange: handleHighlightColorChange\n  }), createElement(SettingLabel, null, getI18nText(props, I18nKey.RANDOM_COLOR) + ':'), createElement(StyledCheckbox, {\n    checked: theme.randomColor,\n    onChange: handleRandomColorChange\n  }))), topicThemes, createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.EXPORT_THEME),\n    onClick: handleExportTheme\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.IMPORT_THEME),\n    onClick: handleImportTheme\n  })), alert);\n}\n\nfunction RightTopPanelPlugin() {\n  return {\n    renderRightTopPanel: function renderRightTopPanel(props) {\n      var nProps = _objectSpread(_objectSpread({}, props), {}, {\n        key: 'right-top-panel'\n      });\n\n      return createElement(RightTopPanelWidget, Object.assign({}, nProps));\n    },\n    renderRightTopPanelTabs: function renderRightTopPanelTabs(props) {\n      var controller = props.controller;\n      var styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      var themeEditorTab = controller.run('renderThemeEditor', props);\n      return [styleEditorTab, themeEditorTab];\n    },\n    renderTopicStyleEditor: function renderTopicStyleEditor(ctx) {\n      var tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: getI18nText(ctx, I18nKey.TOPIC_STYLE),\n        panel: createElement(StyleEditor, Object.assign({}, ctx))\n      };\n      return createElement(Tab, Object.assign({}, tProps));\n    },\n    renderThemeEditor: function renderThemeEditor(props) {\n      var tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: getI18nText(props, I18nKey.THEME),\n        panel: createElement(ThemeEditor, Object.assign({}, props))\n      };\n      return createElement(Tab, Object.assign({}, tProps));\n    }\n  };\n}\n\nvar ToolbarRoot = styled.div(_templateObject56 || (_templateObject56 = _taggedTemplateLiteral([\"\\n  box-shadow: rgb(170, 170, 170) 0 0 2px;\\n  background: white;\\n  .iconfont {\\n    font-size: 28px !important;\\n  }\\n\"])));\n\nfunction Toolbar(props) {\n  var controller = props.controller;\n  return createElement(ToolbarRoot, null, controller.run('renderToolbarItems', props));\n}\n\nfunction ToolbarItemLayout(props) {\n  var layoutDirs = [[DiagramLayoutType.LEFT_AND_RIGHT, getI18nText(props, I18nKey.LEFT_AND_RIGHT), 'layout-left-and-right'], [DiagramLayoutType.LEFT_TO_RIGHT, getI18nText(props, I18nKey.ONLY_RIGHT), 'layout-right'], [DiagramLayoutType.RIGHT_TO_LEFT, getI18nText(props, I18nKey.ONLY_LEFT), 'layout-left']];\n\n  var onClickSetLayout = function onClickSetLayout(layoutDir) {\n    return function (e) {\n      var controller = props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_LAYOUT_DIR,\n        layoutDir: layoutDir\n      }));\n    };\n  };\n\n  return createElement(ToolbarItem, Object.assign({\n    className: iconClassName(IconName.LAYOUT_LEFT_AND_RIGHT)\n  }, props), createElement(Popover, {\n    enforceFocus: false\n  }, createElement(ToolbarItemPopoverTarget, null), createElement(Menu, null, layoutDirs.map(function (dir) {\n    return createElement(MenuItem, {\n      key: dir[1],\n      icon: Icon(dir[2]),\n      text: dir[1],\n      onClick: onClickSetLayout(dir[0])\n    });\n  }))));\n}\n\nfunction ToolbarPlugin() {\n  return {\n    renderToolbar: function renderToolbar(props) {\n      return createElement(Toolbar, Object.assign({}, props));\n    },\n    renderToolbarItems: function renderToolbarItems(props) {\n      var controller = props.controller;\n      var itemConfigs = controller.run('customizeToolbar', props); //TODO  order\n\n      itemConfigs.sort(function (a, b) {\n        return a.order - b.order;\n      });\n      return itemConfigs.map(function (item) {\n        return createElement(item.element, _objectSpread(_objectSpread({}, props), {}, {\n          key: item.order.toString()\n        }));\n      });\n    },\n    customizeToolbar: function customizeToolbar(props) {\n      return [{\n        order: 100,\n        element: ToolbarItemLayout\n      }];\n    }\n  };\n}\n\nvar log$h = debug('plugin:utils');\n\nfunction UtilsPlugin() {\n  var tempValueMap = new Map();\n  var eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener: function addTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n\n      eventListenerMap.get(key).push(listener);\n    },\n    removeTempValueChangeListener: function removeTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap.get(key).filter(function (l) {\n          return l !== listener;\n        });\n      }\n    },\n    getTempValue: function getTempValue(props) {\n      var key = props.key;\n      log$h('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n    setTempValue: function setTempValue(props) {\n      var key = props.key,\n          value = props.value;\n      log$h('setTempValue', key);\n      tempValueMap.set(key, value);\n\n      if (eventListenerMap.has(key)) {\n        var listeners = eventListenerMap.get(key);\n\n        var _iterator4 = _createForOfIteratorHelper(listeners),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var listener = _step4.value;\n            listener(value);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n    },\n    deleteTempValue: function deleteTempValue(props) {\n      var key = props.key;\n      log$h('deleteTempValue', key);\n      var value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n\nfunction ReactPlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return [RenderingPlugin(), UtilsPlugin(), ContextMenuPlugin(), RightTopPanelPlugin(), ToolbarPlugin(), DragAndDropPlugin()];\n}\n\nvar log$i = debug('node:text-editor');\nvar Content = styled.div(_templateObject57 || (_templateObject57 = _taggedTemplateLiteral([\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"])), function (props) {\n  return props.readOnly ? null : 'white';\n}, function (props) {\n  return props.readOnly ? 'pointer' : 'text';\n});\n\nvar SimpleTextEditor = /*#__PURE__*/function (_PureComponent2) {\n  _inherits(SimpleTextEditor, _PureComponent2);\n\n  var _super16 = _createSuper(SimpleTextEditor);\n\n  function SimpleTextEditor(props) {\n    var _this13;\n\n    _classCallCheck(this, SimpleTextEditor);\n\n    _this13 = _super16.call(this, props);\n    _this13.state = {\n      content: null\n    };\n\n    _this13.onMouseDown = function (e) {\n      e.stopPropagation();\n    };\n\n    _this13.onMouseMove = function (e) {// log('onMouseMove');\n      // e.stopPropagation();\n    };\n\n    _this13.onKeyDown = function (e) {};\n\n    _this13._handleClick = function (event) {\n      var wasOutside = !_this13.root.contains(event.target);\n      wasOutside && _this13.onClickOutSide(event);\n    };\n\n    _this13.rootRef = function (saveRef) {\n      return function (ref) {\n        saveRef(ref);\n        _this13.root = ref;\n      };\n    };\n\n    _this13.initState();\n\n    return _this13;\n  }\n\n  _createClass(SimpleTextEditor, [{\n    key: \"onChange\",\n    value: function onChange(_ref10) {\n      var value = _ref10.value;\n      log$i('onChange', value);\n      this.setState({\n        content: value\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var readOnly = this.props.readOnly;\n      if (readOnly) return;\n      document.addEventListener('click', this._handleClick);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var readOnly = this.props.readOnly;\n      if (readOnly) return;\n      document.removeEventListener('click', this._handleClick);\n    }\n  }, {\n    key: \"onClickOutSide\",\n    value: function onClickOutSide(e) {}\n  }, {\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      return null;\n    }\n  }, {\n    key: \"getContent\",\n    value: function getContent() {\n      var _this$getCustomizePro = this.getCustomizeProps(),\n          block = _this$getCustomizePro.block;\n\n      var content = block.data;\n      if (content == null) return null;\n\n      if (typeof content === 'string') {\n        content = plainSerializer.deserialize(content);\n      }\n\n      return content;\n    }\n  }, {\n    key: \"initState\",\n    value: function initState() {\n      var content = this.getContent();\n      this.state = {\n        content: content\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props10 = this.props,\n          topicKey = _this$props10.topicKey,\n          saveRef = _this$props10.saveRef;\n\n      var _this$getCustomizePro2 = this.getCustomizeProps(),\n          readOnly = _this$getCustomizePro2.readOnly,\n          getRefKeyFunc = _this$getCustomizePro2.getRefKeyFunc,\n          placeholder = _this$getCustomizePro2.placeholder,\n          style = _this$getCustomizePro2.style;\n\n      log$i(readOnly);\n      var key = getRefKeyFunc(topicKey);\n      var content = readOnly ? this.getContent() : this.state.content;\n      var onMouseDown = this.onMouseDown,\n          onMouseMove = this.onMouseMove,\n          onKeyDown = this.onKeyDown;\n      var editorProps = {\n        value: content,\n        readOnly: readOnly,\n        onChange: this.onChange.bind(this),\n        placeholder: placeholder,\n        style: style\n      };\n      var contentProps = {\n        key: key,\n        readOnly: readOnly,\n        ref: this.rootRef(saveRef(key)),\n        onMouseDown: onMouseDown,\n        onMouseMove: onMouseMove,\n        onKeyDown: onKeyDown\n      };\n      return createElement(Content, Object.assign({}, contentProps), createElement(Editor, Object.assign({}, editorProps, {\n        autoFocus: true\n      })));\n    }\n  }]);\n\n  return SimpleTextEditor;\n}(PureComponent);\n\nvar log$j = debug('node:topic-content-editor');\n\nfunction contentEditorRefKey$1(key) {\n  return \"content-editor-\".concat(key);\n}\n\nvar TopicContentEditor = /*#__PURE__*/function (_SimpleTextEditor) {\n  _inherits(TopicContentEditor, _SimpleTextEditor);\n\n  var _super17 = _createSuper(TopicContentEditor);\n\n  function TopicContentEditor(props) {\n    var _this14;\n\n    _classCallCheck(this, TopicContentEditor);\n\n    _this14 = _super17.call(this, props);\n\n    _this14.onKeyDown = function (e) {\n      if (e.nativeEvent.ctrlKey && e.nativeEvent.code === 'Enter') {\n        _this14.save();\n      }\n    };\n\n    return _this14;\n  }\n\n  _createClass(TopicContentEditor, [{\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      var _this$props11 = this.props,\n          model = _this$props11.model,\n          topicKey = _this$props11.topicKey,\n          readOnly = _this$props11.readOnly;\n      var block = model.getTopic(topicKey).getBlock(BlockType.CONTENT).block;\n      var getRefKeyFunc = contentEditorRefKey$1;\n      var style = {\n        whiteSpace: 'pre'\n      };\n      return {\n        block: block,\n        readOnly: readOnly,\n        getRefKeyFunc: getRefKeyFunc,\n        placeholder: 'new',\n        style: style\n      };\n    }\n  }, {\n    key: \"onClickOutSide\",\n    value: function onClickOutSide(e) {\n      log$j('onClickOutSide');\n      this.save();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var _this$props12 = this.props,\n          model = _this$props12.model,\n          topicKey = _this$props12.topicKey;\n      var readOnly = model.editingContentKey !== topicKey;\n      if (readOnly) return;\n      var controller = this.props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, this.props), {}, {\n        opType: OpType.SET_TOPIC_BLOCK,\n        blockType: BlockType.CONTENT,\n        data: this.state.content,\n        focusMode: FocusMode.NORMAL\n      }));\n    }\n  }]);\n\n  return TopicContentEditor;\n}(SimpleTextEditor);\n\nvar log$k = debug('node:topic-desc-editor');\n\nfunction descEditorRefKey$1(key) {\n  return \"desc-editor-\".concat(key);\n}\n\nvar TopicDescEditor = /*#__PURE__*/function (_SimpleTextEditor2) {\n  _inherits(TopicDescEditor, _SimpleTextEditor2);\n\n  var _super18 = _createSuper(TopicDescEditor);\n\n  function TopicDescEditor(props) {\n    var _this15;\n\n    _classCallCheck(this, TopicDescEditor);\n\n    _this15 = _super18.call(this, props);\n    log$k('constructor');\n    return _this15;\n  }\n\n  _createClass(TopicDescEditor, [{\n    key: \"initState\",\n    value: function initState() {\n      _get(_getPrototypeOf(TopicDescEditor.prototype), \"initState\", this).call(this);\n\n      var _this$props13 = this.props,\n          controller = _this$props13.controller,\n          topicKey = _this$props13.topicKey;\n      var key = \"topic-desc-data-\".concat(topicKey);\n      var value = this.state.content;\n      controller.run('setTempValue', {\n        key: key,\n        value: value\n      });\n    }\n  }, {\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      var _this$props14 = this.props,\n          model = _this$props14.model,\n          topicKey = _this$props14.topicKey;\n      var block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n      var readOnly = model.editingDescKey !== topicKey;\n      var getRefKeyFunc = descEditorRefKey$1;\n      return {\n        block: block,\n        readOnly: readOnly,\n        getRefKeyFunc: getRefKeyFunc,\n        placeholder: 'write topic notes here'\n      };\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(_ref11) {\n      var value = _ref11.value;\n      log$k('onChange');\n      var _this$props15 = this.props,\n          controller = _this$props15.controller,\n          topicKey = _this$props15.topicKey,\n          model = _this$props15.model;\n      var readOnly = model.editingDescKey !== topicKey;\n      if (readOnly) return;\n      var key = \"topic-desc-data-\".concat(topicKey);\n      controller.run('setTempValue', {\n        key: key,\n        value: value\n      });\n      this.setState({\n        content: value\n      });\n    }\n  }]);\n\n  return TopicDescEditor;\n}(SimpleTextEditor);\n\nfunction SimpleTextEditorPlugin() {\n  return {\n    getTopicTitle: function getTopicTitle(props) {\n      var model = props.model,\n          controller = props.controller,\n          topicKey = props.topicKey,\n          maxLength = props.maxLength;\n      var topic = model.getTopic(topicKey);\n      var block = topic.getBlock(BlockType.CONTENT).block;\n      var text = controller.run('serializeBlockData', _objectSpread(_objectSpread({}, props), {}, {\n        block: block\n      }));\n\n      if (maxLength != null) {\n        text = text.length > maxLength ? text.substr(0, maxLength) + '...' : text;\n      }\n\n      return text;\n    },\n    renderTopicContentEditor: function renderTopicContentEditor(props) {\n      return createElement(TopicContentEditor, Object.assign({}, props));\n    },\n    renderTopicDescEditor: function renderTopicDescEditor(props) {\n      return createElement(TopicDescEditor, Object.assign({}, props));\n    },\n    isBlockEmpty: function isBlockEmpty(props, next) {\n      var block = props.block,\n          controller = props.controller;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return block.data == null || controller.run('serializeBlockData', props) === '';\n      }\n\n      return next();\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var block = props.block;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return typeof block.data === 'string' ? block.data : plainSerializer.serialize(block.data);\n      }\n\n      return next();\n    }\n  };\n}\n\nvar log$l = debug('plugin:StylePlugin');\n\nfunction StylePlugin() {\n  var colorMap = new Map();\n  var colorIndex = 0;\n  return {\n    getTopicStyle: function getTopicStyle(props) {\n      var controller = props.controller;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n    getTopicContentStyle: function getTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getTopicContentStyle:', topicKey, model);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;else if (visualLevel === TopicVisualLevel.PRIMARY) themeStyle = theme.primaryTopic;else themeStyle = theme.normalTopic;\n      themeStyle = _objectSpread(_objectSpread({}, theme.contentStyle), themeStyle.contentStyle);\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        themeStyle = _objectSpread(_objectSpread({}, themeStyle), {}, {\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: _objectSpread(_objectSpread({}, themeStyle.subLinkStyle), {}, {\n            lineColor: randomColor\n          })\n        });\n      }\n\n      var topic = model.getTopic(topicKey);\n\n      if (!topic.style) {\n        return themeStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _objectSpread(_objectSpread({}, themeStyle), customStyle.contentStyle);\n    },\n    getLinkStyle: function getLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var linkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.linkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.linkStyle;else presetStyle = theme.normalTopic.linkStyle;\n      linkStyle = _objectSpread(_objectSpread({}, linkStyle), presetStyle);\n      var topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        var parentSubLinkStyle = controller.run('getSubLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: topic.parentKey\n        }));\n        linkStyle = _objectSpread(_objectSpread({}, linkStyle), parentSubLinkStyle);\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _objectSpread(_objectSpread({}, linkStyle), customStyle.linkStyle);\n    },\n    getSubLinkStyle: function getSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var subLinkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.subLinkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.subLinkStyle;else presetStyle = theme.normalTopic.subLinkStyle;\n      subLinkStyle = _objectSpread(_objectSpread({}, subLinkStyle), presetStyle);\n      var topic = model.getTopic(topicKey); // color\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        log$l(randomColor);\n        subLinkStyle = _objectSpread(_objectSpread({}, subLinkStyle), {}, {\n          lineColor: randomColor\n        });\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n\n      var res = _objectSpread(_objectSpread({}, subLinkStyle), customStyle.subLinkStyle); // if (res.lineRadius == null) res.lineRadius = 5;\n\n\n      return res;\n    },\n    setTopicContentStyle: function setTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          style = props.style,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var topicStyle = topic.style;\n      var styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        contentStyle: _objectSpread(_objectSpread({}, styleObj.contentStyle), style)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setLinkStyle: function setLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          linkStyle = props.linkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        linkStyle: _objectSpread(_objectSpread({}, styleObj.linkStyle), linkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setSubLinkStyle: function setSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          subLinkStyle = props.subLinkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        subLinkStyle: _objectSpread(_objectSpread({}, styleObj.subLinkStyle), subLinkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    getTopicThemeStyle: function getTopicThemeStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model;\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n    getRandomColor: function getRandomColor(props) {\n      var topicKey = props.topicKey;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      var colors = ['#00CC99', '#FFEE88', '#A167A5', '#E5F993', '#F5C396', '#DB995A', '#83BCFF', '#ED7B84', '#739E82', '#D3BCC0', '#FFA0FD', '#EFD3D7', '#C6878F'];\n      var color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log$l('getRandomColor', topicKey, color);\n      return color;\n    }\n  };\n}\n\nfunction ThemePlugin() {\n  return {\n    getThemeOfTopic: function getThemeOfTopic(ctx) {\n      var model = ctx.model;\n      var theme = model.config.theme;\n      var contentStyle = theme.contentStyle,\n          rootTopic = theme.rootTopic,\n          primaryTopic = theme.primaryTopic,\n          normalTopic = theme.normalTopic;\n      return {\n        rootTopic: _objectSpread(_objectSpread({}, rootTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), rootTopic.contentStyle)\n        }),\n        primaryTopic: _objectSpread(_objectSpread({}, primaryTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), primaryTopic.contentStyle)\n        }),\n        normalTopic: _objectSpread(_objectSpread({}, normalTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), normalTopic.contentStyle)\n        })\n      };\n    }\n  };\n}\n\nfunction DefaultPlugin() {\n  return [ReactPlugin(), LayoutPlugin(), OperationPlugin(), StylePlugin(), EventPlugin(), HotKeyPlugin(), GetValuePlugin(), SimpleTextEditorPlugin(), CreateModelPlugin(), ThemePlugin(), I18nPlugin()];\n}\n\nvar log$m = debug('node:Diagram');\n\nvar Diagram = /*#__PURE__*/function (_Component6) {\n  _inherits(Diagram, _Component6);\n\n  var _super19 = _createSuper(Diagram);\n\n  function Diagram() {\n    var _this16;\n\n    _classCallCheck(this, Diagram);\n\n    _this16 = _super19.apply(this, arguments);\n    _this16.resolveController = memoizeOne(function () {\n      var plugins = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var TheDefaultPlugin = arguments.length > 1 ? arguments[1] : undefined;\n      var defaultPlugin = TheDefaultPlugin();\n      _this16.controller = new Controller({\n        plugins: [plugins, defaultPlugin],\n        onChange: _this16.props.onChange\n      });\n    });\n    return _this16;\n  }\n\n  _createClass(Diagram, [{\n    key: \"getDiagramProps\",\n    value: function getDiagramProps() {\n      return this.controller.run('getDiagramProps');\n    }\n  }, {\n    key: \"openNewModel\",\n    value: function openNewModel(newModel) {\n      var props = this.getDiagramProps();\n      var controller = props.controller;\n      controller.run('openNewModel', _objectSpread(_objectSpread({}, props), {}, {\n        newModel: newModel\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props16 = this.props,\n          plugins = _this$props16.plugins,\n          controller = _this$props16.controller;\n      if (controller) this.controller = controller;else this.resolveController(plugins, DefaultPlugin);\n      var model = this.props.model;\n\n      if (!model) {\n        model = this.controller.run('createNewModel');\n      }\n\n      this.diagramProps = _objectSpread(_objectSpread({}, this.props), {}, {\n        model: model,\n        controller: this.controller\n      });\n      return this.controller.run('renderDiagram', this.diagramProps);\n    }\n  }]);\n\n  return Diagram;\n}(Component);\n\nexport { BaseWidget, Btn, CloseIcon, ColorBar, DefaultPlugin, Diagram, DragScrollWidget, EventKey, Flex, HotKeyName, I18nKey, Icon, IconBg, IconName, Margin, MoveTopicDir, PanelTabRoot, PropKey, PxSelect, RefKey, SaveRef, SettingBoxContainer, SettingGroup, SettingItem, SettingItemButton, SettingItemColorPicker, SettingItemInput, SettingItemNumericInput, SettingItemSelect, SettingLabel, SettingRow, SettingTitle, ShowMenuIcon, StyledCheckbox, Title, ToolbarItem, ToolbarItemPopoverTarget, ToolbarItemRoot, TopicBlockIcon, VListContainer, WithBorder, ZIndex, borderWidthItems, browserDownloadFile, browserDownloadText, browserOpenFile, cancelEvent, center, centerPointX, centerPointY, centerX, centerY, collapseRefKey, contentEditorRefKey, contentRefKey, descEditorRefKey, dropAreaRefKey, getI18nText, getLinkKey, _getRelativeRect as getRelativeRect, getRelativeVector, iconClassName, linksRefKey, linksSvgRefKey, paddingCss, renderItem, renderItemI18n, topicRefKey, topicWidgetRefKey };","import { OpType, FocusMode, ModelModifier } from '@blink-mind/core';\nimport { iconClassName, TopicBlockIcon, BaseWidget, Btn, Icon, IconName, cancelEvent } from '@blink-mind/renderer-react';\nimport { Alert, Tooltip, Position, Classes, Drawer, MenuDivider, MenuItem } from '@blueprintjs/core';\nimport { createElement, Component, Fragment } from 'react';\nimport { Topology } from 'topology-core';\nimport { registerNode } from 'topology-core/middles';\nimport { flowData, flowDataAnchors, flowDataIconRect, flowDataTextRect, flowSubprocess, flowSubprocessIconRect, flowSubprocessTextRect, flowDb, flowDbIconRect, flowDbTextRect, flowDocument, flowDocumentAnchors, flowDocumentIconRect, flowDocumentTextRect, flowInternalStorage, flowInternalStorageIconRect, flowInternalStorageTextRect, flowExternStorage, flowExternStorageAnchors, flowExternStorageIconRect, flowExternStorageTextRect, flowQueue, flowQueueIconRect, flowQueueTextRect, flowManually, flowManuallyAnchors, flowManuallyIconRect, flowManuallyTextRect, flowDisplay, flowDisplayAnchors, flowDisplayIconRect, flowDisplayTextRect, flowParallel, flowParallelAnchors, flowComment, flowCommentAnchors } from 'topology-flow-diagram';\nimport '@blink-mind/icons/iconfont/topology';\nimport styled from 'styled-components';\nimport { activityFinal, activityFinalIconRect, activityFinalTextRect, swimlaneV, swimlaneVIconRect, swimlaneVTextRect, swimlaneH, swimlaneHIconRect, swimlaneHTextRect, fork, forkHAnchors, forkIconRect, forkTextRect, forkVAnchors } from 'topology-activity-diagram';\nimport { simpleClass, simpleClassIconRect, simpleClassTextRect, interfaceClass, interfaceClassIconRect, interfaceClassTextRect } from 'topology-class-diagram';\nimport { lifeline, lifelineAnchors, lifelineIconRect, lifelineTextRect, sequenceFocus, sequenceFocusAnchors, sequenceFocusIconRect, sequenceFocusTextRect } from 'topology-sequence-diagram';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar FOCUS_MODE_EDITING_TOPOLOGY = 'FOCUS_MODE_EDITING_TOPOLOGY';\nvar OP_TYPE_START_EDITING_TOPOLOGY = 'OP_TYPE_START_EDITING_TOPOLOGY';\nvar BLOCK_TYPE_TOPOLOGY = 'TOPOLOGY';\nvar REF_KEY_TOPOLOGY_DIAGRAM = 'TOPOLOGY_DIAGRAM';\nvar REF_KEY_TOPOLOGY_DIAGRAM_UTIL = 'TOPOLOGY_DIAGRAM_UTIL';\n\nfunction TopicBlockTopology(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OP_TYPE_START_EDITING_TOPOLOGY\n    }));\n  };\n\n  var isEditing = model.focusKey === topicKey && model.focusMode === FOCUS_MODE_EDITING_TOPOLOGY;\n  var block = model.getTopic(topicKey).getBlock(BLOCK_TYPE_TOPOLOGY).block;\n  if (!isEditing && !block) return null;\n  var iconProps = {\n    className: iconClassName('topology'),\n    onClick: onClick,\n    tabIndex: -1\n  };\n  return createElement(TopicBlockIcon, _assign({}, iconProps));\n}\n\nvar ToolsConfig = [{\n  group: 'Basic',\n  children: [{\n    name: 'rectangle',\n    icon: 'icon-rect',\n    data: {\n      text: 'Topology',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      paddingLeft: 10,\n      paddingRight: 10,\n      paddingTop: 10,\n      paddingBottom: 10,\n      name: 'rectangle',\n      icon: \"\\uE64D\",\n      iconFamily: 'topology',\n      iconColor: '#2f54eb'\n    }\n  }, {\n    name: 'rectangle',\n    icon: 'icon-rectangle',\n    data: {\n      text: 'rectangle',\n      rect: {\n        width: 200,\n        height: 50\n      },\n      paddingLeft: 10,\n      paddingRight: 10,\n      paddingTop: 10,\n      paddingBottom: 10,\n      borderRadius: 0.1,\n      name: 'rectangle'\n    }\n  }, {\n    name: 'circle',\n    icon: 'icon-circle',\n    data: {\n      text: 'circle',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'circle',\n      textMaxLine: 1\n    }\n  }, {\n    name: 'triangle',\n    icon: 'icon-triangle',\n    data: {\n      text: 'triangle',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'triangle'\n    }\n  }, {\n    name: 'diamond',\n    icon: 'icon-diamond',\n    data: {\n      text: 'diamond',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'diamond'\n    }\n  }, {\n    name: 'pentagon',\n    icon: 'icon-pentagon',\n    data: {\n      text: 'pentagon',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'pentagon'\n    }\n  }, {\n    name: 'hexagon',\n    icon: 'icon-hexagon',\n    data: {\n      text: 'hexagon',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      paddingTop: 10,\n      paddingBottom: 10,\n      name: 'hexagon'\n    }\n  }, {\n    name: 'pentagram',\n    icon: 'icon-pentagram',\n    data: {\n      text: 'pentagram',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'pentagram'\n    }\n  }, {\n    name: 'left arrow',\n    icon: 'icon-arrow-left',\n    data: {\n      text: '',\n      rect: {\n        width: 200,\n        height: 100\n      },\n      name: 'leftArrow'\n    }\n  }, {\n    name: 'right arrow',\n    icon: 'icon-arrow-right',\n    data: {\n      text: '',\n      rect: {\n        width: 200,\n        height: 100\n      },\n      name: 'rightArrow'\n    }\n  }, {\n    name: 'bidirectional arrow',\n    icon: 'icon-twoway-arrow',\n    data: {\n      text: '',\n      rect: {\n        width: 200,\n        height: 100\n      },\n      name: 'twowayArrow'\n    }\n  }, {\n    name: 'line',\n    icon: 'icon-line',\n    data: {\n      text: 'line',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'line'\n    }\n  }, {\n    name: 'cloud',\n    icon: 'icon-cloud',\n    data: {\n      text: 'cloud',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'cloud'\n    }\n  }, {\n    name: 'message',\n    icon: 'icon-msg',\n    data: {\n      text: 'message',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      paddingLeft: 10,\n      paddingRight: 10,\n      paddingTop: 10,\n      paddingBottom: 10,\n      name: 'message'\n    }\n  }, {\n    name: 'file',\n    icon: 'icon-file',\n    data: {\n      text: 'file',\n      rect: {\n        width: 80,\n        height: 100\n      },\n      paddingLeft: 10,\n      paddingRight: 10,\n      paddingTop: 10,\n      paddingBottom: 10,\n      name: 'file'\n    }\n  }, {\n    name: 'text',\n    icon: 'icon-text',\n    data: {\n      text: 'text',\n      rect: {\n        width: 160,\n        height: 30\n      },\n      name: 'text'\n    }\n  }, {\n    name: 'image',\n    icon: 'icon-image',\n    data: {\n      text: '',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'image',\n      image: '/assets/img/logo.png'\n    }\n  }, {\n    name: 'cube',\n    icon: 'icon-cube',\n    data: {\n      rect: {\n        width: 50,\n        height: 70\n      },\n      is3D: true,\n      z: 10,\n      zRotate: 15,\n      fillStyle: '#ddd',\n      name: 'cube',\n      icon: \"\\uE63C\",\n      iconFamily: 'topology',\n      iconColor: '#777',\n      iconSize: 30\n    }\n  }, {\n    name: 'people',\n    icon: 'icon-people',\n    data: {\n      rect: {\n        width: 70,\n        height: 100\n      },\n      name: 'people'\n    }\n  }, {\n    name: 'multi media',\n    icon: 'icon-pc',\n    data: {\n      text: 'multi media',\n      rect: {\n        width: 200,\n        height: 200\n      },\n      paddingLeft: 10,\n      paddingRight: 10,\n      paddingTop: 10,\n      paddingBottom: 10,\n      // strokeStyle: 'transparent',\n      name: 'div'\n    }\n  }]\n}, {\n  group: 'Flow Graph',\n  children: [{\n    name: 'start/end',\n    icon: 'icon-flow-start',\n    data: {\n      text: 'start',\n      rect: {\n        width: 120,\n        height: 40\n      },\n      borderRadius: 0.5,\n      name: 'rectangle'\n    }\n  }, {\n    name: 'flow',\n    icon: 'icon-rectangle',\n    data: {\n      text: 'flow',\n      rect: {\n        width: 120,\n        height: 40\n      },\n      name: 'rectangle'\n    }\n  }, {\n    name: 'judgement',\n    icon: 'icon-diamond',\n    data: {\n      text: 'judgement',\n      rect: {\n        width: 120,\n        height: 60\n      },\n      name: 'diamond'\n    }\n  }, {\n    name: 'data',\n    icon: 'icon-flow-data',\n    data: {\n      text: 'data',\n      rect: {\n        width: 120,\n        height: 50\n      },\n      name: 'flowData'\n    }\n  }, {\n    name: 'prepare',\n    icon: 'icon-flow-ready',\n    data: {\n      text: 'prepare',\n      rect: {\n        width: 120,\n        height: 50\n      },\n      name: 'hexagon'\n    }\n  }, {\n    name: 'sub flow',\n    icon: 'icon-flow-subprocess',\n    data: {\n      text: 'sub flow',\n      rect: {\n        width: 120,\n        height: 50\n      },\n      name: 'flowSubprocess'\n    }\n  }, {\n    name: 'database',\n    icon: 'icon-db',\n    data: {\n      text: 'database',\n      rect: {\n        width: 80,\n        height: 120\n      },\n      name: 'flowDb'\n    }\n  }, {\n    name: 'document',\n    icon: 'icon-flow-document',\n    data: {\n      text: 'document',\n      rect: {\n        width: 120,\n        height: 100\n      },\n      name: 'flowDocument'\n    }\n  }, {\n    name: 'internal storage',\n    icon: 'icon-internal-storage',\n    data: {\n      text: 'internal storage',\n      rect: {\n        width: 120,\n        height: 80\n      },\n      name: 'flowInternalStorage'\n    }\n  }, {\n    name: 'external storage',\n    icon: 'icon-extern-storage',\n    data: {\n      text: 'external storage',\n      rect: {\n        width: 120,\n        height: 80\n      },\n      name: 'flowExternStorage'\n    }\n  }, {\n    name: 'queue',\n    icon: 'icon-flow-queue',\n    data: {\n      text: 'queue',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'flowQueue'\n    }\n  }, {\n    name: 'input manually',\n    icon: 'icon-flow-manually',\n    data: {\n      text: 'input manually',\n      rect: {\n        width: 120,\n        height: 80\n      },\n      name: 'flowManually'\n    }\n  }, {\n    name: 'display',\n    icon: 'icon-flow-display',\n    data: {\n      text: 'display',\n      rect: {\n        width: 120,\n        height: 80\n      },\n      name: 'flowDisplay'\n    }\n  }, {\n    name: 'parallel',\n    icon: 'icon-flow-parallel',\n    data: {\n      text: 'parallel',\n      rect: {\n        width: 120,\n        height: 50\n      },\n      name: 'flowParallel'\n    }\n  }, {\n    name: 'comment',\n    icon: 'icon-flow-comment',\n    data: {\n      text: 'comment',\n      rect: {\n        width: 100,\n        height: 100\n      },\n      name: 'flowComment'\n    }\n  }]\n}, {\n  group: 'Activity Diagram',\n  children: [{\n    name: 'start',\n    icon: 'icon-inital',\n    data: {\n      text: '',\n      rect: {\n        width: 30,\n        height: 30\n      },\n      name: 'circle',\n      fillStyle: '#555',\n      strokeStyle: 'transparent'\n    }\n  }, {\n    name: 'end',\n    icon: 'icon-final',\n    data: {\n      text: '',\n      rect: {\n        width: 30,\n        height: 30\n      },\n      name: 'activityFinal'\n    }\n  }, {\n    name: 'action',\n    icon: 'icon-action',\n    data: {\n      text: 'action',\n      rect: {\n        width: 120,\n        height: 50\n      },\n      borderRadius: 0.25,\n      name: 'rectangle'\n    }\n  }, {\n    name: 'decision/merge',\n    icon: 'icon-diamond',\n    data: {\n      text: '',\n      rect: {\n        width: 120,\n        height: 50\n      },\n      name: 'diamond'\n    }\n  }, {\n    name: 'vertical swimming lane',\n    icon: 'icon-swimlane-v',\n    data: {\n      text: 'vertical swimming lane',\n      rect: {\n        width: 200,\n        height: 500\n      },\n      name: 'swimlaneV'\n    }\n  }, {\n    name: 'horizontal swimming lane',\n    icon: 'icon-swimlane-h',\n    data: {\n      text: 'horizontal swimming lane',\n      rect: {\n        width: 500,\n        height: 200\n      },\n      name: 'swimlaneH'\n    }\n  }, {\n    name: 'vertical fork/merge',\n    icon: 'icon-fork-v',\n    data: {\n      text: '',\n      rect: {\n        width: 10,\n        height: 150\n      },\n      name: 'forkV',\n      fillStyle: '#555',\n      strokeStyle: 'transparent'\n    }\n  }, {\n    name: 'horizontal fork/merge',\n    icon: 'icon-fork',\n    data: {\n      text: '',\n      rect: {\n        width: 150,\n        height: 10\n      },\n      name: 'forkH',\n      fillStyle: '#555',\n      strokeStyle: 'transparent'\n    }\n  }]\n}, {\n  group: 'Sequence Diagram && Class Diagram',\n  children: [{\n    name: 'lifeline',\n    icon: 'icon-lifeline',\n    data: {\n      text: 'lifeline',\n      rect: {\n        width: 150,\n        height: 400\n      },\n      name: 'lifeline'\n    }\n  }, {\n    name: 'activation',\n    icon: 'icon-focus',\n    data: {\n      text: '',\n      rect: {\n        width: 12,\n        height: 200\n      },\n      name: 'sequenceFocus'\n    }\n  }, {\n    name: 'simple class',\n    icon: 'icon-simple-class',\n    data: {\n      text: 'Topolgoy',\n      rect: {\n        width: 270,\n        height: 200\n      },\n      paddingTop: 40,\n      font: {\n        fontFamily: 'Arial',\n        color: '#222',\n        fontWeight: 'bold'\n      },\n      fillStyle: '#ffffba',\n      strokeStyle: '#7e1212',\n      name: 'simpleClass',\n      children: [{\n        text: '- name: string\\n+ setName(name: string): void',\n        name: 'text',\n        paddingLeft: 10,\n        paddingRight: 10,\n        paddingTop: 10,\n        paddingBottom: 10,\n        rectInParent: {\n          x: 0,\n          y: 0,\n          width: '100%',\n          height: '100%',\n          rotate: 0\n        },\n        font: {\n          fontFamily: 'Arial',\n          color: '#222',\n          textAlign: 'left',\n          textBaseline: 'top'\n        }\n      }]\n    }\n  }, {\n    name: 'class',\n    icon: 'icon-class',\n    data: {\n      text: 'Topolgoy',\n      rect: {\n        width: 270,\n        height: 200\n      },\n      paddingTop: 40,\n      font: {\n        fontFamily: 'Arial',\n        color: '#222',\n        fontWeight: 'bold'\n      },\n      fillStyle: '#ffffba',\n      strokeStyle: '#7e1212',\n      name: 'interfaceClass',\n      children: [{\n        text: '- name: string',\n        name: 'text',\n        paddingLeft: 10,\n        paddingRight: 10,\n        paddingTop: 10,\n        paddingBottom: 10,\n        rectInParent: {\n          x: 0,\n          y: 0,\n          width: '100%',\n          height: '50%',\n          rotate: 0\n        },\n        font: {\n          fontFamily: 'Arial',\n          color: '#222',\n          textAlign: 'left',\n          textBaseline: 'top'\n        }\n      }, {\n        text: '+ setName(name: string): void',\n        name: 'text',\n        paddingLeft: 10,\n        paddingRight: 10,\n        paddingTop: 10,\n        paddingBottom: 10,\n        rectInParent: {\n          x: 0,\n          y: '50%',\n          width: '100%',\n          height: '50%',\n          rotate: 0\n        },\n        font: {\n          fontFamily: 'Arial',\n          color: '#222',\n          textAlign: 'left',\n          textBaseline: 'top'\n        }\n      }]\n    }\n  }]\n}];\nvar Root = styled.div(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: relative;\\n  display: flex;\\n  width: 100%;\\n  height: 100%;\\n\"], [\"\\n  position: relative;\\n  display: flex;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar Canvas = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  flex: 1;\\n  width: initial;\\n  position: relative;\\n  overflow: auto;\\n  background: #fff;\\n\"], [\"\\n  flex: 1;\\n  width: initial;\\n  position: relative;\\n  overflow: auto;\\n  background: #fff;\\n\"])));\nvar Tools = styled.div(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  flex-shrink: 0;\\n  width: 1.75rem;\\n  background-color: #f8f8f8;\\n  border-right: 1px solid #d9d9d9;\\n  overflow-y: auto;\\n\"], [\"\\n  flex-shrink: 0;\\n  width: 1.75rem;\\n  background-color: #f8f8f8;\\n  border-right: 1px solid #d9d9d9;\\n  overflow-y: auto;\\n\"])));\nvar ToolTitle = styled.div(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  color: #0d1a26;\\n  font-weight: 600;\\n  font-size: 0.12rem;\\n  padding: 0.05rem 0.1rem;\\n  margin-top: 0.08rem;\\n  border-bottom: 1px solid #ddd;\\n\\n  &:first-child {\\n    border-top: none;\\n  }\\n\"], [\"\\n  color: #0d1a26;\\n  font-weight: 600;\\n  font-size: 0.12rem;\\n  padding: 0.05rem 0.1rem;\\n  margin-top: 0.08rem;\\n  border-bottom: 1px solid #ddd;\\n\\n  &:first-child {\\n    border-top: none;\\n  }\\n\"])));\nvar ToolbarButtons = styled.div(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  padding: 0.1rem 0;\\n  a {\\n    display: inline-block;\\n    color: @text-color;\\n    line-height: 1;\\n    width: 0.4rem;\\n    height: 0.4rem;\\n    text-align: center;\\n    text-decoration: none !important;\\n\\n    .iconfont {\\n      font-size: 0.24rem;\\n    }\\n  }\\n\"], [\"\\n  padding: 0.1rem 0;\\n  a {\\n    display: inline-block;\\n    color: @text-color;\\n    line-height: 1;\\n    width: 0.4rem;\\n    height: 0.4rem;\\n    text-align: center;\\n    text-decoration: none !important;\\n\\n    .iconfont {\\n      font-size: 0.24rem;\\n    }\\n  }\\n\"])));\n\nvar TopologyDiagram = function (_super) {\n  __extends(TopologyDiagram, _super);\n\n  function TopologyDiagram() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      id: '',\n      data: null,\n      toolsConfig: ToolsConfig,\n      iconfont: {\n        fontSize: '0.24rem'\n      }\n    };\n    _this.canvasOptions = {};\n\n    _this.handleContextMenu = function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n    };\n\n    _this.onMessage = function (event, data) {\n      var getRef = _this.props.getRef;\n      var diagramUtil = getRef(REF_KEY_TOPOLOGY_DIAGRAM_UTIL);\n\n      switch (event) {\n        case 'resize':\n        case 'scale':\n        case 'locked':\n          if (_this.topology && diagramUtil) {\n            diagramUtil.setCanvasData(_this.topology.data);\n          }\n\n          break;\n      }\n    };\n\n    return _this;\n  }\n\n  TopologyDiagram.prototype.canvasRegister = function () {\n    registerNode('flowData', flowData, flowDataAnchors, flowDataIconRect, flowDataTextRect);\n    registerNode('flowSubprocess', flowSubprocess, null, flowSubprocessIconRect, flowSubprocessTextRect);\n    registerNode('flowDb', flowDb, null, flowDbIconRect, flowDbTextRect);\n    registerNode('flowDocument', flowDocument, flowDocumentAnchors, flowDocumentIconRect, flowDocumentTextRect);\n    registerNode('flowInternalStorage', flowInternalStorage, null, flowInternalStorageIconRect, flowInternalStorageTextRect);\n    registerNode('flowExternStorage', flowExternStorage, flowExternStorageAnchors, flowExternStorageIconRect, flowExternStorageTextRect);\n    registerNode('flowQueue', flowQueue, null, flowQueueIconRect, flowQueueTextRect);\n    registerNode('flowManually', flowManually, flowManuallyAnchors, flowManuallyIconRect, flowManuallyTextRect);\n    registerNode('flowDisplay', flowDisplay, flowDisplayAnchors, flowDisplayIconRect, flowDisplayTextRect);\n    registerNode('flowParallel', flowParallel, flowParallelAnchors, null, null);\n    registerNode('flowComment', flowComment, flowCommentAnchors, null, null); // activity\n\n    registerNode('activityFinal', activityFinal, null, activityFinalIconRect, activityFinalTextRect);\n    registerNode('swimlaneV', swimlaneV, null, swimlaneVIconRect, swimlaneVTextRect);\n    registerNode('swimlaneH', swimlaneH, null, swimlaneHIconRect, swimlaneHTextRect);\n    registerNode('forkH', fork, forkHAnchors, forkIconRect, forkTextRect);\n    registerNode('forkV', fork, forkVAnchors, forkIconRect, forkTextRect); // class\n\n    registerNode('simpleClass', simpleClass, null, simpleClassIconRect, simpleClassTextRect);\n    registerNode('interfaceClass', interfaceClass, null, interfaceClassIconRect, interfaceClassTextRect); // sequence\n\n    registerNode('lifeline', lifeline, lifelineAnchors, lifelineIconRect, lifelineTextRect);\n    registerNode('sequenceFocus', sequenceFocus, sequenceFocusAnchors, sequenceFocusIconRect, sequenceFocusTextRect);\n  };\n\n  TopologyDiagram.prototype.componentDidMount = function () {\n    this.canvasRegister();\n    this.canvasOptions.on = this.onMessage;\n    this.topology = new Topology('topology-canvas', this.canvasOptions);\n    this.openData();\n  };\n\n  TopologyDiagram.prototype.componentDidUpdate = function () {\n    this.openData();\n  };\n\n  TopologyDiagram.prototype.openData = function () {\n    var _a = this.props,\n        model = _a.model,\n        topicKey = _a.topicKey;\n    var topic = model.getTopic(topicKey);\n    var block = topic.getBlock(BLOCK_TYPE_TOPOLOGY).block;\n\n    if (block && block.data && block.data !== '') {\n      this.setState({\n        data: block.data\n      });\n      this.topology.open(block.data);\n    }\n  };\n\n  TopologyDiagram.prototype.onDrag = function (event, node) {\n    event.dataTransfer.setData('Text', JSON.stringify(node.data));\n  };\n\n  TopologyDiagram.prototype.renderTools = function () {\n    var _this = this;\n\n    return createElement(Tools, null, this.state.toolsConfig.map(function (item, index) {\n      return createElement(\"div\", {\n        key: index\n      }, createElement(ToolTitle, null, item.group), createElement(ToolbarButtons, null, //TODO\n      //@ts-ignore\n      item.children.map(function (btn, i) {\n        return createElement(\"a\", {\n          key: i,\n          title: btn.name,\n          draggable: true,\n          onDragStart: function onDragStart(ev) {\n            _this.onDrag(ev, btn);\n          }\n        }, createElement(\"i\", {\n          className: 'iconfont ' + btn.icon,\n          style: _this.state.iconfont\n        }));\n      })));\n    }));\n  };\n\n  TopologyDiagram.prototype.render = function () {\n    return createElement(Root, null, this.renderTools(), createElement(Canvas, {\n      id: \"topology-canvas\",\n      onContextMenu: this.handleContextMenu\n    }));\n  };\n\n  return TopologyDiagram;\n}(BaseWidget);\n\nvar templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;\nvar Root$1 = styled.div(templateObject_1$1 || (templateObject_1$1 = __makeTemplateObject([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  z-index: 3;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  z-index: 3;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"])));\nvar Item_ = styled(Btn)(templateObject_2$1 || (templateObject_2$1 = __makeTemplateObject([\"\\n  margin: 10px;\\n\"], [\"\\n  margin: 10px;\\n\"])));\n\nvar Item = function Item(props) {\n  return createElement(Tooltip, {\n    content: props.tooltip,\n    position: Position.TOP,\n    className: Classes.ICON\n  }, createElement(Item_, {\n    onClick: props.onClick\n  }, props.children));\n};\n\nvar ZoomFactorSpan = styled.span(templateObject_3$1 || (templateObject_3$1 = __makeTemplateObject([\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"], [\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"])));\n\nvar TopologyDiagramUtils = function (_super) {\n  __extends(TopologyDiagramUtils, _super);\n\n  function TopologyDiagramUtils(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.setCanvasData = function (canvasData) {\n      _this.setState({\n        canvasData: canvasData\n      });\n    };\n\n    _this.onClickResetZoom = function (e) {\n      var topology = _this.getTopology();\n\n      topology.scaleTo(1);\n    };\n\n    _this.state = {\n      deleteConfirm: false,\n      canvasData: null\n    };\n    return _this;\n  }\n\n  TopologyDiagramUtils.prototype.getTopology = function () {\n    var getRef = this.props.getRef;\n    return getRef(REF_KEY_TOPOLOGY_DIAGRAM).topology;\n  };\n\n  TopologyDiagramUtils.prototype.render = function () {\n    var _this = this;\n\n    var props = this.props;\n    var controller = props.controller;\n\n    var onClickDelete = function onClickDelete(e) {\n      _this.setState({\n        deleteConfirm: true\n      });\n    };\n\n    var deleteAlertProps = {\n      isOpen: this.state.deleteConfirm,\n      cancelButtonText: 'cancel',\n      onConfirm: function onConfirm(e) {\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OpType.DELETE_TOPIC_BLOCK,\n          blockType: BLOCK_TYPE_TOPOLOGY\n        }));\n      },\n      onCancel: function onCancel(e) {\n        _this.setState({\n          deleteConfirm: false\n        });\n      },\n      onClose: function onClose(e) {\n        _this.setState({\n          deleteConfirm: false\n        });\n      }\n    };\n    var canvasData = this.state.canvasData;\n    var scale = canvasData ? canvasData.scale : 1;\n    return createElement(Root$1, null, createElement(Item, {\n      onClick: this.onClickResetZoom,\n      tooltip: \"reset zoom\"\n    }, createElement(ZoomFactorSpan, null, \"zoom:\" + Math.floor(scale * 100) + \"%\")), createElement(Item, {\n      onClick: onClickDelete,\n      tooltip: \"delete this diagram\"\n    }, Icon(IconName.TRASH)), createElement(Alert, _assign({}, deleteAlertProps), createElement(\"p\", null, \"Are you confirm to delete this topology diagram?\")));\n  };\n\n  return TopologyDiagramUtils;\n}(Component);\n\nvar templateObject_1$1, templateObject_2$1, templateObject_3$1;\nvar DiagramWrapper = styled.div(templateObject_1$2 || (templateObject_1$2 = __makeTemplateObject([\"\\n  position: relative;\\n  overflow: auto;\\n  padding: 0px 0px 0px 5px;\\n  background: #88888850;\\n  height: 100%;\\n\"], [\"\\n  position: relative;\\n  overflow: auto;\\n  padding: 0px 0px 0px 5px;\\n  background: #88888850;\\n  height: 100%;\\n\"])));\nvar Title = styled.span(templateObject_2$2 || (templateObject_2$2 = __makeTemplateObject([\"\\n  padding: 0px 20px;\\n\"], [\"\\n  padding: 0px 20px;\\n\"])));\n\nfunction TopologyDrawer(props) {\n  var controller = props.controller,\n      topicKey = props.topicKey,\n      getRef = props.getRef,\n      saveRef = props.saveRef;\n\n  var onDiagramClose = function onDiagramClose(e) {\n    e.stopPropagation(); // const key = `topic-topology-data-${topicKey}`;\n    // const topologyData = controller.run('deleteTempValue', { key });\n\n    var diagram = getRef(REF_KEY_TOPOLOGY_DIAGRAM);\n    var topologyData = diagram.topology.data;\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_TOPIC_BLOCK,\n      topicKey: topicKey,\n      blockType: BLOCK_TYPE_TOPOLOGY,\n      data: topologyData,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  var diagramProps = _assign(_assign({}, props), {\n    ref: saveRef(REF_KEY_TOPOLOGY_DIAGRAM)\n  });\n\n  var utilProps = _assign(_assign({}, props), {\n    ref: saveRef(REF_KEY_TOPOLOGY_DIAGRAM_UTIL)\n  });\n\n  return createElement(Drawer, {\n    title: createElement(Title, null, \"Topology Diagram Editor\"),\n    icon: Icon('topology'),\n    isOpen: true,\n    hasBackdrop: true,\n    backdropClassName: \"backdrop\",\n    backdropProps: {\n      onMouseDown: cancelEvent\n    },\n    canOutsideClickClose: false,\n    isCloseButtonShown: true,\n    onClose: onDiagramClose,\n    size: \"100%\"\n  }, createElement(DiagramWrapper, {\n    onClick: cancelEvent,\n    onDoubleClick: cancelEvent\n  }, createElement(TopologyDiagram, _assign({}, diagramProps)), createElement(TopologyDiagramUtils, _assign({}, utilProps))));\n}\n\nvar templateObject_1$2, templateObject_2$2;\n\nfunction startEditingTopology(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  var topic = model.getTopic(topicKey);\n  var block = topic.getBlock(BLOCK_TYPE_TOPOLOGY).block;\n\n  if (block == null || block.data == null) {\n    model = ModelModifier.setBlockData({\n      model: model,\n      topicKey: topicKey,\n      blockType: BLOCK_TYPE_TOPOLOGY,\n      data: ''\n    });\n  }\n\n  model = ModelModifier.focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FOCUS_MODE_EDITING_TOPOLOGY\n  });\n  return model;\n}\n\nfunction TopologyDiagramPlugin() {\n  return {\n    renderTopicBlock: function renderTopicBlock(props, next) {\n      var controller = props.controller,\n          block = props.block;\n\n      if (block.type === BLOCK_TYPE_TOPOLOGY) {\n        return controller.run('renderTopicBlockTopology', props);\n      }\n\n      return next();\n    },\n    renderTopicBlockTopology: function renderTopicBlockTopology(props) {\n      return createElement(TopicBlockTopology, _assign({}, props));\n    },\n    renderDrawer: function renderDrawer(props, next) {\n      var model = props.model;\n\n      if (model.focusMode === FOCUS_MODE_EDITING_TOPOLOGY) {\n        var topoProps = _assign(_assign({}, props), {\n          topicKey: model.focusKey,\n          key: 'topology-drawer'\n        });\n\n        return createElement(TopologyDrawer, _assign({}, topoProps));\n      }\n\n      return next();\n    },\n    customizeTopicContextMenu: function customizeTopicContextMenu(props, next) {\n      var controller = props.controller;\n\n      function editTopology(e) {\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OP_TYPE_START_EDITING_TOPOLOGY\n        }));\n      }\n\n      return createElement(Fragment, null, next(), createElement(MenuDivider, null), createElement(MenuItem, {\n        icon: Icon('topology'),\n        text: \"Edit Topology Diagram\",\n        onClick: editTopology\n      }));\n    },\n    getOpMap: function getOpMap(props, next) {\n      var opMap = next();\n      opMap.set(OP_TYPE_START_EDITING_TOPOLOGY, startEditingTopology);\n      return opMap;\n    }\n  };\n}\n\nexport default TopologyDiagramPlugin;","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","var isProduction = process.env.NODE_ENV === 'production';\n\nfunction warning(condition, message) {\n  if (!isProduction) {\n    if (condition) {\n      return;\n    }\n\n    var text = \"Warning: \" + message;\n\n    if (typeof console !== 'undefined') {\n      console.warn(text);\n    }\n\n    try {\n      throw Error(text);\n    } catch (x) {}\n  }\n}\n\nexport default warning;","import _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { Record, List, Map as Map$1 } from 'immutable';\nimport debug from 'debug';\nimport isPlainObject from 'is-plain-object';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT',\n  SET_LAYOUT_DIR: 'SET_LAYOUT_DIR'\n};\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = /*#__PURE__*/function (_Record) {\n  _inherits(Block, _Record);\n\n  var _super = _createSuper(Block);\n\n  function Block() {\n    _classCallCheck(this, Block);\n\n    return _super.apply(this, arguments);\n  }\n\n  _createClass(Block, [{\n    key: \"data\",\n    get: function get() {\n      return this.get('data');\n    }\n  }, {\n    key: \"type\",\n    get: function get() {\n      return this.get('type');\n    }\n  }], [{\n    key: \"create\",\n    value: function create(obj) {\n      return new Block(obj);\n    }\n  }, {\n    key: \"createList\",\n    value: function createList(obj) {\n      if (List.isList(obj) || Array.isArray(obj)) {\n        // @ts-ignore\n        return List(obj.map(Block.create));\n      }\n\n      throw new Error(\"Block.createList only accepts Array or List, but you passed it: \".concat(obj));\n    }\n  }]);\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = /*#__PURE__*/function (_Record2) {\n  _inherits(Config, _Record2);\n\n  var _super2 = _createSuper(Config);\n\n  function Config() {\n    _classCallCheck(this, Config);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(Config, [{\n    key: \"layoutDir\",\n    get: function get() {\n      return this.get('layoutDir');\n    }\n  }, {\n    key: \"readOnly\",\n    get: function get() {\n      return this.get('readOnly');\n    }\n  }, {\n    key: \"allowUndo\",\n    get: function get() {\n      return this.get('allowUndo');\n    }\n  }, {\n    key: \"theme\",\n    get: function get() {\n      return this.get('theme');\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      return new Config(obj);\n    }\n  }]);\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = /*#__PURE__*/function (_Record3) {\n  _inherits(Topic, _Record3);\n\n  var _super3 = _createSuper(Topic);\n\n  function Topic() {\n    _classCallCheck(this, Topic);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(Topic, [{\n    key: \"key\",\n    get: function get() {\n      return this.get('key');\n    }\n  }, {\n    key: \"parentKey\",\n    get: function get() {\n      return this.get('parentKey');\n    }\n  }, {\n    key: \"collapse\",\n    get: function get() {\n      return this.get('collapse');\n    }\n  }, {\n    key: \"subKeys\",\n    get: function get() {\n      return this.get('subKeys');\n    }\n  }, {\n    key: \"blocks\",\n    get: function get() {\n      return this.get('blocks');\n    }\n  }, {\n    key: \"relations\",\n    get: function get() {\n      return this.get('relations');\n    }\n  }, {\n    key: \"style\",\n    get: function get() {\n      return this.get('style');\n    }\n  }, {\n    key: \"getBlock\",\n    value: function getBlock(type) {\n      var index = this.blocks.findIndex(function (b) {\n        return b.type === type;\n      });\n      if (index === -1) return {\n        index: index,\n        block: null\n      };\n      return {\n        index: index,\n        block: this.blocks.get(index)\n      };\n    }\n  }], [{\n    key: \"fromJSON\",\n    value: function fromJSON(obj) {\n      var key = obj.key,\n          _obj$parentKey = obj.parentKey,\n          parentKey = _obj$parentKey === void 0 ? null : _obj$parentKey,\n          blocks = obj.blocks,\n          _obj$subKeys = obj.subKeys,\n          subKeys = _obj$subKeys === void 0 ? [] : _obj$subKeys,\n          _obj$collapse = obj.collapse,\n          collapse = _obj$collapse === void 0 ? false : _obj$collapse;\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        collapse: collapse,\n        subKeys: List(subKeys),\n        blocks: Block.createList(blocks)\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(_ref) {\n      var key = _ref.key,\n          _ref$parentKey = _ref.parentKey,\n          parentKey = _ref$parentKey === void 0 ? null : _ref$parentKey,\n          _ref$content = _ref.content,\n          content = _ref$content === void 0 ? '' : _ref$content,\n          _ref$subKeys = _ref.subKeys,\n          subKeys = _ref$subKeys === void 0 ? [] : _ref$subKeys,\n          _ref$collapse = _ref.collapse,\n          collapse = _ref$collapse === void 0 ? false : _ref$collapse;\n      var block = Block.create({\n        type: BlockType.CONTENT,\n        data: content,\n        key: null\n      });\n      var blocks = List([block]);\n      return new Topic({\n        key: key,\n        parentKey: parentKey,\n        blocks: blocks,\n        subKeys: List(subKeys),\n        collapse: collapse\n      });\n    }\n  }]);\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var _res;\n\n    var subKeys = item.subKeys.toArray();\n\n    (_res = res).push.apply(_res, _toConsumableArray(subKeys));\n\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, _toConsumableArray(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey) {\n  var reverse = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log = debug('modifier');\n\nfunction toggleCollapse(_ref2) {\n  var model = _ref2.model,\n      topicKey = _ref2.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_ref3) {\n  var model = _ref3.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  model = focusTopic({\n    model: model,\n    topicKey: model.editorRootTopicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction expandAll(_ref4) {\n  var model = _ref4.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log(model);\n  return model;\n}\n\nfunction expandTo(_ref5) {\n  var model = _ref5.model,\n      topicKey = _ref5.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_ref6) {\n  var model = _ref6.model,\n      topicKey = _ref6.topicKey,\n      focusMode = _ref6.focusMode;\n  log('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_ref7) {\n  var model = _ref7.model,\n      focusMode = _ref7.focusMode;\n  log('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_ref8) {\n  var model = _ref8.model,\n      topicKey = _ref8.topicKey;\n  log('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child.key, child);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_ref9) {\n  var model = _ref9.model,\n      topicKey = _ref9.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx = pItem.subKeys.indexOf(topicKey);\n    var sibling = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling.key, sibling);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx + 1, sibling.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_ref10) {\n  var model = _ref10.model,\n      topicKey = _ref10.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_ref11) {\n  var model = _ref11.model,\n      topicKey = _ref11.topicKey,\n      blockType = _ref11.blockType,\n      focusMode = _ref11.focusMode,\n      data = _ref11.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock = topic.getBlock(blockType),\n        index = _topic$getBlock.index,\n        block = _topic$getBlock.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_ref12) {\n  var model = _ref12.model,\n      topicKey = _ref12.topicKey,\n      blockType = _ref12.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _topic$getBlock2 = topic.getBlock(blockType),\n        index = _topic$getBlock2.index;\n\n    if (index !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_ref13) {\n  var model = _ref13.model,\n      topicKey = _ref13.topicKey,\n      style = _ref13.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction clearAllCustomStyle(_ref14) {\n  var model = _ref14.model;\n  model = model.withMutations(function (model) {\n    model.topics.keySeq().forEach(function (key) {\n      model.setIn(['topics', key, 'style'], null);\n    });\n  });\n  return model;\n}\n\nfunction setTheme(_ref15) {\n  var model = _ref15.model,\n      theme = _ref15.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_ref16) {\n  var model = _ref16.model,\n      layoutDir = _ref16.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_ref17) {\n  var model = _ref17.model,\n      topicKey = _ref17.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_ref18) {\n  var model = _ref18.model,\n      zoomFactor = _ref18.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  clearAllCustomStyle: clearAllCustomStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: new Config(),\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = /*#__PURE__*/function (_Record4) {\n  _inherits(Model, _Record4);\n\n  var _super4 = _createSuper(Model);\n\n  function Model() {\n    _classCallCheck(this, Model);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(Model, [{\n    key: \"toJS\",\n    value: function toJS() {\n      var obj = {\n        rootTopicKey: this.rootTopicKey,\n        topics: Object.values(this.topics.toJS()),\n        config: this.config,\n        extData: this.extData,\n        zoomFactor: this.zoomFactor\n      };\n      return obj;\n    }\n  }, {\n    key: \"extData\",\n    get: function get() {\n      return this.get('extData');\n    }\n  }, {\n    key: \"topics\",\n    get: function get() {\n      return this.get('topics');\n    }\n  }, {\n    key: \"config\",\n    get: function get() {\n      return this.get('config');\n    }\n  }, {\n    key: \"formatVersion\",\n    get: function get() {\n      return this.get('formatVersion');\n    }\n  }, {\n    key: \"rootTopicKey\",\n    get: function get() {\n      return this.get('rootTopicKey');\n    }\n  }, {\n    key: \"editorRootTopicKey\",\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    }\n  }, {\n    key: \"focusKey\",\n    get: function get() {\n      return this.get('focusKey');\n    }\n  }, {\n    key: \"focusMode\",\n    get: function get() {\n      return this.get('focusMode');\n    }\n  }, {\n    key: \"editingContentKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    }\n  }, {\n    key: \"editingDescKey\",\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    }\n  }, {\n    key: \"getTopic\",\n    value: function getTopic(key) {\n      return this.topics.get(key);\n    }\n  }, {\n    key: \"getExtDataItem\",\n    value: function getExtDataItem(key, c) {\n      return this.extData.get(key) || new c();\n    }\n  }, {\n    key: \"getParentTopic\",\n    value: function getParentTopic(key) {\n      var topic = this.getTopic(key);\n      return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n    }\n  }, {\n    key: \"getTopicVisualLevel\",\n    value: function getTopicVisualLevel(key) {\n      var topic = this.getTopic(key);\n      var level = 0;\n\n      while (topic && topic.key !== this.editorRootTopicKey) {\n        level++;\n        topic = this.getParentTopic(topic.key);\n      }\n\n      return level;\n    }\n  }, {\n    key: \"rootTopic\",\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    }\n  }, {\n    key: \"zoomFactor\",\n    get: function get() {\n      return this.get('zoomFactor');\n    }\n  }], [{\n    key: \"isModel\",\n    value: function isModel(obj) {\n      return obj instanceof Model;\n    }\n  }, {\n    key: \"create\",\n    value: function create() {\n      var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      if (attrs == null) return Model.createEmpty();\n      var res;\n\n      if (Model.isModel(attrs)) {\n        res = attrs;\n      }\n\n      if (isPlainObject(attrs)) {\n        res = Model.fromJSON(attrs);\n      }\n\n      if (res) {\n        if (res.focusKey == null) {\n          res = res.set('focusKey', res.rootTopicKey);\n        }\n\n        if (res.focusMode == null) {\n          res = res.set('focusMode', FocusMode.NORMAL);\n        }\n\n        return res;\n      }\n\n      throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \".concat(attrs));\n    }\n  }, {\n    key: \"createEmpty\",\n    value: function createEmpty() {\n      var model = new Model();\n      var rootTopic = Topic.create({\n        key: createKey(),\n        content: 'RootTopic'\n      });\n      return model.update('topics', function (topics) {\n        return topics.set(rootTopic.key, rootTopic);\n      }).set('rootTopicKey', rootTopic.key).set('editorRootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n    }\n  }, {\n    key: \"fromJSON\",\n    value: function fromJSON(object) {\n      var model = new Model();\n      var _object$topics = object.topics,\n          topics = _object$topics === void 0 ? [] : _object$topics,\n          _object$config = object.config,\n          config = _object$config === void 0 ? {} : _object$config,\n          rootTopicKey = object.rootTopicKey;\n      var editorRootTopicKey = object.editorRootTopicKey;\n      if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n      model = model.merge({\n        rootTopicKey: rootTopicKey,\n        editorRootTopicKey: editorRootTopicKey\n      });\n      model = model.withMutations(function (model) {\n        topics.forEach(function (topic) {\n          model.update('topics', function (topics) {\n            return topics.set(topic.key, Topic.fromJSON(topic));\n          });\n        });\n        model.set('config', Config.fromJSON(config));\n      });\n      return model;\n    }\n  }]);\n\n  return Model;\n}(Record(defaultModelRecord));\n\nfunction CorePlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var _options$plugins = options.plugins,\n      plugins = _options$plugins === void 0 ? [] : _options$plugins;\n  return _toConsumableArray(plugins);\n}\n\nvar log$1 = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  var _iterator = _createForOfIteratorHelper(middleware),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var fn = _step.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = /*#__PURE__*/function () {\n  function Controller() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Controller);\n\n    var _options$plugins2 = options.plugins,\n        plugins = _options$plugins2 === void 0 ? [] : _options$plugins2,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  _createClass(Controller, [{\n    key: \"run\",\n    value: function run(key) {\n      var middleware = this.middleware;\n      var fns = middleware[key] || [];\n      warning(fns.length !== 0, \"the middleware function \".concat(key, \" is not found!\"));\n      var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return composedFn.apply(void 0, args);\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue(propKey, arg) {\n      return this.run('getValue', _objectSpread(_objectSpread({}, arg), {}, {\n        propKey: propKey\n      }));\n    }\n  }, {\n    key: \"change\",\n    value: function change(model, callback) {\n      this.onChange(model, callback);\n      this.currentModel = model;\n    }\n  }]);\n\n  return Controller;\n}();\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import _get from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectWithoutProperties from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _createForOfIteratorHelper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _assertThisInitialized from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _taggedTemplateLiteral from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nimport _objectSpread from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/testvagrant/git/other/react-mindmap-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _excluded = [\"title\"],\n    _excluded2 = [\"layout\", \"title\"],\n    _excluded3 = [\"layout\", \"title\"],\n    _excluded4 = [\"controller\", \"children\", \"onClick\"],\n    _excluded5 = [\"text\"];\n\nvar _templateObject, _templateObject2, _templateObject3, _templateObject4, _templateObject5, _templateObject6, _templateObject7, _templateObject8, _templateObject9, _templateObject10, _templateObject11, _templateObject12, _templateObject13, _templateObject14, _templateObject15, _templateObject16, _templateObject17, _templateObject18, _templateObject19, _templateObject20, _templateObject21, _templateObject22, _templateObject23, _templateObject24, _templateObject25, _templateObject26, _templateObject27, _templateObject28, _templateObject29, _templateObject30, _templateObject31, _templateObject32, _templateObject33, _templateObject34, _templateObject35, _templateObject36, _templateObject37, _templateObject38, _templateObject39, _templateObject40, _templateObject41, _templateObject42, _templateObject43, _templateObject44, _templateObject45, _templateObject46, _templateObject47, _templateObject48, _templateObject49, _templateObject50, _templateObject51, _templateObject52, _templateObject53, _templateObject54, _templateObject55, _templateObject56, _templateObject57;\n\nimport { Component, createElement, PureComponent, useState, Fragment } from 'react';\nimport ResizeObserver from 'resize-observer-polyfill';\nimport styled, { css, ThemeProvider } from 'styled-components';\nimport debug from 'debug';\nimport { Checkbox, Divider, Popover, Button, NumericInput, InputGroup, MenuItem, Menu, Hotkey, Hotkeys, HotkeysTarget, PopoverPosition, Breadcrumb, Tooltip, Breadcrumbs, Dialog, Classes, ContextMenuTarget, PopoverInteractionKind, Position, Drawer, Tabs, Tab, Alert } from '@blueprintjs/core';\nimport { Select } from '@blueprintjs/select';\nimport { SketchPicker } from 'react-color';\nimport { Model, FocusMode, OpType, DiagramLayoutType, getRelationship, TopicRelationship, getAllSubTopicKeys, ModelModifier, BlockType, TopicDirection, isThemeType, TopicVisualLevel, Controller } from '@blink-mind/core';\nimport '@blink-mind/icons';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport memoizeOne from 'memoize-one';\nimport { Stack, List } from 'immutable';\nimport cx from 'classnames';\nimport { cloneDeep, merge, isEqual } from 'lodash';\nimport plainSerializer from 'slate-plain-serializer';\nimport { Editor } from 'slate-react';\n\nvar BaseWidget = /*#__PURE__*/function (_Component) {\n  _inherits(BaseWidget, _Component);\n\n  var _super = _createSuper(BaseWidget);\n\n  function BaseWidget(props) {\n    _classCallCheck(this, BaseWidget);\n\n    return _super.call(this, props);\n  }\n\n  _createClass(BaseWidget, [{\n    key: \"operation\",\n    value: function operation(opType, arg) {\n      this.props.controller.run('operation', _objectSpread({\n        opType: opType\n      }, arg));\n    }\n  }, {\n    key: \"run\",\n    value: function run(name, arg) {\n      this.props.controller.run(name, arg);\n    }\n  }, {\n    key: \"topic\",\n    get: function get() {\n      return this.props.model.getTopic(this.props.topicKey);\n    }\n  }]);\n\n  return BaseWidget;\n}(Component);\n\nvar log = debug('node:drag-scroll-widget');\nvar DragScrollView = styled.div(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  position: relative;\\n  width: 100%;\\n  height: 100%;\\n  overflow: scroll;\\n\"])));\nvar DragScrollContent = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  width: max-content;\\n\"])));\n\nvar DragScrollWidget = /*#__PURE__*/function (_Component2) {\n  _inherits(DragScrollWidget, _Component2);\n\n  var _super2 = _createSuper(DragScrollWidget);\n\n  function DragScrollWidget(props) {\n    var _this;\n\n    _classCallCheck(this, DragScrollWidget);\n\n    _this = _super2.call(this, props);\n\n    _this.contentResizeCallback = function (entries, observer) {\n      if (_this.oldContentRect) {\n        var widgetStyle = {\n          width: _this.content.clientWidth + _this.viewBox.clientWidth * 2,\n          height: _this.content.clientHeight + _this.viewBox.clientHeight * 2\n        };\n        _this.bigView.style.width = widgetStyle.width + 'px';\n        _this.bigView.style.height = widgetStyle.height + 'px';\n      }\n\n      _this.oldContentRect = entries[0].contentRect;\n    };\n\n    _this.contentResizeObserver = new ResizeObserver(_this.contentResizeCallback);\n\n    _this.contentRef = function (ref) {\n      if (ref) {\n        _this.content = ref;\n\n        _this.contentResizeObserver.observe(_this.content);\n      }\n    };\n\n    _this.viewBoxRef = function (ref) {\n      if (ref) {\n        _this.viewBox = ref;\n\n        if (!_this.props.enableMouseWheel) {\n          log('addEventListener onwheel');\n\n          _this.viewBox.addEventListener('wheel', function (e) {\n            log('onwheel');\n            (e.ctrlKey || e.altKey) && e.preventDefault();\n          }, {\n            passive: false\n          });\n        }\n\n        _this.setViewBoxScroll(_this.viewBox.clientWidth, _this.viewBox.clientHeight);\n      }\n    };\n\n    _this.bigViewRef = function (ref) {\n      if (ref) {\n        _this.bigView = ref;\n      }\n    };\n\n    _this.setWidgetStyle = function () {\n      if (_this.content && _this.viewBox && _this.bigView) {\n        _this.bigView.style.width = (_this.content.clientWidth + _this.viewBox.clientWidth) * 2 + 'px';\n        _this.bigView.style.height = (_this.content.clientHeight + _this.viewBox.clientHeight) * 2 + 'px';\n        _this.content.style.left = _this.viewBox.clientWidth + 'px';\n        _this.content.style.top = _this.viewBox.clientHeight + 'px';\n      }\n    };\n\n    _this.setViewBoxScroll = function (left, top) {\n      log(\"setViewBoxScroll \".concat(left, \" \").concat(top));\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft = left;\n        _this.viewBox.scrollTop = top;\n      }\n    };\n\n    _this.setViewBoxScrollDelta = function (deltaLeft, deltaTop) {\n      log(\"setViewBoxScrollDelta \".concat(deltaLeft, \" \").concat(deltaTop));\n\n      if (_this.viewBox) {\n        _this.viewBox.scrollLeft += deltaLeft;\n        _this.viewBox.scrollTop += deltaTop;\n      }\n    };\n\n    _this.onMouseDown = function (e) {\n      // log('Drag Scroll onMouseDown');\n      // log(e.nativeEvent.target);\n      // mouseKey \n      // needKeyPressed ctrl\n      // canDragFunc\n      var _this$props = _this.props,\n          mouseKey = _this$props.mouseKey,\n          needKeyPressed = _this$props.needKeyPressed,\n          canDragFunc = _this$props.canDragFunc;\n      if (canDragFunc && !canDragFunc()) return;\n\n      if (e.button === 0 && mouseKey === 'left' || e.button === 2 && mouseKey === 'right') {\n        if (needKeyPressed) {\n          if (!e.ctrlKey) return;\n        }\n\n        _this._lastCoordX = _this.viewBox.scrollLeft + e.nativeEvent.clientX;\n        _this._lastCoordY = _this.viewBox.scrollTop + e.nativeEvent.clientY;\n        var ele = _this.viewBox;\n        ele.addEventListener('mousemove', _this.onMouseMove);\n        ele.addEventListener('mouseup', _this.onMouseUp);\n      }\n    };\n\n    _this.onMouseUp = function (e) {\n      var ele = _this.viewBox;\n      ele.removeEventListener('mousemove', _this.onMouseMove);\n      ele.removeEventListener('mouseup', _this.onMouseUp);\n    };\n\n    _this.onMouseMove = function (e) {\n      _this.viewBox.scrollLeft = _this._lastCoordX - e.clientX;\n      _this.viewBox.scrollTop = _this._lastCoordY - e.clientY; // log(`onMouseMove ${this.viewBox.scrollLeft} ${this.viewBox.scrollTop}`);\n    };\n\n    _this.handleContextMenu = function (e) {\n      e.preventDefault();\n    };\n\n    _this.state = {\n      widgetStyle: {\n        width: '10000px',\n        height: '10000px'\n      }\n    };\n    return _this;\n  }\n\n  _createClass(DragScrollWidget, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setWidgetStyle();\n      document.addEventListener('contextmenu', this.handleContextMenu);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('contextmenu', this.handleContextMenu);\n    }\n  }, {\n    key: \"setZoomFactor\",\n    value: function setZoomFactor(zoomFactor) {\n      this.bigView.style.transform = \"scale(\".concat(zoomFactor, \")\");\n      this.bigView.style.transformOrigin = '50% 50%';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var style = _objectSpread({}, this.state.widgetStyle);\n\n      return createElement(DragScrollView, {\n        ref: this.viewBoxRef,\n        onMouseDown: this.onMouseDown\n      }, createElement(\"div\", {\n        style: style,\n        ref: this.bigViewRef\n      }, createElement(DragScrollContent, {\n        ref: this.contentRef,\n        style: this.state.contentStyle\n      }, this.props.children(this.setViewBoxScroll, this.setViewBoxScrollDelta))));\n    }\n  }]);\n\n  return DragScrollWidget;\n}(Component);\n\nDragScrollWidget.defaultProps = {\n  mouseKey: 'left',\n  needKeyPressed: false\n};\nvar log$1 = debug('node:save-ref'); //TODO ,topic\n\nvar SaveRef = /*#__PURE__*/function (_Component3) {\n  _inherits(SaveRef, _Component3);\n\n  var _super3 = _createSuper(SaveRef);\n\n  function SaveRef() {\n    var _this2;\n\n    _classCallCheck(this, SaveRef);\n\n    _this2 = _super3.apply(this, arguments);\n\n    _this2.getRef = function (name) {\n      log$1(_assertThisInitialized(_this2));\n      return _this2[name];\n    };\n\n    _this2.saveRef = function (name) {\n      return function (node) {\n        if (node) {\n          _this2[name] = node;\n\n          _this2.fireListener(name, node);\n        }\n      };\n    };\n\n    _this2.deleteRef = function (name) {\n      log$1('deleteRef:', name);\n      delete _this2[name];\n    };\n\n    _this2.observers = new Map();\n\n    _this2.fireListener = function (name, ref) {\n      if (_this2.observers.has(name)) {\n        var listeners = _this2.observers.get(name);\n\n        var _iterator = _createForOfIteratorHelper(listeners),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var listener = _step.value;\n            listener(name, ref);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      }\n    };\n\n    _this2.registerRefListener = function (name, listener) {\n      if (!_this2.observers.has(name)) {\n        _this2.observers.set(name, [listener]);\n      } else {\n        _this2.observers.get(name).push(listener);\n      }\n    };\n\n    return _this2;\n  }\n\n  _createClass(SaveRef, [{\n    key: \"render\",\n    value: function render() {\n      return this.props.children(this.saveRef, this.getRef, this.deleteRef, this.registerRefListener.bind(this));\n    }\n  }]);\n\n  return SaveRef;\n}(Component);\n\nvar Flex = styled.div(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: \", \";\\n  align-items: \", \";\\n  justify-content: \", \";\\n\"])), function (props) {\n  return props.flexDirection ? props.flexDirection : 'row';\n}, function (props) {\n  return props.alignItems;\n}, function (props) {\n  return props.justifyContent;\n});\nvar Margin = styled.div(_templateObject4 || (_templateObject4 = _taggedTemplateLiteral([\"\\n  margin: \", \";\\n\"])), function (props) {\n  return props.margin;\n});\nvar ShowMenuIcon = styled.a(_templateObject5 || (_templateObject5 = _taggedTemplateLiteral([\"\\n  font-size: 20px !important;\\n\"])));\nvar IconBg = styled.div(_templateObject6 || (_templateObject6 = _taggedTemplateLiteral([\"\\n  padding: 5px;\\n  cursor: pointer;\\n\"])));\nvar Btn = styled.div(_templateObject7 || (_templateObject7 = _taggedTemplateLiteral([\"\\n  cursor: pointer;\\n  &:hover {\\n    color: #1ea7fd;\\n  }\\n\"])));\nvar StyledCheckbox = styled(Checkbox)(_templateObject8 || (_templateObject8 = _taggedTemplateLiteral([\"\\n  margin-bottom: 0px !important;\\n\"])));\nvar CloseIcon = styled(Btn)(_templateObject9 || (_templateObject9 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: 5px;\\n  top: 5px;\\n  //padding: 5px;\\n\"])));\nvar Title = styled.div(_templateObject10 || (_templateObject10 = _taggedTemplateLiteral([\"\\n  height: 16px;\\n\"])));\nvar TopicBlockIcon = styled.span(_templateObject11 || (_templateObject11 = _taggedTemplateLiteral([\"\\n  margin: 0px 10px;\\n  &:hover {\\n    color: palevioletred;\\n  }\\n\"])));\nvar ZIndex = styled.div(_templateObject12 || (_templateObject12 = _taggedTemplateLiteral([\"\\n  z-index: \", \";\\n\"])), function (props) {\n  return props.zIndex;\n});\nvar PanelTabRoot = styled.div(_templateObject13 || (_templateObject13 = _taggedTemplateLiteral([\"\\n  min-width: 380px;\\n  max-width: 482px;\\n  max-height: 470px;\\n  overflow: auto;\\n\"])));\nvar ToolbarItemPopoverTarget = styled.div(_templateObject14 || (_templateObject14 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar VListContainer = styled.div(_templateObject15 || (_templateObject15 = _taggedTemplateLiteral([\"\\n  max-height: \", \";\\n  overflow-y: auto;\\n  overflow-x: hidden;\\n\"])), function (props) {\n  return props.maxHeight || '300px';\n});\nvar SettingTitle = styled.div(_templateObject16 || (_templateObject16 = _taggedTemplateLiteral([\"\\n  margin-top: 10px;\\n  margin-bottom: 5px;\\n  font-weight: bold;\\n\"])));\nvar SettingItem = styled.span(_templateObject17 || (_templateObject17 = _taggedTemplateLiteral([\"\\n  margin: 0 10px 0 2px;\\n\"])));\nvar SettingBoxContainer = styled.div(_templateObject18 || (_templateObject18 = _taggedTemplateLiteral([\"\\n  padding: 10px;\\n  margin: 0 0 10px 0;\\n  border: rgba(16, 22, 26, 0.15) solid 1px;\\n  border-radius: 5px;\\n\"])));\nvar SettingLabel = styled(SettingItem)(_templateObject19 || (_templateObject19 = _taggedTemplateLiteral([\"\"])));\nvar SettingRow = styled.div(_templateObject20 || (_templateObject20 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  //justify-content: center;\\n  margin: 5px 0;\\n\"])));\nvar ColorBar = styled.div(_templateObject21 || (_templateObject21 = _taggedTemplateLiteral([\"\\n  height: 3px;\\n  width: 80%;\\n  margin-left: 10%;\\n  margin-right: 10%;\\n  margin-bottom: 2px;\\n  background: \", \";\\n\"])), function (props) {\n  return props.color;\n});\nvar WithBorder = styled.div(_templateObject22 || (_templateObject22 = _taggedTemplateLiteral([\"\\n  border: 1px solid grey;\\n  cursor: pointer;\\n  font-weight: bold;\\n\"])));\nvar IconName = {\n  SHOW_MENU: 'show-menu',\n  CLOSE: 'close',\n  COLOR_PICKER: 'color-picker',\n  NOTES: 'notes',\n  PLUS: 'plus',\n  MINUS: 'minus',\n  COLLAPSE_ALL: 'collapse',\n  EXPAND_ALL: 'expand',\n  CENTER: 'center',\n  TRASH: 'trash',\n  SEARCH: 'search',\n  THEME: 'theme',\n  EXPORT: 'export',\n  OPEN_FILE: 'openfile',\n  OPEN: 'open',\n  NEW_FILE: 'newfile',\n  SAVE: 'save',\n  LAYOUT_LEFT_AND_RIGHT: 'layout-left-and-right',\n  LAYOUT_LEFT: 'layout-left',\n  LAYOUT_RIGHT: 'layout-right',\n  UNDO: 'undo',\n  REDO: 'redo'\n};\n\nfunction iconClassName(name) {\n  return \"icon iconfont bm-\".concat(name);\n}\n\nfunction Icon(iconName) {\n  return createElement(\"span\", {\n    className: iconClassName(iconName)\n  });\n}\n\nfunction contentRefKey(key) {\n  return \"content-\".concat(key);\n}\n\nfunction contentEditorRefKey(key) {\n  return \"content-editor-\".concat(key);\n}\n\nfunction descEditorRefKey(key) {\n  return \"desc-editor-\".concat(key);\n}\n\nfunction topicWidgetRefKey(key) {\n  return \"topic-widget-\".concat(key);\n}\n\nfunction topicRefKey(key) {\n  return \"topic-\".concat(key);\n}\n\nfunction linksRefKey(key) {\n  return \"links-\".concat(key);\n}\n\nfunction linksSvgRefKey(key) {\n  return \"links-svg-\".concat(key);\n}\n\nfunction collapseRefKey(key) {\n  return \"collapse-\".concat(key);\n}\n\nfunction dropAreaRefKey(key, dir) {\n  return \"dropArea-\".concat(dir, \"-\").concat(key);\n}\n\nvar RefKey = {\n  DIAGRAM_ROOT_KEY: 'DIAGRAM-ROOT',\n  DRAG_SCROLL_WIDGET_KEY: 'DragScrollWidget',\n  SVG_HIGHLIGHT_KEY: 'svg-highlight',\n  FOCUS_HIGHLIGHT_KEY: 'focus-highlight',\n  DROP_EFFECT_KEY: 'drop-effect'\n};\nvar EventKey = {\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC'\n};\nvar PropKey = {\n  DIAGRAM_CUSTOMIZE_BASE_Z_INDEX: 'DIAGRAM_CUSTOMIZE_BASE_Z_INDEX',\n  TOPIC_CONTEXT_MENU_ENABLED: 'TOPIC_CONTEXT_MENU_ENABLED',\n  TOPIC_TITLE: 'TOPIC_TITLE',\n  DRAG_DROP_STATE: 'DRAG_DROP_STATE',\n  RIGHT_TOP_PANEL_STATE: 'RIGHT_TOP_PANEL_STATE',\n  OPERATION_ENABLED: 'OPERATION_ENABLED'\n};\nvar I18nKey = {\n  CONFIRM: 'CONFIRM',\n  CANCEL: 'CANCEL',\n  DEFAULT: 'DEFAULT',\n  SEARCH: 'SEARCH',\n  LEFT_AND_RIGHT: 'LEFT_AND_RIGHT',\n  ONLY_LEFT: 'ONLY_LEFT',\n  ONLY_RIGHT: 'ONLY_RIGHT',\n  EDIT: 'EDIT',\n  ADD_SIBLING: 'ADD_SIBLING',\n  ADD_CHILD: 'ADD_CHILD',\n  EDIT_NOTES: 'EDIT_NOTES',\n  DELETE: 'DELETE',\n  SET_AS_EDITOR_ROOT: 'SET_AS_EDITOR_ROOT',\n  EDIT_TOPOLOGY_DIAGRAM: 'EDIT_TOPOLOGY_DIAGRAM',\n  SET_TOPIC_REFERENCES: 'SET_TOPIC_REFERENCES',\n  //========================================\n  TOPIC_STYLE: 'TOPIC_STYLE',\n  STYLE: 'STYLE',\n  TEXT_EDITOR: 'TEXT_EDITOR',\n  LINK: 'LINK',\n  LINK_TO_PARENT: 'LINK_TO_PARENT',\n  SUB_LINKS: 'SUB_LINKS',\n  COPY_STYLE: 'COPY_STYLE',\n  PASTE_STYLE: 'PASTE_STYLE',\n  CLEAR_TOPIC_STYLE: 'CLEAR_TOPIC_STYLE',\n  CLEAR_ALL_CUSTOM_STYLE: 'CLEAR_ALL_CUSTOM_STYLE',\n  LINE_TYPE: 'LINE_TYPE',\n  //=======================================\n  THEME: 'THEME',\n  GLOBAL: 'GLOBAL',\n  HIGHLIGHT: 'HIGHLIGHT',\n  RANDOM_COLOR: 'RANDOM_COLOR',\n  NORMAL_TOPIC: 'NORMAL_TOPIC',\n  PRIMARY_TOPIC: 'PRIMARY_TOPIC',\n  ROOT_TOPIC: 'ROOT_TOPIC',\n  EXPORT_THEME: 'EXPORT_THEME',\n  IMPORT_THEME: 'IMPORT_THEME',\n  //=======================================\n  TAGS: 'TAGS',\n  TAGS_MANAGER: 'TAGS_MANAGER',\n  TAG_NAME: 'TAG_NAME',\n  ADD_TAG: 'ADD_TAG',\n  UPDATE_TAG: 'UPDATE_TAG',\n  ALREADY_ADDED: 'ALREADY_ADDED',\n  CAN_BE_ADDED: 'CAN_BE_ADDED',\n  TOPICS_THAT_USE_THIS_TAG: 'TOPICS_THAT_USE_THIS_TAG',\n  //=======================================\n  BACKGROUND: 'BACKGROUND',\n  COLOR: 'COLOR',\n  BORDER: 'BORDER',\n  WIDTH: 'WIDTH',\n  RADIUS: 'RADIUS',\n  FONT_SIZE: 'FONT_SIZE',\n  LINE_HEIGHT: 'LINE_HEIGHT',\n  PADDING: 'PADDING',\n  TOP: 'TOP',\n  BOTTOM: 'BOTTOM',\n  LEFT: 'LEFT',\n  RIGHT: 'RIGHT',\n  NONE: 'NONE',\n  SOLID: 'SOLID',\n  DOTTED: 'DOTTED',\n  DASHED: 'DASHED',\n  DOUBLE: 'DOUBLE',\n  ROUND: 'ROUND',\n  CURVE: 'CURVE',\n  LINE: 'LINE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  CENTER_ROOT_TOPIC: 'CENTER_ROOT_TOPIC',\n  ZOOM: 'ZOOM',\n  ZOOM_IN: 'ZOOM_IN',\n  ZOOM_OUT: 'ZOOM_OUT',\n  RESET: 'RESET',\n  RESET_ZOOM: 'RESET_ZOOM',\n  NOTE_PLACEHOLDER: \"NOTE_PLACEHOLDER\",\n  TOPOLOGY_DIAGRAM_EDITOR: 'TOPOLOGY_DIAGRAM_EDITOR',\n  BASIC: 'BASIC',\n  FLOW_GRAPH: 'FLOW_GRAPH',\n  ACTIVITY_DIAGRAM: 'ACTIVITY_DIAGRAM',\n  SEQUENCE_DIAGRAM: 'SEQUENCE_DIAGRAM',\n  CLASS_DIAGRAM: 'CLASS_DIAGRAM',\n  REFERENCE_TOPICS: \"REFERENCE_TOPICS\",\n  REFERENCED_TOPICS: \"REFERENCED_TOPICS\",\n  SELECT_REF_TOPICS_TIP: 'SELECT_REF_TOPICS_TIP',\n  TAG_NAME_OVER_MAX_TIP: 'TAG_NAME_OVER_MAX_TIP',\n  DELETE_TAG_TIP: 'DELETE_TAG_TIP',\n  DELETE_TOPOLOGY_TIP: 'DELETE_TOPOLOGY_TIP'\n};\n\nvar cancelEvent = function cancelEvent(e) {\n  e.stopPropagation();\n};\n\nfunction browserDownloadFile(url, filename) {\n  var link = document.createElement('a');\n  link.href = url;\n  link.download = filename;\n  link.click();\n}\n\nfunction browserDownloadText(text, filename) {\n  var url = \"data:text/plain,\".concat(encodeURIComponent(text));\n  browserDownloadFile(url, filename);\n}\n\nfunction browserOpenFile(accept) {\n  var input = document.createElement('input');\n  input.type = 'file';\n  input.accept = accept;\n  return new Promise(function (resolve, reject) {\n    input.addEventListener('change', function (evt) {\n      //@ts-ignore\n      var file = evt.target.files[0];\n      var fr = new FileReader();\n\n      fr.onload = function (evt) {\n        var txt = evt.target.result; //@ts-ignore\n\n        resolve(txt);\n      };\n\n      fr.onerror = function (evt) {\n        reject(evt.target.error);\n      };\n\n      fr.readAsText(file);\n    });\n    input.click();\n  });\n}\n\nfunction paddingCss(arg) {\n  var _arg$top = arg.top,\n      top = _arg$top === void 0 ? 0 : _arg$top,\n      _arg$right = arg.right,\n      right = _arg$right === void 0 ? 0 : _arg$right,\n      _arg$bottom = arg.bottom,\n      bottom = _arg$bottom === void 0 ? 0 : _arg$bottom,\n      _arg$left = arg.left,\n      left = _arg$left === void 0 ? 0 : _arg$left;\n  return \"\".concat(top, \"px \").concat(right, \"px \").concat(bottom, \"px \").concat(left, \"px\");\n} // import { I18nKey } from './keys';\n\n\nfunction getI18nText(ctx, key) {\n  if (Array.isArray(key)) {\n    return key.map(function (k) {\n      return ctx.controller.run('getI18nText', _objectSpread(_objectSpread({}, ctx), {}, {\n        key: k\n      }));\n    });\n  }\n\n  return ctx.controller.run('getI18nText', _objectSpread(_objectSpread({}, ctx), {}, {\n    key: key.toUpperCase()\n  }));\n} // export function getCssI18nText(ctx, cssName) {\n//   const cssNames = {\n//     none: I18nKey.NONE,\n//     solid: I18nKey.SOLID,\n//     dotted: I18nKey.DOTTED,\n//     dashed: I18nKey.DASHED,\n//     double: I18nKey.DOUBLE,\n//\n//     round: I18nKey.ROUND,\n//     curve: I18nKey.CURVE,\n//\n//   };\n//\n//   return getI18nText(ctx, cssNames[cssName]);\n// }\n\n\nfunction getLinkKey(fromKey, toKey) {\n  return \"link-\".concat(fromKey, \"-\").concat(toKey);\n}\n\nfunction centerY(rect) {\n  return (rect.top + rect.bottom) / 2;\n}\n\nfunction centerX(rect) {\n  return (rect.left + rect.right) / 2;\n}\n\nfunction centerPointX(p1, p2) {\n  return (p1.x + p2.x) / 2;\n}\n\nfunction centerPointY(p1, p2) {\n  return (p1.y + p2.y) / 2;\n}\n\nfunction center(rect) {\n  return [(rect.left + rect.right) / 2, (rect.top + rect.bottom) / 2];\n}\n\nfunction _getRelativeRect(el, rel) {\n  var scale = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  elCenter[0] = (elCenter[0] - relCenter[0]) / scale;\n  elCenter[1] = (elCenter[1] - relCenter[1]) / scale;\n  var width = rect.width / scale;\n  var height = rect.height / scale;\n  return {\n    left: elCenter[0] - width / 2,\n    right: elCenter[0] + width / 2,\n    top: elCenter[1] - height / 2,\n    bottom: elCenter[1] + height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getRelativeVector(el, rel) {\n  var rect = el.getBoundingClientRect();\n  var relRect = rel.getBoundingClientRect();\n  var relCenter = center(relRect);\n  var elCenter = center(rect);\n  return [elCenter[0] - relCenter[0], elCenter[1] - relCenter[1]];\n}\n\nfunction SettingGroup(props) {\n  return createElement(\"div\", null, props.children, createElement(Divider, {\n    style: {\n      margin: '10px 0'\n    }\n  }));\n}\n\nfunction SettingItemColorPicker(props) {\n  var title = props.title,\n      _props$layout = props.layout,\n      layout = _props$layout === void 0 ? 'h' : _props$layout,\n      color = props.color,\n      handleColorChange = props.handleColorChange;\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), title != null && createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(Popover, null, createElement(WithBorder, null, createElement(\"div\", {\n    className: iconClassName(IconName.COLOR_PICKER)\n  }), createElement(ColorBar, {\n    color: color\n  })), createElement(\"div\", null, createElement(SketchPicker, {\n    color: color,\n    onChangeComplete: function onChangeComplete(color) {\n      return handleColorChange(color.hex);\n    }\n  })))));\n}\n\nfunction SettingItemButton(props) {\n  var title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded);\n\n  return createElement(SettingItem, null, createElement(Button, Object.assign({}, restProps), title));\n}\n\nfunction SettingItemNumericInput(props) {\n  var _props$layout2 = props.layout,\n      layout = _props$layout2 === void 0 ? 'h' : _props$layout2,\n      title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded2);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title), createElement(NumericInput, Object.assign({}, restProps))));\n}\n\nfunction SettingItemInput(props) {\n  var _props$layout3 = props.layout,\n      layout = _props$layout3 === void 0 ? 'h' : _props$layout3,\n      title = props.title,\n      restProps = _objectWithoutProperties(props, _excluded3);\n\n  var flexProps = {\n    flexDirection: layout === 'h' ? 'row' : 'column',\n    alignItems: 'center'\n  };\n  return createElement(SettingItem, null, createElement(Flex, Object.assign({}, flexProps), createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, title, \" \"), createElement(InputGroup, Object.assign({}, restProps))));\n}\n\nfunction SettingItemSelect(props) {\n  var text = props.text,\n      items = props.items,\n      itemRenderer = props.itemRenderer,\n      onItemSelect = props.onItemSelect;\n  var PxSelect = Select.ofType();\n  var pxProps = {\n    items: items,\n    itemRenderer: itemRenderer,\n    onItemSelect: onItemSelect,\n    filterable: false\n  };\n  return createElement(SettingItem, null, createElement(PxSelect, Object.assign({}, pxProps), createElement(Button, {\n    text: text\n  })));\n}\n\nvar renderItem = function renderItem(unit) {\n  return function (v, _ref) {\n    var handleClick = _ref.handleClick;\n    return createElement(MenuItem, {\n      text: \"\".concat(v).concat(unit),\n      key: v,\n      onClick: handleClick\n    });\n  };\n};\n\nvar renderItemI18n = function renderItemI18n(ctx) {\n  return function (v, _ref2) {\n    var handleClick = _ref2.handleClick;\n    return createElement(MenuItem, {\n      text: getI18nText(ctx, v),\n      key: v,\n      onClick: handleClick\n    });\n  };\n};\n\nvar PxSelect = Select.ofType();\n\nvar borderWidthItems = _toConsumableArray(Array(7).keys());\n\nvar ToolbarItemRoot = styled.div(_templateObject23 || (_templateObject23 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  padding: 6px;\\n  width: 40px;\\n  height: 40px;\\n  cursor: pointer;\\n  color: \", \";\\n  font-size: 24px;\\n  display: inline-block;\\n  &:hover {\\n    color: \", \";\\n  }\\n\"])), function (props) {\n  return props.disabled ? 'grey' : 'black';\n}, function (props) {\n  return props.disabled ? 'grey' : 'rgb(44, 184, 146)';\n});\n\nfunction ToolbarItem(props) {\n  var controller = props.controller,\n      children = props.children,\n      onClick = props.onClick,\n      restProps = _objectWithoutProperties(props, _excluded4);\n\n  var disabled = props.disabled;\n  disabled = disabled || !controller.getValue(PropKey.OPERATION_ENABLED, props);\n\n  var handleClick = function handleClick(e) {\n    if (!disabled) onClick(e);\n  };\n\n  var nProps = _objectSpread({\n    controller: controller,\n    disabled: disabled,\n    onClick: handleClick\n  }, restProps);\n\n  return createElement(ToolbarItemRoot, Object.assign({}, nProps), children);\n}\n\nfunction CreateModelPlugin() {\n  return {\n    createNewModel: function createNewModel(props) {\n      return Model.createEmpty();\n    }\n  };\n}\n\nvar log$2 = debug('plugin:event');\n\nfunction EventPlugin() {\n  var eventListeners = {};\n  return {\n    handleTopicClick: function handleTopicClick(props) {\n      log$2('handleTopicClick');\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey;\n      log$2(model.zoomFactor); //TODO\n\n      if (model.editingDescKey !== null) return;\n      if (model.editingContentKey === topicKey) return;\n      if (model.focusKey === topicKey && model.focusMode === FocusMode.EDITING_CONTENT) return;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.NORMAL\n      }));\n    },\n    handleTopicDoubleClick: function handleTopicDoubleClick(props) {\n      var controller = props.controller,\n          model = props.model;\n      if (model.editingDescKey !== null) return;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.EDITING_CONTENT\n      }));\n    },\n    handleTopicContextMenu: function handleTopicContextMenu(props) {\n      var controller = props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n    },\n    handleActiveModalClose: function handleActiveModalClose(props) {\n      var controller = props.controller;\n      var activeModalProps = controller.run('getActiveModalProps', props);\n      if (activeModalProps == null) return null;\n\n      if (activeModalProps.name === 'edit-desc') {\n        return function () {\n          controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n            focusMode: FocusMode.NORMAL,\n            opType: OpType.FOCUS_TOPIC\n          }));\n        };\n      }\n    },\n    addEventListener: function addEventListener(props) {\n      var key = props.key,\n          listener = props.listener,\n          once = props.once,\n          controller = props.controller;\n      if (!eventListeners[key]) eventListeners[key] = [];\n\n      if (once) {\n        only.origin = listener;\n        eventListeners[key].push(only);\n      } else {\n        eventListeners[key].push(listener);\n      }\n\n      function only() {\n        listener();\n        controller.run('removeEventListener', {\n          key: key,\n          listener: listener\n        });\n      }\n    },\n    removeEventListener: function removeEventListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListeners[key]) {\n        eventListeners[key] = eventListeners[key].filter(function (fn) {\n          return fn !== listener && fn.origin !== listener;\n        });\n      }\n    },\n    fireEvent: function fireEvent(props) {\n      var key = props.key;\n\n      if (eventListeners[key]) {\n        eventListeners[key].forEach(function (fn) {\n          return fn();\n        });\n      }\n    }\n  };\n}\n\nfunction GetValuePlugin() {\n  return {\n    getValue: function getValue(props, next) {\n      var propKey = props.propKey,\n          controller = props.controller,\n          diagramState = props.diagramState;\n\n      switch (propKey) {\n        case PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX:\n          return 3;\n\n        case PropKey.TOPIC_CONTEXT_MENU_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.OPERATION_ENABLED:\n          return controller.run('isOperationEnabled', props);\n\n        case PropKey.TOPIC_TITLE:\n          return controller.run('getTopicTitle', props);\n\n        case PropKey.DRAG_DROP_STATE:\n          return diagramState.dragDrop;\n\n        case PropKey.RIGHT_TOP_PANEL_STATE:\n          return diagramState.rightTopPanel;\n      }\n\n      return next();\n    }\n  };\n}\n\nvar HotKeyName = {\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  EDIT_CONTENT: 'EDIT_CONTENT',\n  EDIT_NOTES: 'EDIT_NOTES',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\nvar MoveTopicDir = {\n  CENTER: 0,\n  LEFT_CENTER: 1\n};\n\nfunction op(opType, props) {\n  var _props = props,\n      topicKey = _props.topicKey,\n      model = _props.model,\n      controller = _props.controller;\n\n  if (topicKey === undefined) {\n    props = _objectSpread(_objectSpread({}, props), {}, {\n      topicKey: model.focusKey\n    });\n  }\n\n  controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n    opType: opType\n  }));\n}\n\nfunction HotKeyPlugin() {\n  return {\n    customizeHotKeys: function customizeHotKeys(props) {\n      var handleKeyDown = function handleKeyDown(opType) {\n        return function (e) {\n          // log('HotKeyPlugin', opType);\n          op(opType, props);\n        };\n      };\n\n      var topicHotKeys = new Map([[HotKeyName.ADD_CHILD, {\n        label: 'add child',\n        combo: 'tab',\n        onKeyDown: handleKeyDown(OpType.ADD_CHILD)\n      }], [HotKeyName.ADD_SIBLING, {\n        label: 'add sibling',\n        combo: 'enter',\n        onKeyDown: handleKeyDown(OpType.ADD_SIBLING)\n      }], [HotKeyName.DELETE_TOPIC, {\n        label: 'delete topic',\n        combo: 'del',\n        onKeyDown: handleKeyDown(OpType.DELETE_TOPIC)\n      }], [HotKeyName.EDIT_CONTENT, {\n        label: 'edit content',\n        combo: 'space',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_CONTENT)\n      }], [HotKeyName.EDIT_NOTES, {\n        label: 'edit notes',\n        combo: 'alt + d',\n        onKeyDown: handleKeyDown(OpType.START_EDITING_DESC)\n      }], [HotKeyName.SET_EDITOR_ROOT, {\n        label: 'set editor root',\n        combo: 'alt + shift + f',\n        onKeyDown: handleKeyDown(OpType.SET_EDITOR_ROOT)\n      }]]);\n      var globalHotKeys = new Map();\n      return {\n        topicHotKeys: topicHotKeys,\n        globalHotKeys: globalHotKeys\n      };\n    }\n  };\n}\n\nfunction I18nPlugin() {\n  var i18nTextMap = new Map([[I18nKey.CONFIRM, 'Confirm'], [I18nKey.CANCEL, 'Cancel'], [I18nKey.DEFAULT, 'Default'], [I18nKey.SEARCH, 'Search'], [I18nKey.LEFT_AND_RIGHT, 'Left And Right'], [I18nKey.ONLY_LEFT, 'Only Left'], [I18nKey.ONLY_RIGHT, 'Only Right'], [I18nKey.EDIT, 'Edit'], [I18nKey.ADD_CHILD, 'Add Child'], [I18nKey.ADD_SIBLING, 'Add Sibling'], [I18nKey.EDIT_NOTES, 'Edit Notes'], [I18nKey.DELETE, 'Delete'], [I18nKey.SET_AS_EDITOR_ROOT, 'Set as Editor Root'], [I18nKey.EDIT_TOPOLOGY_DIAGRAM, 'Edit Topology Diagram'], [I18nKey.SET_TOPIC_REFERENCES, 'Set Topic References'], [I18nKey.TOPIC_STYLE, 'TopicStyle'], [I18nKey.STYLE, 'Style'], [I18nKey.TEXT_EDITOR, 'Text Editor'], [I18nKey.LINK, 'Link'], [I18nKey.LINK_TO_PARENT, 'LinkToParent'], [I18nKey.SUB_LINKS, 'SubLinks'], [I18nKey.COPY_STYLE, 'Copy Style'], [I18nKey.PASTE_STYLE, 'Paste Style'], [I18nKey.CLEAR_TOPIC_STYLE, 'Clear Topic Style'], [I18nKey.CLEAR_ALL_CUSTOM_STYLE, 'Clear All Custom Style'], [I18nKey.LINE_TYPE, 'LineType'], [I18nKey.THEME, 'Theme'], [I18nKey.GLOBAL, 'Global'], [I18nKey.HIGHLIGHT, 'Highlight'], [I18nKey.RANDOM_COLOR, 'Random Color'], [I18nKey.NORMAL_TOPIC, 'NormalTopic'], [I18nKey.PRIMARY_TOPIC, 'PrimaryTopic'], [I18nKey.ROOT_TOPIC, 'RootTopic'], [I18nKey.EXPORT_THEME, 'Export Theme'], [I18nKey.IMPORT_THEME, 'Import Theme'], [I18nKey.TAGS, 'Tags'], [I18nKey.TAGS_MANAGER, 'Tags Manager'], [I18nKey.TAG_NAME, 'Tag Name'], [I18nKey.ADD_TAG, 'Add Tag'], [I18nKey.UPDATE_TAG, 'Update Tag'], [I18nKey.ALREADY_ADDED, 'Already Added'], [I18nKey.CAN_BE_ADDED, 'Can be Added'], [I18nKey.TOPICS_THAT_USE_THIS_TAG, 'Topics that Use this Tag'], [I18nKey.BACKGROUND, 'Background'], [I18nKey.COLOR, 'Color'], [I18nKey.BORDER, 'Border'], [I18nKey.WIDTH, 'Width'], [I18nKey.RADIUS, 'Radius'], [I18nKey.FONT_SIZE, 'FontSize'], [I18nKey.LINE_HEIGHT, 'LineHeight'], [I18nKey.PADDING, 'Padding'], [I18nKey.TOP, 'Top'], [I18nKey.BOTTOM, 'Bottom'], [I18nKey.LEFT, 'Left'], [I18nKey.RIGHT, 'Right'], [I18nKey.NONE, 'None'], [I18nKey.SOLID, 'Solid'], [I18nKey.DOTTED, 'Dotted'], [I18nKey.DASHED, 'Dashed'], [I18nKey.DOUBLE, 'Double'], [I18nKey.ROUND, 'Round'], [I18nKey.CURVE, 'Curve'], [I18nKey.LINE, 'Line'], [I18nKey.COLLAPSE_ALL, 'Collapse All'], [I18nKey.EXPAND_ALL, 'Expand All'], [I18nKey.CENTER_ROOT_TOPIC, 'Center Root Topic'], [I18nKey.ZOOM, 'zoom'], [I18nKey.ZOOM_IN, 'Zoom In'], [I18nKey.ZOOM_OUT, 'Zoom Out'], [I18nKey.RESET, 'Reset'], [I18nKey.RESET_ZOOM, 'Reset Zoom'], [I18nKey.NOTE_PLACEHOLDER, 'Write topic notes here'], [I18nKey.TOPOLOGY_DIAGRAM_EDITOR, 'Topology Diagram Editor'], [I18nKey.BASIC, 'Basic'], [I18nKey.FLOW_GRAPH, 'Flow Graph'], [I18nKey.ACTIVITY_DIAGRAM, 'Activity Diagram'], [I18nKey.SEQUENCE_DIAGRAM, 'Sequence Diagram'], [I18nKey.CLASS_DIAGRAM, 'Class Diagram'], [I18nKey.REFERENCE_TOPICS, 'Reference Topics'], [I18nKey.REFERENCED_TOPICS, 'Referenced Topics'], [I18nKey.SELECT_REF_TOPICS_TIP, 'Please select the topics you want to reference. After selection, click the confirm button.'], [I18nKey.TAG_NAME_OVER_MAX_TIP, 'The length of tag name over the maximum length: 50!'], [I18nKey.DELETE_TAG_TIP, 'All the relationship about this tag will be lost if you delete this tag! Are you confirm?'], [I18nKey.DELETE_TOPOLOGY_TIP, 'Are you confirm to delete this topology diagram?']]);\n  return {\n    getI18nTextMap: function getI18nTextMap() {\n      return i18nTextMap;\n    },\n    getI18nText: function getI18nText(ctx) {\n      var controller = ctx.controller,\n          key = ctx.key;\n      var m = controller.run('getI18nTextMap', ctx);\n\n      if (!m.has(key)) {\n        throw new Error(\"i18n key \".concat(key, \" is not exist\"));\n      }\n\n      return m.get(key);\n    }\n  };\n}\n\nfunction LayoutPlugin() {\n  var _zoomFactor = 1;\n  return {\n    getPartTopics: function getPartTopics(_ref3) {\n      var layout = _ref3.layout,\n          model = _ref3.model,\n          topicKey = _ref3.topicKey;\n      var topic = model.getTopic(topicKey);\n      var subTopicCount = topic.subKeys.size;\n      var topics = topic.subKeys.toArray();\n\n      switch (layout) {\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return {\n            R: topics\n          };\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return {\n            L: topics\n          };\n\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return {\n            L: topics.slice(Math.ceil(subTopicCount / 2), subTopicCount),\n            R: topics.slice(0, Math.ceil(subTopicCount / 2))\n          };\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return {\n            B: topics\n          };\n      }\n    },\n    createSubTopics: function createSubTopics(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          topics = props.topics,\n          saveRef = props.saveRef;\n      var topic = model.getTopic(topicKey);\n      if (topics.size === 0 || topic.collapse) return null;\n      var subTopics = [];\n      topics.forEach(function (tKey) {\n        var topicProps = _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: tKey,\n          key: tKey,\n          ref: saveRef(topicWidgetRefKey(tKey))\n        });\n\n        subTopics.push(controller.run('renderTopicWidget', topicProps));\n      });\n      return {\n        subTopics: subTopics\n      };\n    },\n    layout: function layout(props) {\n      var getRef = props.getRef,\n          model = props.model;\n      var links = getRef(linksRefKey(model.editorRootTopicKey));\n      var highlight = getRef(RefKey.FOCUS_HIGHLIGHT_KEY);\n      var dropEffect = getRef(RefKey.DROP_EFFECT_KEY);\n      links && links.layout();\n      highlight && highlight.layout();\n      dropEffect && dropEffect.layout();\n      var editorRootTopic = model.getTopic(model.editorRootTopicKey);\n      layoutTopic(editorRootTopic);\n\n      function layoutTopic(topic) {\n        if (topic.key !== model.editorRootTopicKey) {\n          var topicWidget = getRef(topicWidgetRefKey(topic.key));\n          topicWidget && topicWidget.layoutLinks();\n        }\n\n        if (!topic.collapse) {\n          var _iterator2 = _createForOfIteratorHelper(topic.subKeys),\n              _step2;\n\n          try {\n            for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n              var subKey = _step2.value;\n              layoutTopic(model.getTopic(subKey));\n            }\n          } catch (err) {\n            _iterator2.e(err);\n          } finally {\n            _iterator2.f();\n          }\n        }\n      }\n    },\n    getRelativeRect: function getRelativeRect(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      return _getRelativeRect(element, bigView, zoomFactor);\n    },\n    getRelativeRectFromViewPort: function getRelativeRectFromViewPort(props) {\n      var element = props.element,\n          controller = props.controller,\n          getRef = props.getRef;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return _getRelativeRect(element, viewBox, zoomFactor);\n    },\n    getRelativeVectorFromViewPort: function getRelativeVectorFromViewPort(props) {\n      var element = props.element,\n          getRef = props.getRef;\n      var viewBox = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).viewBox;\n      return getRelativeVector(element, viewBox);\n    },\n    addZoomFactorChangeEventListener: function addZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('addTempValueChangeListener', _objectSpread({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    removeZoomFactorChangeEventListener: function removeZoomFactorChangeEventListener(props) {\n      var controller = props.controller;\n      controller.run('removeTempValueChangeListener', _objectSpread({\n        key: 'ZoomFactor'\n      }, props));\n    },\n    setZoomFactor: function setZoomFactor(props) {\n      var controller = props.controller,\n          zoomFactor = props.zoomFactor;\n      return controller.run('setTempValue', {\n        key: 'ZoomFactor',\n        value: zoomFactor\n      });\n    },\n    getZoomFactor: function getZoomFactor(props) {\n      var controller = props.controller;\n      return controller.run('getTempValue', {\n        key: 'ZoomFactor'\n      }) || _zoomFactor;\n    },\n    moveTopicToCenter: function moveTopicToCenter(props) {\n      var getRef = props.getRef,\n          topicKey = props.topicKey,\n          model = props.model,\n          _props$moveDir = props.moveDir,\n          moveDir = _props$moveDir === void 0 ? MoveTopicDir.LEFT_CENTER : _props$moveDir;\n\n      if (model.editorRootTopicKey !== topicKey && getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n        throw new Error(\"moveTopicToCenter error: topicKey \".concat(topicKey, \" is not the DESCENDANT of editor root topic\"));\n      }\n\n      var topic = getRef(topicRefKey(topicKey));\n      var dragScroll = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n      var viewBox = dragScroll.viewBox;\n\n      if (!topic || !viewBox) {\n        throw new Error(\"moveTopicToCenter error: topic or viewBox is null\");\n      }\n\n      var vector = getRelativeVector(topic, viewBox); //TODO\n\n      if (moveDir === MoveTopicDir.CENTER) dragScroll.setViewBoxScrollDelta(vector[0], vector[1]);else if (moveDir === MoveTopicDir.LEFT_CENTER) {\n        var boxRect = viewBox.getBoundingClientRect();\n        var topicRect = topic.getBoundingClientRect();\n        var delta = (boxRect.width - topicRect.width) / 2;\n        dragScroll.setViewBoxScrollDelta(vector[0] + delta - 200, vector[1]);\n      }\n    },\n    focusTopicAndMoveToCenter: function focusTopicAndMoveToCenter(props) {\n      var controller = props.controller,\n          topicKey = props.topicKey;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opArray: [{\n          opType: OpType.FOCUS_TOPIC,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL\n        }, {\n          opType: OpType.EXPAND_TO,\n          topicKey: topicKey\n        }],\n        allowUndo: false,\n        callback: function callback(model) {\n          return function () {\n            controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, props), {}, {\n              model: model,\n              topicKey: topicKey\n            }));\n          };\n        }\n      }));\n    }\n  };\n}\n\nvar log$3 = debug('plugin:operation');\n\nfunction OperationPlugin() {\n  var startEditingContent = function startEditingContent(_ref4) {\n    var model = _ref4.model,\n        topicKey = _ref4.topicKey;\n    return ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  };\n\n  var startEditingDesc = function startEditingDesc(_ref5) {\n    var model = _ref5.model,\n        topicKey = _ref5.topicKey;\n    var topic = model.getTopic(topicKey);\n    var desc = topic.getBlock(BlockType.DESC);\n\n    if (desc.block == null || desc.block.data == null) {\n      model = ModelModifier.setBlockData({\n        model: model,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: ''\n      });\n    }\n\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FocusMode.EDITING_DESC\n    });\n    return model;\n  };\n\n  function dragAndDrop(props) {\n    var srcKey = props.srcKey,\n        dstKey = props.dstKey,\n        dropDir = props.dropDir;\n    var model = props.model;\n    var srcTopic = model.getTopic(srcKey);\n    var dstTopic = model.getTopic(dstKey);\n    var srcParentKey = srcTopic.parentKey;\n    var srcParentTopic = model.getTopic(srcParentKey);\n    var srcParentSubKeys = srcParentTopic.subKeys;\n    var srcIndex = srcParentSubKeys.indexOf(srcKey);\n    srcParentSubKeys = srcParentSubKeys.delete(srcIndex);\n\n    if (dropDir === 'in') {\n      var dstSubKeys = dstTopic.subKeys;\n      dstSubKeys = dstSubKeys.push(srcKey);\n      model = model.withMutations(function (m) {\n        m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstKey).setIn(['topics', dstKey, 'subKeys'], dstSubKeys).setIn(['topics', dstKey, 'collapse'], false);\n      });\n    } else {\n      var dstParentKey = dstTopic.parentKey;\n      var dstParentItem = model.getTopic(dstParentKey);\n      var dstParentSubKeys = dstParentItem.subKeys;\n      var dstIndex = dstParentSubKeys.indexOf(dstKey); //src  dst \n\n      if (srcParentKey === dstParentKey) {\n        var newDstParentSubKeys = List();\n        dstParentSubKeys.forEach(function (key) {\n          if (key !== srcKey) {\n            if (key === dstKey) {\n              if (dropDir === 'prev') {\n                newDstParentSubKeys = newDstParentSubKeys.push(srcKey).push(key);\n              } else {\n                newDstParentSubKeys = newDstParentSubKeys.push(key).push(srcKey);\n              }\n            } else {\n              newDstParentSubKeys = newDstParentSubKeys.push(key);\n            }\n          }\n        });\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', dstParentKey, 'subKeys'], newDstParentSubKeys);\n        });\n      } else {\n        if (dropDir === 'prev') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex, srcKey);\n        } else if (dropDir === 'next') {\n          dstParentSubKeys = dstParentSubKeys.insert(dstIndex + 1, srcKey);\n        }\n\n        model = model.withMutations(function (m) {\n          m.setIn(['topics', srcParentKey, 'subKeys'], srcParentSubKeys).setIn(['topics', srcKey, 'parentKey'], dstParentKey).setIn(['topics', dstParentKey, 'subKeys'], dstParentSubKeys).setIn(['topics', dstParentKey, 'collapse'], false);\n        });\n      }\n    }\n\n    return model;\n  }\n\n  var OpMap = new Map([[OpType.TOGGLE_COLLAPSE, ModelModifier.toggleCollapse], [OpType.COLLAPSE_ALL, ModelModifier.collapseAll], [OpType.EXPAND_ALL, ModelModifier.expandAll], [OpType.EXPAND_TO, ModelModifier.expandTo], [OpType.ADD_CHILD, ModelModifier.addChild], [OpType.ADD_SIBLING, ModelModifier.addSibling], [OpType.DELETE_TOPIC, ModelModifier.deleteTopic], [OpType.FOCUS_TOPIC, ModelModifier.focusTopic], [OpType.SET_FOCUS_MODE, ModelModifier.setFocusMode], [OpType.SET_STYLE, ModelModifier.setStyle], [OpType.CLEAR_ALL_CUSTOM_STYLE, ModelModifier.clearAllCustomStyle], [OpType.SET_THEME, ModelModifier.setTheme], [OpType.SET_TOPIC_BLOCK, ModelModifier.setBlockData], [OpType.DELETE_TOPIC_BLOCK, ModelModifier.deleteBlock], [OpType.START_EDITING_CONTENT, startEditingContent], [OpType.START_EDITING_DESC, startEditingDesc], [OpType.DRAG_AND_DROP, dragAndDrop], [OpType.SET_EDITOR_ROOT, ModelModifier.setEditorRootTopicKey], [OpType.SET_LAYOUT_DIR, ModelModifier.setLayoutDir]]);\n  var undoStack = Stack();\n  var redoStack = Stack();\n  var enabled = true;\n  var whiteListOperation = new Set();\n  return {\n    isOperationEnabled: function isOperationEnabled(props) {\n      return enabled;\n    },\n    enableOperation: function enableOperation() {\n      enabled = true;\n    },\n    disableOperation: function disableOperation(_ref6) {\n      var whiteList = _ref6.whiteList;\n      enabled = false;\n      if (whiteList) whiteListOperation = new Set(whiteList);else whiteListOperation.clear();\n    },\n\n    /** plugin can extend Operation Map\r\n     * for example: A plugin can write a function\r\n     * getOpMap(ctx,next) {\r\n     *   let opMap = next();\r\n     *   opMap.set(\"OpTypeName\",opFunc);\r\n     *   return opMap;\r\n     * }\r\n     * @param ctx\r\n     */\n    getOpMap: function getOpMap(ctx) {\n      return OpMap;\n    },\n    //undo\n    getAllowUndo: function getAllowUndo(ctx) {\n      var model = ctx.model,\n          opType = ctx.opType,\n          _ctx$allowUndo = ctx.allowUndo,\n          allowUndo = _ctx$allowUndo === void 0 ? true : _ctx$allowUndo;\n      if (allowUndo === false) return false;\n\n      if (opType) {\n        switch (opType) {\n          // undo \n          case OpType.FOCUS_TOPIC:\n          case OpType.SET_FOCUS_MODE:\n          case OpType.START_EDITING_CONTENT:\n          case OpType.START_EDITING_DESC:\n            return false;\n        }\n      }\n\n      switch (model.focusMode) {\n        case 'EDITING_DESC':\n        case 'EDITING_CONTENT':\n          return false;\n      }\n\n      return model.config.allowUndo;\n    },\n    getUndoRedoStack: function getUndoRedoStack() {\n      return {\n        undoStack: undoStack,\n        redoStack: redoStack\n      };\n    },\n    setUndoStack: function setUndoStack(ctx) {\n      log$3('setUndoStack', ctx.undoStack);\n      undoStack = ctx.undoStack;\n    },\n    setRedoStack: function setRedoStack(ctx) {\n      log$3('setRedoStack', ctx.redoStack);\n      redoStack = ctx.redoStack;\n    },\n    canUndo: function canUndo(ctx) {\n      var controller = ctx.controller;\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n      if (!isOperationEnabled) return false;\n\n      var _controller$run = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run.undoStack;\n\n      var allowUndo = controller.run('getAllowUndo', ctx);\n      return undoStack.size > 0 && allowUndo;\n    },\n    canRedo: function canRedo(ctx) {\n      var controller = ctx.controller;\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n      if (!isOperationEnabled) return false;\n\n      var _controller$run2 = controller.run('getUndoRedoStack', ctx),\n          redoStack = _controller$run2.redoStack;\n\n      var allowUndo = controller.run('getAllowUndo', ctx);\n      return redoStack.size > 0 && allowUndo;\n    },\n    undo: function undo(ctx) {\n      var controller = ctx.controller,\n          model = ctx.model;\n\n      if (!controller.run('getAllowUndo', ctx)) {\n        return;\n      }\n\n      var _controller$run3 = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run3.undoStack,\n          redoStack = _controller$run3.redoStack;\n\n      var newModel = undoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        undoStack: undoStack.shift()\n      }));\n      controller.run('setRedoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        redoStack: redoStack.push(model)\n      }));\n      log$3(newModel);\n      controller.change(newModel);\n    },\n    redo: function redo(ctx) {\n      var controller = ctx.controller,\n          model = ctx.model;\n\n      if (!controller.run('getAllowUndo', ctx)) {\n        return;\n      }\n\n      var _controller$run4 = controller.run('getUndoRedoStack', ctx),\n          undoStack = _controller$run4.undoStack,\n          redoStack = _controller$run4.redoStack;\n\n      var newModel = redoStack.peek();\n      if (!newModel) return;\n      controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        undoStack: undoStack.push(model)\n      }));\n      controller.run('setRedoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n        redoStack: redoStack.shift()\n      }));\n      controller.change(newModel);\n    },\n    //TODO \n    operation: function operation(ctx) {\n      var controller = ctx.controller,\n          opType = ctx.opType,\n          model = ctx.model,\n          opArray = ctx.opArray,\n          callback = ctx.callback;\n\n      if (opArray != null && !Array.isArray(opArray)) {\n        throw new Error('operation: the type of opArray must be array!');\n      }\n\n      if (opType != null && opArray != null) {\n        throw new Error('operation: opType and opArray conflict!');\n      }\n\n      var isOperationEnabled = controller.run('isOperationEnabled', ctx);\n\n      if (!isOperationEnabled) {\n        // warning(\n        //   true,\n        //   `You have disabled operation,but you run operation ${props} now!`\n        // );\n        if (whiteListOperation.size === 0) return;\n\n        if (opArray != null) {\n          var opNotInWhiteList = opArray.filter(function (op) {\n            return !whiteListOperation.has(op.opType);\n          });\n\n          if (opNotInWhiteList && opNotInWhiteList.length > 0) {\n            return;\n          }\n        } else if (!whiteListOperation.has(opType)) {\n          return;\n        }\n      }\n\n      log$3('operation:', opType || opArray.map(function (op) {\n        return op.opType;\n      }));\n      log$3('operation:', model);\n      log$3('operation:', ctx);\n      var opMap = controller.run('getOpMap', ctx);\n      controller.run('beforeOperation', ctx);\n\n      if (controller.run('getAllowUndo', ctx)) {\n        var _controller$run5 = controller.run('getUndoRedoStack', ctx),\n            _undoStack = _controller$run5.undoStack;\n\n        controller.run('setUndoStack', _objectSpread(_objectSpread({}, ctx), {}, {\n          undoStack: _undoStack.push(model)\n        }));\n      }\n\n      var newModel;\n\n      if (opArray != null) {\n        newModel = opArray.reduce(function (acc, cur) {\n          var opType = cur.opType;\n          if (!opMap.has(opType)) throw new Error(\"opType:\".concat(opType, \" not exist!\"));\n          var opFunc = opMap.get(opType);\n\n          var opFuncProps = _objectSpread(_objectSpread({\n            controller: controller\n          }, cur), {}, {\n            model: acc\n          });\n\n          var res = controller.run('beforeOpFunction', opFuncProps);\n          res = opFunc(_objectSpread(_objectSpread({}, opFuncProps), {}, {\n            model: res\n          }));\n          res = controller.run('afterOpFunction', _objectSpread(_objectSpread({}, opFuncProps), {}, {\n            model: res\n          }));\n          return res;\n        }, model);\n      } else {\n        if (!opMap.has(opType)) throw new Error(\"opType:\".concat(opType, \" not exist!\"));\n        var opFunc = opMap.get(opType);\n        newModel = controller.run('beforeOpFunction', ctx);\n        newModel = opFunc(_objectSpread(_objectSpread({}, ctx), {}, {\n          model: newModel\n        }));\n        newModel = controller.run('afterOpFunction', _objectSpread(_objectSpread({}, ctx), {}, {\n          model: newModel\n        }));\n      }\n\n      log$3('newModel:', newModel);\n      controller.change(newModel, callback ? callback(newModel) : null);\n      controller.run('afterOperation', ctx);\n    },\n    deleteRefKey: function deleteRefKey(ctx) {\n      var model = ctx.model,\n          topicKey = ctx.topicKey,\n          deleteRef = ctx.deleteRef;\n      var allSubKeys = getAllSubTopicKeys(model, topicKey);\n      allSubKeys.push(topicKey);\n\n      var _iterator3 = _createForOfIteratorHelper(allSubKeys),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var key = _step3.value;\n          deleteRef(linksRefKey(key));\n          deleteRef(linksSvgRefKey(key));\n          deleteRef(contentRefKey(key));\n          deleteRef(contentEditorRefKey(key));\n          deleteRef(descEditorRefKey(key));\n          deleteRef(topicWidgetRefKey(key));\n          deleteRef(topicRefKey(key));\n          deleteRef(collapseRefKey(key));\n          deleteRef(dropAreaRefKey(key, 'next'));\n          deleteRef(dropAreaRefKey(key, 'prev'));\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n    },\n    // Operation\n    beforeOperation: function beforeOperation(props) {},\n    afterOperation: function afterOperation(props) {},\n    // OpFunction\n    beforeOpFunction: function beforeOpFunction(ctx) {\n      var controller = ctx.controller,\n          opType = ctx.opType,\n          model = ctx.model,\n          topicKey = ctx.topicKey;\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        controller.run('deleteRefKey', ctx);\n      }\n\n      return model;\n    },\n    afterOpFunction: function afterOpFunction(ctx) {\n      return ctx.model;\n    },\n    openNewModel: function openNewModel(ctx) {\n      var model = ctx.model,\n          controller = ctx.controller,\n          newModel = ctx.newModel;\n      controller.run('deleteRefKey', _objectSpread(_objectSpread({}, ctx), {}, {\n        topicKey: model.rootTopicKey\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, ctx), {}, {\n        opType: OpType.EXPAND_TO,\n        topicKey: newModel.focusKey,\n        model: newModel,\n        callback: function callback(model) {\n          return function () {\n            controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, ctx), {}, {\n              model: model,\n              topicKey: model.focusKey\n            }));\n          };\n        }\n      }));\n    }\n  };\n}\n\nvar TopicContextMenu = /*#__PURE__*/function (_BaseWidget) {\n  _inherits(TopicContextMenu, _BaseWidget);\n\n  var _super4 = _createSuper(TopicContextMenu);\n\n  function TopicContextMenu() {\n    _classCallCheck(this, TopicContextMenu);\n\n    return _super4.apply(this, arguments);\n  }\n\n  _createClass(TopicContextMenu, [{\n    key: \"render\",\n    value: function render() {\n      var controller = this.props.controller;\n      return createElement(Menu, null, controller.run('customizeTopicContextMenu', this.props));\n    }\n  }]);\n\n  return TopicContextMenu;\n}(BaseWidget);\n\nvar items = [{\n  icon: 'edit',\n  label: I18nKey.EDIT,\n  shortcut: 'Space',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_CONTENT\n}, {\n  icon: 'add-sibling',\n  label: I18nKey.ADD_SIBLING,\n  shortcut: 'Enter',\n  opType: OpType.ADD_SIBLING\n}, {\n  icon: 'add-child',\n  label: I18nKey.ADD_CHILD,\n  shortcut: 'Tab',\n  rootCanUse: true,\n  opType: OpType.ADD_CHILD\n}, {\n  icon: 'notes',\n  label: I18nKey.EDIT_NOTES,\n  shortcut: 'Alt + D',\n  rootCanUse: true,\n  opType: OpType.START_EDITING_DESC\n}, {\n  icon: 'delete-node',\n  label: I18nKey.DELETE,\n  shortcut: 'Del',\n  opType: OpType.DELETE_TOPIC\n}, {\n  icon: 'root',\n  label: I18nKey.SET_AS_EDITOR_ROOT,\n  shortcut: 'Alt + Shift + F',\n  opType: OpType.SET_EDITOR_ROOT\n}];\n\nfunction ContextMenuPlugin() {\n  return {\n    renderTopicContextMenu: function renderTopicContextMenu(props) {\n      return createElement(TopicContextMenu, Object.assign({}, props));\n    },\n    customizeTopicContextMenu: function customizeTopicContextMenu(ctx) {\n      var topicKey = ctx.topicKey,\n          model = ctx.model,\n          controller = ctx.controller;\n      var isRoot = topicKey === model.editorRootTopicKey;\n\n      function onClickItem(item) {\n        return function (e) {\n          item.opType && controller.run('operation', _objectSpread(_objectSpread({}, ctx), {}, {\n            opType: item.opType\n          }));\n        };\n      }\n\n      return items.map(function (item) {\n        return isRoot && !item.rootCanUse ? null : createElement(MenuItem, {\n          key: item.label,\n          icon: Icon(item.icon),\n          text: getI18nText(ctx, item.label),\n          labelElement: createElement(\"kbd\", null, item.shortcut),\n          onClick: onClickItem(item)\n        });\n      });\n    }\n  };\n}\n\nvar log$4 = debug('node:topic-drop-effect');\nvar DropEffectSvg = styled.svg(_templateObject24 || (_templateObject24 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicDropEffect = /*#__PURE__*/function (_BaseWidget2) {\n  _inherits(TopicDropEffect, _BaseWidget2);\n\n  var _super5 = _createSuper(TopicDropEffect);\n\n  function TopicDropEffect() {\n    var _this3;\n\n    _classCallCheck(this, TopicDropEffect);\n\n    _this3 = _super5.apply(this, arguments);\n    _this3.state = {\n      content: null\n    };\n    return _this3;\n  }\n\n  _createClass(TopicDropEffect, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var getRef = props.getRef,\n          model = props.model,\n          zoomFactor = props.zoomFactor,\n          diagramState = props.diagramState;\n      var dragDrop = diagramState.dragDrop;\n\n      if (dragDrop == null) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var targetKey = dragDrop.targetKey,\n          targetDir = dragDrop.targetDir;\n      log$4('layout', targetDir);\n\n      if (targetKey == null) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var refKey;\n\n      if (targetDir === 'in') {\n        refKey = contentRefKey(targetKey);\n      } else {\n        refKey = dropAreaRefKey(targetKey, targetDir);\n      }\n\n      var content = getRef(refKey);\n      var svg = getRef('svg-drop-effect');\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var padding = 3;\n      var x = contentRect.left - svgRect.left - padding;\n      var y = contentRect.top - svgRect.top - padding;\n      var width = contentRect.width + 2 * padding;\n      var height = contentRect.height + 2 * padding;\n      this.setState({\n        content: createElement(\"g\", null, createElement(\"rect\", {\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: \"none\",\n          stroke: model.config.theme.highlightColor,\n          strokeDasharray: \"5,5\",\n          strokeWidth: 2\n        }))\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var saveRef = this.props.saveRef;\n      return createElement(DropEffectSvg, {\n        ref: saveRef('svg-drop-effect')\n      }, this.state.content);\n    }\n  }]);\n\n  return TopicDropEffect;\n}(BaseWidget);\n\nvar log$5 = debug('plugin:drag-and-drop');\nvar DropArea = styled.div(_templateObject25 || (_templateObject25 = _taggedTemplateLiteral([\"\\n  height: \", \";\\n  width: 100%;\\n  margin: 5px 0px;\\n\"])), function (props) {\n  return \"\".concat(props.height, \"px\");\n});\n\nfunction DragAndDropPlugin() {\n  // let dragTargetKey: KeyType = null;\n  // let dragTargetDir: string = null;\n  return {\n    renderTopicDropArea: function renderTopicDropArea(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          saveRef = props.saveRef,\n          controller = props.controller,\n          model = props.model;\n\n      var onDragEnter = function onDragEnter(ev) {\n        log$5('onDragEnter', topicKey, dropDir);\n        controller.run('handleTopicDragEnter', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragLeave = function onDragLeave(ev) {\n        log$5('onDragLeave', topicKey, dropDir);\n        controller.run('handleTopicDragLeave', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var onDragOver = function onDragOver(ev) {\n        ev.preventDefault();\n      };\n\n      var onDrop = function onDrop(ev) {\n        log$5('onDrop', topicKey, dropDir);\n        controller.run('handleTopicDrop', _objectSpread(_objectSpread({}, props), {}, {\n          ev: ev,\n          dropDir: dropDir\n        }));\n      };\n\n      var eventHandlers = {\n        onDragEnter: onDragEnter,\n        onDragLeave: onDragLeave,\n        onDragOver: onDragOver,\n        onDrop: onDrop\n      };\n      return createElement(DropArea, Object.assign({\n        height: model.config.theme.marginV / 2,\n        ref: saveRef(dropAreaRefKey(topicKey, dropDir))\n      }, eventHandlers));\n    },\n    renderDragAndDropEffect: function renderDragAndDropEffect(props) {\n      log$5('renderDragAndDropEffect');\n      var saveRef = props.saveRef;\n      return createElement(TopicDropEffect, Object.assign({\n        ref: saveRef(RefKey.DROP_EFFECT_KEY)\n      }, props));\n    },\n    handleTopicDragStart: function handleTopicDragStart(props) {\n      var controller = props.controller,\n          ev = props.ev;\n      ev.stopPropagation();\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.FOCUS_TOPIC,\n        focusMode: FocusMode.DRAGGING\n      }));\n    },\n    canDrop: function canDrop(props) {\n      var srcKey = props.srcKey,\n          dstKey = props.dstKey,\n          model = props.model,\n          dropDir = props.dropDir;\n      if (srcKey === model.editorRootTopicKey || srcKey === dstKey || getRelationship(model, srcKey, dstKey) === TopicRelationship.ANCESTOR) return false;\n      if (dstKey === model.editorRootTopicKey && dropDir !== 'in') return false;\n      var srcTopic = model.getTopic(srcKey);\n      if (srcTopic.parentKey === dstKey && dropDir === 'in') return false;\n      return true;\n    },\n    handleTopicDragEnter: function handleTopicDragEnter(props) {\n      var dropDir = props.dropDir,\n          topicKey = props.topicKey,\n          controller = props.controller,\n          model = props.model,\n          diagramState = props.diagramState,\n          setDiagramState = props.setDiagramState;\n      log$5('handleTopicDragEnter:', topicKey, dropDir);\n      var canDrop = controller.run('canDrop', _objectSpread(_objectSpread({}, props), {}, {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      }));\n\n      if (canDrop) {\n        setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n          dragDrop: {\n            targetKey: topicKey,\n            targetDir: dropDir\n          }\n        }));\n      }\n    },\n    handleTopicDragLeave: function handleTopicDragLeave(props) {\n      var topicKey = props.topicKey,\n          dropDir = props.dropDir,\n          getRef = props.getRef,\n          ev = props.ev,\n          diagramState = props.diagramState,\n          setDiagramState = props.setDiagramState;\n      var relatedTarget = ev.nativeEvent.relatedTarget;\n      log$5('handleTopicDragLeave:', topicKey, dropDir);\n      var content = getRef(contentRefKey(topicKey));\n\n      if (content == relatedTarget || content.contains(relatedTarget)) {\n        return;\n      }\n\n      setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n        dragDrop: null\n      }));\n    },\n    handleTopicDrop: function handleTopicDrop(props) {\n      log$5('handleTopicDrop');\n      var _props2 = props,\n          controller = _props2.controller,\n          topicKey = _props2.topicKey,\n          model = _props2.model,\n          diagramState = _props2.diagramState,\n          setDiagramState = _props2.setDiagramState;\n      props = _objectSpread(_objectSpread({}, props), {}, {\n        srcKey: model.focusKey,\n        dstKey: topicKey\n      });\n      setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n        dragDrop: null\n      }));\n\n      if (controller.run('canDrop', props)) {\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.DRAG_AND_DROP\n        }));\n      }\n    }\n  };\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nvar NodeLayer = styled.div(_templateObject26 || (_templateObject26 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  align-items: center;\\n  padding: 5px;\\n\"])));\nvar DIV = styled.div(_templateObject27 || (_templateObject27 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  background: \", \";\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nvar MindDragScrollWidget = /*#__PURE__*/function (_PureComponent) {\n  _inherits(MindDragScrollWidget, _PureComponent);\n\n  var _super6 = _createSuper(MindDragScrollWidget);\n\n  function MindDragScrollWidget(props) {\n    var _this4;\n\n    _classCallCheck(this, MindDragScrollWidget);\n\n    _this4 = _super6.call(this, props);\n\n    _this4.setZoomFactor = function (zoomFactor) {\n      _this4.dragScrollWidget.setZoomFactor(zoomFactor);\n    };\n\n    _this4.onWheel = function (e) {\n      if (e.altKey || e.ctrlKey) {\n        var controller = _this4.props.controller;\n        var zoomFactor = controller.run('getZoomFactor', _this4.props);\n        zoomFactor = zoomFactor - (e.nativeEvent.deltaY > 0 ? 0.1 : -0.1);\n        if (zoomFactor < 0.5) zoomFactor = 0.5;\n        if (zoomFactor > 4) zoomFactor = 4; // console.log('zoomFactor=>', zoomFactor);\n\n        controller.run('setZoomFactor', _objectSpread(_objectSpread({}, _this4.props), {}, {\n          zoomFactor: zoomFactor\n        }));\n      }\n    };\n\n    return _this4;\n  }\n\n  _createClass(MindDragScrollWidget, [{\n    key: \"renderHotkeys\",\n    value: function renderHotkeys() {\n      var props = this.props;\n      var controller = props.controller,\n          model = props.model;\n      var hotKeys = controller.run('customizeHotKeys', props);\n      if (hotKeys === null) return null;\n\n      if (!(hotKeys.topicHotKeys instanceof Map && hotKeys.globalHotKeys instanceof Map)) {\n        throw new TypeError('topicHotKeys and globalHotKeys must be a Map');\n      }\n\n      var children = [];\n\n      if (model.focusMode === FocusMode.NORMAL || model.focusMode === FocusMode.SHOW_POPUP) {\n        hotKeys.topicHotKeys.forEach(function (v, k) {\n          children.push(createElement(Hotkey, Object.assign({\n            key: k\n          }, v, {\n            global: true\n          })));\n        });\n      }\n\n      hotKeys.globalHotKeys.forEach(function (v, k) {\n        children.push(createElement(Hotkey, Object.assign({\n          key: k\n        }, v, {\n          global: true\n        })));\n      });\n      return createElement(Hotkeys, null, children);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props2 = this.props,\n          getRef = _this$props2.getRef,\n          model = _this$props2.model,\n          controller = _this$props2.controller;\n      controller.run('addZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, this.props), {}, {\n        listener: this.setZoomFactor\n      }));\n      var rootTopic = getRef(topicRefKey(model.editorRootTopicKey)); //TODO\n\n      var nodeLayer = getRef('node-layer');\n      var rootTopicRect = rootTopic.getBoundingClientRect();\n      var nodeLayerRect = nodeLayer.getBoundingClientRect();\n      this.dragScrollWidget.setViewBoxScrollDelta(0, rootTopicRect.top - nodeLayerRect.top - this.dragScrollWidget.viewBox.getBoundingClientRect().height / 2 + rootTopicRect.height);\n      this.layout();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var controller = this.props.controller;\n      controller.run('removeZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, this.props), {}, {\n        listener: this.setZoomFactor\n      }));\n    }\n  }, {\n    key: \"dragScrollWidget\",\n    get: function get() {\n      return this.props.getRef(RefKey.DRAG_SCROLL_WIDGET_KEY);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      var controller = this.props.controller;\n      controller.run('fireEvent', _objectSpread(_objectSpread({}, this.props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC\n      }));\n      this.layout();\n    }\n  }, {\n    key: \"layout\",\n    value: function layout() {\n      var controller = this.props.controller;\n      controller.run('layout', this.props);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      var _this$props3 = this.props,\n          saveRef = _this$props3.saveRef,\n          model = _this$props3.model,\n          controller = _this$props3.controller;\n      var nodeKey = model.editorRootTopicKey;\n      return createElement(DIV, {\n        onWheel: this.onWheel\n      }, createElement(DragScrollWidget, Object.assign({}, this.state, {\n        enableMouseWheel: false,\n        zoomFactor: model.zoomFactor,\n        ref: saveRef(RefKey.DRAG_SCROLL_WIDGET_KEY)\n      }), function (setViewBoxScroll, setViewBoxScrollDelta) {\n        var rootWidgetProps = _objectSpread(_objectSpread({}, _this5.props), {}, {\n          topicKey: nodeKey,\n          setViewBoxScroll: setViewBoxScroll,\n          setViewBoxScrollDelta: setViewBoxScrollDelta\n        });\n\n        return createElement(NodeLayer, {\n          ref: saveRef('node-layer')\n        }, controller.run('renderRootWidget', rootWidgetProps));\n      }));\n    }\n  }]);\n\n  return MindDragScrollWidget;\n}(PureComponent);\n\nMindDragScrollWidget = __decorate([HotkeysTarget], MindDragScrollWidget);\nvar Root = styled.div(_templateObject28 || (_templateObject28 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  width: 100%;\\n  height: 100%;\\n\"])));\nvar DiagramContainer = styled.div(_templateObject29 || (_templateObject29 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  //height: 100%;\\n  overflow: auto;\\n  flex-grow: 1;\\n  background: \", \";\\n  position: relative;\\n\"])), function (props) {\n  return props.theme.background;\n});\n\nfunction DiagramRoot(props) {\n  var controller = props.controller,\n      saveRef = props.saveRef;\n\n  var _useState = useState(controller.run('getInitialDiagramState', props)),\n      _useState2 = _slicedToArray(_useState, 2),\n      diagramState = _useState2[0],\n      setDiagramState = _useState2[1];\n\n  var nProps = _objectSpread(_objectSpread({}, props), {}, {\n    diagramState: diagramState,\n    setDiagramState: setDiagramState\n  });\n\n  return createElement(Root, null, controller.run('renderToolbar', props), createElement(DiagramContainer, {\n    ref: saveRef(RefKey.DIAGRAM_ROOT_KEY)\n  }, createElement(MindDragScrollWidget, Object.assign({}, nProps)), controller.run('renderDiagramCustomize', nProps)));\n}\n\nvar EditorRootBreadcrumbsRoot = styled(ZIndex)(_templateObject30 || (_templateObject30 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  width: 20%;\\n  padding: 0 5px;\\n  background: white;\\n  left: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n\"])));\nvar TooltipContent = styled.div(_templateObject31 || (_templateObject31 = _taggedTemplateLiteral([\"\\n  max-width: 600px;\\n\"])));\nvar BreadcrumbTitle = styled.span(_templateObject32 || (_templateObject32 = _taggedTemplateLiteral([\"\"])));\n\nvar EditorRootBreadcrumbs = /*#__PURE__*/function (_BaseWidget3) {\n  _inherits(EditorRootBreadcrumbs, _BaseWidget3);\n\n  var _super7 = _createSuper(EditorRootBreadcrumbs);\n\n  function EditorRootBreadcrumbs(props) {\n    var _this6;\n\n    _classCallCheck(this, EditorRootBreadcrumbs);\n\n    _this6 = _super7.call(this, props);\n\n    _this6.setEditorRootTopicKey = function (topicKey) {\n      return function () {\n        var _this6$props = _this6.props,\n            model = _this6$props.model,\n            controller = _this6$props.controller;\n\n        if (model.editorRootTopicKey !== topicKey) {\n          controller.run('operation', _objectSpread(_objectSpread({}, _this6.props), {}, {\n            opType: OpType.SET_EDITOR_ROOT,\n            topicKey: topicKey\n          }));\n        }\n      };\n    };\n\n    _this6.breadcrumbRenderer = function (props) {\n      var text = props.text,\n          breadProps = _objectWithoutProperties(props, _excluded5);\n\n      var needTooltip = text.length > 8;\n      var title = needTooltip ? text.substr(0, 8) + '...' : text; //TODO\n\n      var content = createElement(TooltipContent, null, text);\n      var tooltipProps = {\n        content: content,\n        position: PopoverPosition.BOTTOM_RIGHT\n      };\n      var breadcrumb = createElement(Breadcrumb, Object.assign({}, breadProps), createElement(BreadcrumbTitle, null, title));\n      return needTooltip ? createElement(Tooltip, Object.assign({}, tooltipProps), breadcrumb) : breadcrumb;\n    };\n\n    return _this6;\n  }\n\n  _createClass(EditorRootBreadcrumbs, [{\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var model = props.model,\n          controller = props.controller,\n          zIndex = props.zIndex;\n      var editingRootKey = model.editorRootTopicKey;\n      if (editingRootKey === model.rootTopicKey) return null;\n      var items = [];\n      var topic = model.getTopic(editingRootKey);\n\n      while (topic != null) {\n        var title = controller.getValue(PropKey.TOPIC_TITLE, _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: topic.key\n        }));\n        items.unshift({\n          text: title,\n          onClick: this.setEditorRootTopicKey(topic.key)\n        });\n        topic = model.getTopic(topic.parentKey);\n      }\n\n      var breadcrumbProps = {\n        items: items,\n        breadcrumbRenderer: this.breadcrumbRenderer\n      };\n      return createElement(EditorRootBreadcrumbsRoot, {\n        zIndex: zIndex\n      }, createElement(Breadcrumbs, Object.assign({}, breadcrumbProps)));\n    }\n  }]);\n\n  return EditorRootBreadcrumbs;\n}(BaseWidget);\n\nvar Modals = /*#__PURE__*/function (_BaseWidget4) {\n  _inherits(Modals, _BaseWidget4);\n\n  var _super8 = _createSuper(Modals);\n\n  function Modals() {\n    var _this7;\n\n    _classCallCheck(this, Modals);\n\n    _this7 = _super8.apply(this, arguments);\n\n    _this7.handleClose = function () {\n      var controller = _this7.props.controller;\n      var handleActiveModalClose = controller.run('handleActiveModalClose', _this7.props);\n      handleActiveModalClose && handleActiveModalClose();\n    };\n\n    return _this7;\n  }\n\n  _createClass(Modals, [{\n    key: \"render\",\n    value: function render() {\n      var controller = this.props.controller;\n      var activeModal = controller.run('renderModal', this.props);\n      var activeModalProps = controller.run('getActiveModalProps', this.props);\n      return createElement(Dialog, {\n        onClose: this.handleClose,\n        isOpen: activeModal !== null,\n        autoFocus: true,\n        enforceFocus: true,\n        usePortal: true,\n        title: activeModalProps && activeModalProps.title,\n        style: activeModalProps && activeModalProps.style\n      }, createElement(\"div\", {\n        className: Classes.DIALOG_BODY,\n        style: {\n          minHeight: 0\n        }\n      }, activeModal));\n    }\n  }]);\n\n  return Modals;\n}(BaseWidget);\n\nvar RootLinksSvg = styled.svg(_templateObject33 || (_templateObject33 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$6 = debug('node:root-sub-links');\n\nvar RootSubLinks = /*#__PURE__*/function (_BaseWidget5) {\n  _inherits(RootSubLinks, _BaseWidget5);\n\n  var _super9 = _createSuper(RootSubLinks);\n\n  function RootSubLinks() {\n    var _this8;\n\n    _classCallCheck(this, RootSubLinks);\n\n    _this8 = _super9.apply(this, arguments);\n    _this8.state = {\n      curves: []\n    };\n    return _this8;\n  }\n\n  _createClass(RootSubLinks, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var model = props.model,\n          getRef = props.getRef,\n          topicKey = props.topicKey,\n          zoomFactor = props.zoomFactor,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var content = getRef(contentRefKey(topicKey));\n      var svg = getRef(linksSvgRefKey(topicKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var p1, p2;\n      p1 = {\n        x: centerX(contentRect) - svgRect.left,\n        y: centerY(contentRect) - svgRect.top\n      };\n      var curves = [];\n      topic.subKeys.forEach(function (key) {\n        var linkStyle = controller.run('getLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: key\n        }));\n        var lineType = linkStyle.lineType;\n        var subTopicContent = getRef(contentRefKey(key));\n\n        var rect = _getRelativeRect(subTopicContent, bigView, zoomFactor);\n\n        if (rect.left > contentRect.right) {\n          p2 = {\n            x: rect.left,\n            y: centerY(rect)\n          };\n        } else {\n          p2 = {\n            x: rect.right,\n            y: centerY(rect)\n          };\n        }\n\n        p2 = {\n          x: p2.x - svgRect.left,\n          y: p2.y - svgRect.top\n        };\n        var curve;\n\n        if (lineType === 'curve') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" C \").concat(p1.x, \" \").concat(centerPointY(p1, p2), \" \").concat(centerPointX(p1, p2), \" \").concat(p2.y, \" \").concat(p2.x, \" \").concat(p2.y);\n        } else if (lineType === 'line') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p2.x, \" \").concat(p2.y);\n        } else if (lineType === 'round') {\n          var vDir = p2.y > p1.y ? 1 : -1;\n          var hDir = p2.x > p1.x ? 1 : -1;\n          var radius = linkStyle.lineRadius;\n\n          if (radius == null) {\n            throw new Error('link line type is round, but lineRadius is not provided!');\n          }\n\n          if (p2.y === p1.y) {\n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x);\n          } else {\n            // 0  1 \n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \"  V \").concat(p2.y - vDir * radius, \" A \").concat(radius, \" \").concat(radius, \" 0 0 \").concat(vDir * hDir === 1 ? 0 : 1, \" \").concat(p1.x + radius * hDir, \" \").concat(p2.y, \" H \").concat(p2.x);\n          }\n        }\n\n        curves.push(createElement(\"path\", {\n          key: \"link-\".concat(key),\n          d: curve,\n          strokeWidth: linkStyle.lineWidth,\n          stroke: linkStyle.lineColor,\n          fill: \"none\"\n        }));\n      });\n      this.setState({\n        curves: curves\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$6('render');\n      var _this$props4 = this.props,\n          topicKey = _this$props4.topicKey,\n          saveRef = _this$props4.saveRef;\n      return createElement(RootLinksSvg, {\n        ref: saveRef(linksSvgRefKey(topicKey))\n      }, createElement(\"g\", null, this.state.curves));\n    }\n  }]);\n\n  return RootSubLinks;\n}(BaseWidget);\n\nvar log$7 = debug('RootNode');\nvar LayerPart = styled.div(_templateObject34 || (_templateObject34 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n\\n  align-items: \", \";\\n  flex-direction: column;\\n\\n  padding: \", \";\\n\"])), function (props) {\n  return (//@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? 'flex-end' : 'flex-start'\n  );\n}, function (props) {\n  return (//@ts-ignore\n    props.topicDirection === TopicDirection.LEFT ? '15px 60px 15px 0px' : '15px 0px 15px 60px'\n  );\n});\nvar Topic = styled.div(_templateObject35 || (_templateObject35 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n  z-index: 3;\\n\"])));\n\nvar RootWidget = /*#__PURE__*/function (_Component4) {\n  _inherits(RootWidget, _Component4);\n\n  var _super10 = _createSuper(RootWidget);\n\n  function RootWidget() {\n    _classCallCheck(this, RootWidget);\n\n    return _super10.apply(this, arguments);\n  }\n\n  _createClass(RootWidget, [{\n    key: \"renderPartTopics\",\n    value: function renderPartTopics(topics, dir) {\n      var _this$props5 = this.props,\n          controller = _this$props5.controller,\n          saveRef = _this$props5.saveRef;\n      var res = controller.run('createSubTopics', _objectSpread(_objectSpread({}, this.props), {}, {\n        dir: dir,\n        isRoot: true,\n        topics: topics\n      }));\n      if (!res) return null;\n      var subTopics = res.subTopics;\n      var cxName = \"bm-layer-\".concat(dir === TopicDirection.LEFT ? 'left' : 'right');\n      return (//@ts-ignore\n        createElement(LayerPart, {\n          topicDirection: dir,\n          ref: saveRef(cxName)\n        }, subTopics)\n      );\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$7('render');\n      var props = this.props;\n      var model = props.model,\n          topicKey = props.topicKey,\n          saveRef = props.saveRef,\n          controller = props.controller;\n      var topicStyle = controller.run('getTopicContentStyle', props);\n      var config = model.config;\n      var topicContent = controller.run('renderTopicContent', _objectSpread(_objectSpread({}, props), {}, {\n        topicStyle: topicStyle,\n        dir: TopicDirection.MAIN\n      }));\n      var partTopics = controller.run('getPartTopics', {\n        layout: config.layoutDir,\n        model: model,\n        topicKey: topicKey\n      });\n      var rootTopic = createElement(Topic, {\n        ref: saveRef(topicRefKey(topicKey))\n      }, topicContent);\n      var children = controller.run('renderRootWidgetOtherChildren', props);\n\n      switch (config.layoutDir) {\n        case DiagramLayoutType.LEFT_AND_RIGHT:\n          return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n        case DiagramLayoutType.LEFT_TO_RIGHT:\n          return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.R, 'R'), children);\n\n        case DiagramLayoutType.RIGHT_TO_LEFT:\n          return createElement(Fragment, null, this.renderPartTopics(partTopics.L, 'L'), rootTopic, children);\n\n        case DiagramLayoutType.TOP_TO_BOTTOM:\n          return createElement(Fragment, null, rootTopic, this.renderPartTopics(partTopics.B, 'B'), children);\n      }\n\n      return null;\n    }\n  }]);\n\n  return RootWidget;\n}(Component);\n\nvar Icon$1 = styled.div(_templateObject36 || (_templateObject36 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  top: calc(50% - 10px);\\n  \", \";\\n  border-radius: 50%;\\n  width: 20px;\\n  height: 20px;\\n  text-align: center;\\n  //@ts-ignore\\n  background: \", \";\\n  cursor: pointer;\\n  padding: 0;\\n  font-size: 14px;\\n  line-height: 20px;\\n  border: 0;\\n  z-index: 2;\\n\"])), function (_ref7) {\n  var dir = _ref7.dir;\n  if (dir === TopicDirection.RIGHT) return css(_templateObject37 || (_templateObject37 = _taggedTemplateLiteral([\"\\n        right: -25px;\\n      \"])));\n  if (dir === TopicDirection.LEFT) return css(_templateObject38 || (_templateObject38 = _taggedTemplateLiteral([\"\\n        left: -25px;\\n      \"])));\n}, function (props) {\n  return props.background;\n});\n\nfunction TopicCollapseIcon(props) {\n  var model = props.model,\n      topicKey = props.topicKey,\n      topicStyle = props.topicStyle,\n      dir = props.dir,\n      saveRef = props.saveRef,\n      onClickCollapse = props.onClickCollapse;\n  var topic = model.getTopic(topicKey);\n  return topic.subKeys.size > 0 ? createElement(Icon$1, {\n    ref: saveRef(collapseRefKey(topicKey)),\n    onClick: onClickCollapse,\n    background: topicStyle.background,\n    dir: dir,\n    className: cx(_defineProperty({\n      icon: true,\n      iconfont: true\n    }, \"bm-\".concat(topic.collapse ? 'plus' : 'minus'), true))\n  }) : null;\n}\n\nvar log$8 = debug('node:topic-content2');\nvar EditingRoot = styled.div(_templateObject39 || (_templateObject39 = _taggedTemplateLiteral([\"\\n  position: relative;\\n\"])));\nvar EditingWrapper = styled.div(_templateObject40 || (_templateObject40 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  width: auto;\\n  z-index: 10;\\n  color: black;\\n\"])));\n\nvar cancelEvent$1 = function cancelEvent$1(e) {\n  log$8('cancelEvent');\n  e.preventDefault();\n  e.stopPropagation();\n};\n\nfunction TopicContent(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var readOnly = model.editingContentKey !== topicKey;\n  var editor = controller.run('renderTopicContentEditor', _objectSpread(_objectSpread({}, props), {}, {\n    readOnly: readOnly\n  }));\n  var child;\n\n  if (readOnly) {\n    child = editor;\n  } else {\n    var wrapper;\n\n    var wrapperRef = function wrapperRef(ref) {\n      if (ref) {\n        wrapper = ref;\n        contentResizeObserver.observe(wrapper);\n      }\n    };\n\n    var rect = {\n      width: 50,\n      height: 40\n    };\n    var editorDiv = getRef(\"content-editor-\".concat(topicKey));\n    if (editorDiv) rect = editorDiv.getBoundingClientRect();\n\n    var contentResizeCallback = function contentResizeCallback(entries, observer) {\n      var r = entries[0].contentRect;\n      wrapper.style.left = (rect.width - r.width) / 2 + 'px';\n      wrapper.style.top = (rect.height - r.height) / 2 + 'px';\n    };\n\n    var contentResizeObserver = new ResizeObserver(contentResizeCallback);\n    log$8(rect);\n    child = createElement(Fragment, null, createElement(\"div\", {\n      style: {\n        width: rect.width,\n        height: rect.height\n      }\n    }), createElement(EditingWrapper, {\n      ref: wrapperRef\n    }, editor));\n  }\n\n  return createElement(EditingRoot, {\n    onDragEnter: cancelEvent$1,\n    onDragOver: cancelEvent$1\n  }, child);\n}\n\nvar log$9 = debug('node:topic-content-widget');\nvar TopicContent$1 = styled.div(_templateObject41 || (_templateObject41 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  //overflow: hidden;\\n  position: relative;\\n\"])));\nvar TopicContentWithDropArea = styled.div(_templateObject42 || (_templateObject42 = _taggedTemplateLiteral([\"\\n  position: relative;\\n\"])));\n\nvar TopicContentWidget = /*#__PURE__*/function (_BaseWidget6) {\n  _inherits(TopicContentWidget, _BaseWidget6);\n\n  var _super11 = _createSuper(TopicContentWidget);\n\n  function TopicContentWidget(props) {\n    var _this9;\n\n    _classCallCheck(this, TopicContentWidget);\n\n    _this9 = _super11.call(this, props);\n\n    _this9.onDragStart = function (ev) {\n      _this9.run('handleTopicDragStart', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev\n      }));\n    };\n\n    _this9.onDragOver = function (ev) {\n      // log('onDragOver');\n      ev.preventDefault();\n    };\n\n    _this9.onDragEnter = function (ev) {\n      log$9('onDragEnter', _this9.props.topicKey);\n\n      _this9.run('handleTopicDragEnter', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onDragLeave = function (ev) {\n      _this9.run('handleTopicDragLeave', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onDrop = function (ev) {\n      log$9('onDrop');\n\n      _this9.run('handleTopicDrop', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev,\n        dropDir: 'in'\n      }));\n    };\n\n    _this9.onClick = function (ev) {\n      var props = _this9.props;\n      var controller = props.controller; //TODO bug [Violation] 'setTimeout' handler took 69ms\n\n      _this9.handleTopicClickTimeout = setTimeout(function () {\n        // log('handleTopicClick');\n        //this.props, props, onClick, topic-content-editoronClickOutside\n        //onClickOutside,model, props,model model\n        controller.run('handleTopicClick', _objectSpread(_objectSpread({}, _this9.props), {}, {\n          ev: ev\n        }));\n      }, 200);\n    };\n\n    _this9.onDoubleClick = function (ev) {\n      clearTimeout(_this9.handleTopicClickTimeout);\n      var controller = _this9.props.controller;\n      controller.run('handleTopicDoubleClick', _objectSpread(_objectSpread({}, _this9.props), {}, {\n        ev: ev\n      }));\n    };\n\n    _this9.needRelocation = false;\n\n    _this9.onClickCollapse = function (e) {\n      e.stopPropagation();\n      var _this9$props = _this9.props,\n          topicKey = _this9$props.topicKey,\n          getRef = _this9$props.getRef;\n      _this9.needRelocation = true;\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var rect = collapseIcon.getBoundingClientRect();\n      log$9('oldRect', rect);\n      _this9.oldCollapseIconVector = [rect.left + rect.width / 2, rect.top + rect.height / 2];\n      log$9('oldCollapseIconVector', _this9.oldCollapseIconVector); // this.oldCollapseIconVector = controller.run('getRelativeVectorFromViewPort', {\n      //   ...this.props,\n      //   element: collapseIcon\n      // });\n\n      _this9.operation(OpType.TOGGLE_COLLAPSE, _this9.props);\n    };\n\n    _this9.state = {\n      dragEnter: false\n    };\n    return _this9;\n  }\n\n  _createClass(TopicContentWidget, [{\n    key: \"renderContextMenu\",\n    value: function renderContextMenu() {\n      var controller = this.props.controller;\n\n      if (!controller.getValue(PropKey.TOPIC_CONTEXT_MENU_ENABLED, _objectSpread({}, this.props))) {\n        return;\n      }\n\n      this.operation(OpType.FOCUS_TOPIC, _objectSpread(_objectSpread({}, this.props), {}, {\n        focusMode: FocusMode.SHOW_POPUP\n      }));\n      return controller.run('renderTopicContextMenu', this.props);\n    }\n  }, {\n    key: \"onContextMenuClose\",\n    value: function onContextMenuClose() {// Optional method called once the context menu is closed.\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.needRelocation) {\n        var _this$props6 = this.props,\n            getRef = _this$props6.getRef,\n            topicKey = _this$props6.topicKey,\n            setViewBoxScrollDelta = _this$props6.setViewBoxScrollDelta;\n        var newIcon = getRef(collapseRefKey(topicKey));\n        var newRect = newIcon.getBoundingClientRect(); // const newVector = controller.run('getRelativeVectorFromViewPort', {\n        //   ...this.props,\n        //   element: getRef(collapseRefKey(topicKey))\n        // });\n\n        var newVector = [newRect.left + newRect.width / 2, newRect.top + newRect.height / 2];\n        log$9('newVector:', newVector);\n        log$9('oldVector:', this.oldCollapseIconVector); //TODO bug\n\n        var vector = [newVector[0] - this.oldCollapseIconVector[0], newVector[1] - this.oldCollapseIconVector[1]];\n        log$9('vector', vector);\n        setViewBoxScrollDelta(vector[0], vector[1]);\n        this.needRelocation = false;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller,\n          topicStyle = props.topicStyle,\n          dir = props.dir;\n      log$9('render', topicKey, model.focusMode);\n      var draggable = controller.run('isOperationEnabled', props) && model.editingContentKey !== topicKey;\n      var collapseIcon = controller.run('renderTopicCollapseIcon', _objectSpread(_objectSpread({}, props), {}, {\n        onClickCollapse: this.onClickCollapse.bind(this)\n      }));\n      var prevDropArea = controller.run('renderTopicDropArea', _objectSpread(_objectSpread({}, props), {}, {\n        dropDir: 'prev'\n      }));\n      var nextDropArea = controller.run('renderTopicDropArea', _objectSpread(_objectSpread({}, props), {}, {\n        dropDir: 'next'\n      }));\n      var dropEventHandlers = {\n        onDragEnter: this.onDragEnter,\n        onDragLeave: this.onDragLeave,\n        onDragOver: this.onDragOver,\n        onDrop: this.onDrop\n      }; // log(topicKey, 'style', topicStyle);\n\n      return createElement(TopicContentWithDropArea, null, prevDropArea, createElement(TopicContent$1, Object.assign({\n        style: topicStyle,\n        draggable: draggable,\n        ref: saveRef(contentRefKey(topicKey)),\n        onDragStart: this.onDragStart,\n        onClick: this.onClick,\n        onDoubleClick: this.onDoubleClick\n      }, dropEventHandlers), controller.run('renderTopicBlocks', props), controller.run('renderTopicContentOthers', props)), nextDropArea, dir !== TopicDirection.MAIN && collapseIcon);\n    }\n  }]);\n\n  return TopicContentWidget;\n}(BaseWidget);\n\nTopicContentWidget = __decorate([ContextMenuTarget], TopicContentWidget);\nvar log$a = debug('node:topic-desc');\nvar TooltipContentWrapper = styled.div(_templateObject43 || (_templateObject43 = _taggedTemplateLiteral([\"\\n  overflow: auto;\\n\"])));\n\nfunction TopicDesc(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey,\n      getRef = props.getRef;\n  var isEditing = model.editingDescKey === topicKey;\n  log$a('isEditing', isEditing);\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.START_EDITING_DESC\n    }));\n  };\n\n  var desc = model.getTopic(topicKey).getBlock(BlockType.DESC);\n  if (!isEditing && controller.run('isBlockEmpty', _objectSpread(_objectSpread({}, props), {}, {\n    block: desc.block\n  }))) return null;\n  var descEditor = controller.run('renderTopicDescEditor', props);\n  var diagramRoot = getRef(RefKey.DIAGRAM_ROOT_KEY);\n  var style = {\n    maxWidth: '800px',\n    maxHeight: '600px'\n  };\n\n  if (diagramRoot) {\n    var dRect = diagramRoot.getBoundingClientRect();\n    style.maxWidth = \"\".concat(dRect.width * 0.6, \"px\");\n    style.maxHeight = \"\".concat(dRect.height * 0.8, \"px\");\n  }\n\n  var tooltipContent = createElement(TooltipContentWrapper, {\n    onClick: cancelEvent,\n    classname: Classes.POPOVER_DISMISS,\n    style: style\n  }, descEditor);\n  var icon = createElement(TopicBlockIcon, {\n    onClick: onClick,\n    className: iconClassName(IconName.NOTES),\n    tabIndex: -1\n  });\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.HOVER,\n    hoverOpenDelay: 500\n  };\n  var descIcon = desc.block && createElement(Popover, Object.assign({}, tooltipProps));\n  return descIcon;\n}\n\nvar FocusHighlightSvg = styled.svg(_templateObject44 || (_templateObject44 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 2;\\n  pointer-events: none;\\n\"])));\n\nvar TopicHighlight = /*#__PURE__*/function (_BaseWidget7) {\n  _inherits(TopicHighlight, _BaseWidget7);\n\n  var _super12 = _createSuper(TopicHighlight);\n\n  function TopicHighlight() {\n    var _this10;\n\n    _classCallCheck(this, TopicHighlight);\n\n    _this10 = _super12.apply(this, arguments);\n    _this10.state = {\n      content: null\n    };\n    return _this10;\n  }\n\n  _createClass(TopicHighlight, [{\n    key: \"layout\",\n    value: function layout() {\n      var _this$props7 = this.props,\n          getRef = _this$props7.getRef,\n          model = _this$props7.model,\n          zoomFactor = _this$props7.zoomFactor;\n      var focusKey = model.focusKey;\n      var focusMode = model.focusMode;\n\n      if (!focusKey || focusMode === FocusMode.EDITING_CONTENT) {\n        this.setState({\n          content: null\n        });\n        return;\n      }\n\n      var content = getRef(contentRefKey(focusKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n      var svg = getRef(RefKey.SVG_HIGHLIGHT_KEY);\n\n      var contentRect = _getRelativeRect(content, bigView, zoomFactor);\n\n      var svgRect = _getRelativeRect(svg, bigView, zoomFactor);\n\n      var padding = 3;\n      var x = contentRect.left - svgRect.left - padding;\n      var y = contentRect.top - svgRect.top - padding;\n      var width = contentRect.width + 2 * padding;\n      var height = contentRect.height + 2 * padding;\n      this.setState({\n        content: createElement(\"rect\", {\n          x: x,\n          y: y,\n          width: width,\n          height: height,\n          fill: \"none\",\n          stroke: model.config.theme.highlightColor,\n          strokeWidth: 2\n        })\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var saveRef = this.props.saveRef;\n      return createElement(FocusHighlightSvg, {\n        ref: saveRef(RefKey.SVG_HIGHLIGHT_KEY)\n      }, this.state.content);\n    }\n  }]);\n\n  return TopicHighlight;\n}(BaseWidget);\n\nvar TopicLinksSvg = styled.svg(_templateObject45 || (_templateObject45 = _taggedTemplateLiteral([\"\\n  width: 100%;\\n  height: 100%;\\n  position: absolute;\\n  left: 0;\\n  top: 0;\\n  z-index: 1;\\n  pointer-events: none;\\n\"])));\nvar log$b = debug('node:topic-sub-links');\n\nvar TopicSubLinks = /*#__PURE__*/function (_BaseWidget8) {\n  _inherits(TopicSubLinks, _BaseWidget8);\n\n  var _super13 = _createSuper(TopicSubLinks);\n\n  function TopicSubLinks() {\n    var _this11;\n\n    _classCallCheck(this, TopicSubLinks);\n\n    _this11 = _super13.apply(this, arguments);\n    _this11.state = {\n      curves: []\n    };\n    return _this11;\n  }\n\n  _createClass(TopicSubLinks, [{\n    key: \"layout\",\n    value: function layout() {\n      var props = this.props;\n      var model = props.model,\n          getRef = props.getRef,\n          topicKey = props.topicKey,\n          dir = props.dir,\n          controller = props.controller;\n      var z = controller.run('getZoomFactor', props);\n      var topic = model.getTopic(topicKey);\n      var content = getRef(contentRefKey(topicKey));\n      var svg = getRef(linksSvgRefKey(topicKey));\n      var collapseIcon = getRef(collapseRefKey(topicKey));\n      var bigView = getRef(RefKey.DRAG_SCROLL_WIDGET_KEY).bigView;\n\n      var svgRect = _getRelativeRect(svg, bigView, z);\n\n      var collapseRect = _getRelativeRect(collapseIcon, bigView, z);\n\n      var contentRect = _getRelativeRect(content, bigView, z);\n\n      log$b(topicKey);\n      log$b('svgRect', svgRect);\n      log$b('collapseRect', collapseRect);\n      log$b('contentRect', contentRect);\n      var p1, p2, p3;\n\n      if (dir === TopicDirection.RIGHT) {\n        p1 = {\n          x: 0,\n          y: centerY(contentRect) - svgRect.top\n        };\n        p2 = {\n          x: collapseRect.right - svgRect.left + 10,\n          y: p1.y\n        };\n      } else if (dir === TopicDirection.LEFT) {\n        p1 = {\n          x: svgRect.right - svgRect.left,\n          y: centerY(contentRect) - svgRect.top\n        };\n        p2 = {\n          x: collapseRect.left - svgRect.left - 10,\n          y: p1.y\n        };\n      }\n\n      var curves = [];\n      topic.subKeys.forEach(function (key) {\n        var curve;\n        var linkStyle = controller.run('getLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: key\n        })); // log(key);\n\n        var subContent = getRef(contentRefKey(key));\n        if (!subContent) return;\n\n        var rect = _getRelativeRect(subContent, bigView, z);\n\n        if (dir === TopicDirection.RIGHT) {\n          p3 = {\n            x: rect.left - svgRect.left,\n            y: centerY(rect) - svgRect.top\n          };\n        }\n\n        if (dir === TopicDirection.LEFT) {\n          p3 = {\n            x: rect.right - svgRect.left,\n            y: centerY(rect) - svgRect.top\n          };\n        }\n\n        var lineType = linkStyle.lineType;\n\n        if (lineType === 'curve') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p2.x, \" \").concat(p2.y, \" C \").concat(p2.x, \" \").concat(centerPointY(p2, p3), \" \").concat(centerPointX(p2, p3), \" \").concat(p3.y, \" \").concat(p3.x, \" \").concat(p3.y);\n        } else if (lineType === 'round') {\n          var vDir = p3.y > p1.y ? 1 : -1;\n          var hDir = p3.x > p1.x ? 1 : -1;\n          var radius = linkStyle.lineRadius; // if (p3.y === p1.y) { //\n\n          if (topic.subKeys.size === 1 || Math.abs(p3.y - p1.y) <= 1) {\n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" L \").concat(p3.x, \" \").concat(p3.y);\n          } else {\n            // 0  1 \n            curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x, \" V \").concat(p3.y - vDir * radius, \" A \").concat(radius, \" \").concat(radius, \" 0 0 \").concat(vDir * hDir === 1 ? 0 : 1, \" \").concat(p2.x + radius * hDir, \" \").concat(p3.y, \" H \").concat(p3.x);\n          }\n        } else if (lineType === 'line') {\n          curve = \"M \".concat(p1.x, \" \").concat(p1.y, \" H \").concat(p2.x, \" L \").concat(p3.x, \" \").concat(p3.y);\n        }\n\n        curves.push(createElement(\"path\", {\n          key: \"link-\".concat(key),\n          d: curve,\n          strokeWidth: linkStyle.lineWidth,\n          stroke: linkStyle.lineColor,\n          fill: \"none\"\n        }));\n      });\n      this.setState({\n        curves: curves\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props8 = this.props,\n          topicKey = _this$props8.topicKey,\n          saveRef = _this$props8.saveRef;\n      return createElement(TopicLinksSvg, {\n        ref: saveRef(linksSvgRefKey(topicKey))\n      }, createElement(\"g\", null, this.state.curves));\n    }\n  }]);\n\n  return TopicSubLinks;\n}(BaseWidget);\n\nvar log$c = debug('node:topic-widget');\nvar Node = styled.div(_templateObject46 || (_templateObject46 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n}); // TODO\n\nvar NodeChildren = styled.div(_templateObject47 || (_templateObject47 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  padding: \", \";\\n\"])), function (props) {\n  return props.dir === TopicDirection.RIGHT ? \"0 0 0 \".concat(props.marginH, \"px\") : \"0 \".concat(props.marginH, \"px 0 0\");\n});\nvar NodeTopic = styled.div(_templateObject48 || (_templateObject48 = _taggedTemplateLiteral([\"\\n  display: flex;\\n  position: relative;\\n  align-items: center;\\n\\n  flex-direction: \", \";\\n\"])), function (props) {\n  return props.topicDirection === TopicDirection.RIGHT ? 'row' : 'row-reverse';\n});\n\nvar TopicWidget = /*#__PURE__*/function (_Component5) {\n  _inherits(TopicWidget, _Component5);\n\n  var _super14 = _createSuper(TopicWidget);\n\n  function TopicWidget() {\n    _classCallCheck(this, TopicWidget);\n\n    return _super14.apply(this, arguments);\n  }\n\n  _createClass(TopicWidget, [{\n    key: \"renderSubTopics\",\n    value: function renderSubTopics() {\n      var props = this.props;\n      var controller = props.controller,\n          model = props.model,\n          topicKey = props.topicKey,\n          dir = props.dir;\n      var topics = model.getTopic(topicKey).subKeys.toArray();\n      var res = controller.run('createSubTopics', _objectSpread(_objectSpread({}, props), {}, {\n        topics: topics\n      }));\n      if (!res) return null;\n      var subTopics = res.subTopics;\n      var subLinks = controller.run('renderSubLinks', props);\n      return createElement(NodeChildren, {\n        dir: dir,\n        marginH: model.config.theme.marginH\n      }, subTopics, \" \", subLinks);\n    } // componentDidUpdate(): void {\n    //   this.layoutLinks();\n    // }\n    //\n    // componentDidMount(): void {\n    //   this.layoutLinks();\n    // }\n\n  }, {\n    key: \"layoutLinks\",\n    value: function layoutLinks() {\n      var _this$props9 = this.props,\n          getRef = _this$props9.getRef,\n          topicKey = _this$props9.topicKey,\n          model = _this$props9.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return;\n      log$c('layoutLinks', topicKey);\n      var links = getRef(linksRefKey(topicKey));\n      links && links.layout();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var props = this.props;\n      var controller = props.controller,\n          topicKey = props.topicKey,\n          dir = props.dir,\n          saveRef = props.saveRef;\n      log$c('render', topicKey);\n      var topicStyle = controller.run('getTopicContentStyle', props);\n\n      var propsMore = _objectSpread(_objectSpread({}, props), {}, {\n        topicStyle: topicStyle\n      });\n\n      var topicContent = controller.run('renderTopicContent', propsMore);\n      return createElement(Node, {\n        topicDirection: dir\n      }, createElement(NodeTopic, {\n        topicDirection: dir,\n        ref: saveRef(topicRefKey(topicKey))\n      }, topicContent), this.renderSubTopics());\n    }\n  }]);\n\n  return TopicWidget;\n}(Component);\n\nvar log$d = debug('node:view-port-viewer');\nvar ViewerRoot = styled(ZIndex)(_templateObject49 || (_templateObject49 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  bottom: 20px;\\n  border-radius: 2px;\\n  display: flex;\\n  flex-direction: row;\\n  user-select: none;\\n\"])));\nvar Item_ = styled(Btn)(_templateObject50 || (_templateObject50 = _taggedTemplateLiteral([\"\\n  margin: 10px;\\n\"])));\nvar ZoomFactorSpan = styled.span(_templateObject51 || (_templateObject51 = _taggedTemplateLiteral([\"\\n  display: inline-block;\\n  width: 80px;\\n  height: 18px;\\n\"])));\n\nvar Item = function Item(props) {\n  return createElement(Tooltip, {\n    content: props.tooltip,\n    position: Position.TOP,\n    className: Classes.ICON\n  }, createElement(Item_, {\n    onClick: props.onClick,\n    tabIndex: -1\n  }, props.children));\n};\n\nvar ViewPortViewer = /*#__PURE__*/function (_BaseWidget9) {\n  _inherits(ViewPortViewer, _BaseWidget9);\n\n  var _super15 = _createSuper(ViewPortViewer);\n\n  function ViewPortViewer(props) {\n    var _this12;\n\n    _classCallCheck(this, ViewPortViewer);\n\n    _this12 = _super15.call(this, props);\n\n    _this12.zoomFactorChange = function (zoomFactor) {\n      log$d('zoomFactorChange', zoomFactor);\n\n      _this12.setState({\n        zoomFactor: zoomFactor\n      });\n    };\n\n    _this12.onClickResetZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: 1\n      }));\n    };\n\n    _this12.onClickAddZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor + 0.1\n      }));\n    };\n\n    _this12.onClickMinusZoom = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      controller.run('setZoomFactor', _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor - 0.1\n      }));\n    };\n\n    _this12.onClickCollapseAll = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this12.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.COLLAPSE_ALL\n      }));\n    };\n\n    _this12.onClickExpandAll = function (e) {\n      var props = _this12.props;\n      var controller = props.controller;\n      controller.run('addEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        key: EventKey.CENTER_ROOT_TOPIC,\n        listener: _this12.centerRootTopic,\n        once: true\n      }));\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.EXPAND_ALL\n      }));\n    };\n\n    _this12.centerRootTopic = function () {\n      var _this12$props = _this12.props,\n          model = _this12$props.model,\n          controller = _this12$props.controller;\n      controller.run('moveTopicToCenter', _objectSpread(_objectSpread({}, _this12.props), {}, {\n        topicKey: model.editorRootTopicKey\n      }));\n    };\n\n    return _this12;\n  }\n\n  _createClass(ViewPortViewer, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var props = this.props;\n      var controller = props.controller;\n      controller.run('addZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        listener: this.zoomFactorChange\n      }));\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var props = this.props;\n      var controller = props.controller;\n      controller.run('removeZoomFactorChangeEventListener', _objectSpread(_objectSpread({}, props), {}, {\n        listener: this.zoomFactorChange\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      log$d('render');\n      var props = this.props;\n      var controller = props.controller,\n          zIndex = props.zIndex;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      return createElement(ViewerRoot, {\n        zIndex: zIndex\n      }, createElement(Item, {\n        onClick: this.onClickCollapseAll,\n        tooltip: getI18nText(props, I18nKey.COLLAPSE_ALL)\n      }, Icon(IconName.COLLAPSE_ALL)), createElement(Item, {\n        onClick: this.onClickExpandAll,\n        tooltip: getI18nText(props, I18nKey.EXPAND_ALL)\n      }, Icon(IconName.EXPAND_ALL)), createElement(Item, {\n        onClick: this.centerRootTopic,\n        tooltip: getI18nText(props, I18nKey.CENTER_ROOT_TOPIC)\n      }, Icon(IconName.CENTER)), createElement(Item, {\n        onClick: this.onClickMinusZoom,\n        tooltip: getI18nText(props, I18nKey.ZOOM_IN)\n      }, Icon(IconName.MINUS)), createElement(Item, {\n        onClick: this.onClickResetZoom,\n        tooltip: getI18nText(props, I18nKey.RESET)\n      }, createElement(ZoomFactorSpan, null, \"\".concat(getI18nText(props, I18nKey.ZOOM), \":\").concat(Math.floor(zoomFactor * 100), \"%\"))), createElement(Item, {\n        onClick: this.onClickAddZoom,\n        tooltip: getI18nText(props, I18nKey.ZOOM_OUT)\n      }, Icon(IconName.PLUS)));\n    }\n  }]);\n\n  return ViewPortViewer;\n}(BaseWidget);\n\nvar DescEditorWrapper = styled.div(_templateObject52 || (_templateObject52 = _taggedTemplateLiteral([\"\\n  overflow: auto;\\n  padding: 0px 0px 0px 20px;\\n  background: #88888850;\\n\"])));\n\nfunction renderDrawer(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n\n  if (model.focusMode === FocusMode.EDITING_DESC) {\n    var onDescEditorClose = function onDescEditorClose(e) {\n      e.stopPropagation();\n      var key = \"topic-desc-data-\".concat(topicKey);\n      var descData = controller.run('deleteTempValue', {\n        key: key\n      });\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_TOPIC_BLOCK,\n        topicKey: topicKey,\n        blockType: BlockType.DESC,\n        data: descData,\n        focusMode: FocusMode.NORMAL\n      }));\n    };\n\n    var descEditor = controller.run('renderTopicDescEditor', props);\n    return createElement(Drawer, {\n      key: \"drawer\",\n      title: getI18nText(props, I18nKey.EDIT_NOTES),\n      icon: Icon('note'),\n      isOpen: true,\n      hasBackdrop: true,\n      backdropProps: {\n        onMouseDown: cancelEvent\n      },\n      isCloseButtonShown: false,\n      onClose: onDescEditorClose,\n      size: \"70%\"\n    }, createElement(DescEditorWrapper, null, descEditor));\n  }\n} //TODO themeProvider\n\n\nfunction Theme(_ref8) {\n  var theme = _ref8.theme,\n      children = _ref8.children;\n  return (//@ts-ignore\n    createElement(ThemeProvider, {\n      theme: theme\n    }, createElement(Fragment, null, children))\n  );\n}\n\nvar log$e = debug('plugin:rendering');\n\nfunction RenderingPlugin() {\n  var diagramProps;\n  return {\n    getDiagramProps: function getDiagramProps() {\n      return diagramProps;\n    },\n    renderDiagram: function renderDiagram(props) {\n      var model = props.model;\n      return createElement(SaveRef, null, function (saveRef, getRef, deleteRef) {\n        diagramProps = _objectSpread(_objectSpread({}, props), {}, {\n          saveRef: saveRef,\n          getRef: getRef,\n          deleteRef: deleteRef\n        });\n        log$e('renderDiagram', model);\n        return createElement(Theme, {\n          theme: model.config.theme\n        }, createElement(DiagramRoot, diagramProps));\n      });\n    },\n    renderDrawer: renderDrawer,\n    getInitialDiagramState: function getInitialDiagramState(props) {\n      return {\n        rightTopPanel: {\n          isOpen: false,\n          selectedTabId: 'topic-style'\n        }\n      };\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props) {\n      var controller = props.controller,\n          model = props.model;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX);\n\n      var nProps = _objectSpread(_objectSpread({}, props), {}, {\n        zIndex: zIndex,\n        topicKey: model.focusKey\n      });\n\n      var breadcrumbs = controller.run('renderEditorRootBreadcrumbs', nProps); // const styleEditor = controller.run('renderStyleEditor', nProps);\n\n      var rightTopPanel = controller.run('renderRightTopPanel', nProps);\n      var modals = controller.run('renderModals', _objectSpread(_objectSpread({}, nProps), {}, {\n        zIndex: zIndex + 1\n      }));\n      var drawer = controller.run('renderDrawer', _objectSpread(_objectSpread({}, nProps), {}, {\n        zIndex: zIndex + 1\n      }));\n      var viewportViewer = controller.run('renderViewPortViewer', nProps);\n      return [breadcrumbs, rightTopPanel, modals, drawer, viewportViewer];\n    },\n    renderEditorRootBreadcrumbs: function renderEditorRootBreadcrumbs(props) {\n      return createElement(EditorRootBreadcrumbs, Object.assign({\n        key: \"EditorRootBreadcrumbs\"\n      }, props));\n    },\n    renderModals: function renderModals(props) {\n      return createElement(Modals, Object.assign({\n        key: \"modals\"\n      }, props));\n    },\n    renderModal: function renderModal(props) {\n      return null;\n    },\n    getActiveModalProps: function getActiveModalProps(props) {\n      return null;\n    },\n    renderDoc: function renderDoc(_ref9) {\n      var children = _ref9.children;\n      return children;\n    },\n    renderRootWidget: function renderRootWidget(props) {\n      return createElement(RootWidget, Object.assign({}, props));\n    },\n    renderTopicWidget: function renderTopicWidget(props) {\n      return createElement(TopicWidget, Object.assign({}, props));\n    },\n    renderTopicContent: function renderTopicContent(props) {\n      return createElement(TopicContentWidget, Object.assign({}, props));\n    },\n    renderTopicCollapseIcon: function renderTopicCollapseIcon(props) {\n      return createElement(TopicCollapseIcon, Object.assign({}, props));\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props) {\n      return [];\n    },\n    renderTopicBlocks: function renderTopicBlocks(props) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var topic = model.getTopic(topicKey);\n      var blocks = topic.blocks;\n      var res = [];\n      var i = 0;\n      blocks.forEach(function (block) {\n        var b = controller.run('renderTopicBlock', _objectSpread(_objectSpread({}, props), {}, {\n          block: block,\n          blockKey: \"block-\".concat(i)\n        }));\n\n        if (b) {\n          res.push(createElement(Fragment, {\n            key: \"block-\".concat(i)\n          }, b));\n          i++;\n        }\n      });\n      return res;\n    },\n    renderTopicBlock: function renderTopicBlock(props) {\n      var controller = props.controller,\n          block = props.block;\n\n      switch (block.type) {\n        case BlockType.CONTENT:\n          return controller.run('renderTopicBlockContent', props);\n\n        case BlockType.DESC:\n          return controller.run('renderTopicBlockDesc', props);\n      }\n\n      return null;\n    },\n    renderTopicBlockContent: function renderTopicBlockContent(props) {\n      return createElement(TopicContent, Object.assign({}, props));\n    },\n    renderTopicBlockDesc: function renderTopicBlockDesc(props) {\n      return createElement(TopicDesc, Object.assign({}, props));\n    },\n    renderSubLinks: function renderSubLinks(props) {\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      if (topic.subKeys.size === 0 || topic.collapse) return null;\n      return createElement(TopicSubLinks, Object.assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderRootSubLinks: function renderRootSubLinks(props) {\n      // log('renderRootSubLinks');\n      var saveRef = props.saveRef,\n          topicKey = props.topicKey; // ,layout \n      // const topic = model.getTopic(topicKey);\n      // if (topic.subKeys.size === 0) return null;\n\n      return createElement(RootSubLinks, Object.assign({\n        ref: saveRef(linksRefKey(topicKey))\n      }, props));\n    },\n    renderFocusItemHighlight: function renderFocusItemHighlight(props) {\n      var saveRef = props.saveRef;\n      return createElement(TopicHighlight, Object.assign({\n        ref: saveRef(RefKey.FOCUS_HIGHLIGHT_KEY)\n      }, props));\n    },\n    renderRootWidgetOtherChildren: function renderRootWidgetOtherChildren(props) {\n      var _props3 = props,\n          controller = _props3.controller;\n      var zoomFactor = controller.run('getZoomFactor', props);\n      props = _objectSpread(_objectSpread({}, props), {}, {\n        zoomFactor: zoomFactor\n      });\n      return createElement(Fragment, null, controller.run('renderRootSubLinks', props), controller.run('renderFocusItemHighlight', props), controller.run('renderDragAndDropEffect', props));\n    },\n    renderViewPortViewer: function renderViewPortViewer(props) {\n      return createElement(ViewPortViewer, Object.assign({\n        key: \"view-port-viewer\"\n      }, props));\n    }\n  };\n}\n\nvar PanelRoot = styled(ZIndex)(_templateObject53 || (_templateObject53 = _taggedTemplateLiteral([\"\\n  position: absolute;\\n  background: white;\\n  right: 30px;\\n  top: 20px;\\n  border-radius: 2px;\\n  user-select: none;\\n\"])));\nvar StyledTabs = styled(Tabs)(_templateObject54 || (_templateObject54 = _taggedTemplateLiteral([\"\\n  padding: 0px 10px;\\n\"])));\n\nfunction RightTopPanelWidget(props) {\n  var controller = props.controller,\n      zIndex = props.zIndex,\n      diagramState = props.diagramState,\n      setDiagramState = props.setDiagramState;\n  var rightTopPanel = diagramState.rightTopPanel;\n  var isOpen = rightTopPanel.isOpen,\n      selectedTabId = rightTopPanel.selectedTabId;\n\n  var setRightTopPanelState = function setRightTopPanelState(obj) {\n    setDiagramState(_objectSpread(_objectSpread({}, diagramState), {}, {\n      rightTopPanel: _objectSpread(_objectSpread({}, rightTopPanel), obj)\n    }));\n  };\n\n  if (!isOpen) {\n    return createElement(PanelRoot, {\n      zIndex: zIndex\n    }, createElement(IconBg, {\n      onClick: function onClick() {\n        setRightTopPanelState({\n          isOpen: true\n        });\n      }\n    }, createElement(ShowMenuIcon, {\n      className: iconClassName(IconName.SHOW_MENU)\n    })));\n  }\n\n  var handleTabIdChange = function handleTabIdChange(tabId) {\n    setRightTopPanelState({\n      selectedTabId: tabId\n    });\n  };\n\n  return createElement(PanelRoot, {\n    zIndex: zIndex\n  }, createElement(Title, null, createElement(CloseIcon, {\n    className: iconClassName(IconName.CLOSE),\n    onClick: function onClick() {\n      setRightTopPanelState({\n        isOpen: false\n      });\n    }\n  })), createElement(StyledTabs, {\n    id: \"tabs\",\n    selectedTabId: selectedTabId,\n    onChange: handleTabIdChange\n  }, controller.run('renderRightTopPanelTabs', props)));\n}\n\nvar borderWidthItems$1 = _toConsumableArray(Array(7).keys());\n\nvar borderRadiusItems = [0, 5, 10, 15, 20, 25, 30, 35];\nvar borderStyleItems = ['none', 'solid', 'dotted', 'dashed', 'double'];\n\nfunction BorderStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleBorderWidthChange = function handleBorderWidthChange(value) {\n    // log('handleBorderWithChange:', value);\n    setContentStyle({\n      borderWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleBorderStyleChange = function handleBorderStyleChange(value) {\n    setContentStyle({\n      borderStyle: value\n    });\n  };\n\n  var handleBorderRadiusChange = function handleBorderRadiusChange(value) {\n    // log('handleBorderRadiusChange:', value);\n    setContentStyle({\n      borderRadius: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleBorderColorChange = function handleBorderColorChange(color) {\n    setContentStyle({\n      borderColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BORDER)), createElement(SettingRow, null, createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(contentStyle.borderWidth ? contentStyle.borderWidth : getI18nText(props, I18nKey.DEFAULT)),\n    items: borderWidthItems$1,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.STYLE), \": \").concat(contentStyle.borderStyle ? getI18nText(props, contentStyle.borderStyle) : getI18nText(props, I18nKey.NONE)),\n    items: borderStyleItems,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleBorderStyleChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.RADIUS), \": \").concat(contentStyle.borderRadius),\n    items: borderRadiusItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleBorderRadiusChange\n  }), createElement(SettingItemColorPicker, {\n    color: contentStyle.borderColor,\n    handleColorChange: handleBorderColorChange\n  })));\n}\n\nfunction ClearAllCustomStyle(props) {\n  var controller = props.controller;\n\n  var handleClearAllCustomStyle = function handleClearAllCustomStyle(e) {\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.CLEAR_ALL_CUSTOM_STYLE\n    }));\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingItem, null, createElement(Button, {\n    onClick: handleClearAllCustomStyle\n  }, getI18nText(props, I18nKey.CLEAR_ALL_CUSTOM_STYLE))));\n}\n\nvar lineTypes = ['curve', 'round', 'line'];\n\nfunction LinkStyleEditor(props) {\n  var _props$showLinkStyle = props.showLinkStyle,\n      showLinkStyle = _props$showLinkStyle === void 0 ? true : _props$showLinkStyle,\n      _props$showSubLinkSty = props.showSubLinkStyle,\n      showSubLinkStyle = _props$showSubLinkSty === void 0 ? true : _props$showSubLinkSty,\n      _props$linkStyle = props.linkStyle,\n      linkStyle = _props$linkStyle === void 0 ? {} : _props$linkStyle,\n      _props$subLinkStyle = props.subLinkStyle,\n      subLinkStyle = _props$subLinkStyle === void 0 ? {} : _props$subLinkStyle,\n      setLinkStyle = props.setLinkStyle,\n      setSubLinkStyle = props.setSubLinkStyle;\n\n  var handleLinkWidthChange = function handleLinkWidthChange(value) {\n    setLinkStyle({\n      lineWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleLinkTypeChange = function handleLinkTypeChange(value) {\n    setLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleLinkColorChange = function handleLinkColorChange(color) {\n    setLinkStyle({\n      lineColor: color\n    });\n  };\n\n  var handleSubLinkWidthChange = function handleSubLinkWidthChange(value) {\n    setSubLinkStyle({\n      lineWidth: \"\".concat(value, \"px\")\n    });\n  };\n\n  var handleSubLinkTypeChange = function handleSubLinkTypeChange(value) {\n    setSubLinkStyle({\n      lineType: value\n    });\n  };\n\n  var handleSubLinkColorChange = function handleSubLinkColorChange(color) {\n    setSubLinkStyle({\n      lineColor: color\n    });\n  };\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.LINK)), showLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, getI18nText(props, I18nKey.LINK_TO_PARENT) + ':', ' '), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(linkStyle ? linkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.LINE_TYPE), \": \").concat(getI18nText(props, linkStyle.lineType)),\n    items: lineTypes,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: linkStyle.lineColor,\n    handleColorChange: handleLinkColorChange\n  })), showSubLinkStyle && createElement(SettingRow, {\n    alignItems: \"center\"\n  }, createElement(Margin, {\n    margin: \"0 5px 0 0\"\n  }, getI18nText(props, I18nKey.SUB_LINKS) + ': '), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.WIDTH), \": \").concat(subLinkStyle ? subLinkStyle.lineWidth : '0px'),\n    items: borderWidthItems,\n    itemRenderer: renderItem('px'),\n    onItemSelect: handleSubLinkWidthChange\n  }), createElement(SettingItemSelect, {\n    text: \"\".concat(getI18nText(props, I18nKey.LINE_TYPE), \": \").concat(getI18nText(props, subLinkStyle.lineType)),\n    items: lineTypes,\n    itemRenderer: renderItemI18n(props),\n    onItemSelect: handleSubLinkTypeChange\n  }), createElement(SettingItemColorPicker, {\n    color: subLinkStyle.lineColor,\n    handleColorChange: handleSubLinkColorChange\n  })));\n}\n\nfunction TextStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n\n  var handleFontSizeChange = function handleFontSizeChange(value) {\n    // log('handleFontSizeChange:', value);\n    setContentStyle({\n      fontSize: value\n    });\n  };\n\n  var handleLineHeightChange = function handleLineHeightChange(e) {\n    // log('handleLineHeightChange:', e.target.value);\n    setContentStyle({\n      lineHeight: e.target.value\n    });\n  };\n\n  var handleColorChange = function handleColorChange(color) {\n    setContentStyle({\n      color: color\n    });\n  };\n\n  var fontSizeNumInputProps = {\n    title: \"\".concat(getI18nText(props, I18nKey.FONT_SIZE), \":\"),\n    min: 12,\n    max: 100,\n    value: parseInt(contentStyle.fontSize),\n    style: {\n      width: 50\n    },\n    onValueChange: handleFontSizeChange\n  };\n  var lineHeightInputProps = {\n    title: \"\".concat(getI18nText(props, I18nKey.LINE_HEIGHT), \":\"),\n    style: {\n      width: 50\n    },\n    value: contentStyle.lineHeight || '',\n    onChange: handleLineHeightChange\n  };\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.TEXT_EDITOR)), createElement(Flex, null, createElement(SettingItemNumericInput, Object.assign({}, fontSizeNumInputProps)), createElement(SettingItemInput, Object.assign({}, lineHeightInputProps)), createElement(SettingItemColorPicker, {\n    color: contentStyle.color,\n    handleColorChange: handleColorChange\n  })));\n}\n\nvar log$f = debug('node:style-editor');\nvar copiedStyle;\n\nfunction StyleEditor(props) {\n  var controller = props.controller,\n      model = props.model,\n      topicKey = props.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  var setContentStyle = function setContentStyle(style) {\n    controller.run('setTopicContentStyle', _objectSpread(_objectSpread({}, props), {}, {\n      style: style\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(color) {\n    setContentStyle({\n      background: color\n    });\n  };\n\n  var handleClearStyle = function handleClearStyle() {\n    if (topic.style) {\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_STYLE,\n        style: null\n      }));\n    }\n  };\n\n  var handleCopyStyle = function handleCopyStyle() {\n    copiedStyle = controller.run('getTopicStyle', props);\n    log$f(copiedStyle);\n  };\n\n  var handlePasteStyle = function handlePasteStyle() {\n    if (copiedStyle) {\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_STYLE,\n        style: JSON.stringify(copiedStyle)\n      }));\n    }\n  };\n\n  if (!model.focusKey) return null;\n  var contentStyle = controller.run('getTopicContentStyle', props);\n  var linkStyle = controller.run('getLinkStyle', props);\n  var subLinkStyle = controller.run('getSubLinkStyle', props);\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    controller.run('setLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n      linkStyle: linkStyle\n    }));\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    controller.run('setSubLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n      subLinkStyle: subLinkStyle\n    }));\n  };\n\n  var linkStyleEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  });\n\n  var contentStyleEditorPros = _objectSpread(_objectSpread({}, props), {}, {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  });\n\n  return createElement(PanelTabRoot, null, createElement(BorderStyleEditor, Object.assign({}, contentStyleEditorPros)), createElement(TextStyleEditor, Object.assign({}, contentStyleEditorPros)), createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BACKGROUND)), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: handleBackgroundColorChange\n  })), createElement(LinkStyleEditor, Object.assign({}, linkStyleEditorProps)), createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.CLEAR_TOPIC_STYLE),\n    onClick: handleClearStyle\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.COPY_STYLE),\n    onClick: handleCopyStyle\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.PASTE_STYLE),\n    onClick: handlePasteStyle\n  })), ClearAllCustomStyle(props));\n}\n/** Event handler that exposes the target element's value as a boolean. */\n\n\nfunction handleBooleanChange(handler) {\n  return function (event) {\n    return handler(event.target.checked);\n  };\n}\n\nvar expand = require('css-shorthand-expand');\n\nfunction PaddingStyleEditor(props) {\n  var contentStyle = props.contentStyle,\n      setContentStyle = props.setContentStyle;\n  var padding = expand('padding', contentStyle.padding || '0');\n  var commonProps = {\n    layout: 'v',\n    min: 0,\n    max: 99,\n    style: {\n      width: 38\n    }\n  };\n  var top = parseInt(padding['padding-top']);\n  var right = parseInt(padding['padding-right']);\n  var bottom = parseInt(padding['padding-bottom']);\n  var left = parseInt(padding['padding-left']);\n  var p = {\n    top: top,\n    right: right,\n    bottom: bottom,\n    left: left\n  };\n\n  var setPadding = function setPadding(dir) {\n    return function (v) {\n      setContentStyle({\n        padding: paddingCss(_objectSpread(_objectSpread({}, p), {}, _defineProperty({}, dir, v)))\n      });\n    };\n  };\n\n  var topProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.TOP),\n    value: top,\n    onValueChange: setPadding('top')\n  });\n\n  var rightProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.RIGHT),\n    value: right,\n    onValueChange: setPadding('right')\n  });\n\n  var bottomProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.BOTTOM),\n    value: bottom,\n    onValueChange: setPadding('bottom')\n  });\n\n  var leftProps = _objectSpread(_objectSpread({}, commonProps), {}, {\n    title: getI18nText(props, I18nKey.LEFT),\n    value: left,\n    onValueChange: setPadding('left')\n  });\n\n  return createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.PADDING)), createElement(SettingRow, null, createElement(SettingItemNumericInput, Object.assign({}, topProps)), createElement(SettingItemNumericInput, Object.assign({}, rightProps)), createElement(SettingItemNumericInput, Object.assign({}, bottomProps)), createElement(SettingItemNumericInput, Object.assign({}, leftProps))));\n}\n\nvar TopicThemeEditorRoot = styled.div(_templateObject55 || (_templateObject55 = _taggedTemplateLiteral([\"\\n  height: 250px;\\n  overflow: auto;\\n\"])));\n\nfunction TopicThemeEditor(props) {\n  var topicStyle = props.topicStyle,\n      setTopicStyle = props.setTopicStyle;\n  var _topicStyle$contentSt = topicStyle.contentStyle,\n      contentStyle = _topicStyle$contentSt === void 0 ? {} : _topicStyle$contentSt,\n      _topicStyle$linkStyle = topicStyle.linkStyle,\n      linkStyle = _topicStyle$linkStyle === void 0 ? {} : _topicStyle$linkStyle,\n      _topicStyle$subLinkSt = topicStyle.subLinkStyle,\n      subLinkStyle = _topicStyle$subLinkSt === void 0 ? {} : _topicStyle$subLinkSt;\n\n  var setContentStyle = function setContentStyle(contentStyle) {\n    setTopicStyle({\n      contentStyle: contentStyle\n    });\n  };\n\n  var nProps = _objectSpread(_objectSpread({}, props), {}, {\n    contentStyle: contentStyle,\n    setContentStyle: setContentStyle\n  });\n\n  var setLinkStyle = function setLinkStyle(linkStyle) {\n    setTopicStyle({\n      linkStyle: linkStyle\n    });\n  };\n\n  var setSubLinkStyle = function setSubLinkStyle(subLinkStyle) {\n    setTopicStyle({\n      subLinkStyle: subLinkStyle\n    });\n  };\n\n  var linkStyleEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    showLinkStyle: false,\n    linkStyle: linkStyle,\n    subLinkStyle: subLinkStyle,\n    setLinkStyle: setLinkStyle,\n    setSubLinkStyle: setSubLinkStyle\n  });\n\n  return createElement(TopicThemeEditorRoot, null, createElement(BorderStyleEditor, Object.assign({}, nProps)), createElement(PaddingStyleEditor, Object.assign({}, nProps)), createElement(TextStyleEditor, Object.assign({}, nProps)), createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.BACKGROUND)), createElement(SettingItemColorPicker, {\n    color: contentStyle.background,\n    handleColorChange: function handleColorChange(color) {\n      setContentStyle({\n        background: color\n      });\n    }\n  })), createElement(LinkStyleEditor, Object.assign({}, linkStyleEditorProps)));\n}\n\nvar log$g = debug('node:theme-editor');\nvar tabId = 'normal';\n\nfunction ThemeEditor(props) {\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      alertThemeError = _useState4[0],\n      setAlertThemeError = _useState4[1];\n\n  var model = props.model,\n      controller = props.controller; // cloneDeep\n\n  var theme = cloneDeep(model.config.theme);\n\n  var _controller$run6 = controller.run('getThemeOfTopic', _objectSpread(_objectSpread({}, props), {}, {\n    isClone: true\n  })),\n      rootTopic = _controller$run6.rootTopic,\n      primaryTopic = _controller$run6.primaryTopic,\n      normalTopic = _controller$run6.normalTopic;\n\n  var setTheme = function setTheme(theme) {\n    controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n      opType: OpType.SET_THEME,\n      theme: theme\n    }));\n  };\n\n  var handleBackgroundColorChange = function handleBackgroundColorChange(background) {\n    setTheme(merge(theme, {\n      background: background\n    }));\n  };\n\n  var handleHighlightColorChange = function handleHighlightColorChange(highlightColor) {\n    setTheme(merge(theme, {\n      highlightColor: highlightColor\n    }));\n  };\n\n  var handleRandomColorChange = handleBooleanChange(function (randomColor) {\n    setTheme(merge(theme, {\n      randomColor: randomColor\n    }));\n  });\n\n  var setRootTopicStyle = function setRootTopicStyle(style) {\n    setTheme(merge(theme, {\n      rootTopic: style\n    }));\n  };\n\n  var setPrimaryTopicStyle = function setPrimaryTopicStyle(style) {\n    setTheme(merge(theme, {\n      primaryTopic: style\n    }));\n  };\n\n  var setNormalTopicStyle = function setNormalTopicStyle(style) {\n    setTheme(merge(theme, {\n      normalTopic: style\n    }));\n  };\n\n  var rootTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: rootTopic,\n    setTopicStyle: setRootTopicStyle\n  });\n\n  var rootTopicEditor = createElement(TopicThemeEditor, Object.assign({}, rootTopicEditorProps));\n\n  var primaryTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: primaryTopic,\n    setTopicStyle: setPrimaryTopicStyle\n  });\n\n  var primaryTopicEditor = createElement(TopicThemeEditor, Object.assign({}, primaryTopicEditorProps));\n\n  var normalTopicEditorProps = _objectSpread(_objectSpread({}, props), {}, {\n    topicStyle: normalTopic,\n    setTopicStyle: setNormalTopicStyle\n  });\n\n  var normalTopicEditor = createElement(TopicThemeEditor, Object.assign({}, normalTopicEditorProps));\n  var tabsProps = {\n    id: tabId,\n    handleTabIdChange: function handleTabIdChange(id) {\n      tabId = id;\n    }\n  };\n  var topicThemes = createElement(SettingBoxContainer, null, createElement(Tabs, Object.assign({}, tabsProps), createElement(Tab, {\n    id: \"normal\",\n    title: getI18nText(props, I18nKey.NORMAL_TOPIC),\n    panel: normalTopicEditor\n  }), createElement(Tab, {\n    id: \"primary\",\n    title: getI18nText(props, I18nKey.PRIMARY_TOPIC),\n    panel: primaryTopicEditor\n  }), createElement(Tab, {\n    id: \"root\",\n    title: getI18nText(props, I18nKey.ROOT_TOPIC),\n    panel: rootTopicEditor\n  })));\n\n  var handleExportTheme = function handleExportTheme(e) {\n    // setShowExportDialog(true);\n    var text = JSON.stringify(theme);\n    browserDownloadText(text, 'blink-mind-theme.json');\n  };\n\n  var handleImportTheme = function handleImportTheme(e) {\n    browserOpenFile('.json,.txt').then(function (txt) {\n      var t = JSON.parse(txt);\n\n      if (!isThemeType(t)) {\n        setAlertThemeError(true);\n        return;\n      }\n\n      setTheme(t);\n    });\n  };\n\n  var alertProps = {\n    isOpen: alertThemeError,\n    onClose: function onClose(e) {\n      setAlertThemeError(false);\n    }\n  };\n  var alert = createElement(Alert, Object.assign({}, alertProps), createElement(\"p\", null, \"File format error\"));\n  return createElement(PanelTabRoot, null, createElement(SettingGroup, null, createElement(SettingTitle, null, getI18nText(props, I18nKey.GLOBAL)), createElement(SettingRow, null, createElement(SettingLabel, null, getI18nText(props, I18nKey.BACKGROUND) + ':'), createElement(SettingItemColorPicker, {\n    color: theme.background,\n    handleColorChange: handleBackgroundColorChange\n  }), createElement(SettingLabel, null, getI18nText(props, I18nKey.HIGHLIGHT) + ':'), createElement(SettingItemColorPicker, {\n    color: theme.highlightColor,\n    handleColorChange: handleHighlightColorChange\n  }), createElement(SettingLabel, null, getI18nText(props, I18nKey.RANDOM_COLOR) + ':'), createElement(StyledCheckbox, {\n    checked: theme.randomColor,\n    onChange: handleRandomColorChange\n  }))), topicThemes, createElement(SettingGroup, null, createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.EXPORT_THEME),\n    onClick: handleExportTheme\n  }), createElement(SettingItemButton, {\n    title: getI18nText(props, I18nKey.IMPORT_THEME),\n    onClick: handleImportTheme\n  })), alert);\n}\n\nfunction RightTopPanelPlugin() {\n  return {\n    renderRightTopPanel: function renderRightTopPanel(props) {\n      var nProps = _objectSpread(_objectSpread({}, props), {}, {\n        key: 'right-top-panel'\n      });\n\n      return createElement(RightTopPanelWidget, Object.assign({}, nProps));\n    },\n    renderRightTopPanelTabs: function renderRightTopPanelTabs(props) {\n      var controller = props.controller;\n      var styleEditorTab = controller.run('renderTopicStyleEditor', props);\n      var themeEditorTab = controller.run('renderThemeEditor', props);\n      return [styleEditorTab, themeEditorTab];\n    },\n    renderTopicStyleEditor: function renderTopicStyleEditor(ctx) {\n      var tProps = {\n        id: 'topic-style',\n        key: 'topic-style',\n        title: getI18nText(ctx, I18nKey.TOPIC_STYLE),\n        panel: createElement(StyleEditor, Object.assign({}, ctx))\n      };\n      return createElement(Tab, Object.assign({}, tProps));\n    },\n    renderThemeEditor: function renderThemeEditor(props) {\n      var tProps = {\n        id: 'theme-editor',\n        key: 'theme-editor',\n        title: getI18nText(props, I18nKey.THEME),\n        panel: createElement(ThemeEditor, Object.assign({}, props))\n      };\n      return createElement(Tab, Object.assign({}, tProps));\n    }\n  };\n}\n\nvar ToolbarRoot = styled.div(_templateObject56 || (_templateObject56 = _taggedTemplateLiteral([\"\\n  box-shadow: rgb(170, 170, 170) 0 0 2px;\\n  background: white;\\n  .iconfont {\\n    font-size: 28px !important;\\n  }\\n\"])));\n\nfunction Toolbar(props) {\n  var controller = props.controller;\n  return createElement(ToolbarRoot, null, controller.run('renderToolbarItems', props));\n}\n\nfunction ToolbarItemLayout(props) {\n  var layoutDirs = [[DiagramLayoutType.LEFT_AND_RIGHT, getI18nText(props, I18nKey.LEFT_AND_RIGHT), 'layout-left-and-right'], [DiagramLayoutType.LEFT_TO_RIGHT, getI18nText(props, I18nKey.ONLY_RIGHT), 'layout-right'], [DiagramLayoutType.RIGHT_TO_LEFT, getI18nText(props, I18nKey.ONLY_LEFT), 'layout-left']];\n\n  var onClickSetLayout = function onClickSetLayout(layoutDir) {\n    return function (e) {\n      var controller = props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n        opType: OpType.SET_LAYOUT_DIR,\n        layoutDir: layoutDir\n      }));\n    };\n  };\n\n  return createElement(ToolbarItem, Object.assign({\n    className: iconClassName(IconName.LAYOUT_LEFT_AND_RIGHT)\n  }, props), createElement(Popover, {\n    enforceFocus: false\n  }, createElement(ToolbarItemPopoverTarget, null), createElement(Menu, null, layoutDirs.map(function (dir) {\n    return createElement(MenuItem, {\n      key: dir[1],\n      icon: Icon(dir[2]),\n      text: dir[1],\n      onClick: onClickSetLayout(dir[0])\n    });\n  }))));\n}\n\nfunction ToolbarPlugin() {\n  return {\n    renderToolbar: function renderToolbar(props) {\n      return createElement(Toolbar, Object.assign({}, props));\n    },\n    renderToolbarItems: function renderToolbarItems(props) {\n      var controller = props.controller;\n      var itemConfigs = controller.run('customizeToolbar', props); //TODO  order\n\n      itemConfigs.sort(function (a, b) {\n        return a.order - b.order;\n      });\n      return itemConfigs.map(function (item) {\n        return createElement(item.element, _objectSpread(_objectSpread({}, props), {}, {\n          key: item.order.toString()\n        }));\n      });\n    },\n    customizeToolbar: function customizeToolbar(props) {\n      return [{\n        order: 100,\n        element: ToolbarItemLayout\n      }];\n    }\n  };\n}\n\nvar log$h = debug('plugin:utils');\n\nfunction UtilsPlugin() {\n  var tempValueMap = new Map();\n  var eventListenerMap = new Map();\n  return {\n    addTempValueChangeListener: function addTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (!eventListenerMap.has(key)) {\n        eventListenerMap.set(key, []);\n      }\n\n      eventListenerMap.get(key).push(listener);\n    },\n    removeTempValueChangeListener: function removeTempValueChangeListener(props) {\n      var key = props.key,\n          listener = props.listener;\n\n      if (eventListenerMap.has(key)) {\n        eventListenerMap[key] = eventListenerMap.get(key).filter(function (l) {\n          return l !== listener;\n        });\n      }\n    },\n    getTempValue: function getTempValue(props) {\n      var key = props.key;\n      log$h('getTempValue', key);\n      return tempValueMap.get(key);\n    },\n    setTempValue: function setTempValue(props) {\n      var key = props.key,\n          value = props.value;\n      log$h('setTempValue', key);\n      tempValueMap.set(key, value);\n\n      if (eventListenerMap.has(key)) {\n        var listeners = eventListenerMap.get(key);\n\n        var _iterator4 = _createForOfIteratorHelper(listeners),\n            _step4;\n\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var listener = _step4.value;\n            listener(value);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      }\n    },\n    deleteTempValue: function deleteTempValue(props) {\n      var key = props.key;\n      log$h('deleteTempValue', key);\n      var value = tempValueMap.get(key);\n      tempValueMap.delete(key);\n      return value;\n    }\n  };\n}\n\nfunction ReactPlugin() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return [RenderingPlugin(), UtilsPlugin(), ContextMenuPlugin(), RightTopPanelPlugin(), ToolbarPlugin(), DragAndDropPlugin()];\n}\n\nvar log$i = debug('node:text-editor');\nvar Content = styled.div(_templateObject57 || (_templateObject57 = _taggedTemplateLiteral([\"\\n  padding: 6px;\\n  background-color: \", \";\\n  cursor: \", \";\\n  min-width: 50px;\\n\"])), function (props) {\n  return props.readOnly ? null : 'white';\n}, function (props) {\n  return props.readOnly ? 'pointer' : 'text';\n});\n\nvar SimpleTextEditor = /*#__PURE__*/function (_PureComponent2) {\n  _inherits(SimpleTextEditor, _PureComponent2);\n\n  var _super16 = _createSuper(SimpleTextEditor);\n\n  function SimpleTextEditor(props) {\n    var _this13;\n\n    _classCallCheck(this, SimpleTextEditor);\n\n    _this13 = _super16.call(this, props);\n    _this13.state = {\n      content: null\n    };\n\n    _this13.onMouseDown = function (e) {\n      e.stopPropagation();\n    };\n\n    _this13.onMouseMove = function (e) {// log('onMouseMove');\n      // e.stopPropagation();\n    };\n\n    _this13.onKeyDown = function (e) {};\n\n    _this13._handleClick = function (event) {\n      var wasOutside = !_this13.root.contains(event.target);\n      wasOutside && _this13.onClickOutSide(event);\n    };\n\n    _this13.rootRef = function (saveRef) {\n      return function (ref) {\n        saveRef(ref);\n        _this13.root = ref;\n      };\n    };\n\n    _this13.initState();\n\n    return _this13;\n  }\n\n  _createClass(SimpleTextEditor, [{\n    key: \"onChange\",\n    value: function onChange(_ref10) {\n      var value = _ref10.value;\n      log$i('onChange', value);\n      this.setState({\n        content: value\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var readOnly = this.props.readOnly;\n      if (readOnly) return;\n      document.addEventListener('click', this._handleClick);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var readOnly = this.props.readOnly;\n      if (readOnly) return;\n      document.removeEventListener('click', this._handleClick);\n    }\n  }, {\n    key: \"onClickOutSide\",\n    value: function onClickOutSide(e) {}\n  }, {\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      return null;\n    }\n  }, {\n    key: \"getContent\",\n    value: function getContent() {\n      var _this$getCustomizePro = this.getCustomizeProps(),\n          block = _this$getCustomizePro.block;\n\n      var content = block.data;\n      if (content == null) return null;\n\n      if (typeof content === 'string') {\n        content = plainSerializer.deserialize(content);\n      }\n\n      return content;\n    }\n  }, {\n    key: \"initState\",\n    value: function initState() {\n      var content = this.getContent();\n      this.state = {\n        content: content\n      };\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props10 = this.props,\n          topicKey = _this$props10.topicKey,\n          saveRef = _this$props10.saveRef;\n\n      var _this$getCustomizePro2 = this.getCustomizeProps(),\n          readOnly = _this$getCustomizePro2.readOnly,\n          getRefKeyFunc = _this$getCustomizePro2.getRefKeyFunc,\n          placeholder = _this$getCustomizePro2.placeholder,\n          style = _this$getCustomizePro2.style;\n\n      log$i(readOnly);\n      var key = getRefKeyFunc(topicKey);\n      var content = readOnly ? this.getContent() : this.state.content;\n      var onMouseDown = this.onMouseDown,\n          onMouseMove = this.onMouseMove,\n          onKeyDown = this.onKeyDown;\n      var editorProps = {\n        value: content,\n        readOnly: readOnly,\n        onChange: this.onChange.bind(this),\n        placeholder: placeholder,\n        style: style\n      };\n      var contentProps = {\n        key: key,\n        readOnly: readOnly,\n        ref: this.rootRef(saveRef(key)),\n        onMouseDown: onMouseDown,\n        onMouseMove: onMouseMove,\n        onKeyDown: onKeyDown\n      };\n      return createElement(Content, Object.assign({}, contentProps), createElement(Editor, Object.assign({}, editorProps, {\n        autoFocus: true\n      })));\n    }\n  }]);\n\n  return SimpleTextEditor;\n}(PureComponent);\n\nvar log$j = debug('node:topic-content-editor');\n\nfunction contentEditorRefKey$1(key) {\n  return \"content-editor-\".concat(key);\n}\n\nvar TopicContentEditor = /*#__PURE__*/function (_SimpleTextEditor) {\n  _inherits(TopicContentEditor, _SimpleTextEditor);\n\n  var _super17 = _createSuper(TopicContentEditor);\n\n  function TopicContentEditor(props) {\n    var _this14;\n\n    _classCallCheck(this, TopicContentEditor);\n\n    _this14 = _super17.call(this, props);\n\n    _this14.onKeyDown = function (e) {\n      if (e.nativeEvent.ctrlKey && e.nativeEvent.code === 'Enter') {\n        _this14.save();\n      }\n    };\n\n    return _this14;\n  }\n\n  _createClass(TopicContentEditor, [{\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      var _this$props11 = this.props,\n          model = _this$props11.model,\n          topicKey = _this$props11.topicKey,\n          readOnly = _this$props11.readOnly;\n      var block = model.getTopic(topicKey).getBlock(BlockType.CONTENT).block;\n      var getRefKeyFunc = contentEditorRefKey$1;\n      var style = {\n        whiteSpace: 'pre'\n      };\n      return {\n        block: block,\n        readOnly: readOnly,\n        getRefKeyFunc: getRefKeyFunc,\n        placeholder: 'new',\n        style: style\n      };\n    }\n  }, {\n    key: \"onClickOutSide\",\n    value: function onClickOutSide(e) {\n      log$j('onClickOutSide');\n      this.save();\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var _this$props12 = this.props,\n          model = _this$props12.model,\n          topicKey = _this$props12.topicKey;\n      var readOnly = model.editingContentKey !== topicKey;\n      if (readOnly) return;\n      var controller = this.props.controller;\n      controller.run('operation', _objectSpread(_objectSpread({}, this.props), {}, {\n        opType: OpType.SET_TOPIC_BLOCK,\n        blockType: BlockType.CONTENT,\n        data: this.state.content,\n        focusMode: FocusMode.NORMAL\n      }));\n    }\n  }]);\n\n  return TopicContentEditor;\n}(SimpleTextEditor);\n\nvar log$k = debug('node:topic-desc-editor');\n\nfunction descEditorRefKey$1(key) {\n  return \"desc-editor-\".concat(key);\n}\n\nvar TopicDescEditor = /*#__PURE__*/function (_SimpleTextEditor2) {\n  _inherits(TopicDescEditor, _SimpleTextEditor2);\n\n  var _super18 = _createSuper(TopicDescEditor);\n\n  function TopicDescEditor(props) {\n    var _this15;\n\n    _classCallCheck(this, TopicDescEditor);\n\n    _this15 = _super18.call(this, props);\n    log$k('constructor');\n    return _this15;\n  }\n\n  _createClass(TopicDescEditor, [{\n    key: \"initState\",\n    value: function initState() {\n      _get(_getPrototypeOf(TopicDescEditor.prototype), \"initState\", this).call(this);\n\n      var _this$props13 = this.props,\n          controller = _this$props13.controller,\n          topicKey = _this$props13.topicKey;\n      var key = \"topic-desc-data-\".concat(topicKey);\n      var value = this.state.content;\n      controller.run('setTempValue', {\n        key: key,\n        value: value\n      });\n    }\n  }, {\n    key: \"getCustomizeProps\",\n    value: function getCustomizeProps() {\n      var _this$props14 = this.props,\n          model = _this$props14.model,\n          topicKey = _this$props14.topicKey;\n      var block = model.getTopic(topicKey).getBlock(BlockType.DESC).block;\n      var readOnly = model.editingDescKey !== topicKey;\n      var getRefKeyFunc = descEditorRefKey$1;\n      return {\n        block: block,\n        readOnly: readOnly,\n        getRefKeyFunc: getRefKeyFunc,\n        placeholder: 'write topic notes here'\n      };\n    }\n  }, {\n    key: \"onChange\",\n    value: function onChange(_ref11) {\n      var value = _ref11.value;\n      log$k('onChange');\n      var _this$props15 = this.props,\n          controller = _this$props15.controller,\n          topicKey = _this$props15.topicKey,\n          model = _this$props15.model;\n      var readOnly = model.editingDescKey !== topicKey;\n      if (readOnly) return;\n      var key = \"topic-desc-data-\".concat(topicKey);\n      controller.run('setTempValue', {\n        key: key,\n        value: value\n      });\n      this.setState({\n        content: value\n      });\n    }\n  }]);\n\n  return TopicDescEditor;\n}(SimpleTextEditor);\n\nfunction SimpleTextEditorPlugin() {\n  return {\n    getTopicTitle: function getTopicTitle(props) {\n      var model = props.model,\n          controller = props.controller,\n          topicKey = props.topicKey,\n          maxLength = props.maxLength;\n      var topic = model.getTopic(topicKey);\n      var block = topic.getBlock(BlockType.CONTENT).block;\n      var text = controller.run('serializeBlockData', _objectSpread(_objectSpread({}, props), {}, {\n        block: block\n      }));\n\n      if (maxLength != null) {\n        text = text.length > maxLength ? text.substr(0, maxLength) + '...' : text;\n      }\n\n      return text;\n    },\n    renderTopicContentEditor: function renderTopicContentEditor(props) {\n      return createElement(TopicContentEditor, Object.assign({}, props));\n    },\n    renderTopicDescEditor: function renderTopicDescEditor(props) {\n      return createElement(TopicDescEditor, Object.assign({}, props));\n    },\n    isBlockEmpty: function isBlockEmpty(props, next) {\n      var block = props.block,\n          controller = props.controller;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return block.data == null || controller.run('serializeBlockData', props) === '';\n      }\n\n      return next();\n    },\n    serializeBlockData: function serializeBlockData(props, next) {\n      var block = props.block;\n\n      if (block.type === BlockType.CONTENT || block.type === BlockType.DESC) {\n        return typeof block.data === 'string' ? block.data : plainSerializer.serialize(block.data);\n      }\n\n      return next();\n    }\n  };\n}\n\nvar log$l = debug('plugin:StylePlugin');\n\nfunction StylePlugin() {\n  var colorMap = new Map();\n  var colorIndex = 0;\n  return {\n    getTopicStyle: function getTopicStyle(props) {\n      var controller = props.controller;\n      return {\n        contentStyle: controller.run('getTopicContentStyle', props),\n        linkStyle: controller.run('getLinkStyle', props),\n        subLinkStyle: controller.run('getSubLinkStyle', props)\n      };\n    },\n    getTopicContentStyle: function getTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getTopicContentStyle:', topicKey, model);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var themeStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) themeStyle = theme.rootTopic;else if (visualLevel === TopicVisualLevel.PRIMARY) themeStyle = theme.primaryTopic;else themeStyle = theme.normalTopic;\n      themeStyle = _objectSpread(_objectSpread({}, theme.contentStyle), themeStyle.contentStyle);\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        themeStyle = _objectSpread(_objectSpread({}, themeStyle), {}, {\n          background: randomColor,\n          borderColor: randomColor,\n          subLinkStyle: _objectSpread(_objectSpread({}, themeStyle.subLinkStyle), {}, {\n            lineColor: randomColor\n          })\n        });\n      }\n\n      var topic = model.getTopic(topicKey);\n\n      if (!topic.style) {\n        return themeStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _objectSpread(_objectSpread({}, themeStyle), customStyle.contentStyle);\n    },\n    getLinkStyle: function getLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var linkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.linkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.linkStyle;else presetStyle = theme.normalTopic.linkStyle;\n      linkStyle = _objectSpread(_objectSpread({}, linkStyle), presetStyle);\n      var topic = model.getTopic(topicKey);\n\n      if (topic.parentKey != null) {\n        var parentSubLinkStyle = controller.run('getSubLinkStyle', _objectSpread(_objectSpread({}, props), {}, {\n          topicKey: topic.parentKey\n        }));\n        linkStyle = _objectSpread(_objectSpread({}, linkStyle), parentSubLinkStyle);\n      }\n\n      if (!topic.style) {\n        return linkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n      return _objectSpread(_objectSpread({}, linkStyle), customStyle.linkStyle);\n    },\n    getSubLinkStyle: function getSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model,\n          controller = props.controller;\n      log$l('getLinkStyle', topicKey);\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      var subLinkStyle = theme.linkStyle;\n      var presetStyle;\n      if (visualLevel === TopicVisualLevel.ROOT) presetStyle = theme.rootTopic.subLinkStyle;else if (visualLevel === TopicVisualLevel.PRIMARY) presetStyle = theme.primaryTopic.subLinkStyle;else presetStyle = theme.normalTopic.subLinkStyle;\n      subLinkStyle = _objectSpread(_objectSpread({}, subLinkStyle), presetStyle);\n      var topic = model.getTopic(topicKey); // color\n\n      if (theme.randomColor) {\n        var randomColor = controller.run('getRandomColor', props);\n        log$l(randomColor);\n        subLinkStyle = _objectSpread(_objectSpread({}, subLinkStyle), {}, {\n          lineColor: randomColor\n        });\n      }\n\n      if (!topic.style) {\n        return subLinkStyle;\n      }\n\n      var customStyle = JSON.parse(topic.style);\n\n      var res = _objectSpread(_objectSpread({}, subLinkStyle), customStyle.subLinkStyle); // if (res.lineRadius == null) res.lineRadius = 5;\n\n\n      return res;\n    },\n    setTopicContentStyle: function setTopicContentStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          style = props.style,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var topicStyle = topic.style;\n      var styleObj = topicStyle ? JSON.parse(topicStyle) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        contentStyle: _objectSpread(_objectSpread({}, styleObj.contentStyle), style)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setLinkStyle: function setLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          linkStyle = props.linkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        linkStyle: _objectSpread(_objectSpread({}, styleObj.linkStyle), linkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    setSubLinkStyle: function setSubLinkStyle(props) {\n      var topicKey = props.topicKey,\n          controller = props.controller,\n          subLinkStyle = props.subLinkStyle,\n          model = props.model;\n      var topic = model.getTopic(topicKey);\n      var style = topic.style;\n      var styleObj = style ? JSON.parse(style) : {};\n\n      var newStyleObj = _objectSpread(_objectSpread({}, styleObj), {}, {\n        subLinkStyle: _objectSpread(_objectSpread({}, styleObj.subLinkStyle), subLinkStyle)\n      });\n\n      if (!isEqual(styleObj, newStyleObj)) {\n        var newStyleStr = JSON.stringify(newStyleObj);\n        controller.run('operation', _objectSpread(_objectSpread({}, props), {}, {\n          opType: OpType.SET_STYLE,\n          style: newStyleStr\n        }));\n      }\n    },\n    getTopicThemeStyle: function getTopicThemeStyle(props) {\n      var topicKey = props.topicKey,\n          model = props.model;\n      var visualLevel = model.getTopicVisualLevel(topicKey);\n      var theme = model.config.theme;\n      if (visualLevel === TopicVisualLevel.ROOT) return theme.rootTopic;\n      if (visualLevel === TopicVisualLevel.PRIMARY) return theme.primaryTopic;\n      return theme.normalTopic;\n    },\n    getRandomColor: function getRandomColor(props) {\n      var topicKey = props.topicKey;\n      if (colorMap.has(topicKey)) return colorMap.get(topicKey);\n      var colors = ['#00CC99', '#FFEE88', '#A167A5', '#E5F993', '#F5C396', '#DB995A', '#83BCFF', '#ED7B84', '#739E82', '#D3BCC0', '#FFA0FD', '#EFD3D7', '#C6878F'];\n      var color = colors[++colorIndex % colors.length];\n      colorMap.set(topicKey, color);\n      log$l('getRandomColor', topicKey, color);\n      return color;\n    }\n  };\n}\n\nfunction ThemePlugin() {\n  return {\n    getThemeOfTopic: function getThemeOfTopic(ctx) {\n      var model = ctx.model;\n      var theme = model.config.theme;\n      var contentStyle = theme.contentStyle,\n          rootTopic = theme.rootTopic,\n          primaryTopic = theme.primaryTopic,\n          normalTopic = theme.normalTopic;\n      return {\n        rootTopic: _objectSpread(_objectSpread({}, rootTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), rootTopic.contentStyle)\n        }),\n        primaryTopic: _objectSpread(_objectSpread({}, primaryTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), primaryTopic.contentStyle)\n        }),\n        normalTopic: _objectSpread(_objectSpread({}, normalTopic), {}, {\n          contentStyle: _objectSpread(_objectSpread({}, contentStyle), normalTopic.contentStyle)\n        })\n      };\n    }\n  };\n}\n\nfunction DefaultPlugin() {\n  return [ReactPlugin(), LayoutPlugin(), OperationPlugin(), StylePlugin(), EventPlugin(), HotKeyPlugin(), GetValuePlugin(), SimpleTextEditorPlugin(), CreateModelPlugin(), ThemePlugin(), I18nPlugin()];\n}\n\nvar log$m = debug('node:Diagram');\n\nvar Diagram = /*#__PURE__*/function (_Component6) {\n  _inherits(Diagram, _Component6);\n\n  var _super19 = _createSuper(Diagram);\n\n  function Diagram() {\n    var _this16;\n\n    _classCallCheck(this, Diagram);\n\n    _this16 = _super19.apply(this, arguments);\n    _this16.resolveController = memoizeOne(function () {\n      var plugins = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var TheDefaultPlugin = arguments.length > 1 ? arguments[1] : undefined;\n      var defaultPlugin = TheDefaultPlugin();\n      _this16.controller = new Controller({\n        plugins: [plugins, defaultPlugin],\n        onChange: _this16.props.onChange\n      });\n    });\n    return _this16;\n  }\n\n  _createClass(Diagram, [{\n    key: \"getDiagramProps\",\n    value: function getDiagramProps() {\n      return this.controller.run('getDiagramProps');\n    }\n  }, {\n    key: \"openNewModel\",\n    value: function openNewModel(newModel) {\n      var props = this.getDiagramProps();\n      var controller = props.controller;\n      controller.run('openNewModel', _objectSpread(_objectSpread({}, props), {}, {\n        newModel: newModel\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props16 = this.props,\n          plugins = _this$props16.plugins,\n          controller = _this$props16.controller;\n      if (controller) this.controller = controller;else this.resolveController(plugins, DefaultPlugin);\n      var model = this.props.model;\n\n      if (!model) {\n        model = this.controller.run('createNewModel');\n      }\n\n      this.diagramProps = _objectSpread(_objectSpread({}, this.props), {}, {\n        model: model,\n        controller: this.controller\n      });\n      return this.controller.run('renderDiagram', this.diagramProps);\n    }\n  }]);\n\n  return Diagram;\n}(Component);\n\nexport { BaseWidget, Btn, CloseIcon, ColorBar, DefaultPlugin, Diagram, DragScrollWidget, EventKey, Flex, HotKeyName, I18nKey, Icon, IconBg, IconName, Margin, MoveTopicDir, PanelTabRoot, PropKey, PxSelect, RefKey, SaveRef, SettingBoxContainer, SettingGroup, SettingItem, SettingItemButton, SettingItemColorPicker, SettingItemInput, SettingItemNumericInput, SettingItemSelect, SettingLabel, SettingRow, SettingTitle, ShowMenuIcon, StyledCheckbox, Title, ToolbarItem, ToolbarItemPopoverTarget, ToolbarItemRoot, TopicBlockIcon, VListContainer, WithBorder, ZIndex, borderWidthItems, browserDownloadFile, browserDownloadText, browserOpenFile, cancelEvent, center, centerPointX, centerPointY, centerX, centerY, collapseRefKey, contentEditorRefKey, contentRefKey, descEditorRefKey, dropAreaRefKey, getI18nText, getLinkKey, _getRelativeRect as getRelativeRect, getRelativeVector, iconClassName, linksRefKey, linksSvgRefKey, paddingCss, renderItem, renderItemI18n, topicRefKey, topicWidgetRefKey };","import { OpType, FocusMode, getAllSubTopicKeys, ModelModifier } from '@blink-mind/core';\nimport { ZIndex, Flex, PropKey, cancelEvent, iconClassName, TopicBlockIcon, StyledCheckbox, Icon } from '@blink-mind/renderer-react';\nimport { Button, Alert, PopoverInteractionKind, Popover, MenuDivider, MenuItem } from '@blueprintjs/core';\nimport { createElement, useState, Fragment } from 'react';\nimport styled from 'styled-components';\nimport { List, Map, Record } from 'immutable';\nimport { Omnibar } from '@blueprintjs/select';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) {\n    Object.defineProperty(cooked, \"raw\", {\n      value: raw\n    });\n  } else {\n    cooked.raw = raw;\n  }\n\n  return cooked;\n}\n\nvar FOCUS_MODE_SET_REFERENCE_TOPICS = 'FOCUS_MODE_SET_REFERENCE_TOPICS'; // Topic\n\nvar OP_TYPE_START_SET_REFERENCE_TOPICS = 'OP_TYPE_START_SET_REFERENCE_TOPICS';\nvar OP_TYPE_SET_REFERENCE_TOPICS = 'OP_TYPE_SET_REFERENCE_TOPICS';\nvar EXT_DATA_KEY_TOPIC_REFERENCE = 'TOPIC_REFERENCE';\nvar EXT_KEY_TOPIC_REFERENCE = 'EXT_KEY_TOPIC_REFERENCE';\nvar Root = styled(ZIndex)(templateObject_1 || (templateObject_1 = __makeTemplateObject([\"\\n  position: absolute;\\n  left: calc(50% - 150px);\\n  top: 30px;\\n  width: 300px;\\n  background: white;\\n  padding: 10px;\\n  user-select: none;\\n\"], [\"\\n  position: absolute;\\n  left: calc(50% - 150px);\\n  top: 30px;\\n  width: 300px;\\n  background: white;\\n  padding: 10px;\\n  user-select: none;\\n\"])));\nvar Title = styled.div(templateObject_2 || (templateObject_2 = __makeTemplateObject([\"\\n  margin-bottom: 10px;\\n\"], [\"\\n  margin-bottom: 10px;\\n\"])));\n\nfunction AddReferenceTopicPanel(props) {\n  var zIndex = props.zIndex,\n      controller = props.controller,\n      topicKey = props.topicKey;\n\n  var onClickCancel = function onClickCancel(e) {\n    controller.run('clearSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  var onClickConfirm = function onClickConfirm(e) {\n    var referenceKeys = controller.run('getSelectedReferenceKeys', props);\n    controller.run('enableOperation', props);\n    controller.run('operation', _assign(_assign({}, props), {\n      opArray: [{\n        opType: OP_TYPE_SET_REFERENCE_TOPICS,\n        topicKey: topicKey,\n        referenceKeys: referenceKeys\n      }, {\n        opType: OpType.FOCUS_TOPIC,\n        topicKey: topicKey,\n        focusMode: FocusMode.NORMAL\n      }]\n    }));\n    controller.run('clearSelectedReferenceKeys', props);\n  };\n\n  return createElement(Root, {\n    zIndex: zIndex\n  }, createElement(Title, null, \"Please select the topics you want to reference. After selection, click the confirm button.\"), createElement(Flex, {\n    justifyContent: 'space-around'\n  }, createElement(Button, {\n    onClick: onClickConfirm\n  }, \"Confirm\"), createElement(Button, {\n    onClick: onClickCancel\n  }, \"Cancel\")));\n}\n\nvar templateObject_1, templateObject_2;\nvar defaultReferenceRecord = {\n  keyList: List(),\n  dataMap: Map()\n};\n\nvar ReferenceRecord = function (_super) {\n  __extends(ReferenceRecord, _super);\n\n  function ReferenceRecord() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(ReferenceRecord.prototype, \"keyList\", {\n    get: function get() {\n      return this.get('keyList');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ReferenceRecord.prototype, \"dataMap\", {\n    get: function get() {\n      return this.get('dataMap');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ReferenceRecord;\n}(Record(defaultReferenceRecord));\n\nvar defaultExtDataReferenceRecord = {\n  reference: Map()\n};\n\nvar ExtDataReference = function (_super) {\n  __extends(ExtDataReference, _super);\n\n  function ExtDataReference() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(ExtDataReference.prototype, \"reference\", {\n    get: function get() {\n      return this.get('reference');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ExtDataReference.prototype.getReferenceKeys = function (topicKey) {\n    if (this.reference.has(topicKey)) {\n      return this.reference.get(topicKey).keyList.toArray();\n    }\n\n    return [];\n  };\n\n  ExtDataReference.prototype.getReferencedKeys = function (topicKey) {\n    var res = [];\n    this.reference.forEach(function (v, k) {\n      if (v.keyList.includes(topicKey)) {\n        res.push(k);\n      }\n    });\n    return res;\n  };\n\n  return ExtDataReference;\n}(Record(defaultExtDataReferenceRecord)); // TODO \n\n\nfunction setReferenceTopicKeys(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      referenceKeys = _a.referenceKeys;\n  var extData = model.getExtDataItem(EXT_DATA_KEY_TOPIC_REFERENCE, ExtDataReference);\n  var referenceRecord = extData.reference.get(topicKey) || new ReferenceRecord();\n  referenceRecord = referenceRecord.set('keyList', List(referenceKeys));\n  extData = extData.setIn(['reference', topicKey], referenceRecord);\n  model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData);\n  return model;\n}\n\nvar Root$1 = styled.div(templateObject_1$1 || (templateObject_1$1 = __makeTemplateObject([\"\\n  display: flex;\\n  width: 380px;\\n  margin: 10px;\\n  justify-content: center;\\n  align-items: center;\\n\"], [\"\\n  display: flex;\\n  width: 380px;\\n  margin: 10px;\\n  justify-content: center;\\n  align-items: center;\\n\"])));\nvar Content = styled.div(templateObject_2$1 || (templateObject_2$1 = __makeTemplateObject([\"\\n  width: 300px;\\n  text-decoration: underline;\\n  cursor: pointer;\\n\"], [\"\\n  width: 300px;\\n  text-decoration: underline;\\n  cursor: pointer;\\n\"])));\nvar ButtonPlace = styled.div(templateObject_3 || (templateObject_3 = __makeTemplateObject([\"\\n  width: 80px;\\n\"], [\"\\n  width: 80px;\\n\"])));\n\nfunction ReferenceTopicThumbnail(props) {\n  var controller = props.controller,\n      refKey = props.refKey,\n      refType = props.refType,\n      removeHandler = props.removeHandler;\n\n  var _a = __read(useState(false), 2),\n      deleteConfirm = _a[0],\n      setDeleteConfirm = _a[1];\n\n  var onClick = function onClick(e) {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', _assign(_assign({}, props), {\n      topicKey: refKey\n    }));\n  };\n\n  var onClickRemove = function onClickRemove(e) {\n    setDeleteConfirm(true);\n  };\n\n  var content = controller.getValue(PropKey.TOPIC_TITLE, _assign(_assign({}, props), {\n    topicKey: refKey,\n    maxLength: 100\n  }));\n  var deleteAlertProps = {\n    isOpen: deleteConfirm,\n    cancelButtonText: 'cancel',\n    onConfirm: function onConfirm(e) {\n      removeHandler(e);\n    },\n    onCancel: function onCancel(e) {\n      setDeleteConfirm(false);\n    },\n    onClose: function onClose(e) {\n      setDeleteConfirm(false);\n    }\n  };\n  return createElement(Root$1, null, createElement(Content, {\n    onClick: onClick\n  }, content), createElement(ButtonPlace, null, refType === 'reference' && createElement(Fragment, null, createElement(Button, {\n    onClick: onClickRemove\n  }, \"Remove\"), createElement(Alert, _assign({}, deleteAlertProps), createElement(\"p\", null, \"Are you confirm to remove this reference?\")))));\n}\n\nvar templateObject_1$1, templateObject_2$1, templateObject_3;\nvar Root$2 = styled.div(templateObject_1$2 || (templateObject_1$2 = __makeTemplateObject([\"\"], [\"\"])));\nvar Group = styled.div(templateObject_2$2 || (templateObject_2$2 = __makeTemplateObject([\"\\n  padding: 10px;\\n\"], [\"\\n  padding: 10px;\\n\"])));\nvar GroupList = styled.div(templateObject_3$1 || (templateObject_3$1 = __makeTemplateObject([\"\\n  max-height: 200px;\\n  overflow: auto;\\n\"], [\"\\n  max-height: 200px;\\n  overflow: auto;\\n\"])));\nvar GroupTitle = styled.div(templateObject_4 || (templateObject_4 = __makeTemplateObject([\"\\n  font-size: 20px;\\n  color: #106ba3;\\n\"], [\"\\n  font-size: 20px;\\n  color: #106ba3;\\n\"])));\nvar GotoBtn = styled.div(templateObject_5 || (templateObject_5 = __makeTemplateObject([\"\\n  text-decoration: underline;\\n  color: #106ba3;\\n  cursor: pointer;\\n\"], [\"\\n  text-decoration: underline;\\n  color: #106ba3;\\n  cursor: pointer;\\n\"])));\n\nfunction ReferenceTopicList(props) {\n  var topicKey = props.topicKey,\n      controller = props.controller,\n      model = props.model;\n  var extData = model.extData.get(EXT_DATA_KEY_TOPIC_REFERENCE);\n\n  var removeReference = function removeReference(refKey) {\n    return function (e) {\n      e.stopPropagation();\n      var keyList = extData.reference.get(topicKey).keyList;\n      controller.run('operation', _assign(_assign({}, props), {\n        opArray: [{\n          opType: OP_TYPE_SET_REFERENCE_TOPICS,\n          topicKey: topicKey,\n          focusMode: FocusMode.NORMAL,\n          referenceKeys: keyList.delete(keyList.indexOf(refKey)).toArray()\n        }]\n      }));\n    };\n  };\n\n  var referenceKeys = extData.getReferenceKeys(topicKey);\n  var referenceGroup = referenceKeys.length === 0 ? null : createElement(Group, null, createElement(GroupTitle, null, \"Reference Topics:\"), createElement(GroupList, null, referenceKeys.map(function (key) {\n    var thumbProps = _assign(_assign({}, props), {\n      key: key,\n      refKey: key,\n      refType: 'reference',\n      removeHandler: removeReference(key)\n    }); //@ts-ignore\n\n\n    return createElement(ReferenceTopicThumbnail, _assign({}, thumbProps));\n  })));\n  var referencedKeys = extData.getReferencedKeys(topicKey);\n  var referencedGroup = referencedKeys.length === 0 ? null : createElement(Group, null, createElement(GroupTitle, null, \"Referenced Topics:\"), createElement(GroupList, null, referencedKeys.map(function (key) {\n    var thumbProps = _assign(_assign({}, props), {\n      key: key,\n      refKey: key,\n      refType: 'referenced'\n    }); //@ts-ignore\n\n\n    return createElement(ReferenceTopicThumbnail, _assign({}, thumbProps));\n  })));\n\n  var onClickGotoOriginTopic = function onClickGotoOriginTopic(e) {\n    e.stopPropagation();\n    controller.run('focusTopicAndMoveToCenter', props);\n  };\n\n  var currentTopic = model.focusKey !== topicKey && createElement(Group, null, createElement(GotoBtn, {\n    onClick: onClickGotoOriginTopic\n  }, \"Goto Origin Topic\"));\n  return createElement(Root$2, {\n    onMouseDown: cancelEvent\n  }, referenceGroup, referencedGroup, currentTopic);\n}\n\nvar templateObject_1$2, templateObject_2$2, templateObject_3$1, templateObject_4, templateObject_5;\n\nfunction TopicExtReference(props) {\n  var model = props.model,\n      topicKey = props.topicKey;\n  var extData = model.extData.get(EXT_DATA_KEY_TOPIC_REFERENCE) || new ExtDataReference();\n  var refRecord = extData.reference.get(topicKey);\n  var referencedKeys = [];\n  extData.reference.forEach(function (v, k) {\n    if (v.keyList.includes(topicKey)) referencedKeys.push(k);\n  });\n  if ((refRecord == null || refRecord.keyList.size === 0) && referencedKeys.length === 0) return null;\n  var iconProps = {\n    className: iconClassName('reference'),\n    tabIndex: -1\n  };\n  var icon = createElement(TopicBlockIcon, _assign({}, iconProps));\n  var tooltipContent = createElement(ReferenceTopicList, _assign({}, props));\n  var tooltipProps = {\n    autoFocus: false,\n    content: tooltipContent,\n    target: icon,\n    interactionKind: PopoverInteractionKind.CLICK,\n    hoverOpenDelay: 500\n  };\n  return createElement(Popover, _assign({}, tooltipProps));\n}\n\nfunction TopicReferenceCheckbox(props) {\n  var topicKey = props.topicKey,\n      selectedTopicKeys = props.selectedTopicKeys;\n  var a = selectedTopicKeys.has(topicKey);\n\n  var _a = __read(useState(a), 2),\n      checked = _a[0],\n      setChecked = _a[1];\n\n  var checkboxProps = {\n    checked: checked,\n    onChange: function onChange() {\n      if (selectedTopicKeys.has(topicKey)) {\n        selectedTopicKeys.delete(topicKey);\n      } else {\n        selectedTopicKeys.add(topicKey);\n      }\n\n      setChecked(!checked);\n    }\n  };\n  return createElement(StyledCheckbox, _assign({}, checkboxProps));\n}\n\nfunction TopicReferencePlugin() {\n  var selectedTopicKeys = new Set();\n\n  function startSetReferenceTopics(_a) {\n    var model = _a.model,\n        topicKey = _a.topicKey;\n    var extData = model.getExtDataItem(EXT_DATA_KEY_TOPIC_REFERENCE, ExtDataReference);\n    selectedTopicKeys = new Set(extData.getReferenceKeys(topicKey));\n    model = ModelModifier.focusTopic({\n      model: model,\n      topicKey: topicKey,\n      focusMode: FOCUS_MODE_SET_REFERENCE_TOPICS\n    });\n    return model;\n  }\n\n  return {\n    customizeTopicContextMenu: function customizeTopicContextMenu(props, next) {\n      var controller = props.controller;\n\n      function onClickSetReferenceTopics(e) {\n        controller.run('operation', _assign(_assign({}, props), {\n          opType: OP_TYPE_START_SET_REFERENCE_TOPICS\n        }));\n        controller.run('disableOperation', _assign(_assign({}, props), {\n          whiteList: [OpType.TOGGLE_COLLAPSE]\n        }));\n      }\n\n      return createElement(Fragment, null, next(), createElement(MenuDivider, null), createElement(MenuItem, {\n        key: EXT_KEY_TOPIC_REFERENCE,\n        icon: Icon('reference'),\n        text: \"Set Reference Topics\",\n        onClick: onClickSetReferenceTopics\n      }));\n    },\n    getOpMap: function getOpMap(props, next) {\n      var opMap = next();\n      opMap.set(OP_TYPE_START_SET_REFERENCE_TOPICS, startSetReferenceTopics);\n      opMap.set(OP_TYPE_SET_REFERENCE_TOPICS, setReferenceTopicKeys);\n      return opMap;\n    },\n    beforeOpFunction: function beforeOpFunction(props, next) {\n      var model = next();\n      var opType = props.opType,\n          topicKey = props.topicKey; // beforeOpFunction\n\n      if (opType === OpType.DELETE_TOPIC && topicKey !== model.editorRootTopicKey) {\n        var allDeleteKeys = getAllSubTopicKeys(model, topicKey);\n        allDeleteKeys.push(topicKey);\n        var extData_1 = model.getExtDataItem(EXT_DATA_KEY_TOPIC_REFERENCE, ExtDataReference);\n        var reference_1 = extData_1.reference; // Key\n\n        allDeleteKeys.forEach(function (deleteKey) {\n          var referencedKeys = extData_1.getReferencedKeys(deleteKey); // \n\n          reference_1 = reference_1.withMutations(function (reference) {\n            referencedKeys.forEach(function (v) {\n              reference.updateIn([v, 'keyList'], function (keyList) {\n                return keyList.delete(keyList.indexOf(deleteKey));\n              });\n            });\n          }); // \n\n          if (reference_1.has(deleteKey)) {\n            reference_1 = reference_1.delete(deleteKey);\n          }\n        });\n        extData_1 = extData_1.set('reference', reference_1);\n        model = model.setIn(['extData', EXT_DATA_KEY_TOPIC_REFERENCE], extData_1);\n      }\n\n      return model;\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props, next) {\n      var model = props.model,\n          controller = props.controller;\n      var zIndex = controller.getValue(PropKey.DIAGRAM_CUSTOMIZE_BASE_Z_INDEX) + 2;\n      var res = next();\n\n      if (model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS) {\n        var panelProps = _assign(_assign({}, props), {\n          zIndex: zIndex,\n          topicKey: model.focusKey,\n          key: 'AddReferenceTopicPanel'\n        });\n\n        res.push(createElement(AddReferenceTopicPanel, _assign({}, panelProps)));\n      }\n\n      return res;\n    },\n    renderTopicContentOthers: function renderTopicContentOthers(props, next) {\n      var model = props.model,\n          topicKey = props.topicKey,\n          controller = props.controller;\n      var res = next();\n      res.push(controller.run('renderTopicExtReference', _assign(_assign({}, props), {\n        key: EXT_KEY_TOPIC_REFERENCE + '-icon'\n      })));\n\n      if (model.focusMode === FOCUS_MODE_SET_REFERENCE_TOPICS && model.focusKey !== topicKey) {\n        var checkBoxProps = _assign(_assign({}, props), {\n          key: 'checkbox',\n          selectedTopicKeys: selectedTopicKeys\n        });\n\n        var checkbox = createElement(TopicReferenceCheckbox, _assign({}, checkBoxProps));\n        res.push(checkbox);\n      }\n\n      return res;\n    },\n    renderTopicExtReference: function renderTopicExtReference(props, next) {\n      return createElement(TopicExtReference, _assign({}, props));\n    },\n    clearSelectedReferenceKeys: function clearSelectedReferenceKeys() {\n      selectedTopicKeys.clear();\n    },\n    getSelectedReferenceKeys: function getSelectedReferenceKeys() {\n      return Array.from(selectedTopicKeys);\n    },\n    //TODO\n    deserializeExtDataItem: function deserializeExtDataItem(props, next) {\n      var extDataKey = props.extDataKey,\n          extDataItem = props.extDataItem;\n\n      if (extDataKey === EXT_DATA_KEY_TOPIC_REFERENCE) {\n        var extDataReference = new ExtDataReference();\n\n        var _loop_1 = function _loop_1(key) {\n          var item = extDataItem.reference[key];\n          var referenceRecord = new ReferenceRecord({\n            keyList: List(item.keyList),\n            dataMap: Map(item.dataMap)\n          });\n          extDataReference = extDataReference.update('reference', function (reference) {\n            return reference.set(key, referenceRecord);\n          });\n        };\n\n        for (var key in extDataItem.reference) {\n          _loop_1(key);\n        }\n\n        return extDataReference;\n      }\n\n      return next();\n    }\n  };\n}\n\nvar NavOmniBar = Omnibar.ofType();\nvar StyledNavOmniBar = styled(NavOmniBar)(templateObject_1$3 || (templateObject_1$3 = __makeTemplateObject([\"\\n  top: 20%;\\n  left: 25% !important;\\n  width: 50% !important;\\n\"], [\"\\n  top: 20%;\\n  left: 25% !important;\\n  width: 50% !important;\\n\"])));\nvar TopicTitle = styled.div(templateObject_2$3 || (templateObject_2$3 = __makeTemplateObject([\"\\n  margin: 0 5px;\\n  padding: 10px 5px;\\n  width: 100%;\\n  font-size: 16px;\\n  cursor: pointer;\\n  &:hover {\\n    background: #e3e8ec;\\n  }\\n\"], [\"\\n  margin: 0 5px;\\n  padding: 10px 5px;\\n  width: 100%;\\n  font-size: 16px;\\n  cursor: pointer;\\n  &:hover {\\n    background: #e3e8ec;\\n  }\\n\"])));\nvar StyledPopover = styled(Popover)(templateObject_3$2 || (templateObject_3$2 = __makeTemplateObject([\"\\n  display: block;\\n\"], [\"\\n  display: block;\\n\"])));\nvar Tip = styled.div(templateObject_4$1 || (templateObject_4$1 = __makeTemplateObject([\"\\n  padding: 10px;\\n  font-size: 16px;\\n  //max-width: 800px;\\n  //max-height: 600px;\\n  overflow: auto;\\n\"], [\"\\n  padding: 10px;\\n  font-size: 16px;\\n  //max-width: 800px;\\n  //max-height: 600px;\\n  overflow: auto;\\n\"])));\nvar TipContent = styled.div(templateObject_5$1 || (templateObject_5$1 = __makeTemplateObject([\"\\n  white-space: break-spaces;\\n\"], [\"\\n  white-space: break-spaces;\\n\"])));\nvar INPUT_PROPS = {\n  placeholder: 'Search'\n};\n\nfunction SearchPanel(props) {\n  var model = props.model,\n      setSearchWord = props.setSearchWord,\n      controller = props.controller;\n\n  var onClose = function onClose() {\n    controller.run('operation', _assign(_assign({}, props), {\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FocusMode.NORMAL\n    }));\n  };\n\n  var getAllSections = function getAllSections() {\n    var res = [];\n    model.topics.forEach(function (topic, topicKey) {\n      res.push({\n        key: topicKey,\n        title: controller.run('getTopicTitle', _assign(_assign({}, props), {\n          topicKey: topicKey\n        }))\n      });\n    });\n    return res;\n  };\n\n  var navigateToTopic = function navigateToTopic(topicKey) {\n    return function (e) {\n      controller.run('focusTopicAndMoveToCenter', _assign(_assign({}, props), {\n        topicKey: topicKey\n      }));\n    };\n  };\n\n  var renderItem = function renderItem(section, props) {\n    // const pathElements = section.path.reduce<React.ReactChild[]>(\n    //   (elems, el) => {\n    //     elems.push(el, <Icon key={el} icon=\"caret-right\" />);\n    //     return elems;\n    //   },\n    //   []\n    // );\n    var key = section.key,\n        sectionTitle = section.title;\n    var maxLength = 100;\n    var needTip = sectionTitle.length > maxLength;\n    var title = needTip ? sectionTitle.substr(0, maxLength) + '...' : sectionTitle;\n    var titleProps = {\n      key: key,\n      onClick: navigateToTopic(key)\n    };\n    var titleEl = createElement(TopicTitle, _assign({}, titleProps), title);\n    var tip = createElement(Tip, null, createElement(TipContent, null, sectionTitle));\n    var popoverProps = {\n      key: key,\n      target: titleEl,\n      content: tip,\n      fill: true,\n      interactionKind: PopoverInteractionKind.HOVER_TARGET_ONLY,\n      hoverOpenDelay: 1000\n    };\n    return needTip ? createElement(StyledPopover, _assign({}, popoverProps)) : titleEl;\n  };\n\n  var filterMatches = function filterMatches(query, items) {\n    return items.filter(function (item) {\n      return item.title.toLowerCase().includes(query.toLowerCase());\n    });\n  };\n\n  var sections = getAllSections();\n  return createElement(StyledNavOmniBar, {\n    inputProps: INPUT_PROPS,\n    itemListPredicate: filterMatches,\n    isOpen: true,\n    items: sections,\n    itemRenderer: renderItem,\n    // onItemSelect={handleItemSelect}\n    onClose: onClose,\n    resetOnSelect: true\n  });\n}\n\nvar templateObject_1$3, templateObject_2$3, templateObject_3$2, templateObject_4$1, templateObject_5$1;\nvar HOT_KEY_NAME_SEARCH = 'DEFAULT_SEARCH';\nvar FOCUS_MODE_SEARCH = 'FOCUS_MODE_SEARCH';\n\nfunction SearchPlugin() {\n  var setSearchWorld = function setSearchWorld(s) {};\n\n  return {\n    customizeHotKeys: function customizeHotKeys(props, next) {\n      var controller = props.controller,\n          model = props.model;\n      var hotKeys = next();\n      hotKeys.globalHotKeys.set(HOT_KEY_NAME_SEARCH, {\n        label: 'search',\n        combo: 'ctrl + f',\n        onKeyDown: function onKeyDown() {\n          controller.run('operation', _assign(_assign({}, props), {\n            opType: OpType.FOCUS_TOPIC,\n            topicKey: model.focusKey,\n            focusMode: FOCUS_MODE_SEARCH\n          }));\n        }\n      });\n      return hotKeys;\n    },\n    renderDiagramCustomize: function renderDiagramCustomize(props, next) {\n      var res = next();\n      var model = props.model;\n\n      if (model.focusMode === FOCUS_MODE_SEARCH) {\n        var searchPanelProps = _assign(_assign({\n          key: 'search-panel'\n        }, props), {\n          setSearchWorld: setSearchWorld\n        });\n\n        res.push(createElement(SearchPanel, _assign({}, searchPanelProps)));\n      }\n\n      return res;\n    }\n  };\n}\n\nexport { FOCUS_MODE_SEARCH, HOT_KEY_NAME_SEARCH, SearchPlugin, TopicReferencePlugin };","import React from \"react\";\nimport { iconClassName, browserOpenFile } from \"@blink-mind/renderer-react\";\n\nexport function ToolbarItemOpen(props) {\n  const onClickOpenFile = e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n    browserOpenFile(\".json,.blinkmind,.bm\").then(txt => {\n      let obj = JSON.parse(txt);\n      let model = controller.run(\"deserializeModel\", { controller, obj });\n      diagram.openNewModel(model);\n    });\n  };\n  return (\n    <div\n      className={`bm-toolbar-item ${iconClassName(\"openfile\")}`}\n      onClick={onClickOpenFile}\n    />\n  );\n}\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\nfunction isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n}\n/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n\nfunction isObjectObject(o) {\n  return isObject(o) === true && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nfunction isPlainObject(o) {\n  var ctor, prot;\n  if (isObjectObject(o) === false) return false; // If has modified constructor\n\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false; // If has modified prototype\n\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false; // If constructor does not have an Object-specific method\n\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  } // Most likely a plain Object\n\n\n  return true;\n}\n\nexport default isPlainObject;","import debug from 'debug';\nimport memoizeOne from 'memoize-one';\nimport warning from 'tiny-warning';\nimport { List, Record, Map as Map$1 } from 'immutable';\nimport isPlainObject from 'is-plain-object';\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction __values(o) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator],\n      i = 0;\n  if (m) return m.call(o);\n  return {\n    next: function next() {\n      if (o && i >= o.length) o = void 0;\n      return {\n        value: o && o[i++],\n        done: !o\n      };\n    }\n  };\n}\n\nfunction __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) {\n      ar.push(r.value);\n    }\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n}\n\nfunction __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++) {\n    ar = ar.concat(__read(arguments[i]));\n  }\n\n  return ar;\n}\n\nfunction CorePlugin(options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _a = options.plugins,\n      plugins = _a === void 0 ? [] : _a;\n  return __spread(plugins);\n}\n\nvar log = debug('core:controller');\n\nfunction registerPlugin(controller, plugin) {\n  if (Array.isArray(plugin)) {\n    plugin.forEach(function (p) {\n      return registerPlugin(controller, p);\n    });\n    return;\n  }\n\n  if (plugin == null) {\n    return;\n  }\n\n  for (var key in plugin) {\n    var fn = plugin[key];\n    controller.middleware[key] = controller.middleware[key] || [];\n    controller.middleware[key].push(fn);\n  }\n} // modified from koa-compose\n\n\nfunction compose(middleware) {\n  var e_1, _a;\n\n  if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!');\n\n  try {\n    for (var middleware_1 = __values(middleware), middleware_1_1 = middleware_1.next(); !middleware_1_1.done; middleware_1_1 = middleware_1.next()) {\n      var fn = middleware_1_1.value;\n      if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!');\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (middleware_1_1 && !middleware_1_1.done && (_a = middleware_1.return)) _a.call(middleware_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return function (context, next) {\n    // last called middleware #\n    var index = -1;\n    return dispatch(0);\n\n    function dispatch(i) {\n      if (i <= index) throw new Error('next() called multiple times');\n      index = i;\n      var fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return null;\n\n      try {\n        return fn(context, dispatch.bind(null, i + 1));\n      } catch (err) {\n        throw err;\n      }\n    }\n  };\n}\n\nvar Controller = function () {\n  function Controller(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _a = options.plugins,\n        plugins = _a === void 0 ? [] : _a,\n        onChange = options.onChange,\n        readOnly = options.readOnly;\n    this.readOnly = readOnly;\n    this.onChange = onChange;\n    this.middleware = new Map();\n    var corePlugin = CorePlugin({\n      plugins: plugins\n    });\n    registerPlugin(this, corePlugin);\n  }\n\n  Controller.prototype.run = function (key) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    var middleware = this.middleware;\n    var fns = middleware[key] || [];\n    warning(fns.length !== 0, \"the middleware function \" + key + \" is not found!\");\n    var composedFn = memoizeOne(compose)(fns); // @ts-ignore\n\n    return composedFn.apply(void 0, __spread(args));\n  };\n\n  Controller.prototype.getValue = function (propKey, arg) {\n    return this.run('getValue', _assign(_assign({}, arg), {\n      propKey: propKey\n    }));\n  };\n\n  Controller.prototype.change = function (model, callback) {\n    this.onChange(model, callback);\n    this.currentModel = model;\n  };\n\n  return Controller;\n}();\n\nvar TopicDirection = {\n  LEFT: 'L',\n  RIGHT: 'R',\n  BOTTOM: 'B',\n  MAIN: 'M' // root\n\n};\nvar DiagramLayoutType;\n\n(function (DiagramLayoutType) {\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_TO_RIGHT\"] = 0] = \"LEFT_TO_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"RIGHT_TO_LEFT\"] = 1] = \"RIGHT_TO_LEFT\";\n  DiagramLayoutType[DiagramLayoutType[\"LEFT_AND_RIGHT\"] = 2] = \"LEFT_AND_RIGHT\";\n  DiagramLayoutType[DiagramLayoutType[\"TOP_TO_BOTTOM\"] = 3] = \"TOP_TO_BOTTOM\";\n})(DiagramLayoutType || (DiagramLayoutType = {}));\n\nvar TopicVisualLevel = {\n  ROOT: 0,\n  PRIMARY: 1,\n  NORMAL: 2\n};\nvar BlockType = {\n  CONTENT: 'CONTENT',\n  DESC: 'DESC'\n};\nvar FocusMode = {\n  NORMAL: 'NORMAL',\n  EDITING_CONTENT: 'EDITING_CONTENT',\n  EDITING_DESC: 'EDITING_DESC',\n  SHOW_POPUP: 'SHOW_POPUP',\n  DRAGGING: 'DRAGGING'\n};\nvar TopicRelationship = {\n  ANCESTOR: 'ANCESTOR',\n  DESCENDANT: 'DESCENDANT',\n  SIBLING: 'SIBLING',\n  NONE: 'NONE'\n};\nvar OpType = {\n  TOGGLE_COLLAPSE: 'TOGGLE_COLLAPSE',\n  COLLAPSE_ALL: 'COLLAPSE_ALL',\n  EXPAND_ALL: 'EXPAND_ALL',\n  EXPAND_TO: 'EXPAND_TO',\n  ADD_CHILD: 'ADD_CHILD',\n  ADD_SIBLING: 'ADD_SIBLING',\n  DELETE_TOPIC: 'DELETE_TOPIC',\n  FOCUS_TOPIC: 'FOCUS_TOPIC',\n  SET_FOCUS_MODE: 'SET_FOCUS_MODE',\n  SET_STYLE: 'SET_STYLE',\n  SET_THEME: 'SET_THEME',\n  SET_TOPIC_BLOCK: 'SET_TOPIC_BLOCK',\n  DELETE_TOPIC_BLOCK: 'DELETE_TOPIC_BLOCK',\n  // SET_TOPIC_CONTENT: 'SET_TOPIC_CONTENT',\n  // SET_TOPIC_DESC: 'SET_TOPIC_DESC',\n  START_EDITING_CONTENT: 'START_EDITING_CONTENT',\n  START_EDITING_DESC: 'START_EDITING_DESC',\n  DRAG_AND_DROP: 'DRAG_AND_DROP',\n  SET_EDITOR_ROOT: 'SET_EDITOR_ROOT'\n};\n\nfunction createKey() {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = Math.random() * 16 | 0,\n        v = c === 'x' ? r : r & 0x3 | 0x8;\n    return v.toString(16);\n  });\n}\n\nvar defaultBlockRecord = {\n  type: null,\n  key: null,\n  data: null\n};\n\nvar Block = function (_super) {\n  __extends(Block, _super);\n\n  function Block() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(Block.prototype, \"data\", {\n    get: function get() {\n      return this.get('data');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Block.prototype, \"type\", {\n    get: function get() {\n      return this.get('type');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Block.create = function (obj) {\n    return new Block(obj);\n  };\n\n  Block.createList = function (obj) {\n    if (List.isList(obj) || Array.isArray(obj)) {\n      // @ts-ignore\n      return List(obj.map(Block.create));\n    }\n\n    throw new Error(\"Block.createList only accepts Array or List, but you passed it: \" + obj);\n  };\n\n  return Block;\n}(Record(defaultBlockRecord));\n\nvar defaultTopicRecord = {\n  key: null,\n  parentKey: null,\n  collapse: false,\n  subKeys: null,\n  blocks: null,\n  relations: null,\n  style: null\n};\n\nvar Topic = function (_super) {\n  __extends(Topic, _super);\n\n  function Topic() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(Topic.prototype, \"key\", {\n    get: function get() {\n      return this.get('key');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"parentKey\", {\n    get: function get() {\n      return this.get('parentKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"collapse\", {\n    get: function get() {\n      return this.get('collapse');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"subKeys\", {\n    get: function get() {\n      return this.get('subKeys');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"blocks\", {\n    get: function get() {\n      return this.get('blocks');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"relations\", {\n    get: function get() {\n      return this.get('relations');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Topic.prototype, \"style\", {\n    get: function get() {\n      return this.get('style');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Topic.prototype.getBlock = function (type) {\n    var index = this.blocks.findIndex(function (b) {\n      return b.type === type;\n    });\n    if (index === -1) return {\n      index: index,\n      block: null\n    };\n    return {\n      index: index,\n      block: this.blocks.get(index)\n    };\n  };\n\n  Topic.fromJSON = function (obj) {\n    var key = obj.key,\n        _a = obj.parentKey,\n        parentKey = _a === void 0 ? null : _a,\n        blocks = obj.blocks,\n        _b = obj.subKeys,\n        subKeys = _b === void 0 ? [] : _b,\n        _c = obj.collapse,\n        collapse = _c === void 0 ? false : _c;\n    return new Topic({\n      key: key,\n      parentKey: parentKey,\n      collapse: collapse,\n      subKeys: List(subKeys),\n      blocks: Block.createList(blocks)\n    });\n  };\n\n  Topic.create = function (_a) {\n    var key = _a.key,\n        _b = _a.parentKey,\n        parentKey = _b === void 0 ? null : _b,\n        _c = _a.content,\n        content = _c === void 0 ? '' : _c,\n        _d = _a.subKeys,\n        subKeys = _d === void 0 ? [] : _d,\n        _e = _a.collapse,\n        collapse = _e === void 0 ? false : _e;\n    var block = Block.create({\n      type: BlockType.CONTENT,\n      data: content,\n      key: null\n    });\n    var blocks = List([block]);\n    return new Topic({\n      key: key,\n      parentKey: parentKey,\n      blocks: blocks,\n      subKeys: List(subKeys),\n      collapse: collapse\n    });\n  };\n\n  return Topic;\n}(Record(defaultTopicRecord));\n\nfunction getAllSubTopicKeys(model, topicKey) {\n  var item = model.getTopic(topicKey);\n  var res = [];\n\n  if (item.subKeys.size > 0) {\n    var subKeys = item.subKeys.toArray();\n    res.push.apply(res, __spread(subKeys));\n    res = subKeys.reduce(function (acc, key) {\n      acc.push.apply(acc, __spread(getAllSubTopicKeys(model, key)));\n      return acc;\n    }, res);\n  }\n\n  return res;\n}\n\nfunction getKeyPath(model, topicKey, reverse) {\n  if (reverse === void 0) {\n    reverse = false;\n  }\n\n  var res = [topicKey];\n  var item = model.getTopic(topicKey);\n\n  while (item.parentKey) {\n    reverse ? res.push(item.parentKey) : res.unshift(item.parentKey);\n    item = model.getParentTopic(item.key);\n  }\n\n  return res;\n}\n\nfunction getRelationship(model, srcKey, dstKey) {\n  var srcTopic = model.getTopic(srcKey);\n  var dstTopic = model.getTopic(dstKey);\n\n  if (srcTopic && dstTopic) {\n    if (srcTopic.parentKey == dstTopic.parentKey) return TopicRelationship.SIBLING;\n    var pTopic = srcTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === dstTopic.key) return TopicRelationship.DESCENDANT;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n\n    pTopic = dstTopic;\n\n    while (pTopic.parentKey) {\n      if (pTopic.parentKey === srcTopic.key) return TopicRelationship.ANCESTOR;\n      pTopic = model.getParentTopic(pTopic.key);\n    }\n  }\n\n  return TopicRelationship.NONE;\n}\n\nvar log$1 = debug('modifier');\n\nfunction toggleCollapse(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  var topic = model.getTopic(topicKey);\n\n  if (topic && topic.subKeys.size !== 0) {\n    topic = topic.merge({\n      collapse: !topic.collapse\n    });\n    model = model.updateIn(['topics', topic.key, 'collapse'], function (collapse) {\n      return !collapse;\n    });\n  }\n\n  model = focusTopic({\n    model: model,\n    topicKey: topicKey,\n    focusMode: FocusMode.NORMAL\n  });\n  return model;\n}\n\nfunction collapseAll(_a) {\n  var model = _a.model;\n  log$1('collapseAll');\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log$1(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], true);\n    });\n  });\n  log$1(model);\n  return model;\n}\n\nfunction expandAll(_a) {\n  var model = _a.model;\n  var topicKeys = getAllSubTopicKeys(model, model.editorRootTopicKey);\n  log$1(model);\n  model = model.withMutations(function (m) {\n    topicKeys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  });\n  log$1(model);\n  return model;\n}\n\nfunction expandTo(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  var keys = getKeyPath(model, topicKey).filter(function (t) {\n    return t !== topicKey;\n  });\n  model = model.withMutations(function (m) {\n    keys.forEach(function (topicKey) {\n      m.setIn(['topics', topicKey, 'collapse'], false);\n    });\n  }); // \n\n  if (getRelationship(model, topicKey, model.editorRootTopicKey) !== TopicRelationship.DESCENDANT) {\n    model = model.set('editorRootTopicKey', model.rootTopicKey);\n  }\n\n  return model;\n}\n\nfunction focusTopic(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      focusMode = _a.focusMode;\n  log$1('focus topic');\n  if (topicKey !== model.focusKey) model = model.set('focusKey', topicKey);\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction setFocusMode(_a) {\n  var model = _a.model,\n      focusMode = _a.focusMode;\n  log$1('setFocusMode');\n  if (focusMode !== model.focusMode) model = model.set('focusMode', focusMode);\n  return model;\n}\n\nfunction addChild(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  log$1('addChild:', topicKey);\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var child_1 = Topic.create({\n      key: createKey(),\n      parentKey: topic.key\n    });\n    topic = topic.set('collapse', false).update('subKeys', function (subKeys) {\n      return subKeys.push(child_1.key);\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(topicKey, topic).set(child_1.key, child_1);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: child_1.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction addSibling(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  if (topicKey === model.rootTopicKey) return model;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var pItem = model.getTopic(topic.parentKey);\n    var idx_1 = pItem.subKeys.indexOf(topicKey);\n    var sibling_1 = Topic.create({\n      key: createKey(),\n      parentKey: pItem.key\n    });\n    model = model.update('topics', function (topics) {\n      return topics.set(sibling_1.key, sibling_1);\n    }).updateIn(['topics', pItem.key, 'subKeys'], function (subKeys) {\n      return subKeys.insert(idx_1 + 1, sibling_1.key);\n    });\n    return focusTopic({\n      model: model,\n      topicKey: sibling_1.key,\n      focusMode: FocusMode.EDITING_CONTENT\n    });\n  }\n\n  return model;\n}\n\nfunction deleteTopic(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  if (topicKey === model.editorRootTopicKey) return model;\n  var item = model.getTopic(topicKey);\n\n  if (item) {\n    model = model.withMutations(function (m) {\n      m.update('topics', function (topics) {\n        topics = topics.delete(topicKey);\n        var deleteKeys = getAllSubTopicKeys(model, topicKey);\n        topics = topics.withMutations(function (t) {\n          deleteKeys.forEach(function (dKey) {\n            t.delete(dKey);\n          });\n        });\n        return topics;\n      });\n      m.updateIn(['topics', item.parentKey, 'subKeys'], function (subKeys) {\n        return subKeys.delete(subKeys.indexOf(topicKey));\n      });\n      if (m.focusKey === topicKey) m.set('focusKey', null).set('focusMode', null);\n    });\n  }\n\n  return model;\n}\n/**\r\n * setBlockData of one topic\r\n * @param model\r\n * @param topicKey\r\n * @param blockType\r\n * @param focusMode\r\n * @param data\r\n */\n\n\nfunction setBlockData(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      blockType = _a.blockType,\n      focusMode = _a.focusMode,\n      data = _a.data;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var _b = topic.getBlock(blockType),\n        index = _b.index,\n        block = _b.block;\n\n    if (index === -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.push(Block.create({\n          type: blockType,\n          data: data\n        }));\n      });\n    } else {\n      if (block.data !== data) {\n        model = model.updateIn(['topics', topicKey, 'blocks', index, 'data'], function (dt) {\n          return data;\n        });\n      }\n    }\n\n    if (focusMode) {\n      model = focusTopic({\n        model: model,\n        topicKey: topicKey,\n        focusMode: focusMode\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction deleteBlock(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      blockType = _a.blockType;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    var index_1 = topic.getBlock(blockType).index;\n\n    if (index_1 !== -1) {\n      model = model.updateIn(['topics', topicKey, 'blocks'], function (blocks) {\n        return blocks.delete(index_1);\n      });\n    }\n\n    model = focusTopic({\n      model: model,\n      topicKey: null,\n      focusMode: null\n    });\n  }\n\n  return model;\n}\n\nfunction setStyle(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey,\n      style = _a.style;\n  var topic = model.getTopic(topicKey);\n\n  if (topic) {\n    if (style !== topic.style) {\n      model = model.updateIn(['topics', topicKey, 'style'], function (s) {\n        return style;\n      });\n    }\n  }\n\n  return model;\n}\n\nfunction setTheme(_a) {\n  var model = _a.model,\n      theme = _a.theme;\n  model = model.setIn(['config', 'theme'], theme);\n  return model;\n}\n\nfunction setLayoutDir(_a) {\n  var model = _a.model,\n      layoutDir = _a.layoutDir;\n  if (model.config.layoutDir === layoutDir) return model;\n  model = model.setIn(['config', 'layoutDir'], layoutDir);\n  return model;\n}\n\nfunction setEditorRootTopicKey(_a) {\n  var model = _a.model,\n      topicKey = _a.topicKey;\n  if (model.editorRootTopicKey !== topicKey) model = model.set('editorRootTopicKey', topicKey);\n  if (model.getTopic(topicKey).collapse) model = model.setIn(['topics', topicKey, 'collapse'], false);\n  return model;\n}\n\nfunction setZoomFactor(_a) {\n  var model = _a.model,\n      zoomFactor = _a.zoomFactor;\n  if (model.zoomFactor !== zoomFactor) model = model.set('zoomFactor', zoomFactor);\n  return model;\n}\n\nvar modifiers = {\n  addChild: addChild,\n  addSibling: addSibling,\n  toggleCollapse: toggleCollapse,\n  collapseAll: collapseAll,\n  expandAll: expandAll,\n  expandTo: expandTo,\n  focusTopic: focusTopic,\n  setFocusMode: setFocusMode,\n  deleteTopic: deleteTopic,\n  setBlockData: setBlockData,\n  deleteBlock: deleteBlock,\n  setStyle: setStyle,\n  setTheme: setTheme,\n  setLayoutDir: setLayoutDir,\n  setEditorRootTopicKey: setEditorRootTopicKey,\n  setZoomFactor: setZoomFactor\n};\n\nfunction isThemeType(obj) {\n  return obj.name != null && obj.background != null && obj.highlightColor != null;\n}\n\nvar defaultTheme = {\n  name: 'default',\n  randomColor: true,\n  background: 'rgb(57,60,65)',\n  highlightColor: '#50C9CE',\n  marginH: 60,\n  marginV: 20,\n  contentStyle: {\n    lineHeight: '1.5'\n  },\n  linkStyle: {\n    lineRadius: 5,\n    lineType: 'curve',\n    lineWidth: '3px'\n  },\n  rootTopic: {\n    contentStyle: {\n      fontSize: '34px',\n      borderRadius: '35px',\n      padding: '16px 18px 16px 18px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  primaryTopic: {\n    contentStyle: {\n      borderWidth: '1px',\n      borderStyle: 'solid',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '10px 15px 10px 15px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'rgb(113, 203, 45)'\n    }\n  },\n  normalTopic: {\n    contentStyle: {\n      border: '1px solid #e8eaec',\n      borderRadius: '20px',\n      fontSize: '17px',\n      padding: '4px 10px'\n    },\n    subLinkStyle: {\n      lineType: 'curve',\n      lineWidth: '3px',\n      lineColor: 'white'\n    }\n  }\n};\nvar defaultConfigRecord = {\n  readOnly: false,\n  allowUndo: true,\n  layoutDir: DiagramLayoutType.LEFT_AND_RIGHT,\n  theme: defaultTheme\n};\n\nvar Config = function (_super) {\n  __extends(Config, _super);\n\n  function Config() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Object.defineProperty(Config.prototype, \"layoutDir\", {\n    get: function get() {\n      return this.get('layoutDir');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Config.prototype, \"readOnly\", {\n    get: function get() {\n      return this.get('readOnly');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Config.prototype, \"allowUndo\", {\n    get: function get() {\n      return this.get('allowUndo');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Config.prototype, \"theme\", {\n    get: function get() {\n      return this.get('theme');\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Config.fromJSON = function (obj) {\n    return new Config(obj);\n  };\n\n  return Config;\n}(Record(defaultConfigRecord));\n\nvar defaultModelRecord = {\n  topics: Map$1(),\n  extData: Map$1(),\n  config: null,\n  rootTopicKey: null,\n  editorRootTopicKey: null,\n  focusKey: null,\n  focusMode: null,\n  formatVersion: null,\n  zoomFactor: 1\n};\n\nvar Model = function (_super) {\n  __extends(Model, _super);\n\n  function Model() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Model.isModel = function (obj) {\n    return obj instanceof Model;\n  };\n\n  Model.create = function (attrs) {\n    if (attrs === void 0) {\n      attrs = null;\n    }\n\n    if (attrs == null) return Model.createEmpty();\n    var res;\n\n    if (Model.isModel(attrs)) {\n      res = attrs;\n    }\n\n    if (isPlainObject(attrs)) {\n      res = Model.fromJSON(attrs);\n    }\n\n    if (res) {\n      if (res.focusKey == null) {\n        res = res.set('focusKey', res.rootTopicKey);\n      }\n\n      if (res.focusMode == null) {\n        res = res.set('focusMode', FocusMode.NORMAL);\n      }\n\n      return res;\n    }\n\n    throw new Error(\"`Value.create` only accepts objects or values, but you passed it: \" + attrs);\n  };\n\n  Model.createEmpty = function () {\n    var model = new Model();\n    var rootTopic = Topic.create({\n      key: createKey()\n    });\n    return model.update('topics', function (topics) {\n      return topics.set(rootTopic.key, rootTopic);\n    }).set('rootTopicKey', rootTopic.key).set('focusKey', rootTopic.key).set('focusMode', FocusMode.NORMAL);\n  };\n\n  Model.fromJSON = function (object) {\n    var model = new Model();\n    var _a = object.topics,\n        topics = _a === void 0 ? [] : _a,\n        _b = object.config,\n        config = _b === void 0 ? {} : _b,\n        rootTopicKey = object.rootTopicKey;\n    var editorRootTopicKey = object.editorRootTopicKey;\n    if (editorRootTopicKey === undefined) editorRootTopicKey = rootTopicKey;\n    model = model.merge({\n      rootTopicKey: rootTopicKey,\n      editorRootTopicKey: editorRootTopicKey\n    });\n    model = model.withMutations(function (model) {\n      topics.forEach(function (topic) {\n        model.update('topics', function (topics) {\n          return topics.set(topic.key, Topic.fromJSON(topic));\n        });\n      });\n      model.set('config', Config.fromJSON(config));\n    });\n    return model;\n  };\n\n  Model.prototype.toJS = function () {\n    var obj = {\n      rootTopicKey: this.rootTopicKey,\n      topics: Object.values(this.topics.toJS()),\n      config: this.config,\n      extData: this.extData,\n      zoomFactor: this.zoomFactor\n    };\n    return obj;\n  };\n\n  Object.defineProperty(Model.prototype, \"extData\", {\n    get: function get() {\n      return this.get('extData');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"topics\", {\n    get: function get() {\n      return this.get('topics');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"config\", {\n    get: function get() {\n      return this.get('config');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"formatVersion\", {\n    get: function get() {\n      return this.get('formatVersion');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"rootTopicKey\", {\n    get: function get() {\n      return this.get('rootTopicKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"editorRootTopicKey\", {\n    get: function get() {\n      return this.get('editorRootTopicKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"focusKey\", {\n    get: function get() {\n      return this.get('focusKey');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"focusMode\", {\n    get: function get() {\n      return this.get('focusMode');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"editingContentKey\", {\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_CONTENT ? this.focusKey : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"editingDescKey\", {\n    get: function get() {\n      return this.focusMode === FocusMode.EDITING_DESC ? this.focusKey : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Model.prototype.getTopic = function (key) {\n    return this.topics.get(key);\n  };\n\n  Model.prototype.getExtDataItem = function (key, c) {\n    return this.extData.get(key) || new c();\n  };\n\n  Model.prototype.getParentTopic = function (key) {\n    var topic = this.getTopic(key);\n    return topic.parentKey ? this.getTopic(topic.parentKey) : null;\n  };\n\n  Model.prototype.getTopicVisualLevel = function (key) {\n    var topic = this.getTopic(key);\n    var level = 0;\n\n    while (topic && topic.key !== this.editorRootTopicKey) {\n      level++;\n      topic = this.getParentTopic(topic.key);\n    }\n\n    return level;\n  };\n\n  Object.defineProperty(Model.prototype, \"rootTopic\", {\n    get: function get() {\n      return this.getTopic(this.rootTopicKey);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Model.prototype, \"zoomFactor\", {\n    get: function get() {\n      return this.get('zoomFactor');\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return Model;\n}(Record(defaultModelRecord));\n\nexport { Block, BlockType, Config, Controller, DiagramLayoutType, FocusMode, Model, modifiers as ModelModifier, modifiers as Modifiers, OpType, Topic, TopicDirection, TopicRelationship, TopicVisualLevel, createKey, defaultTheme, getAllSubTopicKeys, getKeyPath, getRelationship, isThemeType };","import React from \"react\";\nimport { DiagramLayoutType } from \"@blink-mind/core\";\nimport cx from \"classnames\";\nimport { Icon, iconClassName } from \"@blink-mind/renderer-react\";\nimport { Menu, MenuItem, Popover } from \"@blueprintjs/core\";\n\nexport function ToolbarItemLayout(props) {\n  const layoutDirs = [\n    [\n      DiagramLayoutType.LEFT_AND_RIGHT,\n      \"Left And Right\",\n      \"layout-left-and-right\"\n    ],\n    [DiagramLayoutType.LEFT_TO_RIGHT, \"Only Right\", \"layout-right\"],\n    [DiagramLayoutType.RIGHT_TO_LEFT, \"Only Left\", \"layout-left\"]\n  ];\n\n  const onClickSetLayout = layoutDir => e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n    controller.run(\"setLayoutDir\", { ...diagramProps, layoutDir });\n  };\n\n  return (\n    <div\n      className={cx(\"bm-toolbar-item\", iconClassName(\"layout-left-and-right\"))}\n    >\n      <Popover enforceFocus={false}>\n        <div className=\"bm-toolbar-popover-target\" />\n        <Menu>\n          {layoutDirs.map(dir => (\n            <MenuItem\n              key={dir[1]}\n              icon={Icon(dir[2])}\n              text={dir[1]}\n              onClick={onClickSetLayout(dir[0])}\n            />\n          ))}\n        </Menu>\n      </Popover>\n    </div>\n  );\n};\n","import defaultThemeImg from \"../../images/default.jpg\";\nimport theme1Img from \"../../images/theme1.jpg\";\nimport theme2Img from \"../../images/theme2.jpg\";\nimport theme3Img from \"../../images/theme3.jpg\";\nimport theme4Img from \"../../images/theme4.jpg\";\nimport cx from \"classnames\";\nimport { iconClassName } from \"@blink-mind/renderer-react\";\nimport { Popover } from \"@blueprintjs/core\";\nimport React from \"react\";\n\nexport function ToolbarItemTheme(props) {\n  const onClickSetTheme = themeKey => e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n    controller.run(\"setTheme\", { ...diagramProps, themeKey });\n  };\n  const themes = [\n    [\"default\", defaultThemeImg],\n    [\"theme1\", theme1Img],\n    [\"theme2\", theme2Img],\n    [\"theme3\", theme3Img],\n    [\"theme4\", theme4Img]\n  ];\n\n  return (\n    <div className={cx(\"bm-toolbar-item\", iconClassName(\"theme\"))}>\n      <Popover enforceFocus={false}>\n        <div className=\"bm-toolbar-popover-target\" />\n        <div className=\"bm-popover-theme\">\n          {themes.map(theme => (\n            <div\n              key={theme[0]}\n              className=\"bm-theme-item\"\n              onClick={onClickSetTheme(theme[0])}\n            >\n              <img className=\"bm-theme-img\" src={theme[1]} alt={theme[0]} />\n            </div>\n          ))}\n        </div>\n      </Popover>\n    </div>\n  );\n}\n","import cx from \"classnames\";\nimport { iconClassName } from \"@blink-mind/renderer-react\";\nimport { Menu, MenuDivider, MenuItem, Popover } from \"@blueprintjs/core\";\nimport React from \"react\";\nimport { downloadFile } from \"../../utils\";\n\nexport function ToolbarItemExport(props) {\n  const onClickExportJson = e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller, model } = diagramProps;\n\n    const json = controller.run(\"serializeModel\", diagramProps);\n    const jsonStr = JSON.stringify(json);\n    const url = `data:text/plain,${encodeURIComponent(jsonStr)}`;\n    const title = controller.run(\"getTopicTitle\", {\n      ...diagramProps,\n      topicKey: model.rootTopicKey\n    });\n    downloadFile(url, `${title}.blinkmind`);\n  };\n\n  return (\n    <div className={cx(\"bm-toolbar-item\", iconClassName(\"export\"))}>\n      <Popover enforceFocus={false}>\n        <div className=\"bm-toolbar-popover-target\" />\n        <Menu>\n          <MenuItem text=\"JSON(.json)\" onClick={onClickExportJson} />\n          <MenuDivider />\n        </Menu>\n      </Popover>\n    </div>\n  );\n}\n","import { Model } from \"@blink-mind/core\";\n\nexport const downloadFile = (url, filename) => {\n    const link = document.createElement(\"a\");\n    link.href = url;\n    link.download = filename;\n    link.click();\n};\n\nexport function generateSimpleModel() {\n\n    return Model.create({\n        \"rootTopicKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n        \"editorRootTopicKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n        \"focusKey\": null,\n        \"extData\": {\n            \"TOPIC_REFERENCE\": {\n                \"reference\": {}\n            }\n        },\n        \"topics\": [\n            {\n                \"key\": \"1f66701b-72a2-45be-abad-d14ba71a78e0\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Functional\\nProgramming\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"1c417f10-9197-42eb-a724-a2c99a488847\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"forEach\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"9b52509a-42df-4ba8-9200-29ec192e314a\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                    \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                    \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Data\\nStructures\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"af8c79c0-2a79-40e8-a7ff-5edf08399e5b\",\n                \"parentKey\": \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"get\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"4567082c-b57b-45f4-8c04-168f9a2f123f\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [\n                    \"f548ba3e-55f6-484d-8289-858f8fd28289\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Boolean\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The boolean type has only two values: **true** and **false**\\n\\n```\\nconsole.log(typeof(true)); // \\\"boolean\\\"\\nconsole.log(typeof(false)); // \\\"boolean\\\"\\n\\n```\\n\\n```\\nlet nameFieldChecked = true;\\nlet ageFieldChecked = false;\\n\\nconsole.log(\\\"Name field checked: \\\", nameFieldChecked, \\\" and \\\" , \\\"Age field checked: \\\", ageFieldChecked);\\n// Name field checked:  true  and  Age field checked:  false\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a1649782-ec29-4030-bb2d-d6044103cf10\",\n                \"parentKey\": \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                \"subKeys\": [\n                    \"dfb39c55-dfce-4d5a-88a7-5fd066288121\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Function\\nexpression\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A **function expression** is determined by a function keyword, followed by an optional function name \\\\(anonymous\\\\), a list of parameters in a pair of parenthesis \\\\(para1, ..., paramN\\\\) and a pair of curly braces \\\\{ ... \\\\} that delimits the body code.\\n\\n**Syntax:**\\n```\\nconst exp = function functionName(params1, params2) {\\n    statements;\\n}\\n\\n```\\n\\n**example 1: named function**\\n```\\nconst count = function arrayLength(array) {\\n  return array.length;\\n}\\n\\ncount([5, 7, 8]); // output: \\\"3\\\"\\narrayLength([5, 7, 8]); // ReferenceError: arrayLength is not defined\\n\\n```\\n\\n**example 2: anonymous function**\\n```\\nconst count = function(array) {\\n  return array.length;\\n}\\n\\ncount([5, 7, 8]); // output: \\\"3\\\"\\n\\n```\\n\\n**example 3: Error stack trace**\\n```\\n// Ex 1:\\nconst count = function arrayLength(array) {\\n    throw new Error(\\\"Custom error\\\")\\n}\\n\\ncount([5, 7, 8]);\\n\\nError: Custom error\\n    at arrayLength (/Users/git/other/js/programming-basics/test.js:2:11)\\n    at Object.<anonymous> (/Users/git/other/js/programming-basics/test.js:5:1)\\n    at Module._compile (node:internal/modules/cjs/loader:1101:14)\\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1153:10)\\n    at Module.load (node:internal/modules/cjs/loader:981:32)\\n    at Function.Module._load (node:internal/modules/cjs/loader:822:12)\\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:79:12)\\n    at node:internal/main/run_main_module:17:47\\n\\n// Ex 2:    \\nconst count = function (array) {\\n    throw new Error(\\\"Custom error\\\")\\n}\\n\\ncount([5, 7, 8]);\\n\\nError: Custom error\\n    at count (/Users/git/other/js/programming-basics/test.js:2:11)\\n    at Object.<anonymous> (/Users/git/other/js/programming-basics/test.js:5:1)\\n    at Module._compile (node:internal/modules/cjs/loader:1101:14)\\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1153:10)\\n    at Module.load (node:internal/modules/cjs/loader:981:32)\\n    at Function.Module._load (node:internal/modules/cjs/loader:822:12)\\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:79:12)\\n    at node:internal/main/run_main_module:17:47\\n\\n```\\nOne of the benefits of creating a named function expression is that in case we encountered an error, the stack trace will contain the name of the function, making it easier to find the origin of the error.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"c0743415-e5c5-48da-a6ec-a2d0571da863\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Errors\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"9677e53a-05a4-4bd6-9010-f10826426bb6\",\n                \"parentKey\": \"3854fdd8-7de4-429c-b73d-2519cbf63781\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"else If Statement\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**if** statement can be extended with an **else if** statement, which adds another conditional with its own block, it is a way to chain on extra choices/outcomes.\\n\\n**Syntax:**\\n```\\nif (condition) {\\n     // when condition is true this block will be executed\\n     // no futher conditions will be checked\\n} else if (condition) {\\n      // when a previous block condition has been failed\\n      // this(else if) block condition is evaluted\\n      // when a condition passed this block will be executed\\n} else {\\n      //when all condition has been failed this block will be executed\\n}\\n\\n```\\n\\n**example:**\\n```\\nif (false) {\\n      console.log(\\\"if blocked executed\\\");\\n} else if (2 < 5 && 3 < 5 ) {\\n      console.log(\\\"else if blocked executed\\\");\\n} else {\\n      console.log(\\\"else blocked executed\\\");\\n}\\n\\n// Output - \\\"else if blocked executed\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"7662833c-7ece-4668-a37b-4e11820503b4\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [\n                    \"9c9627b1-6bba-4135-955e-608e6a937ed1\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Function scope\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**Function Scope** \\\\- A function in JavaScript defines a scope for variables declared using **var**, **let** and **const**.\\n\\n**Example 1:**\\n```\\nfunction run() {\\n  // \\\"run\\\" function scope\\n  var message = 'Run, Forrest, Run!';\\n  console.log(message); // 'Run, Forrest, Run!'\\n}\\n\\nrun();\\nconsole.log(message); // throws ReferenceError\\n\\n```\\n**run\\\\(\\\\)** function body creates a scope. The variable message is accessible inside of the function scope, but inaccessible outside.\\n\\n**Exmaple 2:**\\n```\\nfunction run() {\\n  // \\\"run\\\" function scope\\n  const two = 2;\\n  let count = 0;\\n  function run2() {}\\n\\n  console.log(two);   // 2\\n  console.log(count); // 0\\n  console.log(run2);  // function\\n}\\n\\nrun();\\nconsole.log(two);   // throws ReferenceError\\nconsole.log(count); // throws ReferenceError\\nconsole.log(run2);  // throws ReferenceError\\n\\n```\\n\\n**Exmaple 3**: Var is **functional\\\\-scoped**\\n```\\nvar fullMoon = true;\\n\\n// Use var to initialize a variable\\nvar species = \\\"human\\\";\\n\\nif (fullMoon) {\\n  // Attempt to create a new variable in a block\\n  var species = \\\"werewolf\\\";\\n  console.log(`${species}.`); // werewolf\\n}\\n\\nconsole.log(`${species}.`); // werewolf\\n\\n```\\nBoth the **global variable** and the **block\\\\-scoped variable** end up with the same value, **werewolf**. This is because instead of creating a new local variable with var, it is reassigning the same variable in the same scope.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"91f27dd0-5185-4daa-8501-15ba8727dc06\",\n                \"parentKey\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"for .. each\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **forEach\\\\(\\\\)** method executes a provided function once for each array element \\\\(will see more of this in detail in Array & methods\\\\)\\n\\n**example 1:**\\n```\\nconst array = [1, 2, 3, { id: 254, name: \\\"Chris\\\" }]\\n\\narray[5] = 5\\narray[-6] = 6;\\narray[\\\"name\\\"] = \\\"Lars\\\"\\n\\narray.forEach(value => console.log(`Value: ${value}`));\\n\\n// Output:\\n// Value: 1\\n// Value: 2\\n// Value: 3\\n// Value: [object Object]\\n// Value: 5\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"8d03fe66-9d8f-4ae3-96c1-d18220788b3a\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"pop\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"c1e621c4-ae65-40d0-ad48-650368d181d0\",\n                \"parentKey\": \"29f23365-fcf6-4f8f-8060-811df84e4770\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"d4cb9863-ba6c-4ea6-903e-44accf4a5b7b\",\n                    \"29f23365-fcf6-4f8f-8060-811df84e4770\",\n                    \"a3055667-8217-484e-aae8-728cab93135c\",\n                    \"91f27dd0-5185-4daa-8501-15ba8727dc06\",\n                    \"65199906-ca55-4ae8-bd9f-a4a08cbc2432\",\n                    \"a70b7d9d-ea0f-49c3-a488-ddbceebe85d8\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Loops\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A loop is a sequence of instructions that is **continually repeated** until a certain condition is met. An example would be the process of getting an item of data and changing it, and then making sure some condition is checked such as, if a counter has reached a prescribed number.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"dbc9a664-bff0-4263-811c-cb91470ce277\",\n                \"parentKey\": \"2c6ddd66-98a5-4410-b7f2-dbd42aaa7e01\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Object\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**Object** : typeof instance === \\\"object\\\". It is used to store collections of data and more complex entities.\\n\\n```\\nconsole.log(typeof({})); // \\\"object\\\"\\nconsole.log(typeof([])); // \\\"object\\\" - Arrays arent primitive, they are objects\\nconsole.log(typeof(new Map())); // \\\"object\\\"\\nconsole.log(typeof(new Date())); // \\\"object\\\"\\n\\n```\\n\\nSpecial non\\\\-data but Structural type for any constructed object instance also used as data structures: \\n1. new Object, \\n1. new Array, \\n1. new Map, \\n1. new Set, \\n1. new WeakMap, \\n1. new WeakSet, \\n1. new Date and almost everything made with **new** keyword;\\n\\n\\n**Indexed collections**: Arrays and typed Arrays\\n**Keyed collections**: Maps, Sets, WeakMaps, WeakSets\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"277f12bf-6cef-4676-92bb-ee233886e4cb\",\n                \"parentKey\": \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Class\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a70b7d9d-ea0f-49c3-a488-ddbceebe85d8\",\n                \"parentKey\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"do while\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**do\\\\-while** loop will always be executed at least once, even if the condition is false, because the code block is executed before the condition is checked.\\n\\n```\\nlet i = 10;\\ndo {\\n  console.log(\\\"The number is \\\" + i);\\n  i++;\\n}\\nwhile (i < 5);\\n\\n// output: \\\"The number is 10\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"88317110-d644-4ca9-84bf-01ae778571da\",\n                \"parentKey\": \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"entries\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"fa03906c-9682-4352-98eb-3a4525a5780c\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"filter\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"f9aad4c2-5205-49ec-a74c-ed04c3bb6813\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"push\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"d4cb9863-ba6c-4ea6-903e-44accf4a5b7b\",\n                \"parentKey\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"for\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **for** loop repeats a block of code as long as a certain condition is met. It is typically used to execute a block of code for certain number of times.\\n\\n**Syntax:**\\n```\\nfor(initialization; condition; final-expression) {\\n    // Code to be executed\\n}\\n\\n```\\n\\n* **initialization**  it is used to initialize the counter variables, and evaluated once unconditionally before the first execution of the body of the loop.\\n* **condition**  it is evaluated at the beginning of each iteration. If it evaluates to true, the loop statements execute. If it evaluates to false, the execution of the loop ends.\\n* **final\\\\-expression**  this is always evaluated \\\\(or run\\\\) each time the loop has gone through a full iteration. It usually serves to increment \\\\(or in some cases decrement\\\\) the counter variable.\\n\\n\\n**example 1**:\\n```\\nfor (let i = 0; i < 10; i++) {\\n  console.log(\\\"The number is \\\" + i);\\n}\\n\\n// Output:\\n// \\\"The number is 0\\\"\\n// \\\"The number is 1\\\"\\n// \\\"The number is 2\\\"\\n// \\\"The number is 3\\\"\\n// \\\"The number is 4\\\"\\n// \\\"The number is 5\\\"\\n// \\\"The number is 6\\\"\\n// \\\"The number is 7\\\"\\n// \\\"The number is 8\\\"\\n// \\\"The number is 9\\\"\\n\\n```\\n\\n**example 2: **skipping current execution of loop using **continue** statement\\n```\\nfor (let i = 0; i < 10; i++) {\\n  if(i%2===0){\\n    continue;\\n  }\\n  console.log(\\\"The number is \\\" + i);\\n}\\n\\n// Output:\\n// \\\"The number is 1\\\"\\n// \\\"The number is 3\\\"\\n// \\\"The number is 5\\\"\\n// \\\"The number is 7\\\"\\n// \\\"The number is 9\\\"\\n\\n```\\n\\n**example 3**: terminating current execution flow of the loop using **break** statement\\n```\\nfor (let i = 0; i < 10; i++) {\\n  if(i===5){\\n    break;\\n  }\\n  console.log(\\\"The number is \\\" + i);\\n}\\n\\n// Output:\\n// \\\"The number is 0\\\"\\n// \\\"The number is 1\\\"\\n// \\\"The number is 2\\\"\\n// \\\"The number is 3\\\"\\n// \\\"The number is 4\\\"\\n\\n```\\n\\n**example 4: **following example is valid js code\\n```\\nfor (; ;) {\\n    console.log(\\\"Infinite loop - 'JavaScript heap out of memory' it is what you get when you run\\\");\\n}\\n\\n```\\n\\n**example 5: **And it iterates over by **positive numeric index**.\\n```\\nconst array = [1, 2, 3, { id: 254, name: \\\"Chris\\\" }]\\n\\narray[5] = 5\\narray[-6] = 6;\\narray[\\\"name\\\"] = \\\"Lars\\\"\\n\\nfor (let index = 0; index < array.length; index++)\\n    console.log(`Index: ${index} & Value: ${array[index]}`);\\n\\n// Output:\\n//Index: 0 & Value: 1\\n//Index: 1 & Value: 2\\n//Index: 2 & Value: 3\\n//Index: 3 & Value: [object Object]\\n//Index: 4 & Value: undefined\\n//Index: 5 & Value: 5     \\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"parentKey\": null,\n                \"subKeys\": [\n                    \"44213600-22aa-4972-aa99-eec27b840064\",\n                    \"252c6937-bd93-4233-90cb-333938667c72\",\n                    \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                    \"3854fdd8-7de4-429c-b73d-2519cbf63781\",\n                    \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                    \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                    \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                    \"9b52509a-42df-4ba8-9200-29ec192e314a\",\n                    \"1f66701b-72a2-45be-abad-d14ba71a78e0\",\n                    \"862cc5cf-2295-40f3-8bfb-bf1832c716e0\",\n                    \"c0743415-e5c5-48da-a6ec-a2d0571da863\",\n                    \"1340cde2-dcef-48de-a00e-1ce996ecf377\",\n                    \"131c9433-90a2-40b8-9e02-b774761c2456\"\n                ],\n                \"collapse\": false,\n                \"style\": \"{\\\"contentStyle\\\":{\\\"background\\\":\\\"#f8e71c\\\"}}\",\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Js\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"JavaScript is a **prototype\\\\-based**, multi\\\\-paradigm, single\\\\-threaded, dynamic language, supporting object\\\\-oriented, imperative, and declarative \\\\(e.g. functional programming\\\\) styles.\\n\\nIt is a lightweight, interpreted, or just\\\\-in\\\\-time compiled programming language. Which involves two phases  \\n* Parsing/Compilation, and\\n* Execution\\\\.\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a37aef6c-b62c-423c-8124-c18edc14142b\",\n                \"parentKey\": \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                \"subKeys\": [\n                    \"24a0e9fa-2a33-4e0d-8736-ec434151a6d0\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Generator\\nfunction\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A **generator** is a function that can stop midway and then continue from where it stopped. In short, a generator appears to be a function but it behaves like an iterator.\\n\\n**example 1:** function declaration form **function\\\\* <name\\\\>\\\\(\\\\)**\\n```\\nfunction* generatorFunction() {\\n  console.log('This will be executed first.');\\n  yield 'Hello, ';\\n  console.log('I will be printed after the pause');  \\n  yield 'World!';\\n}\\nconst generatorObject = generatorFunction();\\n\\nconsole.log(generatorObject.next().value);\\n// output:\\n// This will be executed first.\\n// Hello, \\nconsole.log(generatorObject.next().value);\\n// output:\\n// I will be printed after the pause\\n// World!\\nconsole.log(generatorObject.next().value);\\n// output:\\n// undefined\\n\\n```\\n\\n**example 2: **function expression form **function\\\\* \\\\(\\\\)**\\n```\\nconst indexGenerator = function* () {\\n  let index = 0;\\n  while(true) {\\n    yield index++;\\n  }\\n};\\nconst g = indexGenerator();\\nconsole.log(g.next().value); // => 0\\nconsole.log(g.next().value); // => 1\\n\\n```\\n\\n**example 3: **Shorthand method definition form **\\\\*<name\\\\>\\\\(\\\\)**\\n```\\nconst obj = {\\n  *indexGenerator() {\\n    var index = 0;\\n    while(true) {\\n      yield index++;\\n    }\\n  }\\n}\\nconst g = obj.indexGenerator();\\nconsole.log(g.next().value); // => 0\\nconsole.log(g.next().value); // => 1\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"62774116-bea5-49c3-a72c-6371f1cde7cb\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"find\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"9c9627b1-6bba-4135-955e-608e6a937ed1\",\n                \"parentKey\": \"7662833c-7ece-4668-a37b-4e11820503b4\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"d3f7bd55-fe91-45b2-b13e-ea98bb7710d9\",\n                \"parentKey\": \"10d9744a-f521-4bdf-8933-9c3fb1cfb2c8\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\",\n                \"parentKey\": \"9b52509a-42df-4ba8-9200-29ec192e314a\",\n                \"subKeys\": [\n                    \"6608af00-8cd4-4fe1-bd0b-e18e12f4a684\",\n                    \"bb6f8cdb-b6ee-4040-9195-170825342ded\",\n                    \"12256f82-0a50-4408-8a76-525865cbad4b\",\n                    \"88317110-d644-4ca9-84bf-01ae778571da\",\n                    \"af72cd3d-9be6-4420-9c07-1a80e2c62e2d\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Set &\\nmethods\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"fc11e9b2-fb2a-4f5d-934e-65c172bb61fa\",\n                \"parentKey\": \"2c6ddd66-98a5-4410-b7f2-dbd42aaa7e01\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Function\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A function is a code snippet that can be called by other code or by itself, or a variable that refers to the function. When a function is called, optionally arguments are passed to the function as input, and the function can return a value. \\n\\nA function in JavaScript is also an **object**.\\n\\n```\\nconsole.log(typeof(x => x * 2)); // \\\"function\\\"\\nconsole.log(typeof(function(){})); // \\\"function\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"b31ac6cb-b3c3-4dd2-83a1-6b5b7466d048\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Null\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"In JavaScript, null is **not** a reference to a non\\\\-existing object or a null pointer like in some other languages. Its just a special value which represents **nothing**, **empty** or **value unknown**.\\n\\nThe special **null** value does not belong to any of the types described above.\\n```\\nconsole.log(typeof(null)); // \\\"object\\\"\\n\\n// This is a bug and one that unfortunately cant be fixed, \\n// because it would break existing code.\\n// https://2ality.com/2013/10/typeof-null.html\\n\\n```\\n\\nIt forms a separate type of its own which contains only the null value:\\n```\\nlet age = null;\\nconsole.log(age); // null\\n\\n```\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"24a0e9fa-2a33-4e0d-8736-ec434151a6d0\",\n                \"parentKey\": \"a37aef6c-b62c-423c-8124-c18edc14142b\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"05c8bbd0-fe13-4906-92cf-8507b33954da\",\n                \"parentKey\": \"252c6937-bd93-4233-90cb-333938667c72\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"var\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"Value stored in it can be **reassigned**. Variables, declared with var, are either function\\\\-scoped or global\\\\-scoped. \\\\(will see more of that in **Scopes & Closures**\\\\). Their visibility is scoped to current function, or global, if declared outside function.\\n\\nTo declare or create a varaible\\n```\\nvar message;\\n\\n```\\n\\nAssign a data into it by using the assignment operator **=**\\n```\\nmessage = 'Hello';\\n\\n```\\n\\nCombine the variable _declaration_ and _assignment_ into a single line\\n```\\nvar message = 'Hello!';\\n\\n```\\n\\nDeclare multiple variables in one line\\n```\\nvar user = 'John', age = 25, message = 'Hello';\\n\\n```\\n\\nReassigning a value\\n```\\nvar userName = \\\"Bruce\\\"\\nuserName = \\\"Wayne\\\"\\n\\nconsole.log(userName) // \\\"Wayne\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"28bcdae2-e48d-47e3-bc28-5f6afecfef7d\",\n                \"parentKey\": \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"delete\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"bb6f8cdb-b6ee-4040-9195-170825342ded\",\n                \"parentKey\": \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"clear\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a44085f3-06c0-4910-9787-af5b20c0709b\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": \"{\\\"contentStyle\\\":{\\\"background\\\":\\\"#9b9b9b\\\"}}\",\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Module scope\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**Module Scope **\\\\- A module is just a file. One script is one module. Modules can load each other and use special directives export and import to interchange functionality, call functions of one module from another one:\\n\\n* **export** keyword labels variables and functions that should be accessible from outside the current module.\\n* **import** allows the import of functionality from other modules.\\n\\n\\nBefore modules, a variable declared outside any function was a global variable. In modules, a variable declared outside any function is hidden and not available to other modules unless it is explicitly exported.\\n\\nTo make import/export work, browsers need **<script type=\\\"module\\\"\\\\> **and for NodeJS \\\\- set **\\\"type\\\": \\\"module\\\"** in the **package\\\\.json** or use the **.mjs** extension\\\\.\\n\\n**Example 1:**\\nFor instance, if we have a file** sayHi\\\\.mjs** exporting a function:\\n```\\n//  sayHi.mjs\\nexport function sayHi(user) {\\n  console.log(`Hello, ${user}!`);\\n}\\n\\n```\\n\\nThen another file may import and use it:\\n```\\n//  main.mjs\\nimport {sayHi} from './sayHi.mjs';\\n\\nconsole.log(sayHi); // function...\\nsayHi('John'); // Hello, John!\\n\\n```\\n\\n**Example 2:**\\n**circle\\\\.mjs**\\n```\\n// \\\"circle\\\" module scope\\nconst pi = 3.14159;\\n\\nconsole.log(pi); // 3.14159\\n\\n// Usage of pi\\n\\n```\\n\\n**main\\\\.mjs**\\n```\\nimport './circle';\\n\\nconsole.log(pi); // ReferenceError: pi is not defined\\n\\n```\\n\\nThe variable pi is **not accessible** outside of circle module \\\\(unless explicitly exported using export\\\\).\\n\\n**Refference**:\\n* [https://hacks.mozilla.org/2018/03/es\\\\-modules\\\\-a\\\\-cartoon\\\\-deep\\\\-dive/](https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/)\\n* [https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Guide/Modules](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules)\\n* [https://javascript.info/modules\\\\-intro](https://javascript.info/modules-intro)\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a3055667-8217-484e-aae8-728cab93135c\",\n                \"parentKey\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"for .. of\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **for\\\\-of** loop is similar to the for\\\\-in loop because it loops over iterable objects. It invokes a custom iteration hook with statements to be executed for the value of each distinct property of the object. Compared to the for\\\\-in loop, it is newer and automatically uses an iterator.\\n\\n**Syntax:**\\n```\\nfor (let i of object) {\\n    console.log(i);\\n}\\n\\n```\\nIf the object is an array, the for\\\\-of loop will **print out the values** of the arrays indexes in order.\\n\\n**example 1:**\\n```\\nlet arr = [3, 5, 7];\\n\\nfor (let i of arr) {\\n  console.log(i);\\n}\\n\\n// output:\\n// 3\\n// 5\\n// 7\\n\\n```\\n\\n**example 2:**\\n```\\nconst items = {\\n  'first': new Date(),\\n  'second': 2,\\n  'third': 'test'\\n}\\n\\nfor (let i of items) {\\n  console.log(i);\\n}\\n\\n// Output: TypeError: items is not iterable\\n\\n```\\n\\n**example 3: **And it gets all the **values** of all postivie index\\n```\\nconst array = [1, 2, 3, { id: 254, name: \\\"Chris\\\" }]\\n\\narray[5] = 5\\narray[-6] = 6;\\narray[\\\"name\\\"] = \\\"Lars\\\"\\n\\nfor (let value of array)\\n    console.log(`Value: ${value}`);\\n    \\n// Output:\\n// Value: 1\\n// Value: 2\\n// Value: 3\\n// Value: [object Object]\\n// Value: undefined\\n// Value: 5\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"3993010c-2552-4c4e-ad7e-195cb2bbc7e5\",\n                \"parentKey\": \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Constructor\\nfunction\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a9f8d9be-7d66-4b3e-941d-429c02913ec5\",\n                \"parentKey\": \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Arrow\\nfunction\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"An **arrow function** is defined using a pair of parenthesis that contains the list of parameters \\\\(param1, param2, ..., paramN\\\\), followed by a fat arrow =\\\\> and a pair of curly braces \\\\{...\\\\} that delimits the body statements.\\n\\n**example 1:**\\n```\\nconst square = (value) => {\\n  return value * value\\n}\\nsquare(10); // output: \\\"100\\\"\\n\\n```\\n\\n**example 2:**\\n* When the arrow function has only one parameter, the pair of parentheses can be omitted. When it contains a single statement, the curly braces and return can be omitted too.\\n\\n```\\nconst square = value => value * value;\\nsquare(10); // output: \\\"100\\\"\\n\\n```\\n\\n**example 3:**\\n* when it takes no parameters\\n\\n```\\nconst currentDate = () => console.log(new Date().toString().slice(0,15));\\ncurrentDate(); // output: \\\"Wed Jul 21 2021\\\"\\n\\nconst currentTime = _ => console.log(new Date().toTimeString().slice(0, 8));\\ncurrentTime(); // output: \\\"19:08:58\\\"\\n\\n```\\n\\n**example 4:**\\n```\\nlet add = (a, b) => a + b;\\n\\nconst result = add(2, 2);\\nconsole.log(result); // output: \\\"4\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"265fb26e-4629-437b-8e64-aa7ce30ae47a\",\n                \"parentKey\": \"252c6937-bd93-4233-90cb-333938667c72\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"let\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"Value stored in it can be reassigned. Let is **blocked** scope \\\\(will see more of that in **Scopes & Closures**\\\\).\\n\\nTo declare or create a varaible\\n```\\nlet message;\\n\\n```\\n\\nAssign a data into it by using the assignment operator =:\\n```\\nmessage = 'Hello';\\n\\n```\\n\\nCombine the variable _declaration_ and _assignment_ into a single line\\n```\\nlet message = 'Hello!';\\n\\n```\\n\\nDeclare multiple variables in one line\\n```\\nlet user = 'John', age = 25, message = 'Hello';\\n\\n```\\n\\nReassigning a value\\n```\\nlet userName = \\\"Bruce\\\"\\nuserName = \\\"Wayne\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"c1f96a01-5d07-4fd0-99fb-210490cb6f5a\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"concat\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"parentKey\": \"44213600-22aa-4972-aa99-eec27b840064\",\n                \"subKeys\": [\n                    \"c92fd58b-57a4-4c72-897a-d1c394f9a8aa\",\n                    \"1590d94a-ef69-4f89-9e2d-a3de018ca2d4\",\n                    \"5c6ad5d4-eb49-479c-be03-0b8d8e805cee\",\n                    \"4567082c-b57b-45f4-8c04-168f9a2f123f\",\n                    \"b31ac6cb-b3c3-4dd2-83a1-6b5b7466d048\",\n                    \"b5c8a0d0-01e6-4922-a8f0-132d5442bb1d\",\n                    \"e784d8b5-f79b-469c-8fa4-e7305d4405b3\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Primitive\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"All primitive values are **immutable**, means **unchangeable**. Read\\\\-only. The variable may be reassigned a new value, but the existing value can not be changed in the ways that objects, arrays, and functions can be altered.\\n\\n**Example 1:**\\n```\\nExample 1:\\nlet str = 'hello';\\nconsole.log(str[0]); // \\\"h\\\"\\nstr[0] = 'j';\\nconsole.log(str); // \\\"hello\\\"\\n\\n```\\n\\n**Example 2:**\\nhttps://github.com/getify/You\\\\-Dont\\\\-Know\\\\-JS/blob/2nd\\\\-ed/get\\\\-started/apA.md\\n```\\nlet myName = \\\"Kyle\\\";\\nlet yourName = myName;\\nmyName = \\\"Frank\\\";\\nconsole.log(myName); // \\\"Frank\\\"\\nconsole.log(yourName); // \\\"Kyle\\\"\\n\\n```\\n**yourName** wasn't affected by the re\\\\-assignment of **myName** to \\\"Frank\\\"? That's because each variable holds its own copy of the value.\\n\\n**Example 3:**\\n```\\n// Using a string method doesn't mutate the string\\nvar bar = \\\"baz\\\";\\nconsole.log(bar);               // baz\\nbar.toUpperCase();\\nconsole.log(bar);               // baz\\n\\n// Assignment gives the primitive a new (not a mutated) value\\nbar = bar.toUpperCase();       // BAZ\\n\\n```\\n\\nFor more info \\\\- [https://developer.mozilla.org/en\\\\-US/docs/Glossary/Primitive](https://developer.mozilla.org/en-US/docs/Glossary/Primitive)\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"1590d94a-ef69-4f89-9e2d-a3de018ca2d4\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"BigInt\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"In JavaScript, the **number** type cannot represent integer values larger than \\\\(253\\\\-1\\\\) \\\\(thats 9007199254740991\\\\), or less than \\\\-\\\\(253\\\\-1\\\\) for negatives. Its a technical limitation caused by their internal representation.\\n\\n```\\nconsole.log(typeof(22234234n)); // \\\"bigint\\\"\\n\\n```\\n\\nA BigInt value is created by appending n to the end of an integer\\n```\\nconst bigInt = 1234567890123456789012345678901234567890n; // the \\\"n\\\" at the end means it's a BigInt\\n\\n```\\n\\nBigInt numbers are rarely needed\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"65199906-ca55-4ae8-bd9f-a4a08cbc2432\",\n                \"parentKey\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"while\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **while** loop loops through a block of code as long as the specified condition evaluates to true. As soon as the condition fails, the loop is stopped.\\n\\n**Syntax:**\\n\\n```\\nwhile(condition) {\\n    // as long as the condition is true\\n    // code in this block will be executed\\n}\\n\\n```\\n\\n**example 1:**\\n\\n```\\nlet count = 1;\\nwhile(count <= 5) {    \\n    console.log(\\\"The number is \\\" + count);\\n    count++;\\n}\\n\\n// Output:\\n// The number is 1\\n// The number is 2\\n// The number is 3\\n// The number is 4\\n// The number is 5\\n\\n```\\n\\n**example 2: **skipping current execution of loop using **continue** statement\\n\\n```\\nlet count = 1;\\nwhile(count <= 10) {\\n    if(count%2===0){\\n        count++;\\n        continue;\\n    }    \\n    console.log(\\\"The number is \\\" + count);\\n    count++;\\n}\\n\\n// Output:\\n// \\\"The number is 1\\\"\\n// \\\"The number is 3\\\"\\n// \\\"The number is 5\\\"\\n// \\\"The number is 7\\\"\\n// \\\"The number is 9\\\"\\n\\n```\\n\\n**example 3**: terminating current execution flow of the loop using **break** statement\\n\\n```\\nlet count = 1;\\nwhile(true) {\\n    if(count===10){\\n        break;\\n    }    \\n    console.log(\\\"The number is \\\" + count);\\n    count++;\\n}\\n\\n// Output:\\n// \\\"The number is 1\\\"\\n// \\\"The number is 2\\\"\\n// \\\"The number is 3\\\"\\n// \\\"The number is 4\\\"\\n// \\\"The number is 5\\\"\\n// \\\"The number is 6\\\"\\n// \\\"The number is 7\\\"\\n// \\\"The number is 8\\\"\\n// \\\"The number is 9\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"f548ba3e-55f6-484d-8289-858f8fd28289\",\n                \"parentKey\": \"4567082c-b57b-45f4-8c04-168f9a2f123f\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"35cf3ece-a21e-4a8e-a8f8-d2b24a2b742d\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Global scope\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The scope of a variable declared with **var** is its current execution context and closures thereof, which is either the enclosing function and functions declared within it, or, for variables declared outside any function, global. \\n\\nYou can also assign a value to a variable For example, **x = 42**. This form creates an **undeclared global variable**. \\n\\n```\\nvar x = 0; // Declares x within file scope, then assigns it a value of 0.\\n\\nconsole.log(typeof z); // \\\"undefined\\\", since z doesn't exist yet\\n\\nfunction a() {\\n    var y = 2; // Declares y within scope of function a, then assigns it a value of 2.\\n\\n    console.log(x, y); // 0 2\\n\\n    function b() {\\n        x = 3; // Assigns 3 to existing file scoped x.\\n        y = 4; // Assigns 4 to existing outer y.\\n        z = 5; // Creates a new global variable z, and assigns it a value of 5.\\n        // (Throws a ReferenceError in strict mode.)\\n    }\\n\\n    b(); // Creates z as a global variable.\\n    console.log(x, y, z); // 3 4 5\\n}\\n\\na(); // Also calls b.\\nconsole.log(x, z);     // 3 5\\nconsole.log(typeof y); // \\\"undefined\\\", as y is local to function a\\n\\n```\\n\\n**Note: window** and **document**, for example, are global variables supplied by the **browser**. In a **Node** environment, you can access **global** object as a global variable.\\n\\n**Refference:**\\n* [https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Reference/Statements/var](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/var)\\n* https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Guide/Grammar\\\\_and\\\\_types#variable\\\\_scope\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"5499f8cd-26d8-4796-acc9-b138109bcea0\",\n                \"parentKey\": \"e784d8b5-f79b-469c-8fa4-e7305d4405b3\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"5c6ad5d4-eb49-479c-be03-0b8d8e805cee\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"String\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A string in JavaScript must be surrounded by quotes.\\n\\n```\\nconsole.log(typeof(\\\"hello\\\")); // \\\"string\\\"\\nconsole.log(typeof('hello')); // \\\"string\\\"\\nconsole.log(typeof(`hello`)); // \\\"string\\\"\\n\\n```\\n\\n```\\nlet str = \\\"Hello\\\";\\nlet str2 = 'Single quotes are ok too';\\nlet phrase = `can embed another ${str}`;\\n\\nconsole.log(\\\"Str:\\\", str, \\\"+\\\", \\\"Str2:\\\", str2, \\\"+\\\", \\\"Phrase:\\\", phrase);\\n// Str: Hello + Str2: Single quotes are ok too + Phrase: can embed another Hello\\n\\n```\\n\\nIn JavaScript, there are 3 types of quotes.\\n```\\nDouble quotes: \\\"Hello\\\".\\nSingle quotes: 'Hello'.\\nBackticks: `Hello`.\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"c92fd58b-57a4-4c72-897a-d1c394f9a8aa\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Number\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The number type represents both **integer** and **floating point** numbers\\\\.\\n\\n**Example 1: **Checking the type\\n```\\nconsole.log(typeof(2)); // \\\"number\\\"\\nconsole.log(typeof(-200)); // \\\"number\\\"\\nconsole.log(typeof(100.554)); // \\\"number\\\"\\nconsole.log(typeof(-99.99)); // \\\"number\\\"\\n\\n```\\n\\n```\\nlet age = 35\\nconst gravity = 9.81  // const for non-changing values\\nlet mass = 72         // mass in Kilogram\\nconst PI = 3.14       // pi a geometrical constant\\nconst boilingPoint = 100 // temperature in oC, boiling point of water which is a constant\\nconst bodyTemp = 37      // oC average human body temperature, which is a constant\\n\\nconsole.log(age, gravity, mass, PI, boilingPoint, bodyTemp) // 35 9.81 72 3.14 100 37\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"12256f82-0a50-4408-8a76-525865cbad4b\",\n                \"parentKey\": \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"delete\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"69e69b35-9400-4fb3-aa5e-e9315b4a6eba\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Closure\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A **closure** is the combination of a function bundled together \\\\(enclosed\\\\) with references to its surrounding state \\\\(the lexical environment\\\\). In other words, a closure gives you access to an outer functions scope from an inner function. In JavaScript, closures are created every time a function is created, at function creation time. In JavaScript, closures are created every time a function is created, at function creation time.\\n\\nThe closure **captures** variables from lexical environment.\\n```\\nfunction outerFunc() {\\n  let outerVar = 'I am outside!';\\n\\n  function innerFunc() {\\n    console.log(outerVar); // => logs \\\"I am outside!\\\"\\n  }\\n\\n  return innerFunc; // Even though this function is being returned it still remembers lexical environment\\n}\\n\\nconst myInnerFunc = outerFunc();\\nmyInnerFunc();\\n\\n```\\nNow **innerFunc\\\\(\\\\)** is executed outside of its lexical scope. And whats important. **innerFunc\\\\(\\\\)** still has access to **outerVar** from its **lexical scope**, _even being executed outside of its lexical scope_.\\n\\nIn other words, **innerFunc\\\\(\\\\) **closes over \\\\(a.k.a. captures, remembers\\\\) the variable outerVar from its lexical scope.\\n\\n**Refference:**\\n* [https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Closures](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)\\n* https://javascript.info/closure#lexical\\\\-environment\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"131c9433-90a2-40b8-9e02-b774761c2456\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": \"{\\\"contentStyle\\\":{\\\"background\\\":\\\"#f1919f\\\",\\\"borderStyle\\\":\\\"none\\\"},\\\"linkStyle\\\":{\\\"lineType\\\":\\\"curve\\\"}}\",\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"OOP\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"af72cd3d-9be6-4420-9c07-1a80e2c62e2d\",\n                \"parentKey\": \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"forEach\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"50256453-3cf5-4adf-85c0-562970b46468\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [\n                    \"c007d461-f421-48fd-9566-ac88d298bbb8\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Block scope\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**Block scope** \\\\- A code block in JavaScript defines a scope for variables declared using **let** and **const **within a curly brace **\\\\{\\\\}. **it can be accessed only within that curly brace.\\n\\n**Example 1:**\\n```\\nif (true) {\\n  // \\\"if\\\" block scope\\n  const message = 'Hello';\\n  let name = \\\"Chris\\\"\\n  console.log(message); // 'Hello'\\n  console.log(name); // 'Chris'\\n}\\nconsole.log(message); // throws ReferenceError\\nconsole.log(name); // throws ReferenceError\\n\\n```\\n\\n**Example 2:**\\n```\\nlet fullMoon = true;\\n\\n// Initialize a global variable\\nlet species = \\\"human\\\";\\n\\nif (fullMoon) {\\n  // Initialize a block-scoped variable\\n  let species = \\\"werewolf\\\";\\n  console.log(`${species}`); // \\\"werewolf\\\"\\n}\\n\\nconsole.log(`${species}`); // \\\"human\\\"\\n\\n```\\n\\n**Example 3: var is not block scoped**\\n```\\nif (true) {\\n  // \\\"if\\\" block scope\\n  var count = 0;\\n  console.log(count); // 0\\n}\\nconsole.log(count); // 0\\n\\n```\\n\\nA code block does not create a scope for var variables, but a function body does.\\n\\n**Refference:**\\n* [https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Reference/Statements/block](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/block)\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                \"parentKey\": \"9b52509a-42df-4ba8-9200-29ec192e314a\",\n                \"subKeys\": [\n                    \"c261d5f7-915b-4abd-b3d1-47ef335bc8ff\",\n                    \"28bcdae2-e48d-47e3-bc28-5f6afecfef7d\",\n                    \"ed43d880-a946-4d1f-8a16-fc59a0662188\",\n                    \"a6c4854c-be38-4f7f-9866-a0025b236e65\",\n                    \"af8c79c0-2a79-40e8-a7ff-5edf08399e5b\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Map &\\nmethods\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"50256453-3cf5-4adf-85c0-562970b46468\",\n                    \"7662833c-7ece-4668-a37b-4e11820503b4\",\n                    \"a44085f3-06c0-4910-9787-af5b20c0709b\",\n                    \"4c35fca7-ac9c-4475-99ab-d77f97120360\",\n                    \"35cf3ece-a21e-4a8e-a8f8-d2b24a2b742d\",\n                    \"84650864-61f6-4e20-b87d-ed779ffa7d20\",\n                    \"69e69b35-9400-4fb3-aa5e-e9315b4a6eba\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Scopes & \\nClosure\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **current context of execution**. The context in which values and expressions are \\\"visible\\\" or can be referenced. If a variable or other expression is not \\\"in the current scope,\\\" then it is unavailable for use. Scopes can also be layered in a hierarchy, so that child scopes have access to parent scopes, but not vice versa.\\n\\nDifference Between **var**, **let**, and **const**\\n```\\n| Keyword |     Scope      | Hoisting | Can Be Reassigned | Can Be Redeclared |\\n| :-----: | :------------: | :------: | :---------------: | :---------------: |\\n|   var   | Function scope |   Yes    |        Yes        |        Yes        |\\n|   let   |  Block scope   |    No    |        Yes        |        No         |\\n|  const  |  Block scope   |    No    |        No         |        No         |\\n\\n```\\n\\n**Reference** \\n* [https://javascript.info/var](https://javascript.info/var)\\n* [https://javascript.info/closure](https://javascript.info/closure)\\n* [https://developer.mozilla.org/en\\\\-US/docs/Glossary/Scope](https://developer.mozilla.org/en-US/docs/Glossary/Scope)\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"45b02b6a-06f9-4bad-80bb-14c97acb3b80\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"unshift\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"10d9744a-f521-4bdf-8933-9c3fb1cfb2c8\",\n                \"parentKey\": \"3854fdd8-7de4-429c-b73d-2519cbf63781\",\n                \"subKeys\": [\n                    \"d3f7bd55-fe91-45b2-b13e-ea98bb7710d9\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"else Statement\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**if** statement can be extended with an **else** statement, which adds another block to run when the **if** condition doesnt pass.\\n\\n**Syntax:**\\n```\\nif (condition) {\\n      //when condition is true this block will be executed\\n      // no futher conditions will be checked\\n} else {\\n      //when a condition is false/failed this block will be executed\\n}\\n\\n```\\n\\n**example:**\\n```\\nif (\\\"cat\\\" === \\\"dog\\\") {\\n      console.log(\\\"if block executed\\\");\\n} else {\\n      console.log(\\\"else block executed\\\");\\n}\\n// Output: \\\"else block executed\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"3854fdd8-7de4-429c-b73d-2519cbf63781\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"ffcc44e2-dc44-4241-8c15-ee2ab8c71588\",\n                    \"10d9744a-f521-4bdf-8933-9c3fb1cfb2c8\",\n                    \"9677e53a-05a4-4bd6-9010-f10826426bb6\",\n                    \"62136ee4-f92e-49fb-b4de-03911ffe1da1\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Conditional\\nStatements\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"Conditional statements controls behavior and determines whether or not a piece of code can run.\\n\\n## Truthy\\n\\nIn JavaScript, a truthy value is a value that is considered true when encountered in a Boolean context. All values are truthy unless they are defined as falsy \\\\(i.e., except for false, 0, \\\\-0, 0n, \\\"\\\", null, undefined, and NaN\\\\).\\n\\n**Examples of truthy values** in JavaScript \\\\(which will be coerced to true in boolean contexts, and thus execute the if block\\\\)\\n```\\nif (true)\\n    if ({})\\n        if ([])\\n            if (42)\\n                if (\\\"0\\\")\\n                    if (\\\"false\\\")\\n                        if (new Date())\\n                            if (-42)\\n                                if (12n)\\n                                    if (3.14)\\n                                        if (-3.14)\\n                                            if (Infinity)\\n                                                if (-Infinity)\\n                                                    console.log(\\\"Yay!!! Success\\\")                                                    \\n// Output - \\\"Yay!!! Success\\\"\\n\\n```\\n\\n\\n## Falsy\\n\\nA falsy \\\\(sometimes written falsey\\\\) value is a value that is considered false when encountered in a Boolean context.\\n\\n**Complete list of JavaScript falsy values**\\n| false | The keyword false. |\\n|:--- |:--- |\\n| 0 | The Number zero \\\\(so, also 0.0, etc., and 0x0\\\\). |\\n| \\\\-0 | The Number negative zero \\\\(so, also \\\\-0.0, etc., and \\\\-0x0\\\\). |\\n| 0n | The BigInt zero \\\\(so, also 0x0n\\\\). Note that there is no BigInt negative zero  the negation of 0n is 0n. |\\n| \\\"\\\", | '', \\\\`\\\\` Empty string value. |\\n| null | null  the absence of any value. |\\n| undefined | undefined  the primitive value. |\\n| NaN | NaN  not a number. |\\n| document\\\\.all | Objects are falsy if and only if they have the \\\\[\\\\[IsHTMLDDA\\\\]\\\\] internal slot.That slot only exists in document.all and cannot be set using JavaScript. |\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"4c35fca7-ac9c-4475-99ab-d77f97120360\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [\n                    \"75e32173-5b17-4d07-b761-2003054bf186\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Scope chain\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**Scope chain** \\\\- When a variable is used in JavaScript, the JavaScript engine will try to find the variables value in the current scope. If it could not find the variable, it will look into the outer scope and will continue to do so until it finds the variable or reaches global scope.\\n\\nIf its still could not find the variable, it will either implicitly declare the variable in the global scope \\\\(if not in strict mode\\\\) or return an error.\\n\\n**Example 1:**\\n```\\nfunction run() {\\n  // \\\"run\\\" function scope\\n  const message = 'Run, Forrest, Run!';\\n\\n  if (true) {\\n    // \\\"if\\\" code block scope\\n    const friend = 'Bubba';\\n    console.log(message); // 'Run, Forrest, Run!'\\n  }\\n\\n  console.log(friend); // throws ReferenceError\\n}\\n\\nrun();\\n\\n```\\n\\nThe scope contained within another scope is named **_inner scope_**. In the example, if code block scope is an inner scope of run\\\\(\\\\) function scope. The scope that wraps another scope is named **_outer scope_**. In the example, run\\\\(\\\\) function scope is an outer scope to if code block scope.\\n\\n**example 2:**\\n```\\n// global scope\\nvar e = 10;\\nfunction sum(a){\\n  return function sum2(b){\\n    return function sum3(c){\\n      // outer functions scope\\n      return function sum4(d){\\n        // local scope\\n        return a + b + c + d + e;\\n      }\\n    }\\n  }\\n}\\n\\nvar sum2 = sum(1);\\nvar sum3 = sum2(2);\\nvar sum4 = sum3(3);\\nvar result = sum4(4);\\nconsole.log(result) //log 20\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"84650864-61f6-4e20-b87d-ed779ffa7d20\",\n                \"parentKey\": \"08aaf5bf-5222-4d4c-bd8d-2267d2f81433\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Hoisting\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"Hoisting is a JavaScript mechanism where variables and function declarations are **moved to the top of their scope** before code execution.\\n\\nWhen you execute a piece of JavaScript code, the JavaScript engine creates the **global execution context**. The global execution context has two phases: **creation** and **execution**. During the creation phase, the JavaScript engine moves the variable and function declarations to the top of your code. This feature is known as **_hoisting_** in JavaScript.\\n\\n## Variable hoisting\\n\\n* using **var**\\n\\n```\\nconsole.log(counter); // undefined\\nvar counter = 1;\\n\\n```\\n\\n* using **let**\\n\\n```\\nconsole.log(counter); // \\\"ReferenceError: Cannot access 'counter' before initialization\\nlet counter = 1;\\n\\n```\\n\\n\\n## Function hoisting\\n\\n```\\nlet x = 20,\\n    y = 10;\\n\\nlet result = add(x,y);\\n\\nconsole.log(add) //  add(a, b){\\n                 //  return a + b;\\n                 //  }\\n\\nconsole.log(result); // 30\\n\\nfunction add(a, b){\\nreturn a + b;\\n}\\n\\n```\\n\\n\\n## Function expressions\\n\\n```\\nlet x = 20,\\n    y = 10;\\n\\nlet result = add(x,y);\\nconsole.log(result); // \\\"TypeError: add is not a function\\n\\nvar add = function(x, y) {\\nreturn x + y;\\n}\\n\\n```\\n\\n```\\nlet x = 20,\\n    y = 10;\\n\\nlet result = add(x,y);\\nconsole.log(result); // \\\"TypeError: add is not a function\\n\\nvar add = (x, y) => x + y;\\n\\n```\\n\\nDuring the creation phase of the **global execution context**, the JavaScript Engine creates the **add** variable in the memory and initializes its value to **undefined**. When executing the following code, the add is undefined, hence, it isnt a function.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"6608af00-8cd4-4fe1-bd0b-e18e12f4a684\",\n                \"parentKey\": \"5c0d4a18-5da2-4f3f-9752-4912ae3df225\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"add\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"ebc9a270-2a40-4a5c-bf55-79f90cd5f8ce\",\n                \"parentKey\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"shift\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"85ee6b37-5053-4f78-b25d-53d1bf11d87b\",\n                \"parentKey\": \"252c6937-bd93-4233-90cb-333938667c72\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"const\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The keyword **const** is an abbreviation for **constant**. Similar to **let**, its **block\\\\-scoped**, however, you cant reassigned it and value must be provided when declaring it.\\n\\n**Example 1:**\\n```\\nconst pi = 3.14\\nconsole.log(\\\"Pi :\\\", pi); // 3.14\\n\\n```\\n\\n**Example 2:**\\n```\\nconst gravity; // SyntaxError: Missing initializer in const declaration\\n\\n```\\n\\n**Example 3:**\\n```\\nconst name = \\\"Chris\\\"\\nname = \\\"Jordan\\\" // TypeError: Assignment to constant variable.\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"62136ee4-f92e-49fb-b4de-03911ffe1da1\",\n                \"parentKey\": \"3854fdd8-7de4-429c-b73d-2519cbf63781\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"switch\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **switch** statement evaluates an expression, matching the expression's value to a case clause, and executes statements associated with that case, as well as statements in cases that follow the matching case.\\n\\n**Example 1:** expression matches a case\\nThe **break** statement terminates the current flow of execution\\n```\\nconst expr = 'Papayas';\\nswitch (expr) {\\n  case 'Oranges':\\n    console.log('Oranges are $0.59 a pound.');\\n    break;\\n  case 'Mangoes':\\n  case 'Papayas':\\n    console.log('Mangoes and papayas are $2.79 a pound.');\\n    break;\\n  default:\\n    console.log(`Sorry, we are out of ${expr}.`);\\n}\\n\\n// output: \\\"Mangoes and papayas are $2.79 a pound.\\\"\\n\\n```\\n\\n**Example 2:** expression did not match any cases\\n```\\nconst expr = 'Onion';\\nswitch (expr) {\\n  case 'Oranges':\\n    console.log('Oranges are $0.59 a pound.');\\n    break;\\n  case 'Mangoes':\\n  case 'Papayas':\\n    console.log('Mangoes and papayas are $2.79 a pound.');\\n    break;\\n  default:\\n    console.log(`Sorry, we are out of ${expr}.`);\\n}\\n\\n// output: \\\"Sorry, we are out of Onion.\\\"\\n\\n```\\n\\n**Example 3:** expression matches a case but break statement is not specified\\nIf you forget a _break_ then the script will run from the case where the criterion is met and will run the cases after that _regardless if a criterion was met_.\\n```\\nconst expr = 'Oranges';\\nswitch (expr) {\\n  case 'Oranges':\\n    console.log('Oranges are $0.59 a pound.');\\n  case 'Mangoes':\\n  case 'Papayas':\\n    console.log('Mangoes and papayas are $2.79 a pound.');\\n  default:\\n    console.log(`Sorry, we are out of ${expr}.`);\\n}\\n\\n// Output:\\n// Oranges are $0.59 a pound.\\n// Mangoes and papayas are $2.79 a pound.\\n// Sorry, we are out of Oranges.\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"2c6ddd66-98a5-4410-b7f2-dbd42aaa7e01\",\n                \"parentKey\": \"44213600-22aa-4972-aa99-eec27b840064\",\n                \"subKeys\": [\n                    \"dbc9a664-bff0-4263-811c-cb91470ce277\",\n                    \"fc11e9b2-fb2a-4f5d-934e-65c172bb61fa\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Non-primitive\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"Non\\\\-primitive are mutuable means '**changeable**'.  Only object values \\\\(arrays, objects, functions, etc.\\\\) are treated as references\\n\\n**Example 1:**\\n```\\nlet arr = [212, 8, 506];\\nconsole.log(arr[0]); // 212\\narr[0] = 420;\\nconsole.log(arr); // [420, 8, 506]\\n\\n```\\n\\n**Example 2 \\\\-**\\n[https://github.com/getify/You\\\\-Dont\\\\-Know\\\\-JS/blob/2nd\\\\-ed/get\\\\-started/apA.md](https://github.com/getify/You-Dont-Know-JS/blob/2nd-ed/get-started/apA.md)\\n```\\nlet myAddress = {\\n    street: \\\"123 JS Blvd\\\",\\n    city: \\\"Austin\\\",\\n    state: \\\"TX\\\"\\n};\\n\\nlet yourAddress = myAddress;\\n\\nmyAddress.street = \\\"456 TS Ave\\\";\\n\\nconsole.log(yourAddress.street); // 456 TS Ave\\nconsole.log(myAddress.street) // 456 TS Ave\\n\\n```\\n\\nValue assigned to **myAddress** is an object, it's held/assigned by reference, and thus the assignment to the **yourAddress** variable is a copy of the reference, not the object value itself. That's why the updated value assigned to the myAddress.street is reflected when we access yourAddress.street. myAddress and yourAddress have copies of the **reference to the single shared object**, so an update to one is an update to both.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"89f35d77-be58-421f-96f1-c53ebf79d892\",\n                    \"79a87fe8-34ea-45e0-90b4-ee2399074191\",\n                    \"3993010c-2552-4c4e-ad7e-195cb2bbc7e5\",\n                    \"277f12bf-6cef-4676-92bb-ee233886e4cb\",\n                    \"e153daae-cd39-4033-bd24-8fcf1a6f9f84\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Objects\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"e153daae-cd39-4033-bd24-8fcf1a6f9f84\",\n                \"parentKey\": \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Object.create()\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"44213600-22aa-4972-aa99-eec27b840064\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                    \"2c6ddd66-98a5-4410-b7f2-dbd42aaa7e01\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Data types\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"1. [https://javascript.info/types](https://javascript.info/types)\\n1. [https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Data\\\\_structures](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures)\\n1. [https://github.com/getify/You\\\\-Dont\\\\-Know\\\\-JS/blob/1st\\\\-ed/types%20%26%20grammar/ch1.md](https://github.com/getify/You-Dont-Know-JS/blob/1st-ed/types%20&%20grammar/ch1.md)\\n\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"ed43d880-a946-4d1f-8a16-fc59a0662188\",\n                \"parentKey\": \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"entries\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"ffcc44e2-dc44-4241-8c15-ee2ab8c71588\",\n                \"parentKey\": \"3854fdd8-7de4-429c-b73d-2519cbf63781\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"If Statement\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**If** statement only runs if the condition enclosed in parentheses \\\\(\\\\) is truthy\\n\\n**Syntax:**\\n```\\nif (condition) {\\n    //when condition is true this block will be executed\\n}\\n\\n```\\n\\n**example**:\\n```\\nif (10 > 5) {\\n    console.log(\\\"if blocked executed\\\");\\n}\\n\\n// Output - \\\"if blocked executed\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"dc0c93cb-0c05-40a0-9bd6-e6c1870c5613\",\n                \"parentKey\": \"9b52509a-42df-4ba8-9200-29ec192e314a\",\n                \"subKeys\": [\n                    \"c1f96a01-5d07-4fd0-99fb-210490cb6f5a\",\n                    \"fa03906c-9682-4352-98eb-3a4525a5780c\",\n                    \"62774116-bea5-49c3-a72c-6371f1cde7cb\",\n                    \"1c417f10-9197-42eb-a724-a2c99a488847\",\n                    \"f9aad4c2-5205-49ec-a74c-ed04c3bb6813\",\n                    \"8d03fe66-9d8f-4ae3-96c1-d18220788b3a\",\n                    \"ebc9a270-2a40-4a5c-bf55-79f90cd5f8ce\",\n                    \"45b02b6a-06f9-4bad-80bb-14c97acb3b80\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Array &\\nmethods\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"75e32173-5b17-4d07-b761-2003054bf186\",\n                \"parentKey\": \"4c35fca7-ac9c-4475-99ab-d77f97120360\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"252c6937-bd93-4233-90cb-333938667c72\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"05c8bbd0-fe13-4906-92cf-8507b33954da\",\n                    \"265fb26e-4629-437b-8e64-aa7ce30ae47a\",\n                    \"85ee6b37-5053-4f78-b25d-53d1bf11d87b\"\n                ],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Variables\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A variable is a **container** for a value or **named storage** for data. And it is a named reference to a value. That way an unpredictable value can be accessed through a predetermined name.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"862cc5cf-2295-40f3-8bfb-bf1832c716e0\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Classes\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"a6c4854c-be38-4f7f-9866-a0025b236e65\",\n                \"parentKey\": \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"forEach\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"89f35d77-be58-421f-96f1-c53ebf79d892\",\n                \"parentKey\": \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Object\\nliterals\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"**Shorthand** method definition can be used in a method declaration on object literals and ES2015 classes. You can define them using a function name, followed by a list of parameters in a pair of parenthesis \\\\(para1, ..., paramN\\\\) and a pair of curly braces \\\\{ ... \\\\} that delimits the body statements.\\n\\n```\\nconst collection = {\\n  items: [],\\n  add(...items) {\\n    this.items.push(...items);\\n  },\\n  get(index) {\\n    return this.items[index];\\n  }\\n};\\ncollection.add('C', 'Js', 'PHP', 'Java');\\nconsole.log(collection.get(1)) //output: \\\"Js\\\"\\n\\n```\\n\\n**add\\\\(\\\\)** and **get\\\\(\\\\)** methods in **collection** object are defined using short method definition. These methods are called as usual: **collection\\\\.add\\\\(...\\\\)** and **collection\\\\.get\\\\(...\\\\)**.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"0341d846-c3f3-4915-a4b3-0c11b3643a9d\",\n                \"parentKey\": \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Function\\ndeclaration\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"A **function** declaration \\\\(also called a function statement\\\\) consists of the function keyword, followed by:\\n* The **name** of the function.\\n* A list of **parameters** to the function, enclosed in parentheses and separated by commas.\\n* The JavaScript **statements** that define the function, enclosed in braces, **\\\\{**...**\\\\}**.\\n\\n\\n**Syntax:**\\n```\\nfunction validFunctionName(parameter1, parameter2) {\\n  return statement;\\n}\\n\\n```\\n\\n**example 1: which takes no parameters and returns nothing \\\\(void\\\\)**\\n```\\nfunction currentTime() {\\n  console.log(new Date().toTimeString().slice(0, 8));\\n}\\n\\ncurrentTime() // output: \\\"18:35:36\\\"\\n\\n```\\n\\n**example 2: which takes parameters and returns a value**\\nThe **return** statement ends function execution and specifies a value to be returned to the function caller.\\n```\\nfunction sum(a, b) {\\n  return a + b;\\n}\\nconst result = sum(5, 6);\\n\\nconsole.log(result); // output: \\\"11\\\"\\n\\n```\\n\\n**example 3**: **default parameters** \\n```\\nfunction showMessage(from, text = \\\"no text given\\\") {\\n  console.log( from + \\\": \\\" + text );\\n}\\n\\nshowMessage(\\\"Ann\\\"); // output: \\\"Ann: no text given\\\"\\nshowMessage(\\\"Ann\\\", \\\"Hello, world!\\\"); // output: \\\"Ann: Hello, world!\\\"\\n\\n```\\n\\n**example 4: constructor function **\\\\(will see more this in detail when it comes to **objects**\\\\)\\n```\\nfunction Emp(id, name) {\\n    this.id = id;\\n    this.name = name;\\n}\\n\\nlet emp1 = new Emp(1, \\\"John\\\");\\n\\nconsole.log(emp1.id); // output: \\\"1\\\"\\nconsole.log(emp1.name); // output: \\\"John\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"b5c8a0d0-01e6-4922-a8f0-132d5442bb1d\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": \"{\\\"contentStyle\\\":{\\\"background\\\":\\\"#50e3c2\\\"}}\",\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Undefined\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The special value undefined also stands apart. It makes a type of its own, just like null.\\n\\n```\\nconsole.log(typeof(undefined)); // \\\"undefined\\\"\\n\\n```\\n\\nThe meaning of undefined is **value is not assigned**. If a **variable is declared, but not assigned**, then its value is undefined:\\n```\\nlet age;\\nconsole.log(age); // shows \\\"undefined\\\"\\n\\n```\\n\\nTechnically, it is possible to explicitly assign undefined to a variable:\\n```\\nlet age = 100;\\n\\n// change the value to undefined\\nage = undefined;\\n\\nconsole.log(age); // shows \\\"undefined\\\"\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"dfb39c55-dfce-4d5a-88a7-5fd066288121\",\n                \"parentKey\": \"a1649782-ec29-4030-bb2d-d6044103cf10\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"e784d8b5-f79b-469c-8fa4-e7305d4405b3\",\n                \"parentKey\": \"06067a6c-cfd1-4faf-8aa6-5eb827f3d020\",\n                \"subKeys\": [\n                    \"5499f8cd-26d8-4796-acc9-b138109bcea0\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Symbol\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The JavaScript **ES6** introduced a new primitive data type called Symbol. A Symbol is a unique and immutable primitive value and may be used as the key of an Object property.\\n\\n```\\nconsole.log(typeof(Symbol())); // \\\"symbol\\\"\\n\\n```\\n\\n```\\n// two symbols with the same description\\n\\nconst value1 = Symbol('hello');\\nconst value2 = Symbol('hello');\\n\\nconsole.log(value1 === value2); // false\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"1340cde2-dcef-48de-a00e-1ce996ecf377\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Operators\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"840a8fff-1b5b-48bd-9aae-6214c599c5ab\",\n                \"parentKey\": \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Immediately invoked \\nfunction expression\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"An **IIFE** \\\\(Immediately Invoked Function Expression\\\\) is a JavaScript function that runs as soon as it is defined or as soon as it starts to executes.\\n\\n**Syntax:**\\n```\\n(function () {\\n  statements\\n})();\\n\\n```\\n* The first is the anonymous function with lexical scope enclosed within the Grouping Operator \\\\(\\\\). This prevents accessing variables within the IIFE idiom as well as polluting the global scope.\\n* The second part creates the immediately invoked function expression \\\\(\\\\) through which the JavaScript engine will directly interpret the function.\\n\\n\\n**example 1:**\\n```\\n(function () {\\n    console.log(\\\"Immediately invoked\\\")\\n})();\\n\\n```\\n\\n**example 2: **Avoid polluting the global namespace\\n* If we have some initiation code that we don't need to use again, we could use the IIFE pattern.\\n\\n```\\n(function () {\\n  // some initiation code\\n  let firstVariable;\\n  let secondVariable;\\n})();\\n\\n// firstVariable and secondVariable will be discarded after the function is executed.\\n\\n```\\n\\n**example 3: **stack trace\\n```\\n// Ex 1:\\n(function () {\\n    throw new Error(\\\"Exception has occurred\\\");\\n})();\\n\\n// Error: Exception has occurred\\n//     at /Users/git/other/js/test.js:2:11\\n//     at Object.<anonymous> (/Users/git/other/js/test.js:3:3)\\n//     at Module._compile (node:internal/modules/cjs/loader:1101:14)\\n//     at Object.Module._extensions..js (node:internal/modules/cjs/loader:1153:10)\\n//     at Module.load (node:internal/modules/cjs/loader:981:32)\\n//     at Function.Module._load (node:internal/modules/cjs/loader:822:12)\\n//     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:79:12)\\n//     at node:internal/main/run_main_module:17:47\\n\\n// Ex 2:\\n(function deposit() {\\n    throw new Error(\\\"Exception has occurred\\\");\\n})();\\n\\n// Error: Exception has occurred\\n//     at deposit (/Users/git/other/js/test.js:6:11)\\n//     at Object.<anonymous> (/Users/git/other/js/test.js:7:3)\\n//     at Module._compile (node:internal/modules/cjs/loader:1101:14)\\n//     at Object.Module._extensions..js (node:internal/modules/cjs/loader:1153:10)\\n//     at Module.load (node:internal/modules/cjs/loader:981:32)\\n//     at Function.Module._load (node:internal/modules/cjs/loader:822:12)\\n//     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:79:12)\\n//     at node:internal/main/run_main_module:17:47\\n\\n```\\nOne of the benefits of creating a named function expression is that in case we encountered an error, the stack trace will contain the name of the function, making it easier to find the origin of the error.\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"c007d461-f421-48fd-9566-ac88d298bbb8\",\n                \"parentKey\": \"50256453-3cf5-4adf-85c0-562970b46468\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"29f23365-fcf6-4f8f-8060-811df84e4770\",\n                \"parentKey\": \"d40f6cf0-dcae-4162-8b2f-d89edd7e3212\",\n                \"subKeys\": [\n                    \"c1e621c4-ae65-40d0-ad48-650368d181d0\"\n                ],\n                \"collapse\": true,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"for .. in\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"The **for\\\\-in** loop always loops over an objects elements one by one. It can be **array indexes** or **key incase of objects**. Iterates over all **enumerable property** keys of an object.\\n\\n**Syntax:**\\n```\\nfor (let i in object) {\\n    console.log(object[i]);\\n}\\n\\n```\\nIf the object is an array, the for\\\\-in loop will **print out the array indexes in order**. If the object contains key\\\\-value pairs, the for\\\\-in loop will **print out each key that exists**. A for...in loop iterates over the properties of an object in an **arbitrary** order\\n\\n**example 1:**\\n```\\nlet arr = [3, 5, 7];\\narr.foo = \\\"hello\\\";\\n\\nfor (let i in arr) {\\n  console.log(i); // by default it prints the indexes and key\\n}\\n\\n// output:\\n// 0\\n// 1\\n// 2\\n// foo\\n\\n```\\n\\n**example 2:**\\n```\\nconst object = { a: 1, b: 2, c: 3 };\\n\\nfor (const property in object) {\\n  console.log(property); // by default it prints the indexes and key\\n}\\n\\n// output:\\n// a\\n// b\\n// c\\n\\n```\\n\\n**example 3:**\\n```\\nconst object = { a: 1, b: 2, c: 3 };\\n\\nfor (const property in object) {\\n  console.log(`${property}: ${object[property]}`);\\n}\\n\\n// output:\\n// \\\"a: 1\\\"\\n// \\\"b: 2\\\"\\n// \\\"c: 3\\\"\\n\\n```\\n\\n**exmaple 4: **And it iterates over by **all index**.\\n```\\nconst array = [1, 2, 3, { id: 254, name: \\\"Chris\\\" }]\\n\\narray[5] = 5\\narray[-6] = 6;\\narray[\\\"name\\\"] = \\\"Lars\\\"\\n\\nfor (let index in array)\\n    console.log(`Index: ${index} & Value: ${array[index]}`);\\n    \\n// Output:\\n// Index: 0 & Value: 1\\n// Index: 1 & Value: 2\\n// Index: 2 & Value: 3\\n// Index: 3 & Value: [object Object]\\n// Index: 5 & Value: 5\\n// Index: -6 & Value: 6\\n// Index: name & Value: Lars\\n\\n```\\n\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"79a87fe8-34ea-45e0-90b4-ee2399074191\",\n                \"parentKey\": \"5df46409-6d87-4099-85c8-664e7e703c8e\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"new Object()\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"c261d5f7-915b-4abd-b3d1-47ef335bc8ff\",\n                \"parentKey\": \"3dc1c815-02b4-4097-ae29-578920b3a065\",\n                \"subKeys\": [],\n                \"collapse\": false,\n                \"style\": null,\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"clear\"\n                    }\n                ]\n            },\n            {\n                \"key\": \"f8750599-32db-4fb3-829e-0673887df2c2\",\n                \"parentKey\": \"7b11654a-e9d3-45ba-a1aa-afca29ff5f18\",\n                \"subKeys\": [\n                    \"0341d846-c3f3-4915-a4b3-0c11b3643a9d\",\n                    \"a1649782-ec29-4030-bb2d-d6044103cf10\",\n                    \"a9f8d9be-7d66-4b3e-941d-429c02913ec5\",\n                    \"a37aef6c-b62c-423c-8124-c18edc14142b\",\n                    \"840a8fff-1b5b-48bd-9aae-6214c599c5ab\"\n                ],\n                \"collapse\": false,\n                \"style\": \"{\\\"contentStyle\\\":{\\\"background\\\":\\\"#9eff88\\\"}}\",\n                \"blocks\": [\n                    {\n                        \"type\": \"CONTENT\",\n                        \"data\": \"Functions\"\n                    },\n                    {\n                        \"type\": \"DESC\",\n                        \"data\": \"Function is a \\\"subprogram\\\" that can be called by code external \\\\(or internal in the case of recursion\\\\) to the function. Like the program itself, a function is composed of a sequence of statements called the function body. Values can be passed to a function, and the function will return a value.\\n\\n**Referrence**:\\n* [https://developer.mozilla.org/en\\\\-US/docs/Web/JavaScript/Reference/Functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions)\\n\\n\"\n                    }\n                ]\n            }\n        ],\n        \"config\": {\n            \"readOnly\": false,\n            \"allowUndo\": true,\n            \"layoutDir\": 2,\n            \"theme\": {\n                \"name\": \"default\",\n                \"randomColor\": true,\n                \"background\": \"rgb(57,60,65)\",\n                \"highlightColor\": \"#50C9CE\",\n                \"marginH\": 60,\n                \"marginV\": 20,\n                \"contentStyle\": {\n                    \"lineHeight\": \"1.5\",\n                    \"fontSize\": \"16px\"\n                },\n                \"linkStyle\": {\n                    \"lineRadius\": 5,\n                    \"lineType\": \"curve\",\n                    \"lineWidth\": \"3px\"\n                },\n                \"rootTopic\": {\n                    \"contentStyle\": {\n                        \"fontSize\": \"36px\"\n                    },\n                    \"subLinkStyle\": {\n                        \"lineType\": \"curve\",\n                        \"lineWidth\": \"3px\"\n                    }\n                },\n                \"primaryTopic\": {\n                    \"contentStyle\": {\n                        \"fontSize\": \"24px\"\n                    },\n                    \"subLinkStyle\": {\n                        \"lineType\": \"curve\",\n                        \"lineWidth\": \"3px\"\n                    }\n                },\n                \"normalTopic\": {\n                    \"subLinkStyle\": {\n                        \"lineType\": \"curve\",\n                        \"lineWidth\": \"3px\"\n                    }\n                }\n            }\n        },\n        \"formatVersion\": \"0.0\"\n    });\n}\n","import React from \"react\";\nimport { OpType } from \"@blink-mind/core\";\nimport { FOCUS_MODE_SEARCH } from \"@blink-mind/plugins\";\nimport { iconClassName, IconName } from \"@blink-mind/renderer-react\";\n\nexport function ToolbarItemSearch(props) {\n  const onClickSearch = e => {\n    const { diagram } = props;\n    const diagramProps = diagram.getDiagramProps();\n    const { controller } = diagramProps;\n\n    controller.run(\"operation\", {\n      ...diagramProps,\n      opType: OpType.SET_FOCUS_MODE,\n      focusMode: FOCUS_MODE_SEARCH\n    });\n  };\n  return (\n    <div\n      className={`bm-toolbar-item ${iconClassName(IconName.SEARCH)}`}\n      onClick={onClickSearch}\n    />\n  );\n}\n","import React from \"react\";\nimport cx from \"classnames\";\nimport \"./Toolbar.css\";\nimport { iconClassName } from \"@blink-mind/renderer-react\";\nimport { ToolbarItemOpen } from \"./toolbar-item-open\";\nimport { ToolbarItemLayout } from \"./toolbar-item-layout\";\nimport { ToolbarItemTheme } from \"./toolbar-item-theme\";\nimport { ToolbarItemExport } from \"./toolbar-item-export\";\nimport { ToolbarItemSearch } from \"./toolbar-item-search\";\n\n// import debug from \"debug\";\n// const log = debug(\"app\");\n\nexport class Toolbar extends React.PureComponent {\n  render() {\n    const props = this.props;\n\n    const { onClickUndo, onClickRedo, canUndo, canRedo } = props;\n\n    return (\n      <div className=\"bm-toolbar\">\n        <ToolbarItemOpen {...props} />\n        <ToolbarItemExport {...props} />\n        <ToolbarItemTheme {...props} />\n        <ToolbarItemLayout {...props} />\n        <ToolbarItemSearch {...props} />\n\n        <div\n          className={cx(\"bm-toolbar-item\", iconClassName(\"undo\"), {\n            \"bm-toolbar-item-disabled\": !canUndo\n          })}\n          onClick={onClickUndo}\n        />\n\n        <div\n          className={cx(\"bm-toolbar-item\", iconClassName(\"redo\"), {\n            \"bm-toolbar-item-disabled\": !canRedo\n          })}\n          onClick={onClickRedo}\n        />\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Diagram } from \"@blink-mind/renderer-react\";\nimport RichTextEditorPlugin from \"@blink-mind/plugin-rich-text-editor\";\nimport { JsonSerializerPlugin } from \"@blink-mind/plugin-json-serializer\";\nimport { ThemeSelectorPlugin } from \"@blink-mind/plugin-theme-selector\";\nimport TopologyDiagramPlugin from \"@blink-mind/plugin-topology-diagram\";\nimport { TopicReferencePlugin, SearchPlugin } from \"@blink-mind/plugins\";\nimport { Toolbar } from \"./toolbar/toolbar\";\nimport { generateSimpleModel } from \"../utils\";\nimport \"@blink-mind/renderer-react/lib/main.css\";\nimport debug from \"debug\";\n\nconst log = debug(\"app\");\n\nconst plugins = [\n  RichTextEditorPlugin(),\n  ThemeSelectorPlugin(),\n  TopicReferencePlugin(),\n  SearchPlugin(),\n  TopologyDiagramPlugin(),\n  JsonSerializerPlugin()\n];\n\nexport class Mindmap extends React.Component {\n  constructor(props) {\n    super(props);\n    this.initModel();\n  }\n\n  diagram;\n  diagramRef = ref => {\n    this.diagram = ref;\n    this.setState({});\n  };\n\n  initModel() {\n    const model = generateSimpleModel();\n    this.state = { model };\n  }\n\n  onClickUndo = e => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run(\"undo\", props);\n  };\n\n  onClickRedo = e => {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    controller.run(\"redo\", props);\n  };\n\n  renderDiagram() {\n    return (\n      <Diagram\n        ref={this.diagramRef}\n        model={this.state.model}\n        onChange={this.onChange}\n        plugins={plugins}\n      />\n    );\n  }\n\n  renderToolbar() {\n    const props = this.diagram.getDiagramProps();\n    const { controller } = props;\n    const canUndo = controller.run(\"canUndo\", props);\n    const canRedo = controller.run(\"canRedo\", props);\n    const toolbarProps = {\n      diagram: this.diagram,\n      onClickUndo: this.onClickUndo,\n      onClickRedo: this.onClickRedo,\n      canUndo,\n      canRedo\n    };\n    return <Toolbar {...toolbarProps} />;\n  }\n\n  onChange = (model, callback) => {\n    this.setState(\n      {\n        model\n      },\n      callback\n    );\n  };\n\n  render() {\n    return (\n      <div className=\"mindmap\">\n        {this.diagram && this.renderToolbar()}\n        {this.renderDiagram()}\n      </div>\n    );\n  }\n}\n\nexport default Mindmap;\n","import React from \"react\";\nimport Mindmap from \"./component/mindmap\";\nimport \"./App.css\";\n\nfunction App() {\n  return <Mindmap />;\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nlet debugNameSpaces = [\n  \"app\",\n  // \"node:*\",\n  'plugin:layout'\n];\n\nlocalStorage.debug = debugNameSpaces.join(\",\");\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}